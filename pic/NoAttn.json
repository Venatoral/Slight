{"episode_reward_max": -2710.2284347334607, "episode_reward_min": -2777.7611822407725, "episode_reward_mean": -2742.9575346722454, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2712.429503177893, -2710.2284347334607, -2777.7611822407725, -2771.4110185368554], "episode_lengths": [1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 213.91928291273143, "mean_raw_obs_processing_ms": 24.626458423963374, "mean_inference_ms": 20.688180265755488, "mean_action_processing_ms": 0.12298621635684845}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 4000, "timers": {"sample_time_ms": 522536.606, "sample_throughput": 7.655, "learn_time_ms": 28752.571, "learn_throughput": 139.118, "update_time_ms": 32.84}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 0.21641788398846984, "policy_loss": -0.0034420686424709857, "vf_loss": 26928.95330810547, "vf_explained_var": -0.025675728917121887, "kl": 0.016063081187894568, "entropy": 52.64218807220459, "entropy_coeff": 0.001}}, "num_steps_sampled": 4000, "num_steps_trained": 4000}, "done": false, "episodes_total": 4, "training_iteration": 1, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-09_18-39-03", "timestamp": 1617964743, "time_this_iter_s": 551.517299413681, "time_total_s": 551.517299413681, "pid": 15878, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 551.517299413681, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 40.74688691232529, "ram_util_percent": 78.34548919949174}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2629.862069121124, "episode_reward_min": -2777.7611822407725, "episode_reward_mean": -2712.3141071733853, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2711.6130421411212, -2629.862069121124, -2723.8415369535755, -2661.36607048228, -2712.429503177893, -2710.2284347334607, -2777.7611822407725, -2771.4110185368554], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.06207849478258, "mean_raw_obs_processing_ms": 24.164193412683943, "mean_inference_ms": 20.718418785607405, "mean_action_processing_ms": 0.12305508248720756}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 8000, "timers": {"sample_time_ms": 520938.956, "sample_throughput": 7.678, "learn_time_ms": 27771.067, "learn_throughput": 144.035, "update_time_ms": 18.337}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 0.15939670073566958, "policy_loss": -0.0027413826319389045, "vf_loss": 21380.457763671875, "vf_explained_var": -0.061260998249053955, "kl": 0.00699758392147487, "entropy": 53.066004514694214, "entropy_coeff": 0.001}}, "num_steps_sampled": 8000, "num_steps_trained": 8000}, "done": false, "episodes_total": 8, "training_iteration": 2, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-09_18-48-09", "timestamp": 1617965289, "time_this_iter_s": 546.1418590545654, "time_total_s": 1097.6591584682465, "pid": 15878, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1097.6591584682465, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 41.162948717948716, "ram_util_percent": 82.68782051282051}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2629.862069121124, "episode_reward_min": -2851.2685748628087, "episode_reward_mean": -2739.3295187351578, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2765.7075349506435, -2782.3797841332444, -2774.0854734881077, -2851.2685748628087, -2712.429503177893, -2710.2284347334607, -2777.7611822407725, -2771.4110185368554, -2711.6130421411212, -2629.862069121124, -2723.8415369535755, -2661.36607048228], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.09818846844394, "mean_raw_obs_processing_ms": 23.93523410363829, "mean_inference_ms": 20.7235031275109, "mean_action_processing_ms": 0.1231627015507379}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 12000, "timers": {"sample_time_ms": 520079.542, "sample_throughput": 7.691, "learn_time_ms": 27423.13, "learn_throughput": 145.862, "update_time_ms": 13.379}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 0.125071287562605, "policy_loss": -0.012767311418429017, "vf_loss": 18944.111572265625, "vf_explained_var": -0.07306985557079315, "kl": 0.0066901465943374205, "entropy": 52.94053506851196, "entropy_coeff": 0.001}}, "num_steps_sampled": 12000, "num_steps_trained": 12000}, "done": false, "episodes_total": 12, "training_iteration": 3, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-09_18-57-14", "timestamp": 1617965834, "time_this_iter_s": 545.1001558303833, "time_total_s": 1642.7593142986298, "pid": 15878, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1642.7593142986298, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 41.15809768637532, "ram_util_percent": 83.2077120822622}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2629.862069121124, "episode_reward_min": -2905.6810704331965, "episode_reward_mean": -2756.710259056495, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2829.607541442082, -2905.6810704331965, -2720.028286916289, -2780.0930212904705, -2712.429503177893, -2710.2284347334607, -2777.7611822407725, -2771.4110185368554, -2711.6130421411212, -2629.862069121124, -2723.8415369535755, -2661.36607048228, -2765.7075349506435, -2782.3797841332444, -2774.0854734881077, -2851.2685748628087], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.2104113302177, "mean_raw_obs_processing_ms": 23.783328479596676, "mean_inference_ms": 20.728259667813703, "mean_action_processing_ms": 0.12329789722221227}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 16000, "timers": {"sample_time_ms": 520213.101, "sample_throughput": 7.689, "learn_time_ms": 27254.831, "learn_throughput": 146.763, "update_time_ms": 10.932}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 0.11320770531892776, "policy_loss": -0.0007448681280948222, "vf_loss": 16492.89862060547, "vf_explained_var": -0.06689277291297913, "kl": 0.007166907889768481, "entropy": 52.40978729724884, "entropy_coeff": 0.001}}, "num_steps_sampled": 16000, "num_steps_trained": 16000}, "done": false, "episodes_total": 16, "training_iteration": 4, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-09_19-06-22", "timestamp": 1617966382, "time_this_iter_s": 547.3743190765381, "time_total_s": 2190.133633375168, "pid": 15878, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2190.133633375168, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 41.296286811779765, "ram_util_percent": 83.13623559539053}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2629.862069121124, "episode_reward_min": -2905.6810704331965, "episode_reward_mean": -2760.365330601483, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2780.758358774932, -2822.9667029687917, -2741.6546953277043, -2754.5627100543084, -2712.429503177893, -2710.2284347334607, -2777.7611822407725, -2771.4110185368554, -2711.6130421411212, -2629.862069121124, -2723.8415369535755, -2661.36607048228, -2765.7075349506435, -2782.3797841332444, -2774.0854734881077, -2851.2685748628087, -2829.607541442082, -2905.6810704331965, -2720.028286916289, -2780.0930212904705], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.29097515453418, "mean_raw_obs_processing_ms": 23.67633592747746, "mean_inference_ms": 20.731672014357834, "mean_action_processing_ms": 0.12338341521321669}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 20000, "timers": {"sample_time_ms": 519918.264, "sample_throughput": 7.694, "learn_time_ms": 27224.874, "learn_throughput": 146.924, "update_time_ms": 9.422}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 0.07065946699003689, "policy_loss": -0.0028239423409104347, "vf_loss": 12490.692779541016, "vf_explained_var": -0.02053655870258808, "kl": 0.006305919567239471, "entropy": 52.684698820114136, "entropy_coeff": 0.001}}, "num_steps_sampled": 20000, "num_steps_trained": 20000}, "done": false, "episodes_total": 20, "training_iteration": 5, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-09_19-15-28", "timestamp": 1617966928, "time_this_iter_s": 545.855676651001, "time_total_s": 2735.989310026169, "pid": 15878, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2735.989310026169, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.035943517329905, "ram_util_percent": 83.07971758664956}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2629.862069121124, "episode_reward_min": -2989.904713086682, "episode_reward_mean": -2776.9856390636673, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2989.904713086682, -2846.6194418136806, -2734.1735823724666, -2869.650988225521, -2712.429503177893, -2710.2284347334607, -2777.7611822407725, -2771.4110185368554, -2711.6130421411212, -2629.862069121124, -2723.8415369535755, -2661.36607048228, -2765.7075349506435, -2782.3797841332444, -2774.0854734881077, -2851.2685748628087, -2829.607541442082, -2905.6810704331965, -2720.028286916289, -2780.0930212904705, -2780.758358774932, -2822.9667029687917, -2741.6546953277043, -2754.5627100543084], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.31394133573326, "mean_raw_obs_processing_ms": 23.590510538133987, "mean_inference_ms": 20.732485302582788, "mean_action_processing_ms": 0.12342309326484639}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 24000, "timers": {"sample_time_ms": 519398.013, "sample_throughput": 7.701, "learn_time_ms": 27156.91, "learn_throughput": 147.292, "update_time_ms": 8.439}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 0.059401554346550256, "policy_loss": -0.0056952862069010735, "vf_loss": 11485.802703857422, "vf_explained_var": 0.037990301847457886, "kl": 0.010814550892973784, "entropy": 51.92409312725067, "entropy_coeff": 0.001}}, "num_steps_sampled": 24000, "num_steps_trained": 24000}, "done": false, "episodes_total": 24, "training_iteration": 6, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-09_19-24-31", "timestamp": 1617967471, "time_this_iter_s": 543.6250014305115, "time_total_s": 3279.6143114566803, "pid": 15878, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3279.6143114566803, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 41.11212903225806, "ram_util_percent": 83.60696774193548}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2629.862069121124, "episode_reward_min": -2989.904713086682, "episode_reward_mean": -2791.2491758402357, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2883.167508549804, -2856.707582703935, -2916.710550782362, -2850.7359439624847, -2712.429503177893, -2710.2284347334607, -2777.7611822407725, -2771.4110185368554, -2711.6130421411212, -2629.862069121124, -2723.8415369535755, -2661.36607048228, -2765.7075349506435, -2782.3797841332444, -2774.0854734881077, -2851.2685748628087, -2829.607541442082, -2905.6810704331965, -2720.028286916289, -2780.0930212904705, -2780.758358774932, -2822.9667029687917, -2741.6546953277043, -2754.5627100543084, -2989.904713086682, -2846.6194418136806, -2734.1735823724666, -2869.650988225521], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.35062786432397, "mean_raw_obs_processing_ms": 23.522291077591774, "mean_inference_ms": 20.7342516675206, "mean_action_processing_ms": 0.12344933128506928}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 28000, "timers": {"sample_time_ms": 519499.634, "sample_throughput": 7.7, "learn_time_ms": 27094.319, "learn_throughput": 147.632, "update_time_ms": 7.736}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 0.049932515306863934, "policy_loss": 0.00568145266151987, "vf_loss": 9469.513244628906, "vf_explained_var": 0.10352212190628052, "kl": 0.007073838685755618, "entropy": 51.85883140563965, "entropy_coeff": 0.001}}, "num_steps_sampled": 28000, "num_steps_trained": 28000}, "done": false, "episodes_total": 28, "training_iteration": 7, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-09_19-33-38", "timestamp": 1617968018, "time_this_iter_s": 546.8397734165192, "time_total_s": 3826.4540848731995, "pid": 15878, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3826.4540848731995, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 41.09731113956466, "ram_util_percent": 84.37464788732395}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2629.862069121124, "episode_reward_min": -2989.904713086682, "episode_reward_mean": -2793.5575782156184, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2840.725124758791, -2813.033807310794, -2821.4782278093735, -2763.628419494226, -2712.429503177893, -2710.2284347334607, -2777.7611822407725, -2771.4110185368554, -2711.6130421411212, -2629.862069121124, -2723.8415369535755, -2661.36607048228, -2765.7075349506435, -2782.3797841332444, -2774.0854734881077, -2851.2685748628087, -2829.607541442082, -2905.6810704331965, -2720.028286916289, -2780.0930212904705, -2780.758358774932, -2822.9667029687917, -2741.6546953277043, -2754.5627100543084, -2989.904713086682, -2846.6194418136806, -2734.1735823724666, -2869.650988225521, -2883.167508549804, -2856.707582703935, -2916.710550782362, -2850.7359439624847], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.39640976535, "mean_raw_obs_processing_ms": 23.46092949914745, "mean_inference_ms": 20.735030250069297, "mean_action_processing_ms": 0.12346241803013216}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 32000, "timers": {"sample_time_ms": 519565.031, "sample_throughput": 7.699, "learn_time_ms": 27079.635, "learn_throughput": 147.712, "update_time_ms": 7.221}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 0.012397886370308697, "policy_loss": -0.003179194260155782, "vf_loss": 6659.605667114258, "vf_explained_var": 0.16753029823303223, "kl": 0.00600764193222858, "entropy": 52.22049903869629, "entropy_coeff": 0.001}}, "num_steps_sampled": 32000, "num_steps_trained": 32000}, "done": false, "episodes_total": 32, "training_iteration": 8, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-09_19-42-45", "timestamp": 1617968565, "time_this_iter_s": 547.0098140239716, "time_total_s": 4373.463898897171, "pid": 15878, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4373.463898897171, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 41.112435897435894, "ram_util_percent": 84.68076923076923}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2629.862069121124, "episode_reward_min": -2989.904713086682, "episode_reward_mean": -2792.5154463377494, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2641.8673696467245, -2752.635242035226, -2879.3460766030603, -2862.8648769741944, -2712.429503177893, -2710.2284347334607, -2777.7611822407725, -2771.4110185368554, -2711.6130421411212, -2629.862069121124, -2723.8415369535755, -2661.36607048228, -2765.7075349506435, -2782.3797841332444, -2774.0854734881077, -2851.2685748628087, -2829.607541442082, -2905.6810704331965, -2720.028286916289, -2780.0930212904705, -2780.758358774932, -2822.9667029687917, -2741.6546953277043, -2754.5627100543084, -2989.904713086682, -2846.6194418136806, -2734.1735823724666, -2869.650988225521, -2883.167508549804, -2856.707582703935, -2916.710550782362, -2850.7359439624847, -2840.725124758791, -2813.033807310794, -2821.4782278093735, -2763.628419494226], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.43324602318262, "mean_raw_obs_processing_ms": 23.409615535667925, "mean_inference_ms": 20.735730508721733, "mean_action_processing_ms": 0.12347102227408863}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 36000, "timers": {"sample_time_ms": 519489.67, "sample_throughput": 7.7, "learn_time_ms": 27043.534, "learn_throughput": 147.91, "update_time_ms": 6.852}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 0.00188333640107885, "policy_loss": -0.0007130015874281526, "vf_loss": 5385.303771972656, "vf_explained_var": 0.22348743677139282, "kl": 0.005615643414785154, "entropy": 52.379823446273804, "entropy_coeff": 0.001}}, "num_steps_sampled": 36000, "num_steps_trained": 36000}, "done": false, "episodes_total": 36, "training_iteration": 9, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-09_19-51-51", "timestamp": 1617969111, "time_this_iter_s": 545.6539216041565, "time_total_s": 4919.1178205013275, "pid": 15878, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4919.1178205013275, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 41.08844672657253, "ram_util_percent": 84.78356867779203}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2629.862069121124, "episode_reward_min": -2989.904713086682, "episode_reward_mean": -2797.039920809225, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2827.8334536284697, -2817.275150340122, -2924.3112966689464, -2781.6208635724674, -2712.429503177893, -2710.2284347334607, -2777.7611822407725, -2771.4110185368554, -2711.6130421411212, -2629.862069121124, -2723.8415369535755, -2661.36607048228, -2765.7075349506435, -2782.3797841332444, -2774.0854734881077, -2851.2685748628087, -2829.607541442082, -2905.6810704331965, -2720.028286916289, -2780.0930212904705, -2780.758358774932, -2822.9667029687917, -2741.6546953277043, -2754.5627100543084, -2989.904713086682, -2846.6194418136806, -2734.1735823724666, -2869.650988225521, -2883.167508549804, -2856.707582703935, -2916.710550782362, -2850.7359439624847, -2840.725124758791, -2813.033807310794, -2821.4782278093735, -2763.628419494226, -2641.8673696467245, -2752.635242035226, -2879.3460766030603, -2862.8648769741944], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.46642988740172, "mean_raw_obs_processing_ms": 23.36552588827408, "mean_inference_ms": 20.735566194953975, "mean_action_processing_ms": 0.1234759150615607}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 40000, "timers": {"sample_time_ms": 519497.749, "sample_throughput": 7.7, "learn_time_ms": 26987.464, "learn_throughput": 148.217, "update_time_ms": 6.511}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.004146918829064816, "policy_loss": -0.0008782476652413607, "vf_loss": 4751.718368530273, "vf_explained_var": 0.27803856134414673, "kl": 0.007782432243402582, "entropy": 52.34233510494232, "entropy_coeff": 0.001}}, "num_steps_sampled": 40000, "num_steps_trained": 40000}, "done": false, "episodes_total": 40, "training_iteration": 10, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-09_20-00-57", "timestamp": 1617969657, "time_this_iter_s": 546.0645098686218, "time_total_s": 5465.182330369949, "pid": 15878, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5465.182330369949, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 41.12053915275995, "ram_util_percent": 85.27946084724005}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2629.862069121124, "episode_reward_min": -2989.904713086682, "episode_reward_mean": -2803.4506868680337, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2834.1928338224675, -2900.073688111659, -2846.7262485254214, -2889.2406193649435, -2712.429503177893, -2710.2284347334607, -2777.7611822407725, -2771.4110185368554, -2711.6130421411212, -2629.862069121124, -2723.8415369535755, -2661.36607048228, -2765.7075349506435, -2782.3797841332444, -2774.0854734881077, -2851.2685748628087, -2829.607541442082, -2905.6810704331965, -2720.028286916289, -2780.0930212904705, -2780.758358774932, -2822.9667029687917, -2741.6546953277043, -2754.5627100543084, -2989.904713086682, -2846.6194418136806, -2734.1735823724666, -2869.650988225521, -2883.167508549804, -2856.707582703935, -2916.710550782362, -2850.7359439624847, -2840.725124758791, -2813.033807310794, -2821.4782278093735, -2763.628419494226, -2641.8673696467245, -2752.635242035226, -2879.3460766030603, -2862.8648769741944, -2827.8334536284697, -2817.275150340122, -2924.3112966689464, -2781.6208635724674], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.48742158642756, "mean_raw_obs_processing_ms": 23.329889478284215, "mean_inference_ms": 20.736338515937994, "mean_action_processing_ms": 0.12348168321537419}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 44000, "timers": {"sample_time_ms": 519040.744, "sample_throughput": 7.707, "learn_time_ms": 26775.991, "learn_throughput": 149.388, "update_time_ms": 3.586}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.014605289092287421, "policy_loss": -0.0055232695885933936, "vf_loss": 4170.860557556152, "vf_explained_var": 0.33205872774124146, "kl": 0.008186170787666924, "entropy": 52.42785608768463, "entropy_coeff": 0.001}}, "num_steps_sampled": 44000, "num_steps_trained": 44000}, "done": false, "episodes_total": 44, "training_iteration": 11, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-09_20-10-02", "timestamp": 1617970202, "time_this_iter_s": 544.6146740913391, "time_total_s": 6009.797004461288, "pid": 15878, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6009.797004461288, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 41.116216216216216, "ram_util_percent": 85.5056628056628}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2747.5964525952904, "episode_reward_min": -2810.007013105044, "episode_reward_mean": -2771.726980804901, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044], "episode_lengths": [1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 215.06613341049814, "mean_raw_obs_processing_ms": 22.807779400304575, "mean_inference_ms": 20.437215221696707, "mean_action_processing_ms": 0.12021556846622465}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 44000, "timers": {"sample_time_ms": 520521.975, "sample_throughput": 7.685, "learn_time_ms": 30226.653, "learn_throughput": 132.334, "update_time_ms": 32.448}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.016168814327102154, "policy_loss": -0.0023420752841047943, "vf_loss": 3735.4975662231445, "vf_explained_var": 0.3234962821006775, "kl": 0.005995704312226735, "entropy": 52.38085401058197, "entropy_coeff": 0.001}}, "num_steps_sampled": 44000, "num_steps_trained": 44000}, "done": false, "episodes_total": 44, "training_iteration": 11, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_11-10-44", "timestamp": 1618024244, "time_this_iter_s": 550.9112627506256, "time_total_s": 6016.093593120575, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 550.9112627506256, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 39.72340966921119, "ram_util_percent": 78.63282442748093}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3019.7125230667316, "episode_reward_mean": -2833.9633420596892, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 215.07035661763808, "mean_raw_obs_processing_ms": 22.271426244832913, "mean_inference_ms": 20.462554462503853, "mean_action_processing_ms": 0.12039894759015363}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 48000, "timers": {"sample_time_ms": 518855.207, "sample_throughput": 7.709, "learn_time_ms": 29701.336, "learn_throughput": 134.674, "update_time_ms": 18.376}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.00748842375469394, "policy_loss": 0.004524629795923829, "vf_loss": 3904.6427993774414, "vf_explained_var": 0.36706575751304626, "kl": 0.007827586305211298, "entropy": 52.6249977350235, "entropy_coeff": 0.001}}, "num_steps_sampled": 48000, "num_steps_trained": 48000}, "done": false, "episodes_total": 48, "training_iteration": 12, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_11-19-51", "timestamp": 1618024791, "time_this_iter_s": 546.3757269382477, "time_total_s": 6562.469320058823, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1097.2869896888733, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.94025641025641, "ram_util_percent": 81.93589743589745}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3019.7125230667316, "episode_reward_mean": -2849.3409891728315, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 215.12860094405744, "mean_raw_obs_processing_ms": 22.005274481838544, "mean_inference_ms": 20.48102688493563, "mean_action_processing_ms": 0.12048980681918602}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 52000, "timers": {"sample_time_ms": 518901.096, "sample_throughput": 7.709, "learn_time_ms": 29447.696, "learn_throughput": 135.834, "update_time_ms": 13.424}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.024167804571334273, "policy_loss": -0.0033712738077156246, "vf_loss": 3102.8190879821777, "vf_explained_var": 0.4273345470428467, "kl": 0.006089875860197935, "entropy": 53.04269623756409, "entropy_coeff": 0.001}}, "num_steps_sampled": 52000, "num_steps_trained": 52000}, "done": false, "episodes_total": 52, "training_iteration": 13, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_11-28-59", "timestamp": 1618025339, "time_this_iter_s": 547.9442527294159, "time_total_s": 7110.4135727882385, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1645.2312424182892, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 39.92416879795397, "ram_util_percent": 82.54539641943734}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3026.7086800913767, "episode_reward_mean": -2876.530693971007, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 215.21692902778642, "mean_raw_obs_processing_ms": 21.819717645964737, "mean_inference_ms": 20.488159718961633, "mean_action_processing_ms": 0.1205527086751596}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 56000, "timers": {"sample_time_ms": 519555.233, "sample_throughput": 7.699, "learn_time_ms": 29304.135, "learn_throughput": 136.5, "update_time_ms": 10.933}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.021290978766046464, "policy_loss": -0.00440595590043813, "vf_loss": 3455.5309295654297, "vf_explained_var": 0.4363694190979004, "kl": 0.00610264280840056, "entropy": 52.66086041927338, "entropy_coeff": 0.001}}, "num_steps_sampled": 56000, "num_steps_trained": 56000}, "done": false, "episodes_total": 56, "training_iteration": 14, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_11-38-09", "timestamp": 1618025889, "time_this_iter_s": 550.4018449783325, "time_total_s": 7660.815417766571, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2195.6330873966217, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 39.932101910828024, "ram_util_percent": 82.63108280254777}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3026.7086800913767, "episode_reward_mean": -2880.1665229958185, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 215.28999487176102, "mean_raw_obs_processing_ms": 21.678735540550527, "mean_inference_ms": 20.495310234774298, "mean_action_processing_ms": 0.12061419679677339}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 60000, "timers": {"sample_time_ms": 519631.352, "sample_throughput": 7.698, "learn_time_ms": 29253.34, "learn_throughput": 136.737, "update_time_ms": 9.596}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.019826813717372715, "policy_loss": -0.00039865641156211495, "vf_loss": 3090.635566711426, "vf_explained_var": 0.4693191647529602, "kl": 0.009991413629904855, "entropy": 52.33279371261597, "entropy_coeff": 0.001}}, "num_steps_sampled": 60000, "num_steps_trained": 60000}, "done": false, "episodes_total": 60, "training_iteration": 15, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_11-47-18", "timestamp": 1618026438, "time_this_iter_s": 548.997300863266, "time_total_s": 8209.812718629837, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2744.6303882598877, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 39.93418367346939, "ram_util_percent": 82.8501275510204}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3066.696697076359, "episode_reward_mean": -2899.6476856107197, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3036.0688988380666, -2954.4411200563495, -2931.0072787701342, -3066.696697076359, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 215.3375168075862, "mean_raw_obs_processing_ms": 21.573680734117726, "mean_inference_ms": 20.495515766088243, "mean_action_processing_ms": 0.12064514661300153}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 64000, "timers": {"sample_time_ms": 519104.147, "sample_throughput": 7.706, "learn_time_ms": 29157.487, "learn_throughput": 137.186, "update_time_ms": 8.552}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.02319604268996045, "policy_loss": -0.006009135453496128, "vf_loss": 3363.9942474365234, "vf_explained_var": 0.4691394567489624, "kl": 0.006204167773830704, "entropy": 52.06767976284027, "entropy_coeff": 0.001}}, "num_steps_sampled": 64000, "num_steps_trained": 64000}, "done": false, "episodes_total": 64, "training_iteration": 16, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_11-56-24", "timestamp": 1618026984, "time_this_iter_s": 545.1588797569275, "time_total_s": 8754.971598386765, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3289.789268016815, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 40.06460746460746, "ram_util_percent": 82.98378378378378}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3073.1478653592835, "episode_reward_mean": -2909.568923458214, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3073.1478653592835, -2849.373974223859, -2973.1293783438377, -2980.7341842457386, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225, -3036.0688988380666, -2954.4411200563495, -2931.0072787701342, -3066.696697076359], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 215.38067010003766, "mean_raw_obs_processing_ms": 21.48845252614522, "mean_inference_ms": 20.49569512175239, "mean_action_processing_ms": 0.12066330668886034}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 68000, "timers": {"sample_time_ms": 518834.187, "sample_throughput": 7.71, "learn_time_ms": 29123.559, "learn_throughput": 137.346, "update_time_ms": 7.865}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.0277076619095169, "policy_loss": -0.004557205538731068, "vf_loss": 2644.875862121582, "vf_explained_var": 0.5504721999168396, "kl": 0.011468738128314726, "entropy": 51.89295959472656, "entropy_coeff": 0.001}}, "num_steps_sampled": 68000, "num_steps_trained": 68000}, "done": false, "episodes_total": 68, "training_iteration": 17, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_12-05-30", "timestamp": 1618027530, "time_this_iter_s": 546.1457145214081, "time_total_s": 9301.117312908173, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3835.9349825382233, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 40.09166666666667, "ram_util_percent": 83.225}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3073.1478653592835, "episode_reward_mean": -2915.4752730408964, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.877688676629, -2913.4994487560193, -2932.188742622236, -2980.7130004238134, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225, -3036.0688988380666, -2954.4411200563495, -2931.0072787701342, -3066.696697076359, -3073.1478653592835, -2849.373974223859, -2973.1293783438377, -2980.7341842457386], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 215.40474188436733, "mean_raw_obs_processing_ms": 21.418154941361216, "mean_inference_ms": 20.496094444772083, "mean_action_processing_ms": 0.1206770222816659}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 72000, "timers": {"sample_time_ms": 518711.188, "sample_throughput": 7.711, "learn_time_ms": 29081.466, "learn_throughput": 137.545, "update_time_ms": 7.347}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.020759608654771, "policy_loss": -0.002691297384444624, "vf_loss": 3086.192876815796, "vf_explained_var": 0.5258002281188965, "kl": 0.010986796842189506, "entropy": 51.12759554386139, "entropy_coeff": 0.001}}, "num_steps_sampled": 72000, "num_steps_trained": 72000}, "done": false, "episodes_total": 72, "training_iteration": 18, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_12-14-36", "timestamp": 1618028076, "time_this_iter_s": 546.6479666233063, "time_total_s": 9847.765279531479, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4382.5829491615295, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 39.98602564102564, "ram_util_percent": 83.6574358974359}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3073.1478653592835, "episode_reward_mean": -2919.879494397402, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2778.643949267673, -2918.2616574746144, -3071.3136061054565, -3052.233848150044, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225, -3036.0688988380666, -2954.4411200563495, -2931.0072787701342, -3066.696697076359, -3073.1478653592835, -2849.373974223859, -2973.1293783438377, -2980.7341842457386, -3000.877688676629, -2913.4994487560193, -2932.188742622236, -2980.7130004238134], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 215.43772065092128, "mean_raw_obs_processing_ms": 21.368415046888874, "mean_inference_ms": 20.49630640138267, "mean_action_processing_ms": 0.12068868167574452}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 76000, "timers": {"sample_time_ms": 518800.912, "sample_throughput": 7.71, "learn_time_ms": 29105.304, "learn_throughput": 137.432, "update_time_ms": 6.936}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.0173080574022606, "policy_loss": 0.006165846134535968, "vf_loss": 2676.4999771118164, "vf_explained_var": 0.5662035942077637, "kl": 0.008033544901991263, "entropy": 51.8456130027771, "entropy_coeff": 0.001}}, "num_steps_sampled": 76000, "num_steps_trained": 76000}, "done": false, "episodes_total": 76, "training_iteration": 19, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_12-23-45", "timestamp": 1618028625, "time_this_iter_s": 548.8266649246216, "time_total_s": 10396.5919444561, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4931.409614086151, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 40.097953964194375, "ram_util_percent": 84.05012787723784}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3073.1478653592835, "episode_reward_mean": -2911.534046780759, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2856.580130848132, -2806.9775775947905, -2843.1893478881375, -2838.9530165928204, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225, -3036.0688988380666, -2954.4411200563495, -2931.0072787701342, -3066.696697076359, -3073.1478653592835, -2849.373974223859, -2973.1293783438377, -2980.7341842457386, -3000.877688676629, -2913.4994487560193, -2932.188742622236, -2980.7130004238134, -2778.643949267673, -2918.2616574746144, -3071.3136061054565, -3052.233848150044], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 215.46821442314686, "mean_raw_obs_processing_ms": 21.3269332422173, "mean_inference_ms": 20.497823112681726, "mean_action_processing_ms": 0.12070406115678771}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 80000, "timers": {"sample_time_ms": 518820.789, "sample_throughput": 7.71, "learn_time_ms": 29112.107, "learn_throughput": 137.4, "update_time_ms": 6.586}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.026024032616987824, "policy_loss": -0.0017603361047804356, "vf_loss": 2638.0153427124023, "vf_explained_var": 0.5482825636863708, "kl": 0.007225848225061782, "entropy": 52.08901655673981, "entropy_coeff": 0.001}}, "num_steps_sampled": 80000, "num_steps_trained": 80000}, "done": false, "episodes_total": 80, "training_iteration": 20, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_12-32-54", "timestamp": 1618029174, "time_this_iter_s": 548.1870377063751, "time_total_s": 10944.778982162476, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5479.596651792526, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 40.06086956521739, "ram_util_percent": 84.50639386189258}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3097.574672386581, "episode_reward_mean": -2911.23099474113, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2898.743443998686, -2809.3451125406204, -3097.574672386581, -2827.138668453456, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225, -3036.0688988380666, -2954.4411200563495, -2931.0072787701342, -3066.696697076359, -3073.1478653592835, -2849.373974223859, -2973.1293783438377, -2980.7341842457386, -3000.877688676629, -2913.4994487560193, -2932.188742622236, -2980.7130004238134, -2778.643949267673, -2918.2616574746144, -3071.3136061054565, -3052.233848150044, -2856.580130848132, -2806.9775775947905, -2843.1893478881375, -2838.9530165928204], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 215.49404406471197, "mean_raw_obs_processing_ms": 21.312843432750856, "mean_inference_ms": 20.498872746111125, "mean_action_processing_ms": 0.12071821257429644}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 84000, "timers": {"sample_time_ms": 519051.693, "sample_throughput": 7.706, "learn_time_ms": 28989.113, "learn_throughput": 137.983, "update_time_ms": 3.694}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.03040435738512315, "policy_loss": -0.007193102705059573, "vf_loss": 2786.1271476745605, "vf_explained_var": 0.5860137939453125, "kl": 0.004525487805949524, "entropy": 51.97762322425842, "entropy_coeff": 0.001}}, "num_steps_sampled": 84000, "num_steps_trained": 84000}, "done": false, "episodes_total": 84, "training_iteration": 21, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_12-42-06", "timestamp": 1618029726, "time_this_iter_s": 551.8462584018707, "time_total_s": 11496.625240564346, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6031.442910194397, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 40.140228426395936, "ram_util_percent": 85.852538071066}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3097.574672386581, "episode_reward_mean": -2915.435267104582, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2965.9786769138764, -3054.1421853540282, -2989.424502208923, -2837.183687933423, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225, -3036.0688988380666, -2954.4411200563495, -2931.0072787701342, -3066.696697076359, -3073.1478653592835, -2849.373974223859, -2973.1293783438377, -2980.7341842457386, -3000.877688676629, -2913.4994487560193, -2932.188742622236, -2980.7130004238134, -2778.643949267673, -2918.2616574746144, -3071.3136061054565, -3052.233848150044, -2856.580130848132, -2806.9775775947905, -2843.1893478881375, -2838.9530165928204, -2898.743443998686, -2809.3451125406204, -3097.574672386581, -2827.138668453456], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 215.69191361468953, "mean_raw_obs_processing_ms": 21.378530908041423, "mean_inference_ms": 20.512345557309306, "mean_action_processing_ms": 0.12084091811517594}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 88000, "timers": {"sample_time_ms": 526801.828, "sample_throughput": 7.593, "learn_time_ms": 29047.049, "learn_throughput": 137.708, "update_time_ms": 3.62}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.03323910594917834, "policy_loss": -0.00484672436141409, "vf_loss": 2311.3887634277344, "vf_explained_var": 0.640156090259552, "kl": 0.005389244899561163, "entropy": 52.04519319534302, "entropy_coeff": 0.001}}, "num_steps_sampled": 88000, "num_steps_trained": 88000}, "done": false, "episodes_total": 88, "training_iteration": 22, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_12-52-30", "timestamp": 1618030350, "time_this_iter_s": 624.4564599990845, "time_total_s": 12121.08170056343, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6655.899370193481, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 44.25106621773289, "ram_util_percent": 85.30897867564533}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3097.574672386581, "episode_reward_mean": -2920.0145904238243, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2971.61574069234, -2932.1984623277885, -2992.8118167753732, -3003.23986122341, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225, -3036.0688988380666, -2954.4411200563495, -2931.0072787701342, -3066.696697076359, -3073.1478653592835, -2849.373974223859, -2973.1293783438377, -2980.7341842457386, -3000.877688676629, -2913.4994487560193, -2932.188742622236, -2980.7130004238134, -2778.643949267673, -2918.2616574746144, -3071.3136061054565, -3052.233848150044, -2856.580130848132, -2806.9775775947905, -2843.1893478881375, -2838.9530165928204, -2898.743443998686, -2809.3451125406204, -3097.574672386581, -2827.138668453456, -2965.9786769138764, -3054.1421853540282, -2989.424502208923, -2837.183687933423], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 215.8515657249186, "mean_raw_obs_processing_ms": 21.425074379861975, "mean_inference_ms": 20.522237369642276, "mean_action_processing_ms": 0.12093559589109072}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 92000, "timers": {"sample_time_ms": 526814.599, "sample_throughput": 7.593, "learn_time_ms": 29047.899, "learn_throughput": 137.704, "update_time_ms": 3.618}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.03281002107542008, "policy_loss": -0.010982728912495077, "vf_loss": 2930.224281311035, "vf_explained_var": 0.5921780467033386, "kl": 0.010645330970874056, "entropy": 52.19406831264496, "entropy_coeff": 0.001}}, "num_steps_sampled": 92000, "num_steps_trained": 92000}, "done": false, "episodes_total": 92, "training_iteration": 23, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_13-01-38", "timestamp": 1618030898, "time_this_iter_s": 548.0805735588074, "time_total_s": 12669.162274122238, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7203.979943752289, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 40.095780051150896, "ram_util_percent": 81.43005115089514}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3097.574672386581, "episode_reward_mean": -2919.892797339439, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2815.6752514533296, -2931.481336854409, -2924.513474450939, -3001.567886211044, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225, -3036.0688988380666, -2954.4411200563495, -2931.0072787701342, -3066.696697076359, -3073.1478653592835, -2849.373974223859, -2973.1293783438377, -2980.7341842457386, -3000.877688676629, -2913.4994487560193, -2932.188742622236, -2980.7130004238134, -2778.643949267673, -2918.2616574746144, -3071.3136061054565, -3052.233848150044, -2856.580130848132, -2806.9775775947905, -2843.1893478881375, -2838.9530165928204, -2898.743443998686, -2809.3451125406204, -3097.574672386581, -2827.138668453456, -2965.9786769138764, -3054.1421853540282, -2989.424502208923, -2837.183687933423, -2971.61574069234, -2932.1984623277885, -2992.8118167753732, -3003.23986122341], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 215.97458660886352, "mean_raw_obs_processing_ms": 21.46232392650469, "mean_inference_ms": 20.52939921614129, "mean_action_processing_ms": 0.12100845446832593}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 96000, "timers": {"sample_time_ms": 526474.748, "sample_throughput": 7.598, "learn_time_ms": 29038.068, "learn_throughput": 137.75, "update_time_ms": 3.626}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.01725070524844341, "policy_loss": 0.005435724917333573, "vf_loss": 2824.239833831787, "vf_explained_var": 0.5983182191848755, "kl": 0.00910186133114621, "entropy": 51.839012145996094, "entropy_coeff": 0.001}}, "num_steps_sampled": 96000, "num_steps_trained": 96000}, "done": false, "episodes_total": 96, "training_iteration": 24, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_13-10-45", "timestamp": 1618031445, "time_this_iter_s": 546.9054517745972, "time_total_s": 13216.067725896835, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7750.885395526886, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 40.02166666666667, "ram_util_percent": 81.7326923076923}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3097.574672386581, "episode_reward_mean": -2921.8124604700743, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2958.901405971058, -2903.7468066699576, -2977.993058250271, -2954.1097063046104, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225, -3036.0688988380666, -2954.4411200563495, -2931.0072787701342, -3066.696697076359, -3073.1478653592835, -2849.373974223859, -2973.1293783438377, -2980.7341842457386, -3000.877688676629, -2913.4994487560193, -2932.188742622236, -2980.7130004238134, -2778.643949267673, -2918.2616574746144, -3071.3136061054565, -3052.233848150044, -2856.580130848132, -2806.9775775947905, -2843.1893478881375, -2838.9530165928204, -2898.743443998686, -2809.3451125406204, -3097.574672386581, -2827.138668453456, -2965.9786769138764, -3054.1421853540282, -2989.424502208923, -2837.183687933423, -2971.61574069234, -2932.1984623277885, -2992.8118167753732, -3003.23986122341, -2815.6752514533296, -2931.481336854409, -2924.513474450939, -3001.567886211044], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 216.07286045263663, "mean_raw_obs_processing_ms": 21.48995685341829, "mean_inference_ms": 20.53450662801989, "mean_action_processing_ms": 0.12106607996866738}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 100000, "timers": {"sample_time_ms": 526376.776, "sample_throughput": 7.599, "learn_time_ms": 29025.427, "learn_throughput": 137.81, "update_time_ms": 3.552}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.0421269538346678, "policy_loss": -0.014902148599503562, "vf_loss": 2379.9652061462402, "vf_explained_var": 0.6387320756912231, "kl": 0.010100204090122133, "entropy": 52.034478425979614, "entropy_coeff": 0.001}}, "num_steps_sampled": 100000, "num_steps_trained": 100000}, "done": false, "episodes_total": 100, "training_iteration": 25, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_13-19-53", "timestamp": 1618031993, "time_this_iter_s": 547.8910467624664, "time_total_s": 13763.958772659302, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8298.776442289352, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 40.019693094629154, "ram_util_percent": 82.706905370844}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3097.574672386581, "episode_reward_mean": -2927.9235111237494, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3033.8307407551747, -3051.66690786883, -3032.0933100641596, -2960.7661250273204, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225, -3036.0688988380666, -2954.4411200563495, -2931.0072787701342, -3066.696697076359, -3073.1478653592835, -2849.373974223859, -2973.1293783438377, -2980.7341842457386, -3000.877688676629, -2913.4994487560193, -2932.188742622236, -2980.7130004238134, -2778.643949267673, -2918.2616574746144, -3071.3136061054565, -3052.233848150044, -2856.580130848132, -2806.9775775947905, -2843.1893478881375, -2838.9530165928204, -2898.743443998686, -2809.3451125406204, -3097.574672386581, -2827.138668453456, -2965.9786769138764, -3054.1421853540282, -2989.424502208923, -2837.183687933423, -2971.61574069234, -2932.1984623277885, -2992.8118167753732, -3003.23986122341, -2815.6752514533296, -2931.481336854409, -2924.513474450939, -3001.567886211044, -2958.901405971058, -2903.7468066699576, -2977.993058250271, -2954.1097063046104], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 216.15423360913343, "mean_raw_obs_processing_ms": 21.510341424895476, "mean_inference_ms": 20.53826104886288, "mean_action_processing_ms": 0.1211132772330262}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 104000, "timers": {"sample_time_ms": 526703.636, "sample_throughput": 7.594, "learn_time_ms": 29076.106, "learn_throughput": 137.57, "update_time_ms": 3.565}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.02970985817955807, "policy_loss": -0.0046054733684286475, "vf_loss": 2665.334648132324, "vf_explained_var": 0.6118038892745972, "kl": 0.004443326070031617, "entropy": 52.20205807685852, "entropy_coeff": 0.001}}, "num_steps_sampled": 104000, "num_steps_trained": 104000}, "done": false, "episodes_total": 104, "training_iteration": 26, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_13-29-02", "timestamp": 1618032542, "time_this_iter_s": 548.931919336319, "time_total_s": 14312.89069199562, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8847.708361625671, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 40.08378033205619, "ram_util_percent": 82.97445721583652}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3097.574672386581, "episode_reward_mean": -2925.071045851024, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2954.036822662905, -2881.47200937563, -2887.087605259153, -2795.1299686519374, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225, -3036.0688988380666, -2954.4411200563495, -2931.0072787701342, -3066.696697076359, -3073.1478653592835, -2849.373974223859, -2973.1293783438377, -2980.7341842457386, -3000.877688676629, -2913.4994487560193, -2932.188742622236, -2980.7130004238134, -2778.643949267673, -2918.2616574746144, -3071.3136061054565, -3052.233848150044, -2856.580130848132, -2806.9775775947905, -2843.1893478881375, -2838.9530165928204, -2898.743443998686, -2809.3451125406204, -3097.574672386581, -2827.138668453456, -2965.9786769138764, -3054.1421853540282, -2989.424502208923, -2837.183687933423, -2971.61574069234, -2932.1984623277885, -2992.8118167753732, -3003.23986122341, -2815.6752514533296, -2931.481336854409, -2924.513474450939, -3001.567886211044, -2958.901405971058, -2903.7468066699576, -2977.993058250271, -2954.1097063046104, -3033.8307407551747, -3051.66690786883, -3032.0933100641596, -2960.7661250273204], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 216.22038027227626, "mean_raw_obs_processing_ms": 21.524181562995015, "mean_inference_ms": 20.540980493619013, "mean_action_processing_ms": 0.12115192436961522}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 108000, "timers": {"sample_time_ms": 526873.87, "sample_throughput": 7.592, "learn_time_ms": 29083.463, "learn_throughput": 137.535, "update_time_ms": 3.56}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.02793968335026875, "policy_loss": -0.0063313307473436, "vf_loss": 3010.693962097168, "vf_explained_var": 0.6111299395561218, "kl": 0.009838265585131012, "entropy": 52.207199454307556, "entropy_coeff": 0.001}}, "num_steps_sampled": 108000, "num_steps_trained": 108000}, "done": false, "episodes_total": 108, "training_iteration": 27, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_13-38-10", "timestamp": 1618033090, "time_this_iter_s": 547.9213564395905, "time_total_s": 14860.812048435211, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9395.629718065262, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 40.06841432225064, "ram_util_percent": 83.53184143222506}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3097.574672386581, "episode_reward_mean": -2925.5451885120497, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2904.449571460448, -3075.4912255725803, -2853.8391007666232, -2900.642557198329, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225, -3036.0688988380666, -2954.4411200563495, -2931.0072787701342, -3066.696697076359, -3073.1478653592835, -2849.373974223859, -2973.1293783438377, -2980.7341842457386, -3000.877688676629, -2913.4994487560193, -2932.188742622236, -2980.7130004238134, -2778.643949267673, -2918.2616574746144, -3071.3136061054565, -3052.233848150044, -2856.580130848132, -2806.9775775947905, -2843.1893478881375, -2838.9530165928204, -2898.743443998686, -2809.3451125406204, -3097.574672386581, -2827.138668453456, -2965.9786769138764, -3054.1421853540282, -2989.424502208923, -2837.183687933423, -2971.61574069234, -2932.1984623277885, -2992.8118167753732, -3003.23986122341, -2815.6752514533296, -2931.481336854409, -2924.513474450939, -3001.567886211044, -2958.901405971058, -2903.7468066699576, -2977.993058250271, -2954.1097063046104, -3033.8307407551747, -3051.66690786883, -3032.0933100641596, -2960.7661250273204, -2954.036822662905, -2881.47200937563, -2887.087605259153, -2795.1299686519374], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 216.27202943074892, "mean_raw_obs_processing_ms": 21.53337941967365, "mean_inference_ms": 20.54290216961256, "mean_action_processing_ms": 0.1211837793403305}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 112000, "timers": {"sample_time_ms": 526750.564, "sample_throughput": 7.594, "learn_time_ms": 29082.492, "learn_throughput": 137.54, "update_time_ms": 3.557}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.02616848109755665, "policy_loss": 0.00029967923182994127, "vf_loss": 2526.7126693725586, "vf_explained_var": 0.6386083364486694, "kl": 0.008418069148319773, "entropy": 52.15618824958801, "entropy_coeff": 0.001}}, "num_steps_sampled": 112000, "num_steps_trained": 112000}, "done": false, "episodes_total": 112, "training_iteration": 28, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_13-47-16", "timestamp": 1618033636, "time_this_iter_s": 545.4049742221832, "time_total_s": 15406.217022657394, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9941.034692287445, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 40.152699228791775, "ram_util_percent": 83.90205655526991}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3102.1985384130403, "episode_reward_mean": -2927.3198196580483, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2832.923387929311, -2981.116617362261, -3102.1985384130403, -2920.8141774394694, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225, -3036.0688988380666, -2954.4411200563495, -2931.0072787701342, -3066.696697076359, -3073.1478653592835, -2849.373974223859, -2973.1293783438377, -2980.7341842457386, -3000.877688676629, -2913.4994487560193, -2932.188742622236, -2980.7130004238134, -2778.643949267673, -2918.2616574746144, -3071.3136061054565, -3052.233848150044, -2856.580130848132, -2806.9775775947905, -2843.1893478881375, -2838.9530165928204, -2898.743443998686, -2809.3451125406204, -3097.574672386581, -2827.138668453456, -2965.9786769138764, -3054.1421853540282, -2989.424502208923, -2837.183687933423, -2971.61574069234, -2932.1984623277885, -2992.8118167753732, -3003.23986122341, -2815.6752514533296, -2931.481336854409, -2924.513474450939, -3001.567886211044, -2958.901405971058, -2903.7468066699576, -2977.993058250271, -2954.1097063046104, -3033.8307407551747, -3051.66690786883, -3032.0933100641596, -2960.7661250273204, -2954.036822662905, -2881.47200937563, -2887.087605259153, -2795.1299686519374, -2904.449571460448, -3075.4912255725803, -2853.8391007666232, -2900.642557198329], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 216.3142540314494, "mean_raw_obs_processing_ms": 21.538075960464433, "mean_inference_ms": 20.544428806696985, "mean_action_processing_ms": 0.12121075064780239}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 116000, "timers": {"sample_time_ms": 526643.971, "sample_throughput": 7.595, "learn_time_ms": 29036.103, "learn_throughput": 137.76, "update_time_ms": 3.528}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.037608341488521546, "policy_loss": -0.008967790228780359, "vf_loss": 2329.2768058776855, "vf_explained_var": 0.7022563219070435, "kl": 0.009228679453372024, "entropy": 52.39474928379059, "entropy_coeff": 0.001}}, "num_steps_sampled": 116000, "num_steps_trained": 116000}, "done": false, "episodes_total": 116, "training_iteration": 29, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_13-56-23", "timestamp": 1618034183, "time_this_iter_s": 547.2955396175385, "time_total_s": 15953.512562274933, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10488.330231904984, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 40.110371318822025, "ram_util_percent": 84.10729833546735}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3102.1985384130403, "episode_reward_mean": -2929.4715833320397, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2994.38551252059, -2928.6636104169584, -3008.029226202951, -2950.342023411021, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225, -3036.0688988380666, -2954.4411200563495, -2931.0072787701342, -3066.696697076359, -3073.1478653592835, -2849.373974223859, -2973.1293783438377, -2980.7341842457386, -3000.877688676629, -2913.4994487560193, -2932.188742622236, -2980.7130004238134, -2778.643949267673, -2918.2616574746144, -3071.3136061054565, -3052.233848150044, -2856.580130848132, -2806.9775775947905, -2843.1893478881375, -2838.9530165928204, -2898.743443998686, -2809.3451125406204, -3097.574672386581, -2827.138668453456, -2965.9786769138764, -3054.1421853540282, -2989.424502208923, -2837.183687933423, -2971.61574069234, -2932.1984623277885, -2992.8118167753732, -3003.23986122341, -2815.6752514533296, -2931.481336854409, -2924.513474450939, -3001.567886211044, -2958.901405971058, -2903.7468066699576, -2977.993058250271, -2954.1097063046104, -3033.8307407551747, -3051.66690786883, -3032.0933100641596, -2960.7661250273204, -2954.036822662905, -2881.47200937563, -2887.087605259153, -2795.1299686519374, -2904.449571460448, -3075.4912255725803, -2853.8391007666232, -2900.642557198329, -2832.923387929311, -2981.116617362261, -3102.1985384130403, -2920.8141774394694], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 216.35054161041703, "mean_raw_obs_processing_ms": 21.540346530909908, "mean_inference_ms": 20.54543068672002, "mean_action_processing_ms": 0.12123331331885771}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 120000, "timers": {"sample_time_ms": 526698.711, "sample_throughput": 7.594, "learn_time_ms": 28987.451, "learn_throughput": 137.991, "update_time_ms": 3.511}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.04150862357346341, "policy_loss": -0.008297099673654884, "vf_loss": 1892.3685131072998, "vf_explained_var": 0.68867427110672, "kl": 0.015925060055451468, "entropy": 52.931458711624146, "entropy_coeff": 0.001}}, "num_steps_sampled": 120000, "num_steps_trained": 120000}, "done": false, "episodes_total": 120, "training_iteration": 30, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_14-05-31", "timestamp": 1618034731, "time_this_iter_s": 548.2441053390503, "time_total_s": 16501.756667613983, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11036.574337244034, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 40.12877237851662, "ram_util_percent": 84.16892583120206}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3102.1985384130403, "episode_reward_mean": -2928.9297586214993, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2942.919055580504, -2927.8049953082427, -2875.8506876325855, -2925.798319121468, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225, -3036.0688988380666, -2954.4411200563495, -2931.0072787701342, -3066.696697076359, -3073.1478653592835, -2849.373974223859, -2973.1293783438377, -2980.7341842457386, -3000.877688676629, -2913.4994487560193, -2932.188742622236, -2980.7130004238134, -2778.643949267673, -2918.2616574746144, -3071.3136061054565, -3052.233848150044, -2856.580130848132, -2806.9775775947905, -2843.1893478881375, -2838.9530165928204, -2898.743443998686, -2809.3451125406204, -3097.574672386581, -2827.138668453456, -2965.9786769138764, -3054.1421853540282, -2989.424502208923, -2837.183687933423, -2971.61574069234, -2932.1984623277885, -2992.8118167753732, -3003.23986122341, -2815.6752514533296, -2931.481336854409, -2924.513474450939, -3001.567886211044, -2958.901405971058, -2903.7468066699576, -2977.993058250271, -2954.1097063046104, -3033.8307407551747, -3051.66690786883, -3032.0933100641596, -2960.7661250273204, -2954.036822662905, -2881.47200937563, -2887.087605259153, -2795.1299686519374, -2904.449571460448, -3075.4912255725803, -2853.8391007666232, -2900.642557198329, -2832.923387929311, -2981.116617362261, -3102.1985384130403, -2920.8141774394694, -2994.38551252059, -2928.6636104169584, -3008.029226202951, -2950.342023411021], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 216.37978256428428, "mean_raw_obs_processing_ms": 21.540461578750133, "mean_inference_ms": 20.54598687119394, "mean_action_processing_ms": 0.12125157215997351}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 124000, "timers": {"sample_time_ms": 526030.906, "sample_throughput": 7.604, "learn_time_ms": 28960.716, "learn_throughput": 138.118, "update_time_ms": 3.525}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.03772829213994555, "policy_loss": -0.007586703519336879, "vf_loss": 2213.71803855896, "vf_explained_var": 0.6631612777709961, "kl": 0.008194369802367873, "entropy": 52.68848478794098, "entropy_coeff": 0.001}}, "num_steps_sampled": 124000, "num_steps_trained": 124000}, "done": false, "episodes_total": 124, "training_iteration": 31, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_14-14-36", "timestamp": 1618035276, "time_this_iter_s": 544.8947396278381, "time_total_s": 17046.65140724182, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11581.469076871872, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 40.214929214929214, "ram_util_percent": 84.5904761904762}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3102.1985384130403, "episode_reward_mean": -2925.689752824422, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2859.576749517355, -2982.7867259859618, -2783.2139186497543, -2805.021130190077, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225, -3036.0688988380666, -2954.4411200563495, -2931.0072787701342, -3066.696697076359, -3073.1478653592835, -2849.373974223859, -2973.1293783438377, -2980.7341842457386, -3000.877688676629, -2913.4994487560193, -2932.188742622236, -2980.7130004238134, -2778.643949267673, -2918.2616574746144, -3071.3136061054565, -3052.233848150044, -2856.580130848132, -2806.9775775947905, -2843.1893478881375, -2838.9530165928204, -2898.743443998686, -2809.3451125406204, -3097.574672386581, -2827.138668453456, -2965.9786769138764, -3054.1421853540282, -2989.424502208923, -2837.183687933423, -2971.61574069234, -2932.1984623277885, -2992.8118167753732, -3003.23986122341, -2815.6752514533296, -2931.481336854409, -2924.513474450939, -3001.567886211044, -2958.901405971058, -2903.7468066699576, -2977.993058250271, -2954.1097063046104, -3033.8307407551747, -3051.66690786883, -3032.0933100641596, -2960.7661250273204, -2954.036822662905, -2881.47200937563, -2887.087605259153, -2795.1299686519374, -2904.449571460448, -3075.4912255725803, -2853.8391007666232, -2900.642557198329, -2832.923387929311, -2981.116617362261, -3102.1985384130403, -2920.8141774394694, -2994.38551252059, -2928.6636104169584, -3008.029226202951, -2950.342023411021, -2942.919055580504, -2927.8049953082427, -2875.8506876325855, -2925.798319121468], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 216.40396476453216, "mean_raw_obs_processing_ms": 21.539336083577464, "mean_inference_ms": 20.546151731432072, "mean_action_processing_ms": 0.12126713513391102}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 128000, "timers": {"sample_time_ms": 518407.756, "sample_throughput": 7.716, "learn_time_ms": 28878.901, "learn_throughput": 138.509, "update_time_ms": 3.548}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.033490705682197586, "policy_loss": -0.0027389599417801946, "vf_loss": 2184.84029006958, "vf_explained_var": 0.6670721769332886, "kl": 0.003830251604085788, "entropy": 52.791656255722046, "entropy_coeff": 0.001}}, "num_steps_sampled": 128000, "num_steps_trained": 128000}, "done": false, "episodes_total": 128, "training_iteration": 32, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_14-23-44", "timestamp": 1618035824, "time_this_iter_s": 547.4066858291626, "time_total_s": 17594.058093070984, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12128.875762701035, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 40.13559539052497, "ram_util_percent": 85.11498079385403}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3102.1985384130403, "episode_reward_mean": -2924.73140209651, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2825.2634820813573, -2963.004554354371, -2797.273465033691, -3029.0492428604016, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225, -3036.0688988380666, -2954.4411200563495, -2931.0072787701342, -3066.696697076359, -3073.1478653592835, -2849.373974223859, -2973.1293783438377, -2980.7341842457386, -3000.877688676629, -2913.4994487560193, -2932.188742622236, -2980.7130004238134, -2778.643949267673, -2918.2616574746144, -3071.3136061054565, -3052.233848150044, -2856.580130848132, -2806.9775775947905, -2843.1893478881375, -2838.9530165928204, -2898.743443998686, -2809.3451125406204, -3097.574672386581, -2827.138668453456, -2965.9786769138764, -3054.1421853540282, -2989.424502208923, -2837.183687933423, -2971.61574069234, -2932.1984623277885, -2992.8118167753732, -3003.23986122341, -2815.6752514533296, -2931.481336854409, -2924.513474450939, -3001.567886211044, -2958.901405971058, -2903.7468066699576, -2977.993058250271, -2954.1097063046104, -3033.8307407551747, -3051.66690786883, -3032.0933100641596, -2960.7661250273204, -2954.036822662905, -2881.47200937563, -2887.087605259153, -2795.1299686519374, -2904.449571460448, -3075.4912255725803, -2853.8391007666232, -2900.642557198329, -2832.923387929311, -2981.116617362261, -3102.1985384130403, -2920.8141774394694, -2994.38551252059, -2928.6636104169584, -3008.029226202951, -2950.342023411021, -2942.919055580504, -2927.8049953082427, -2875.8506876325855, -2925.798319121468, -2859.576749517355, -2982.7867259859618, -2783.2139186497543, -2805.021130190077], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 216.42219896702306, "mean_raw_obs_processing_ms": 21.537928246571738, "mean_inference_ms": 20.546112433709833, "mean_action_processing_ms": 0.12127955669507332}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 132000, "timers": {"sample_time_ms": 518193.939, "sample_throughput": 7.719, "learn_time_ms": 28854.754, "learn_throughput": 138.625, "update_time_ms": 3.63}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025, "cur_lr": 5e-05, "total_loss": -0.03831768233794719, "policy_loss": -0.005578873911872506, "vf_loss": 1990.9999351501465, "vf_explained_var": 0.7069970369338989, "kl": 0.015178569417912513, "entropy": 53.02826774120331, "entropy_coeff": 0.001}}, "num_steps_sampled": 132000, "num_steps_trained": 132000}, "done": false, "episodes_total": 132, "training_iteration": 33, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_14-32-49", "timestamp": 1618036369, "time_this_iter_s": 545.7012434005737, "time_total_s": 18139.759336471558, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12674.577006101608, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 40.11360718870347, "ram_util_percent": 85.68074454428755}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.4656829427818, "episode_reward_min": -3102.1985384130403, "episode_reward_mean": -2919.9601220022328, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2759.0070545651142, -2805.9935917795365, -2899.3219521091887, -2776.560120881546, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225, -3036.0688988380666, -2954.4411200563495, -2931.0072787701342, -3066.696697076359, -3073.1478653592835, -2849.373974223859, -2973.1293783438377, -2980.7341842457386, -3000.877688676629, -2913.4994487560193, -2932.188742622236, -2980.7130004238134, -2778.643949267673, -2918.2616574746144, -3071.3136061054565, -3052.233848150044, -2856.580130848132, -2806.9775775947905, -2843.1893478881375, -2838.9530165928204, -2898.743443998686, -2809.3451125406204, -3097.574672386581, -2827.138668453456, -2965.9786769138764, -3054.1421853540282, -2989.424502208923, -2837.183687933423, -2971.61574069234, -2932.1984623277885, -2992.8118167753732, -3003.23986122341, -2815.6752514533296, -2931.481336854409, -2924.513474450939, -3001.567886211044, -2958.901405971058, -2903.7468066699576, -2977.993058250271, -2954.1097063046104, -3033.8307407551747, -3051.66690786883, -3032.0933100641596, -2960.7661250273204, -2954.036822662905, -2881.47200937563, -2887.087605259153, -2795.1299686519374, -2904.449571460448, -3075.4912255725803, -2853.8391007666232, -2900.642557198329, -2832.923387929311, -2981.116617362261, -3102.1985384130403, -2920.8141774394694, -2994.38551252059, -2928.6636104169584, -3008.029226202951, -2950.342023411021, -2942.919055580504, -2927.8049953082427, -2875.8506876325855, -2925.798319121468, -2859.576749517355, -2982.7867259859618, -2783.2139186497543, -2805.021130190077, -2825.2634820813573, -2963.004554354371, -2797.273465033691, -3029.0492428604016], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 216.4364637227794, "mean_raw_obs_processing_ms": 21.53691177774375, "mean_inference_ms": 20.54598546526393, "mean_action_processing_ms": 0.12129041517018611}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 136000, "timers": {"sample_time_ms": 518584.823, "sample_throughput": 7.713, "learn_time_ms": 28870.6, "learn_throughput": 138.549, "update_time_ms": 3.605}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025, "cur_lr": 5e-05, "total_loss": -0.027453624206827953, "policy_loss": -0.001566343620652333, "vf_loss": 2668.4061698913574, "vf_explained_var": 0.6388804912567139, "kl": 0.009949049461283721, "entropy": 52.82006633281708, "entropy_coeff": 0.001}}, "num_steps_sampled": 136000, "num_steps_trained": 136000}, "done": false, "episodes_total": 136, "training_iteration": 34, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_14-42-00", "timestamp": 1618036920, "time_this_iter_s": 550.9741480350494, "time_total_s": 18690.733484506607, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13225.551154136658, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 39.99758269720102, "ram_util_percent": 85.83511450381678}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2692.293790135894, "episode_reward_min": -3102.1985384130403, "episode_reward_mean": -2915.703343397655, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2877.4385882367546, -2830.6461597228404, -2692.293790135894, -2853.784089455677, -2755.562336282045, -2773.7421212372237, -2747.5964525952904, -2810.007013105044, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225, -3036.0688988380666, -2954.4411200563495, -2931.0072787701342, -3066.696697076359, -3073.1478653592835, -2849.373974223859, -2973.1293783438377, -2980.7341842457386, -3000.877688676629, -2913.4994487560193, -2932.188742622236, -2980.7130004238134, -2778.643949267673, -2918.2616574746144, -3071.3136061054565, -3052.233848150044, -2856.580130848132, -2806.9775775947905, -2843.1893478881375, -2838.9530165928204, -2898.743443998686, -2809.3451125406204, -3097.574672386581, -2827.138668453456, -2965.9786769138764, -3054.1421853540282, -2989.424502208923, -2837.183687933423, -2971.61574069234, -2932.1984623277885, -2992.8118167753732, -3003.23986122341, -2815.6752514533296, -2931.481336854409, -2924.513474450939, -3001.567886211044, -2958.901405971058, -2903.7468066699576, -2977.993058250271, -2954.1097063046104, -3033.8307407551747, -3051.66690786883, -3032.0933100641596, -2960.7661250273204, -2954.036822662905, -2881.47200937563, -2887.087605259153, -2795.1299686519374, -2904.449571460448, -3075.4912255725803, -2853.8391007666232, -2900.642557198329, -2832.923387929311, -2981.116617362261, -3102.1985384130403, -2920.8141774394694, -2994.38551252059, -2928.6636104169584, -3008.029226202951, -2950.342023411021, -2942.919055580504, -2927.8049953082427, -2875.8506876325855, -2925.798319121468, -2859.576749517355, -2982.7867259859618, -2783.2139186497543, -2805.021130190077, -2825.2634820813573, -2963.004554354371, -2797.273465033691, -3029.0492428604016, -2759.0070545651142, -2805.9935917795365, -2899.3219521091887, -2776.560120881546], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 216.44825898500855, "mean_raw_obs_processing_ms": 21.53493064648184, "mean_inference_ms": 20.545823987941958, "mean_action_processing_ms": 0.12129989185130906}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 140000, "timers": {"sample_time_ms": 518602.721, "sample_throughput": 7.713, "learn_time_ms": 28858.83, "learn_throughput": 138.606, "update_time_ms": 3.686}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025, "cur_lr": 5e-05, "total_loss": -0.04009058223164175, "policy_loss": -0.004198943905066699, "vf_loss": 1651.136100769043, "vf_explained_var": 0.7303922176361084, "kl": 0.01561784272780642, "entropy": 52.793440103530884, "entropy_coeff": 0.001}}, "num_steps_sampled": 140000, "num_steps_trained": 140000}, "done": false, "episodes_total": 140, "training_iteration": 35, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_14-51-08", "timestamp": 1618037468, "time_this_iter_s": 547.9531803131104, "time_total_s": 19238.686664819717, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13773.504334449768, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 40.16074168797954, "ram_util_percent": 85.83746803069053}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2692.293790135894, "episode_reward_min": -3102.1985384130403, "episode_reward_mean": -2917.6543206531082, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2789.3739842158157, -2856.4134588893594, -2907.569413722931, -2728.6487919368956, -2735.4656829427818, -2901.513162237433, -3019.7125230667316, -2928.1074450109645, -2836.537524304901, -2907.557211695496, -2913.8499730581498, -2862.4404245379133, -2956.8304017557884, -2889.036906093503, -2959.823245521472, -3026.7086800913767, -2969.40598911473, -2889.332905214838, -2800.1987693681585, -2919.9016926825225, -3036.0688988380666, -2954.4411200563495, -2931.0072787701342, -3066.696697076359, -3073.1478653592835, -2849.373974223859, -2973.1293783438377, -2980.7341842457386, -3000.877688676629, -2913.4994487560193, -2932.188742622236, -2980.7130004238134, -2778.643949267673, -2918.2616574746144, -3071.3136061054565, -3052.233848150044, -2856.580130848132, -2806.9775775947905, -2843.1893478881375, -2838.9530165928204, -2898.743443998686, -2809.3451125406204, -3097.574672386581, -2827.138668453456, -2965.9786769138764, -3054.1421853540282, -2989.424502208923, -2837.183687933423, -2971.61574069234, -2932.1984623277885, -2992.8118167753732, -3003.23986122341, -2815.6752514533296, -2931.481336854409, -2924.513474450939, -3001.567886211044, -2958.901405971058, -2903.7468066699576, -2977.993058250271, -2954.1097063046104, -3033.8307407551747, -3051.66690786883, -3032.0933100641596, -2960.7661250273204, -2954.036822662905, -2881.47200937563, -2887.087605259153, -2795.1299686519374, -2904.449571460448, -3075.4912255725803, -2853.8391007666232, -2900.642557198329, -2832.923387929311, -2981.116617362261, -3102.1985384130403, -2920.8141774394694, -2994.38551252059, -2928.6636104169584, -3008.029226202951, -2950.342023411021, -2942.919055580504, -2927.8049953082427, -2875.8506876325855, -2925.798319121468, -2859.576749517355, -2982.7867259859618, -2783.2139186497543, -2805.021130190077, -2825.2634820813573, -2963.004554354371, -2797.273465033691, -3029.0492428604016, -2759.0070545651142, -2805.9935917795365, -2899.3219521091887, -2776.560120881546, -2877.4385882367546, -2830.6461597228404, -2692.293790135894, -2853.784089455677], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 216.51203945219305, "mean_raw_obs_processing_ms": 21.480887110366183, "mean_inference_ms": 20.549861906974044, "mean_action_processing_ms": 0.12135072456043737}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 144000, "timers": {"sample_time_ms": 518308.349, "sample_throughput": 7.717, "learn_time_ms": 28811.173, "learn_throughput": 138.835, "update_time_ms": 3.697}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025, "cur_lr": 5e-05, "total_loss": -0.05126584292156622, "policy_loss": -0.018281047756318003, "vf_loss": 1973.1504611968994, "vf_explained_var": 0.69931560754776, "kl": 0.016367232950869948, "entropy": 53.12547957897186, "entropy_coeff": 0.001}}, "num_steps_sampled": 144000, "num_steps_trained": 144000}, "done": false, "episodes_total": 144, "training_iteration": 36, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_15-00-14", "timestamp": 1618038014, "time_this_iter_s": 545.5129277706146, "time_total_s": 19784.199592590332, "pid": 9063, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14319.017262220383, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 40.172622107969154, "ram_util_percent": 86.38778920308484}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.8555468551262, "episode_reward_min": -2901.9505309783394, "episode_reward_mean": -2809.9655435069244, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953], "episode_lengths": [1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 182.11647714751174, "mean_raw_obs_processing_ms": 20.207573925477753, "mean_inference_ms": 17.90816708840709, "mean_action_processing_ms": 0.10813515761802936}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 144000, "timers": {"sample_time_ms": 443121.237, "sample_throughput": 9.027, "learn_time_ms": 26597.713, "learn_throughput": 150.389, "update_time_ms": 16.924}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.0377466335776262, "policy_loss": -0.0072893144097179174, "vf_loss": 2014.8428192138672, "vf_explained_var": 0.6815624237060547, "kl": 0.010301407382939942, "entropy": 52.66602611541748, "entropy_coeff": 0.001}}, "num_steps_sampled": 144000, "num_steps_trained": 144000}, "done": false, "episodes_total": 144, "training_iteration": 36, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_16-14-11", "timestamp": 1618042451, "time_this_iter_s": 469.85765290260315, "time_total_s": 19708.54431772232, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 469.85765290260315, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.422205663189267, "ram_util_percent": 78.48673621460506}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2735.8555468551262, "episode_reward_min": -2901.9505309783394, "episode_reward_mean": -2801.8405635079444, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 182.01816423543642, "mean_raw_obs_processing_ms": 19.632821492803604, "mean_inference_ms": 17.887884758411673, "mean_action_processing_ms": 0.10814712180092173}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 148000, "timers": {"sample_time_ms": 440292.841, "sample_throughput": 9.085, "learn_time_ms": 25721.319, "learn_throughput": 155.513, "update_time_ms": 10.311}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.04424536449369043, "policy_loss": -0.011053282709326595, "vf_loss": 1713.4233016967773, "vf_explained_var": 0.747667133808136, "kl": 0.010353698948165402, "entropy": 52.39705169200897, "entropy_coeff": 0.001}}, "num_steps_sampled": 148000, "num_steps_trained": 148000}, "done": false, "episodes_total": 148, "training_iteration": 37, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_16-21-53", "timestamp": 1618042913, "time_this_iter_s": 462.3220202922821, "time_total_s": 20170.866338014603, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 932.1796731948853, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 25.759242424242423, "ram_util_percent": 82.58015151515151}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2720.8728981613804, "episode_reward_min": -2901.9505309783394, "episode_reward_mean": -2785.576596395, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 182.06404527124846, "mean_raw_obs_processing_ms": 19.31354753834644, "mean_inference_ms": 17.893488087815005, "mean_action_processing_ms": 0.10819783643422913}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 152000, "timers": {"sample_time_ms": 439930.697, "sample_throughput": 9.092, "learn_time_ms": 25417.726, "learn_throughput": 157.37, "update_time_ms": 8.231}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.04455974034499377, "policy_loss": -0.013612270122393966, "vf_loss": 2125.51833152771, "vf_explained_var": 0.6728861331939697, "kl": 0.0033415131983929314, "entropy": 52.870952129364014, "entropy_coeff": 0.001}}, "num_steps_sampled": 152000, "num_steps_trained": 152000}, "done": false, "episodes_total": 152, "training_iteration": 38, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_16-29-37", "timestamp": 1618043377, "time_this_iter_s": 464.02779054641724, "time_total_s": 20634.89412856102, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1396.2074637413025, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 25.955740181268883, "ram_util_percent": 82.56495468277946}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2592.5903777598346, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2782.10764568636, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 182.07387940328113, "mean_raw_obs_processing_ms": 19.123067323123365, "mean_inference_ms": 17.89505821306411, "mean_action_processing_ms": 0.10825098402240631}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 156000, "timers": {"sample_time_ms": 439656.855, "sample_throughput": 9.098, "learn_time_ms": 25235.169, "learn_throughput": 158.509, "update_time_ms": 7.085}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04136296582873911, "policy_loss": -0.009941661381162703, "vf_loss": 2008.7729988098145, "vf_explained_var": 0.6905575394630432, "kl": 0.013859938742825761, "entropy": 52.895028591156006, "entropy_coeff": 0.001}}, "num_steps_sampled": 156000, "num_steps_trained": 156000}, "done": false, "episodes_total": 156, "training_iteration": 39, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_16-37-21", "timestamp": 1618043841, "time_this_iter_s": 463.5333323478699, "time_total_s": 21098.42746090889, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1859.7407960891724, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.719364599092284, "ram_util_percent": 82.3768532526475}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2592.5903777598346, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2787.466593830129, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 182.00318609196424, "mean_raw_obs_processing_ms": 18.990101912759886, "mean_inference_ms": 17.89327970845798, "mean_action_processing_ms": 0.10828130358782737}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 160000, "timers": {"sample_time_ms": 438521.498, "sample_throughput": 9.122, "learn_time_ms": 25159.068, "learn_throughput": 158.988, "update_time_ms": 6.378}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.027731149515602738, "policy_loss": 0.0036515083629637957, "vf_loss": 2094.2119369506836, "vf_explained_var": 0.6856072545051575, "kl": 0.006050489246263169, "entropy": 52.92982316017151, "entropy_coeff": 0.001}}, "num_steps_sampled": 160000, "num_steps_trained": 160000}, "done": false, "episodes_total": 160, "training_iteration": 40, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_16-45-00", "timestamp": 1618044300, "time_this_iter_s": 458.84510922431946, "time_total_s": 21557.27257013321, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2318.585905313492, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 25.764885496183204, "ram_util_percent": 82.44992366412214}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2592.5903777598346, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2784.995158688251, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.9591701934772, "mean_raw_obs_processing_ms": 18.88136955057536, "mean_inference_ms": 17.89218542954003, "mean_action_processing_ms": 0.1083031762661854}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 164000, "timers": {"sample_time_ms": 438378.05, "sample_throughput": 9.125, "learn_time_ms": 25114.528, "learn_throughput": 159.27, "update_time_ms": 5.916}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.03750766930170357, "policy_loss": -0.007440878514898941, "vf_loss": 2188.708683013916, "vf_explained_var": 0.6557797789573669, "kl": 0.009836847413680516, "entropy": 52.93755865097046, "entropy_coeff": 0.001}}, "num_steps_sampled": 164000, "num_steps_trained": 164000}, "done": false, "episodes_total": 164, "training_iteration": 41, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_16-52-43", "timestamp": 1618044763, "time_this_iter_s": 462.564049243927, "time_total_s": 22019.836619377136, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2781.149954557419, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 25.772878787878785, "ram_util_percent": 82.43681818181818}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2592.5903777598346, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2783.113199313324, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.907026501873, "mean_raw_obs_processing_ms": 18.79605167272705, "mean_inference_ms": 17.891622666656335, "mean_action_processing_ms": 0.10830760130934793}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 168000, "timers": {"sample_time_ms": 437922.375, "sample_throughput": 9.134, "learn_time_ms": 25072.084, "learn_throughput": 159.54, "update_time_ms": 5.573}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.03503013600129634, "policy_loss": -0.004611083219060674, "vf_loss": 2164.3059692382812, "vf_explained_var": 0.6666802763938904, "kl": 0.011740856323740445, "entropy": 53.236196517944336, "entropy_coeff": 0.001}}, "num_steps_sampled": 168000, "num_steps_trained": 168000}, "done": false, "episodes_total": 168, "training_iteration": 42, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_17-00-23", "timestamp": 1618045223, "time_this_iter_s": 460.01615619659424, "time_total_s": 22479.85277557373, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3241.166110754013, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 25.793750000000006, "ram_util_percent": 82.21753048780488}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2592.5903777598346, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2773.35080031185, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.84990032311111, "mean_raw_obs_processing_ms": 18.7241827198514, "mean_inference_ms": 17.891723759723945, "mean_action_processing_ms": 0.10830899380765271}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 172000, "timers": {"sample_time_ms": 437506.204, "sample_throughput": 9.143, "learn_time_ms": 25034.795, "learn_throughput": 159.778, "update_time_ms": 5.336}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.0367731933365576, "policy_loss": -0.005660202819854021, "vf_loss": 2065.734106063843, "vf_explained_var": 0.6859483122825623, "kl": 0.009532530442811549, "entropy": 52.72358286380768, "entropy_coeff": 0.001}}, "num_steps_sampled": 172000, "num_steps_trained": 172000}, "done": false, "episodes_total": 172, "training_iteration": 43, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_17-08-02", "timestamp": 1618045682, "time_this_iter_s": 459.37887144088745, "time_total_s": 22939.231647014618, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3700.5449821949005, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 25.763262195121946, "ram_util_percent": 82.19634146341464}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2592.5903777598346, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2771.8135588251553, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.79305589907815, "mean_raw_obs_processing_ms": 18.660439423180385, "mean_inference_ms": 17.89124992631104, "mean_action_processing_ms": 0.10830830212580661}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 176000, "timers": {"sample_time_ms": 437145.275, "sample_throughput": 9.15, "learn_time_ms": 25008.463, "learn_throughput": 159.946, "update_time_ms": 5.181}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.040817364322720096, "policy_loss": -0.011296550132101402, "vf_loss": 2228.0466346740723, "vf_explained_var": 0.6669111847877502, "kl": 0.011731626058463007, "entropy": 52.97444033622742, "entropy_coeff": 0.001}}, "num_steps_sampled": 176000, "num_steps_trained": 176000}, "done": false, "episodes_total": 176, "training_iteration": 44, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_17-15-41", "timestamp": 1618046141, "time_this_iter_s": 459.0667815208435, "time_total_s": 23398.29842853546, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4159.611763715744, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 25.760763358778625, "ram_util_percent": 82.38839694656488}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2592.5903777598346, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2763.8691363841376, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.74118752303926, "mean_raw_obs_processing_ms": 18.604091510104695, "mean_inference_ms": 17.890676669799905, "mean_action_processing_ms": 0.10831155974450946}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 180000, "timers": {"sample_time_ms": 436865.573, "sample_throughput": 9.156, "learn_time_ms": 24986.791, "learn_throughput": 160.085, "update_time_ms": 5.058}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04028469801414758, "policy_loss": -0.009104623546591029, "vf_loss": 2088.289596557617, "vf_explained_var": 0.6816204786300659, "kl": 0.009637684765039012, "entropy": 53.026735663414, "entropy_coeff": 0.001}}, "num_steps_sampled": 180000, "num_steps_trained": 180000}, "done": false, "episodes_total": 180, "training_iteration": 45, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_17-23-20", "timestamp": 1618046600, "time_this_iter_s": 459.16989731788635, "time_total_s": 23857.468325853348, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4618.78166103363, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 25.793129770992365, "ram_util_percent": 82.22961832061068}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2592.5903777598346, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2760.021239859221, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.69309063948097, "mean_raw_obs_processing_ms": 18.557847818588684, "mean_inference_ms": 17.889236644919112, "mean_action_processing_ms": 0.10830768002909194}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 184000, "timers": {"sample_time_ms": 435994.827, "sample_throughput": 9.174, "learn_time_ms": 24799.603, "learn_throughput": 161.293, "update_time_ms": 3.787}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04243766801664606, "policy_loss": -0.005676459870301187, "vf_loss": 1500.6187896728516, "vf_explained_var": 0.7419381141662598, "kl": 0.010559705406194553, "entropy": 52.82336175441742, "entropy_coeff": 0.001}}, "num_steps_sampled": 184000, "num_steps_trained": 184000}, "done": false, "episodes_total": 184, "training_iteration": 46, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_17-31-00", "timestamp": 1618047060, "time_this_iter_s": 459.15064311027527, "time_total_s": 24316.618968963623, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5077.932304143906, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 25.78381679389313, "ram_util_percent": 82.39938931297709}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2592.5903777598346, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2758.4666582324185, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.65851941219296, "mean_raw_obs_processing_ms": 18.519303831928344, "mean_inference_ms": 17.88814229170541, "mean_action_processing_ms": 0.10830299022542884}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 188000, "timers": {"sample_time_ms": 436121.091, "sample_throughput": 9.172, "learn_time_ms": 24791.084, "learn_throughput": 161.348, "update_time_ms": 3.862}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.03876799502177164, "policy_loss": -0.004597657243721187, "vf_loss": 1767.193468093872, "vf_explained_var": 0.7343897819519043, "kl": 0.009585810112184845, "entropy": 52.80084788799286, "entropy_coeff": 0.001}}, "num_steps_sampled": 188000, "num_steps_trained": 188000}, "done": false, "episodes_total": 188, "training_iteration": 47, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_17-38-43", "timestamp": 1618047523, "time_this_iter_s": 463.49811148643494, "time_total_s": 24780.117080450058, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5541.430415630341, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 25.716490166414527, "ram_util_percent": 82.2518910741301}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2592.5903777598346, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2754.0721822312885, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.6235196198864, "mean_raw_obs_processing_ms": 18.48824279375889, "mean_inference_ms": 17.88752468420179, "mean_action_processing_ms": 0.10830175264878515}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 192000, "timers": {"sample_time_ms": 435649.617, "sample_throughput": 9.182, "learn_time_ms": 24790.317, "learn_throughput": 161.353, "update_time_ms": 3.834}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04232786822831258, "policy_loss": -0.005662762385327369, "vf_loss": 1537.1025867462158, "vf_explained_var": 0.7524100542068481, "kl": 0.007844640291295946, "entropy": 52.820592045784, "entropy_coeff": 0.001}}, "num_steps_sampled": 192000, "num_steps_trained": 192000}, "done": false, "episodes_total": 192, "training_iteration": 48, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_17-46-22", "timestamp": 1618047982, "time_this_iter_s": 459.3048777580261, "time_total_s": 25239.421958208084, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6000.735293388367, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 25.802748091603053, "ram_util_percent": 82.10152671755725}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2530.6147905924167, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2746.106133080808, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.59551145325602, "mean_raw_obs_processing_ms": 18.461625716505303, "mean_inference_ms": 17.887242315735907, "mean_action_processing_ms": 0.10830306510102808}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 196000, "timers": {"sample_time_ms": 435690.603, "sample_throughput": 9.181, "learn_time_ms": 24796.798, "learn_throughput": 161.311, "update_time_ms": 3.873}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04582048929296434, "policy_loss": -0.008704423627932556, "vf_loss": 1439.761468887329, "vf_explained_var": 0.7721095085144043, "kl": 0.009950367821147665, "entropy": 52.50871205329895, "entropy_coeff": 0.001}}, "num_steps_sampled": 196000, "num_steps_trained": 196000}, "done": false, "episodes_total": 196, "training_iteration": 49, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_17-54-06", "timestamp": 1618048446, "time_this_iter_s": 464.00853633880615, "time_total_s": 25703.43049454689, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6464.743829727173, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 25.66586102719033, "ram_util_percent": 82.14123867069486}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2530.6147905924167, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2746.528137501512, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.57579711867567, "mean_raw_obs_processing_ms": 18.43780585682479, "mean_inference_ms": 17.887440193992163, "mean_action_processing_ms": 0.10830355430325084}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 200000, "timers": {"sample_time_ms": 436189.951, "sample_throughput": 9.17, "learn_time_ms": 24787.438, "learn_throughput": 161.372, "update_time_ms": 3.9}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04342611986794509, "policy_loss": -0.004811570164747536, "vf_loss": 1268.8301410675049, "vf_explained_var": 0.78868567943573, "kl": 0.008933065153541975, "entropy": 52.19615566730499, "entropy_coeff": 0.001}}, "num_steps_sampled": 200000, "num_steps_trained": 200000}, "done": false, "episodes_total": 200, "training_iteration": 50, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_18-01-50", "timestamp": 1618048910, "time_this_iter_s": 463.74727511405945, "time_total_s": 26167.17776966095, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6928.491104841232, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 25.75906344410876, "ram_util_percent": 82.51268882175226}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2530.6147905924167, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2747.875301172854, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.56303918684927, "mean_raw_obs_processing_ms": 18.416524385583706, "mean_inference_ms": 17.88766919140373, "mean_action_processing_ms": 0.10830319168041852}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 204000, "timers": {"sample_time_ms": 436330.068, "sample_throughput": 9.167, "learn_time_ms": 24776.594, "learn_throughput": 161.443, "update_time_ms": 3.907}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04998184205032885, "policy_loss": -0.010551908024353907, "vf_loss": 1199.0583400726318, "vf_explained_var": 0.7869361639022827, "kl": 0.009925208170898259, "entropy": 52.41304004192352, "entropy_coeff": 0.001}}, "num_steps_sampled": 204000, "num_steps_trained": 204000}, "done": false, "episodes_total": 204, "training_iteration": 51, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_18-09-34", "timestamp": 1618049374, "time_this_iter_s": 463.8564486503601, "time_total_s": 26631.03421831131, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7392.347553491592, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 25.773827534039334, "ram_util_percent": 82.45733736762482}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2530.6147905924167, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2748.404832003267, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.5489367128431, "mean_raw_obs_processing_ms": 18.397962345695106, "mean_inference_ms": 17.887578496926, "mean_action_processing_ms": 0.1083031151250783}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 208000, "timers": {"sample_time_ms": 436304.066, "sample_throughput": 9.168, "learn_time_ms": 24767.915, "learn_throughput": 161.499, "update_time_ms": 3.949}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.0487897719576722, "policy_loss": -0.007624226549523883, "vf_loss": 1043.468415260315, "vf_explained_var": 0.8238563537597656, "kl": 0.006393072893843055, "entropy": 52.23953592777252, "entropy_coeff": 0.001}}, "num_steps_sampled": 208000, "num_steps_trained": 208000}, "done": false, "episodes_total": 208, "training_iteration": 52, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_18-17-14", "timestamp": 1618049834, "time_this_iter_s": 459.6700642108917, "time_total_s": 27090.7042825222, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7852.017617702484, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 25.76295731707317, "ram_util_percent": 82.29131097560976}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2530.6147905924167, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2748.352019160431, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.53447167402518, "mean_raw_obs_processing_ms": 18.379859556315697, "mean_inference_ms": 17.88755096609156, "mean_action_processing_ms": 0.10830194898173277}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 212000, "timers": {"sample_time_ms": 436357.45, "sample_throughput": 9.167, "learn_time_ms": 24777.438, "learn_throughput": 161.437, "update_time_ms": 3.962}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04537687811534852, "policy_loss": -0.010134510463103652, "vf_loss": 1587.938735961914, "vf_explained_var": 0.7485603094100952, "kl": 0.01302942298934795, "entropy": 52.42469620704651, "entropy_coeff": 0.001}}, "num_steps_sampled": 212000, "num_steps_trained": 212000}, "done": false, "episodes_total": 212, "training_iteration": 53, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_18-24-54", "timestamp": 1618050294, "time_this_iter_s": 460.0069818496704, "time_total_s": 27550.711264371872, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8312.024599552155, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 25.72267884322679, "ram_util_percent": 82.20365296803654}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2530.6147905924167, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2749.902846342793, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.52382599858475, "mean_raw_obs_processing_ms": 18.363656945419347, "mean_inference_ms": 17.887647237150986, "mean_action_processing_ms": 0.10830083400183478}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 216000, "timers": {"sample_time_ms": 436729.676, "sample_throughput": 9.159, "learn_time_ms": 24786.108, "learn_throughput": 161.381, "update_time_ms": 3.938}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.040776731504593045, "policy_loss": -0.001750925526721403, "vf_loss": 1303.1556243896484, "vf_explained_var": 0.8006181120872498, "kl": 0.006291811674600467, "entropy": 52.686543703079224, "entropy_coeff": 0.001}}, "num_steps_sampled": 216000, "num_steps_trained": 216000}, "done": false, "episodes_total": 216, "training_iteration": 54, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_18-32-37", "timestamp": 1618050757, "time_this_iter_s": 462.87528467178345, "time_total_s": 28013.586549043655, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8774.899884223938, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 25.805000000000003, "ram_util_percent": 82.29787878787879}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2530.6147905924167, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2746.981675677084, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.51437464860527, "mean_raw_obs_processing_ms": 18.34781707030337, "mean_inference_ms": 17.887806545349395, "mean_action_processing_ms": 0.10829996510796633}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 220000, "timers": {"sample_time_ms": 436907.781, "sample_throughput": 9.155, "learn_time_ms": 24789.951, "learn_throughput": 161.356, "update_time_ms": 3.896}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05450496819685213, "policy_loss": -0.015704030374763533, "vf_loss": 1316.9658584594727, "vf_explained_var": 0.7862401008605957, "kl": 0.008586987241869792, "entropy": 52.82929289340973, "entropy_coeff": 0.001}}, "num_steps_sampled": 220000, "num_steps_trained": 220000}, "done": false, "episodes_total": 220, "training_iteration": 55, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_18-40-18", "timestamp": 1618051218, "time_this_iter_s": 460.9703872203827, "time_total_s": 28474.556936264038, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9235.87027144432, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 25.79179331306991, "ram_util_percent": 82.52933130699087}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2530.6147905924167, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2744.663293252456, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.506320155866, "mean_raw_obs_processing_ms": 18.3339232344246, "mean_inference_ms": 17.88791875071587, "mean_action_processing_ms": 0.10829955727302476}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 224000, "timers": {"sample_time_ms": 437200.481, "sample_throughput": 9.149, "learn_time_ms": 24801.131, "learn_throughput": 161.283, "update_time_ms": 3.849}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04220011297729798, "policy_loss": -0.002049912029178813, "vf_loss": 1179.6836700439453, "vf_explained_var": 0.8030683994293213, "kl": 0.01010194153059274, "entropy": 52.95722532272339, "entropy_coeff": 0.001}}, "num_steps_sampled": 224000, "num_steps_trained": 224000}, "done": false, "episodes_total": 224, "training_iteration": 56, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_18-48-00", "timestamp": 1618051680, "time_this_iter_s": 462.1891493797302, "time_total_s": 28936.74608564377, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9698.05942082405, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 25.78072837632777, "ram_util_percent": 82.34992412746587}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2530.6147905924167, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2743.880695727887, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.498491955421, "mean_raw_obs_processing_ms": 18.320930446056817, "mean_inference_ms": 17.88822599231453, "mean_action_processing_ms": 0.10829999113151159}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 228000, "timers": {"sample_time_ms": 437071.378, "sample_throughput": 9.152, "learn_time_ms": 24798.193, "learn_throughput": 161.302, "update_time_ms": 3.758}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.050858513510320336, "policy_loss": -0.011543659813469276, "vf_loss": 1289.2399978637695, "vf_explained_var": 0.7893948554992676, "kl": 0.009694259118987247, "entropy": 53.17667829990387, "entropy_coeff": 0.001}}, "num_steps_sampled": 228000, "num_steps_trained": 228000}, "done": false, "episodes_total": 228, "training_iteration": 57, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_18-55-42", "timestamp": 1618052142, "time_this_iter_s": 462.1773364543915, "time_total_s": 29398.92342209816, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10160.236757278442, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 25.718664643399087, "ram_util_percent": 82.20986342943854}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2530.6147905924167, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2741.9826881581143, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.49071898785357, "mean_raw_obs_processing_ms": 18.308868072874475, "mean_inference_ms": 17.88854117844076, "mean_action_processing_ms": 0.10830052819279104}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 232000, "timers": {"sample_time_ms": 437220.064, "sample_throughput": 9.149, "learn_time_ms": 24801.342, "learn_throughput": 161.282, "update_time_ms": 3.74}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.053176153713138774, "policy_loss": -0.01277310075238347, "vf_loss": 1238.8807792663574, "vf_explained_var": 0.7999373078346252, "kl": 0.007802275533322245, "entropy": 53.57208442687988, "entropy_coeff": 0.001}}, "num_steps_sampled": 232000, "num_steps_trained": 232000}, "done": false, "episodes_total": 232, "training_iteration": 58, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_19-03-23", "timestamp": 1618052603, "time_this_iter_s": 460.82565546035767, "time_total_s": 29859.749077558517, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10621.0624127388, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 25.76322188449848, "ram_util_percent": 82.4741641337386}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2530.6147905924167, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2737.029884584968, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.48375958675214, "mean_raw_obs_processing_ms": 18.297909321665397, "mean_inference_ms": 17.88892258459305, "mean_action_processing_ms": 0.10830087877707038}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 236000, "timers": {"sample_time_ms": 437215.426, "sample_throughput": 9.149, "learn_time_ms": 24809.186, "learn_throughput": 161.231, "update_time_ms": 3.692}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.03982451697811484, "policy_loss": -0.0011507172894198447, "vf_loss": 1419.5211086273193, "vf_explained_var": 0.7706285715103149, "kl": 0.005773769196821377, "entropy": 53.446385979652405, "entropy_coeff": 0.001}}, "num_steps_sampled": 236000, "num_steps_trained": 236000}, "done": false, "episodes_total": 236, "training_iteration": 59, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_19-11-07", "timestamp": 1618053067, "time_this_iter_s": 464.04053711891174, "time_total_s": 30323.78961467743, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11085.102949857712, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 25.693051359516616, "ram_util_percent": 82.69939577039275}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2530.6147905924167, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2733.0220526418866, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2901.9505309783394, -2798.269783682138, -2735.8555468551262, -2803.7863125120953, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.47509068549053, "mean_raw_obs_processing_ms": 18.288119545829066, "mean_inference_ms": 17.889116188014686, "mean_action_processing_ms": 0.10830035155835942}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 240000, "timers": {"sample_time_ms": 436725.736, "sample_throughput": 9.159, "learn_time_ms": 24809.67, "learn_throughput": 161.227, "update_time_ms": 3.679}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04588137858081609, "policy_loss": -0.0018001460121013224, "vf_loss": 881.414249420166, "vf_explained_var": 0.8454239368438721, "kl": 0.008277294487925246, "entropy": 53.72309732437134, "entropy_coeff": 0.001}}, "num_steps_sampled": 240000, "num_steps_trained": 240000}, "done": false, "episodes_total": 240, "training_iteration": 60, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_19-18-46", "timestamp": 1618053526, "time_this_iter_s": 458.85376167297363, "time_total_s": 30782.643376350403, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11543.956711530685, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 25.753058103975537, "ram_util_percent": 82.03073394495412}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2530.6147905924167, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2724.8346795004372, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2785.9360620189686, -2827.7745886617763, -2772.459720718673, -2788.691962636441, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.44244379020836, "mean_raw_obs_processing_ms": 18.20247948780946, "mean_inference_ms": 17.888729048697204, "mean_action_processing_ms": 0.10830668407119505}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 244000, "timers": {"sample_time_ms": 436882.274, "sample_throughput": 9.156, "learn_time_ms": 24807.083, "learn_throughput": 161.244, "update_time_ms": 3.68}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.050543572258902714, "policy_loss": -0.012683929060585797, "vf_loss": 1496.7637481689453, "vf_explained_var": 0.7366930842399597, "kl": 0.006901510379975662, "entropy": 53.51742708683014, "entropy_coeff": 0.001}}, "num_steps_sampled": 244000, "num_steps_trained": 244000}, "done": false, "episodes_total": 244, "training_iteration": 61, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_19-26-31", "timestamp": 1618053991, "time_this_iter_s": 465.3961682319641, "time_total_s": 31248.039544582367, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12009.35287976265, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 25.6855421686747, "ram_util_percent": 82.28855421686748}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2510.127161499556, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2718.0039976950293, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2757.5632519227515, -2740.4492239762217, -2720.8728981613804, -2793.3092746160864, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.41751812592412, "mean_raw_obs_processing_ms": 18.162550114163583, "mean_inference_ms": 17.88995499723478, "mean_action_processing_ms": 0.10831225769122314}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 248000, "timers": {"sample_time_ms": 436919.191, "sample_throughput": 9.155, "learn_time_ms": 24815.885, "learn_throughput": 161.187, "update_time_ms": 3.638}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.0420649582229089, "policy_loss": -0.003179700783221051, "vf_loss": 1389.4842319488525, "vf_explained_var": 0.7508727312088013, "kl": 0.0066192587109981105, "entropy": 53.44202160835266, "entropy_coeff": 0.001}}, "num_steps_sampled": 248000, "num_steps_trained": 248000}, "done": false, "episodes_total": 248, "training_iteration": 62, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_19-34-12", "timestamp": 1618054452, "time_this_iter_s": 460.1270773410797, "time_total_s": 31708.166621923447, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12469.47995710373, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 25.798782343987824, "ram_util_percent": 81.95844748858448}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2510.127161499556, "episode_reward_min": -2935.5743241745886, "episode_reward_mean": -2711.1732882963424, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2592.5903777598346, -2935.5743241745886, -2743.8072104473467, -2814.83126185999, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.38182861509233, "mean_raw_obs_processing_ms": 18.137278423955436, "mean_inference_ms": 17.88972181053422, "mean_action_processing_ms": 0.10831224071845552}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 252000, "timers": {"sample_time_ms": 436793.911, "sample_throughput": 9.158, "learn_time_ms": 24825.427, "learn_throughput": 161.125, "update_time_ms": 3.612}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04700031166430563, "policy_loss": -0.008440710080321878, "vf_loss": 1384.668788909912, "vf_explained_var": 0.7582725286483765, "kl": 0.009651077285525389, "entropy": 53.3713960647583, "entropy_coeff": 0.001}}, "num_steps_sampled": 252000, "num_steps_trained": 252000}, "done": false, "episodes_total": 252, "training_iteration": 63, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_19-41-51", "timestamp": 1618054911, "time_this_iter_s": 458.84922671318054, "time_total_s": 32167.015848636627, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12928.32918381691, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 25.858256880733943, "ram_util_percent": 82.3493883792049}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2472.598526302547, "episode_reward_min": -2908.5685183367577, "episode_reward_mean": -2702.2574032986777, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2908.5685183367577, -2748.510146693925, -2781.648244477495, -2796.8826361126503, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.34719396097714, "mean_raw_obs_processing_ms": 18.116766435488287, "mean_inference_ms": 17.889764941757605, "mean_action_processing_ms": 0.10830820093561803}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 256000, "timers": {"sample_time_ms": 436576.282, "sample_throughput": 9.162, "learn_time_ms": 24818.631, "learn_throughput": 161.169, "update_time_ms": 3.609}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04438946006121114, "policy_loss": -0.004605906025972217, "vf_loss": 1316.849859237671, "vf_explained_var": 0.7840350866317749, "kl": 0.00576307404844556, "entropy": 53.52835750579834, "entropy_coeff": 0.001}}, "num_steps_sampled": 256000, "num_steps_trained": 256000}, "done": false, "episodes_total": 256, "training_iteration": 64, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_19-49-31", "timestamp": 1618055371, "time_this_iter_s": 460.63114881515503, "time_total_s": 32627.646997451782, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13388.960332632065, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 25.75920852359209, "ram_util_percent": 82.32313546423136}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2472.598526302547, "episode_reward_min": -2886.4756142536535, "episode_reward_mean": -2691.351040534037, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2837.487517580333, -2767.6204093586875, -2780.1962359143977, -2705.247769062024, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.330121880589, "mean_raw_obs_processing_ms": 18.100065737358978, "mean_inference_ms": 17.89045134862535, "mean_action_processing_ms": 0.10830486390470283}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 260000, "timers": {"sample_time_ms": 436895.58, "sample_throughput": 9.156, "learn_time_ms": 24809.549, "learn_throughput": 161.228, "update_time_ms": 3.618}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04980983631685376, "policy_loss": -0.009180258843116462, "vf_loss": 1229.1984958648682, "vf_explained_var": 0.7757772207260132, "kl": 0.009314660303061828, "entropy": 53.85302698612213, "entropy_coeff": 0.001}}, "num_steps_sampled": 260000, "num_steps_trained": 260000}, "done": false, "episodes_total": 260, "training_iteration": 65, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_19-57-15", "timestamp": 1618055835, "time_this_iter_s": 464.07249903678894, "time_total_s": 33091.71949648857, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13853.032831668854, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 25.82462235649547, "ram_util_percent": 82.28882175226586}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2472.598526302547, "episode_reward_min": -2886.4756142536535, "episode_reward_mean": -2682.790073719795, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2733.583699887749, -2793.590964437016, -2738.0807130144194, -2822.0303949158615, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.31146637948237, "mean_raw_obs_processing_ms": 18.088244059894137, "mean_inference_ms": 17.891161200010945, "mean_action_processing_ms": 0.108300770256526}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 264000, "timers": {"sample_time_ms": 436943.192, "sample_throughput": 9.155, "learn_time_ms": 24811.334, "learn_throughput": 161.217, "update_time_ms": 3.652}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.051303047803230584, "policy_loss": -0.009690667735412717, "vf_loss": 1141.6668395996094, "vf_explained_var": 0.8031802177429199, "kl": 0.011859764432301745, "entropy": 54.21502435207367, "entropy_coeff": 0.001}}, "num_steps_sampled": 264000, "num_steps_trained": 264000}, "done": false, "episodes_total": 264, "training_iteration": 66, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_20-04-58", "timestamp": 1618056298, "time_this_iter_s": 462.6851444244385, "time_total_s": 33554.40464091301, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14315.717976093292, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 25.613464447806354, "ram_util_percent": 82.6089258698941}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2472.598526302547, "episode_reward_min": -2886.4756142536535, "episode_reward_mean": -2674.4277880859577, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2673.543150469265, -2634.4789547405917, -2728.1373009198273, -2783.8966230764413, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.29942746937755, "mean_raw_obs_processing_ms": 18.078951737945953, "mean_inference_ms": 17.89192361207877, "mean_action_processing_ms": 0.10829955981492809}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 268000, "timers": {"sample_time_ms": 436970.737, "sample_throughput": 9.154, "learn_time_ms": 24830.115, "learn_throughput": 161.095, "update_time_ms": 3.694}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.041155734739732, "policy_loss": -0.001936409156769514, "vf_loss": 1392.1967115402222, "vf_explained_var": 0.7666817903518677, "kl": 0.009724505653139204, "entropy": 54.11374020576477, "entropy_coeff": 0.001}}, "num_steps_sampled": 268000, "num_steps_trained": 268000}, "done": false, "episodes_total": 268, "training_iteration": 67, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_20-12-41", "timestamp": 1618056761, "time_this_iter_s": 462.64076042175293, "time_total_s": 34017.04540133476, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14778.358736515045, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 25.79424242424242, "ram_util_percent": 82.80530303030304}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2448.525994963044, "episode_reward_min": -2886.4756142536535, "episode_reward_mean": -2667.7385927378714, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2772.502707668948, -2656.966324383329, -2853.613603101267, -2754.9798725728556, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.29045424257023, "mean_raw_obs_processing_ms": 18.071776219528626, "mean_inference_ms": 17.892484798734827, "mean_action_processing_ms": 0.10829872709725263}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 272000, "timers": {"sample_time_ms": 436455.175, "sample_throughput": 9.165, "learn_time_ms": 24829.416, "learn_throughput": 161.099, "update_time_ms": 3.696}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05320708564249799, "policy_loss": -0.015178574074525386, "vf_loss": 1483.0507888793945, "vf_explained_var": 0.7500287890434265, "kl": 0.011925295577384531, "entropy": 54.05155003070831, "entropy_coeff": 0.001}}, "num_steps_sampled": 272000, "num_steps_trained": 272000}, "done": false, "episodes_total": 272, "training_iteration": 68, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_20-20-16", "timestamp": 1618057216, "time_this_iter_s": 455.66143774986267, "time_total_s": 34472.706839084625, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 15234.020174264908, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 25.78707692307692, "ram_util_percent": 82.6563076923077}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2448.525994963044, "episode_reward_min": -2886.4756142536535, "episode_reward_mean": -2658.769813867175, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418, -2744.450509149444, -2694.2190556025944, -2689.7573534167173, -2641.0504194911473, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.284188508215, "mean_raw_obs_processing_ms": 18.067893154280938, "mean_inference_ms": 17.893135500015642, "mean_action_processing_ms": 0.10829786546624462}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 276000, "timers": {"sample_time_ms": 435953.724, "sample_throughput": 9.175, "learn_time_ms": 24815.74, "learn_throughput": 161.188, "update_time_ms": 3.753}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.052279698313213885, "policy_loss": -0.005146513867657632, "vf_loss": 651.0854692459106, "vf_explained_var": 0.8692046999931335, "kl": 0.005920836701989174, "entropy": 54.2361216545105, "entropy_coeff": 0.001}}, "num_steps_sampled": 276000, "num_steps_trained": 276000}, "done": false, "episodes_total": 276, "training_iteration": 69, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_20-27-55", "timestamp": 1618057675, "time_this_iter_s": 458.88988041877747, "time_total_s": 34931.5967195034, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 15692.910054683685, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 25.70671755725191, "ram_util_percent": 82.70274809160306}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2448.525994963044, "episode_reward_min": -2886.4756142536535, "episode_reward_mean": -2652.073491968196, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2529.7949907798848, -2593.4524220424014, -2495.9865957267234, -2480.611139213084, -2735.684721521899, -2774.6764824827947, -2653.095656859114, -2722.7122375764257, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.27903783491382, "mean_raw_obs_processing_ms": 18.066070761405005, "mean_inference_ms": 17.893742960146025, "mean_action_processing_ms": 0.10829526865314403}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 280000, "timers": {"sample_time_ms": 435922.659, "sample_throughput": 9.176, "learn_time_ms": 24801.963, "learn_throughput": 161.278, "update_time_ms": 3.778}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05253392123267986, "policy_loss": -0.011827221314888448, "vf_loss": 1247.1635341644287, "vf_explained_var": 0.7767412662506104, "kl": 0.009765709633938968, "entropy": 54.15490424633026, "entropy_coeff": 0.001}}, "num_steps_sampled": 280000, "num_steps_trained": 280000}, "done": false, "episodes_total": 280, "training_iteration": 70, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_20-35-34", "timestamp": 1618058134, "time_this_iter_s": 458.40770506858826, "time_total_s": 35390.00442457199, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16151.317759752274, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 25.72920489296636, "ram_util_percent": 82.65}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2432.233243254026, "episode_reward_min": -2886.4756142536535, "episode_reward_mean": -2645.592265160638, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2622.341833501327, -2652.1814513614922, -2432.233243254026, -2531.289889567548, -2831.523751810999, -2719.833690577589, -2746.683120117361, -2667.4244788443616, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418, -2529.7949907798848, -2593.4524220424014, -2495.9865957267234, -2480.611139213084], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.27362527706268, "mean_raw_obs_processing_ms": 18.063992218729606, "mean_inference_ms": 17.894692267982464, "mean_action_processing_ms": 0.1082950505792166}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 284000, "timers": {"sample_time_ms": 435022.897, "sample_throughput": 9.195, "learn_time_ms": 24793.19, "learn_throughput": 161.335, "update_time_ms": 3.762}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.06328826659591869, "policy_loss": -0.01920393347973004, "vf_loss": 920.7218713760376, "vf_explained_var": 0.8307018876075745, "kl": 0.008297321081045084, "entropy": 54.121278047561646, "entropy_coeff": 0.001}}, "num_steps_sampled": 284000, "num_steps_trained": 284000}, "done": false, "episodes_total": 284, "training_iteration": 71, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_20-43-10", "timestamp": 1618058590, "time_this_iter_s": 456.3102231025696, "time_total_s": 35846.31464767456, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16607.627982854843, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 25.732411674347162, "ram_util_percent": 82.75345622119816}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2432.233243254026, "episode_reward_min": -2886.4756142536535, "episode_reward_mean": -2636.194080999499, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2473.0977646427973, -2535.4959919378975, -2559.9370980000635, -2457.1157706556614, -2685.637488469004, -2599.795129874084, -2681.4077130227374, -2838.5135495051154, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418, -2529.7949907798848, -2593.4524220424014, -2495.9865957267234, -2480.611139213084, -2622.341833501327, -2652.1814513614922, -2432.233243254026, -2531.289889567548], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.26321270755278, "mean_raw_obs_processing_ms": 18.061220870769628, "mean_inference_ms": 17.895461370240653, "mean_action_processing_ms": 0.10829518969760876}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 288000, "timers": {"sample_time_ms": 434491.789, "sample_throughput": 9.206, "learn_time_ms": 24784.497, "learn_throughput": 161.391, "update_time_ms": 3.784}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.041811344563029706, "policy_loss": -3.988592652603984e-05, "vf_loss": 1176.7945737838745, "vf_explained_var": 0.797370433807373, "kl": 0.009515706551610492, "entropy": 54.49097466468811, "entropy_coeff": 0.001}}, "num_steps_sampled": 288000, "num_steps_trained": 288000}, "done": false, "episodes_total": 288, "training_iteration": 72, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_20-50-45", "timestamp": 1618059045, "time_this_iter_s": 454.72874093055725, "time_total_s": 36301.04338860512, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 17062.3567237854, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 25.8516975308642, "ram_util_percent": 82.375}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2432.233243254026, "episode_reward_min": -2886.4756142536535, "episode_reward_mean": -2628.6220852876577, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2523.3222158665976, -2522.685673090176, -2446.4899098709866, -2555.6565108590376, -2656.4679349643184, -2668.911166556364, -2530.6147905924167, -2714.19608438513, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418, -2529.7949907798848, -2593.4524220424014, -2495.9865957267234, -2480.611139213084, -2622.341833501327, -2652.1814513614922, -2432.233243254026, -2531.289889567548, -2473.0977646427973, -2535.4959919378975, -2559.9370980000635, -2457.1157706556614], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.25402593887486, "mean_raw_obs_processing_ms": 18.057259801397734, "mean_inference_ms": 17.896019058595293, "mean_action_processing_ms": 0.10829400850550769}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 292000, "timers": {"sample_time_ms": 434443.51, "sample_throughput": 9.207, "learn_time_ms": 24760.372, "learn_throughput": 161.548, "update_time_ms": 3.957}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04627983074169606, "policy_loss": -0.00898050528485328, "vf_loss": 1581.8598327636719, "vf_explained_var": 0.6972476840019226, "kl": 0.014143131411401555, "entropy": 54.53223180770874, "entropy_coeff": 0.001}}, "num_steps_sampled": 292000, "num_steps_trained": 292000}, "done": false, "episodes_total": 292, "training_iteration": 73, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_20-58-23", "timestamp": 1618059503, "time_this_iter_s": 458.1268038749695, "time_total_s": 36759.17019248009, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 17520.48352766037, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 25.69923547400612, "ram_util_percent": 82.75963302752294}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2380.985792588075, "episode_reward_min": -2886.4756142536535, "episode_reward_mean": -2621.031362021619, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2510.673000465015, -2511.577049427904, -2407.881807413378, -2380.985792588075, -2742.587739453288, -2780.232168636295, -2721.048547264404, -2765.8763422115057, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418, -2529.7949907798848, -2593.4524220424014, -2495.9865957267234, -2480.611139213084, -2622.341833501327, -2652.1814513614922, -2432.233243254026, -2531.289889567548, -2473.0977646427973, -2535.4959919378975, -2559.9370980000635, -2457.1157706556614, -2523.3222158665976, -2522.685673090176, -2446.4899098709866, -2555.6565108590376], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.2416179048095, "mean_raw_obs_processing_ms": 18.05316844503264, "mean_inference_ms": 17.89639618473067, "mean_action_processing_ms": 0.10829107812275436}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 296000, "timers": {"sample_time_ms": 434028.174, "sample_throughput": 9.216, "learn_time_ms": 24764.604, "learn_throughput": 161.521, "update_time_ms": 3.936}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.053276429942343384, "policy_loss": -0.010461699275765568, "vf_loss": 1110.595591545105, "vf_explained_var": 0.7956541180610657, "kl": 0.010304999523214065, "entropy": 54.95118260383606, "entropy_coeff": 0.001}}, "num_steps_sampled": 296000, "num_steps_trained": 296000}, "done": false, "episodes_total": 296, "training_iteration": 74, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_21-06-00", "timestamp": 1618059960, "time_this_iter_s": 456.5195848941803, "time_total_s": 37215.68977737427, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 17977.00311255455, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 25.782181259600616, "ram_util_percent": 82.78694316436253}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2380.985792588075, "episode_reward_min": -2886.4756142536535, "episode_reward_mean": -2609.1728774361923, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2470.257187822342, -2423.3731840433693, -2469.0691400010364, -2461.196827156067, -2866.3960899831413, -2806.316401467486, -2732.9552974003245, -2666.663236120996, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418, -2529.7949907798848, -2593.4524220424014, -2495.9865957267234, -2480.611139213084, -2622.341833501327, -2652.1814513614922, -2432.233243254026, -2531.289889567548, -2473.0977646427973, -2535.4959919378975, -2559.9370980000635, -2457.1157706556614, -2523.3222158665976, -2522.685673090176, -2446.4899098709866, -2555.6565108590376, -2510.673000465015, -2511.577049427904, -2407.881807413378, -2380.985792588075], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.22481096289548, "mean_raw_obs_processing_ms": 18.049348582682722, "mean_inference_ms": 17.896400062636165, "mean_action_processing_ms": 0.10828786209237369}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 300000, "timers": {"sample_time_ms": 433222.82, "sample_throughput": 9.233, "learn_time_ms": 24748.221, "learn_throughput": 161.628, "update_time_ms": 3.929}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05539616197347641, "policy_loss": -0.009837379038799554, "vf_loss": 816.9373836517334, "vf_explained_var": 0.8321031928062439, "kl": 0.010145859225303866, "entropy": 54.74274265766144, "entropy_coeff": 0.001}}, "num_steps_sampled": 300000, "num_steps_trained": 300000}, "done": false, "episodes_total": 300, "training_iteration": 75, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_21-13-35", "timestamp": 1618060415, "time_this_iter_s": 455.8568341732025, "time_total_s": 37671.54661154747, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 18432.859946727753, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 25.806, "ram_util_percent": 81.96753846153847}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2380.985792588075, "episode_reward_min": -2886.4756142536535, "episode_reward_mean": -2595.876536334831, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2414.9750409323815, -2463.010285069388, -2442.6747122672596, -2422.036876566856, -2785.2245202750073, -2704.2388248463362, -2775.111350142186, -2762.9346058959472, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418, -2529.7949907798848, -2593.4524220424014, -2495.9865957267234, -2480.611139213084, -2622.341833501327, -2652.1814513614922, -2432.233243254026, -2531.289889567548, -2473.0977646427973, -2535.4959919378975, -2559.9370980000635, -2457.1157706556614, -2523.3222158665976, -2522.685673090176, -2446.4899098709866, -2555.6565108590376, -2510.673000465015, -2511.577049427904, -2407.881807413378, -2380.985792588075, -2470.257187822342, -2423.3731840433693, -2469.0691400010364, -2461.196827156067], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.2027413297557, "mean_raw_obs_processing_ms": 18.045907306362782, "mean_inference_ms": 17.89620875533353, "mean_action_processing_ms": 0.1082849831020589}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 304000, "timers": {"sample_time_ms": 432509.041, "sample_throughput": 9.248, "learn_time_ms": 24725.268, "learn_throughput": 161.778, "update_time_ms": 3.882}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.050137098820414394, "policy_loss": -0.004544406314380467, "vf_loss": 847.8118562698364, "vf_explained_var": 0.8305978775024414, "kl": 0.012444798601791263, "entropy": 55.31529116630554, "entropy_coeff": 0.001}}, "num_steps_sampled": 304000, "num_steps_trained": 304000}, "done": false, "episodes_total": 304, "training_iteration": 76, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_21-21-11", "timestamp": 1618060871, "time_this_iter_s": 455.31550908088684, "time_total_s": 38126.86212062836, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 18888.17545580864, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 25.71107692307692, "ram_util_percent": 82.58476923076923}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2380.985792588075, "episode_reward_min": -2886.4756142536535, "episode_reward_mean": -2583.581788229762, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2388.0396322123133, -2432.4589640355634, -2528.9481168883103, -2448.587777516334, -2736.828419310286, -2835.230317004804, -2757.7280481448374, -2660.0300188689976, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418, -2529.7949907798848, -2593.4524220424014, -2495.9865957267234, -2480.611139213084, -2622.341833501327, -2652.1814513614922, -2432.233243254026, -2531.289889567548, -2473.0977646427973, -2535.4959919378975, -2559.9370980000635, -2457.1157706556614, -2523.3222158665976, -2522.685673090176, -2446.4899098709866, -2555.6565108590376, -2510.673000465015, -2511.577049427904, -2407.881807413378, -2380.985792588075, -2470.257187822342, -2423.3731840433693, -2469.0691400010364, -2461.196827156067, -2414.9750409323815, -2463.010285069388, -2442.6747122672596, -2422.036876566856], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.18082600783498, "mean_raw_obs_processing_ms": 18.042316494204925, "mean_inference_ms": 17.89617767672571, "mean_action_processing_ms": 0.1082818224958824}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 308000, "timers": {"sample_time_ms": 431933.886, "sample_throughput": 9.261, "learn_time_ms": 24701.807, "learn_throughput": 161.931, "update_time_ms": 3.893}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.06389790045795962, "policy_loss": -0.02416569401975721, "vf_loss": 1368.1601905822754, "vf_explained_var": 0.751897394657135, "kl": 0.013467528682667762, "entropy": 54.760560274124146, "entropy_coeff": 0.001}}, "num_steps_sampled": 308000, "num_steps_trained": 308000}, "done": false, "episodes_total": 308, "training_iteration": 77, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_21-28-48", "timestamp": 1618061328, "time_this_iter_s": 456.65708351135254, "time_total_s": 38583.51920413971, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 19344.832539319992, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 25.69325153374233, "ram_util_percent": 82.40444785276073}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2378.8211380460034, "episode_reward_min": -2886.4756142536535, "episode_reward_mean": -2571.996413126219, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2378.8211380460034, -2423.7021581597664, -2545.440608436416, -2483.3153883324403, -2773.0451674625465, -2774.85280422448, -2676.897356560531, -2886.4756142536535, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418, -2529.7949907798848, -2593.4524220424014, -2495.9865957267234, -2480.611139213084, -2622.341833501327, -2652.1814513614922, -2432.233243254026, -2531.289889567548, -2473.0977646427973, -2535.4959919378975, -2559.9370980000635, -2457.1157706556614, -2523.3222158665976, -2522.685673090176, -2446.4899098709866, -2555.6565108590376, -2510.673000465015, -2511.577049427904, -2407.881807413378, -2380.985792588075, -2470.257187822342, -2423.3731840433693, -2469.0691400010364, -2461.196827156067, -2414.9750409323815, -2463.010285069388, -2442.6747122672596, -2422.036876566856, -2388.0396322123133, -2432.4589640355634, -2528.9481168883103, -2448.587777516334], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.15913726634673, "mean_raw_obs_processing_ms": 18.040203496834778, "mean_inference_ms": 17.896037990559158, "mean_action_processing_ms": 0.10827925260576286}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 312000, "timers": {"sample_time_ms": 432261.043, "sample_throughput": 9.254, "learn_time_ms": 24691.53, "learn_throughput": 161.999, "update_time_ms": 3.886}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05013240227708593, "policy_loss": -0.005121325608342886, "vf_loss": 927.5383996963501, "vf_explained_var": 0.8289473056793213, "kl": 0.007735955994576216, "entropy": 55.06005275249481, "entropy_coeff": 0.001}}, "num_steps_sampled": 312000, "num_steps_trained": 312000}, "done": false, "episodes_total": 312, "training_iteration": 78, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_21-36-26", "timestamp": 1618061786, "time_this_iter_s": 458.82935905456543, "time_total_s": 39042.348563194275, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 19803.661898374557, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 25.73333333333333, "ram_util_percent": 82.72660550458716}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2359.766277178773, "episode_reward_min": -2802.5627033028823, "episode_reward_mean": -2557.814155082182, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2363.3293781686702, -2359.766277178773, -2506.94906299147, -2463.0004197585877, -2744.181753993129, -2647.0588064295343, -2706.1386250326295, -2668.5385466591647, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418, -2529.7949907798848, -2593.4524220424014, -2495.9865957267234, -2480.611139213084, -2622.341833501327, -2652.1814513614922, -2432.233243254026, -2531.289889567548, -2473.0977646427973, -2535.4959919378975, -2559.9370980000635, -2457.1157706556614, -2523.3222158665976, -2522.685673090176, -2446.4899098709866, -2555.6565108590376, -2510.673000465015, -2511.577049427904, -2407.881807413378, -2380.985792588075, -2470.257187822342, -2423.3731840433693, -2469.0691400010364, -2461.196827156067, -2414.9750409323815, -2463.010285069388, -2442.6747122672596, -2422.036876566856, -2388.0396322123133, -2432.4589640355634, -2528.9481168883103, -2448.587777516334, -2378.8211380460034, -2423.7021581597664, -2545.440608436416, -2483.3153883324403], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.1348673860191, "mean_raw_obs_processing_ms": 18.0377656686742, "mean_inference_ms": 17.89568648077234, "mean_action_processing_ms": 0.10827645098578785}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 316000, "timers": {"sample_time_ms": 432062.759, "sample_throughput": 9.258, "learn_time_ms": 24693.247, "learn_throughput": 161.988, "update_time_ms": 3.87}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04461093875579536, "policy_loss": 0.0006472841487266123, "vf_loss": 927.269998550415, "vf_explained_var": 0.8086502552032471, "kl": 0.008956400808528997, "entropy": 55.42656397819519, "entropy_coeff": 0.001}}, "num_steps_sampled": 316000, "num_steps_trained": 316000}, "done": false, "episodes_total": 316, "training_iteration": 79, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_21-44-03", "timestamp": 1618062243, "time_this_iter_s": 456.9233479499817, "time_total_s": 39499.27191114426, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 20260.58524632454, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 25.775460122699386, "ram_util_percent": 82.16748466257668}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2359.766277178773, "episode_reward_min": -2802.5627033028823, "episode_reward_mean": -2546.7223807739974, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2436.5987670277086, -2403.4149267544194, -2385.022180228617, -2431.704427285287, -2642.7924231175375, -2696.6520340173747, -2670.417453416697, -2783.3206684879915, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418, -2529.7949907798848, -2593.4524220424014, -2495.9865957267234, -2480.611139213084, -2622.341833501327, -2652.1814513614922, -2432.233243254026, -2531.289889567548, -2473.0977646427973, -2535.4959919378975, -2559.9370980000635, -2457.1157706556614, -2523.3222158665976, -2522.685673090176, -2446.4899098709866, -2555.6565108590376, -2510.673000465015, -2511.577049427904, -2407.881807413378, -2380.985792588075, -2470.257187822342, -2423.3731840433693, -2469.0691400010364, -2461.196827156067, -2414.9750409323815, -2463.010285069388, -2442.6747122672596, -2422.036876566856, -2388.0396322123133, -2432.4589640355634, -2528.9481168883103, -2448.587777516334, -2378.8211380460034, -2423.7021581597664, -2545.440608436416, -2483.3153883324403, -2363.3293781686702, -2359.766277178773, -2506.94906299147, -2463.0004197585877], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.10871870563452, "mean_raw_obs_processing_ms": 18.03642064462407, "mean_inference_ms": 17.89522335026438, "mean_action_processing_ms": 0.10827334780029935}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 320000, "timers": {"sample_time_ms": 431787.272, "sample_throughput": 9.264, "learn_time_ms": 24705.539, "learn_throughput": 161.907, "update_time_ms": 3.821}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.052968187839724123, "policy_loss": -0.008478525240207091, "vf_loss": 971.9318046569824, "vf_explained_var": 0.8076664805412292, "kl": 0.008847538163536228, "entropy": 55.09372961521149, "entropy_coeff": 0.001}}, "num_steps_sampled": 320000, "num_steps_trained": 320000}, "done": false, "episodes_total": 320, "training_iteration": 80, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_21-51-39", "timestamp": 1618062699, "time_this_iter_s": 455.7726237773895, "time_total_s": 39955.044534921646, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 20716.35787010193, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 25.749076923076924, "ram_util_percent": 82.52830769230769}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2359.766277178773, "episode_reward_min": -2802.5627033028823, "episode_reward_mean": -2537.019874759498, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2481.437928404916, -2468.99410632492, -2394.74959547923, -2477.7503473806037, -2697.837325695289, -2710.2420576087716, -2699.1425042408137, -2802.5627033028823, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418, -2529.7949907798848, -2593.4524220424014, -2495.9865957267234, -2480.611139213084, -2622.341833501327, -2652.1814513614922, -2432.233243254026, -2531.289889567548, -2473.0977646427973, -2535.4959919378975, -2559.9370980000635, -2457.1157706556614, -2523.3222158665976, -2522.685673090176, -2446.4899098709866, -2555.6565108590376, -2510.673000465015, -2511.577049427904, -2407.881807413378, -2380.985792588075, -2470.257187822342, -2423.3731840433693, -2469.0691400010364, -2461.196827156067, -2414.9750409323815, -2463.010285069388, -2442.6747122672596, -2422.036876566856, -2388.0396322123133, -2432.4589640355634, -2528.9481168883103, -2448.587777516334, -2378.8211380460034, -2423.7021581597664, -2545.440608436416, -2483.3153883324403, -2363.3293781686702, -2359.766277178773, -2506.94906299147, -2463.0004197585877, -2436.5987670277086, -2403.4149267544194, -2385.022180228617, -2431.704427285287], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.0815895998443, "mean_raw_obs_processing_ms": 18.034397589914665, "mean_inference_ms": 17.894714984166647, "mean_action_processing_ms": 0.10826975308535058}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 324000, "timers": {"sample_time_ms": 431887.34, "sample_throughput": 9.262, "learn_time_ms": 24705.391, "learn_throughput": 161.908, "update_time_ms": 3.844}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.0583894457668066, "policy_loss": -0.012083266221452504, "vf_loss": 769.3959407806396, "vf_explained_var": 0.848442554473877, "kl": 0.010541430820012465, "entropy": 55.05428147315979, "entropy_coeff": 0.001}}, "num_steps_sampled": 324000, "num_steps_trained": 324000}, "done": false, "episodes_total": 324, "training_iteration": 81, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_21-59-17", "timestamp": 1618063157, "time_this_iter_s": 457.3115622997284, "time_total_s": 40412.356097221375, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 21173.669432401657, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 25.799540581929552, "ram_util_percent": 82.39188361408883}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2359.766277178773, "episode_reward_min": -2784.5368032967012, "episode_reward_mean": -2525.6679242656287, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2438.072783305417, -2408.6683755390486, -2528.9642926872575, -2398.8840899290653, -2784.5368032967012, -2692.412731734614, -2655.9342081902646, -2668.022343270861, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418, -2529.7949907798848, -2593.4524220424014, -2495.9865957267234, -2480.611139213084, -2622.341833501327, -2652.1814513614922, -2432.233243254026, -2531.289889567548, -2473.0977646427973, -2535.4959919378975, -2559.9370980000635, -2457.1157706556614, -2523.3222158665976, -2522.685673090176, -2446.4899098709866, -2555.6565108590376, -2510.673000465015, -2511.577049427904, -2407.881807413378, -2380.985792588075, -2470.257187822342, -2423.3731840433693, -2469.0691400010364, -2461.196827156067, -2414.9750409323815, -2463.010285069388, -2442.6747122672596, -2422.036876566856, -2388.0396322123133, -2432.4589640355634, -2528.9481168883103, -2448.587777516334, -2378.8211380460034, -2423.7021581597664, -2545.440608436416, -2483.3153883324403, -2363.3293781686702, -2359.766277178773, -2506.94906299147, -2463.0004197585877, -2436.5987670277086, -2403.4149267544194, -2385.022180228617, -2431.704427285287, -2481.437928404916, -2468.99410632492, -2394.74959547923, -2477.7503473806037], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.05408319066473, "mean_raw_obs_processing_ms": 18.03255713161677, "mean_inference_ms": 17.893998673816476, "mean_action_processing_ms": 0.10826550998780901}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 328000, "timers": {"sample_time_ms": 432114.47, "sample_throughput": 9.257, "learn_time_ms": 24689.339, "learn_throughput": 162.013, "update_time_ms": 3.82}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.059778793482109904, "policy_loss": -0.012642304558539763, "vf_loss": 694.042573928833, "vf_explained_var": 0.8674801588058472, "kl": 0.009157488151686266, "entropy": 54.99265956878662, "entropy_coeff": 0.001}}, "num_steps_sampled": 328000, "num_steps_trained": 328000}, "done": false, "episodes_total": 328, "training_iteration": 82, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_22-06-53", "timestamp": 1618063613, "time_this_iter_s": 456.83942675590515, "time_total_s": 40869.19552397728, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 21630.508859157562, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 25.834254992319508, "ram_util_percent": 82.42503840245776}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2313.992087744758, "episode_reward_min": -2731.502891483954, "episode_reward_mean": -2512.279684058851, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2313.992087744758, -2383.218597726837, -2356.8705117191703, -2408.0008686239676, -2538.207764085711, -2645.161520090479, -2661.747790261439, -2647.344535172796, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418, -2529.7949907798848, -2593.4524220424014, -2495.9865957267234, -2480.611139213084, -2622.341833501327, -2652.1814513614922, -2432.233243254026, -2531.289889567548, -2473.0977646427973, -2535.4959919378975, -2559.9370980000635, -2457.1157706556614, -2523.3222158665976, -2522.685673090176, -2446.4899098709866, -2555.6565108590376, -2510.673000465015, -2511.577049427904, -2407.881807413378, -2380.985792588075, -2470.257187822342, -2423.3731840433693, -2469.0691400010364, -2461.196827156067, -2414.9750409323815, -2463.010285069388, -2442.6747122672596, -2422.036876566856, -2388.0396322123133, -2432.4589640355634, -2528.9481168883103, -2448.587777516334, -2378.8211380460034, -2423.7021581597664, -2545.440608436416, -2483.3153883324403, -2363.3293781686702, -2359.766277178773, -2506.94906299147, -2463.0004197585877, -2436.5987670277086, -2403.4149267544194, -2385.022180228617, -2431.704427285287, -2481.437928404916, -2468.99410632492, -2394.74959547923, -2477.7503473806037, -2438.072783305417, -2408.6683755390486, -2528.9642926872575, -2398.8840899290653], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 181.0274953352078, "mean_raw_obs_processing_ms": 18.030733013737017, "mean_inference_ms": 17.89328256484579, "mean_action_processing_ms": 0.10826093798286024}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 332000, "timers": {"sample_time_ms": 432461.533, "sample_throughput": 9.249, "learn_time_ms": 24676.171, "learn_throughput": 162.1, "update_time_ms": 3.631}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.054980979446554556, "policy_loss": -0.008195651404093951, "vf_loss": 729.7206830978394, "vf_explained_var": 0.8227283358573914, "kl": 0.010465452418429777, "entropy": 55.1290762424469, "entropy_coeff": 0.001}}, "num_steps_sampled": 332000, "num_steps_trained": 332000}, "done": false, "episodes_total": 332, "training_iteration": 83, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_22-14-35", "timestamp": 1618064075, "time_this_iter_s": 461.4636423587799, "time_total_s": 41330.65916633606, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22091.972501516342, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 25.67951441578149, "ram_util_percent": 82.7247344461305}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2305.2122191902163, "episode_reward_min": -2731.502891483954, "episode_reward_mean": -2500.9644633910684, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2316.8831596885902, -2381.41965677147, -2357.4245071818314, -2305.2122191902163, -2570.0431989862836, -2651.282260971452, -2594.5079925899868, -2731.502891483954, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418, -2529.7949907798848, -2593.4524220424014, -2495.9865957267234, -2480.611139213084, -2622.341833501327, -2652.1814513614922, -2432.233243254026, -2531.289889567548, -2473.0977646427973, -2535.4959919378975, -2559.9370980000635, -2457.1157706556614, -2523.3222158665976, -2522.685673090176, -2446.4899098709866, -2555.6565108590376, -2510.673000465015, -2511.577049427904, -2407.881807413378, -2380.985792588075, -2470.257187822342, -2423.3731840433693, -2469.0691400010364, -2461.196827156067, -2414.9750409323815, -2463.010285069388, -2442.6747122672596, -2422.036876566856, -2388.0396322123133, -2432.4589640355634, -2528.9481168883103, -2448.587777516334, -2378.8211380460034, -2423.7021581597664, -2545.440608436416, -2483.3153883324403, -2363.3293781686702, -2359.766277178773, -2506.94906299147, -2463.0004197585877, -2436.5987670277086, -2403.4149267544194, -2385.022180228617, -2431.704427285287, -2481.437928404916, -2468.99410632492, -2394.74959547923, -2477.7503473806037, -2438.072783305417, -2408.6683755390486, -2528.9642926872575, -2398.8840899290653, -2313.992087744758, -2383.218597726837, -2356.8705117191703, -2408.0008686239676], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 180.99915366841302, "mean_raw_obs_processing_ms": 18.028564820923425, "mean_inference_ms": 17.89244201831299, "mean_action_processing_ms": 0.10825628998919509}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 336000, "timers": {"sample_time_ms": 432348.089, "sample_throughput": 9.252, "learn_time_ms": 24659.784, "learn_throughput": 162.207, "update_time_ms": 3.635}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.052181120292516425, "policy_loss": -0.008271858445368707, "vf_loss": 1001.9466648101807, "vf_explained_var": 0.8101236820220947, "kl": 0.0111189246235881, "entropy": 55.04061484336853, "entropy_coeff": 0.001}}, "num_steps_sampled": 336000, "num_steps_trained": 336000}, "done": false, "episodes_total": 336, "training_iteration": 84, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_22-22-10", "timestamp": 1618064530, "time_this_iter_s": 455.22153782844543, "time_total_s": 41785.880704164505, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22547.194039344788, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 25.769337442218802, "ram_util_percent": 82.74345146379045}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2305.2122191902163, "episode_reward_min": -2705.7089008207085, "episode_reward_mean": -2490.689390370602, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2342.248428589117, -2385.5058376841826, -2462.301767269676, -2329.773008442034, -2580.9657254330195, -2644.012756450356, -2544.4125750404087, -2651.733802959089, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418, -2529.7949907798848, -2593.4524220424014, -2495.9865957267234, -2480.611139213084, -2622.341833501327, -2652.1814513614922, -2432.233243254026, -2531.289889567548, -2473.0977646427973, -2535.4959919378975, -2559.9370980000635, -2457.1157706556614, -2523.3222158665976, -2522.685673090176, -2446.4899098709866, -2555.6565108590376, -2510.673000465015, -2511.577049427904, -2407.881807413378, -2380.985792588075, -2470.257187822342, -2423.3731840433693, -2469.0691400010364, -2461.196827156067, -2414.9750409323815, -2463.010285069388, -2442.6747122672596, -2422.036876566856, -2388.0396322123133, -2432.4589640355634, -2528.9481168883103, -2448.587777516334, -2378.8211380460034, -2423.7021581597664, -2545.440608436416, -2483.3153883324403, -2363.3293781686702, -2359.766277178773, -2506.94906299147, -2463.0004197585877, -2436.5987670277086, -2403.4149267544194, -2385.022180228617, -2431.704427285287, -2481.437928404916, -2468.99410632492, -2394.74959547923, -2477.7503473806037, -2438.072783305417, -2408.6683755390486, -2528.9642926872575, -2398.8840899290653, -2313.992087744758, -2383.218597726837, -2356.8705117191703, -2408.0008686239676, -2316.8831596885902, -2381.41965677147, -2357.4245071818314, -2305.2122191902163], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 180.97127691447704, "mean_raw_obs_processing_ms": 18.02550082544242, "mean_inference_ms": 17.89176965826302, "mean_action_processing_ms": 0.10825245532138085}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 340000, "timers": {"sample_time_ms": 432102.072, "sample_throughput": 9.257, "learn_time_ms": 24664.878, "learn_throughput": 162.174, "update_time_ms": 3.617}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05048032464401331, "policy_loss": -0.009073321125470102, "vf_loss": 1255.6821556091309, "vf_explained_var": 0.7474731802940369, "kl": 0.010175777511904016, "entropy": 54.98140287399292, "entropy_coeff": 0.001}}, "num_steps_sampled": 340000, "num_steps_trained": 340000}, "done": false, "episodes_total": 340, "training_iteration": 85, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_22-29-44", "timestamp": 1618064984, "time_this_iter_s": 453.44531059265137, "time_total_s": 42239.32601475716, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23000.63934993744, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 25.82550231839258, "ram_util_percent": 82.73122102009272}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2305.2122191902163, "episode_reward_min": -2705.7089008207085, "episode_reward_mean": -2483.3102421018148, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2436.1881768968537, -2464.9689906888657, -2412.0994954041, -2369.953370014333, -2705.7089008207085, -2680.0805695935805, -2510.127161499556, -2595.877521581154, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418, -2529.7949907798848, -2593.4524220424014, -2495.9865957267234, -2480.611139213084, -2622.341833501327, -2652.1814513614922, -2432.233243254026, -2531.289889567548, -2473.0977646427973, -2535.4959919378975, -2559.9370980000635, -2457.1157706556614, -2523.3222158665976, -2522.685673090176, -2446.4899098709866, -2555.6565108590376, -2510.673000465015, -2511.577049427904, -2407.881807413378, -2380.985792588075, -2470.257187822342, -2423.3731840433693, -2469.0691400010364, -2461.196827156067, -2414.9750409323815, -2463.010285069388, -2442.6747122672596, -2422.036876566856, -2388.0396322123133, -2432.4589640355634, -2528.9481168883103, -2448.587777516334, -2378.8211380460034, -2423.7021581597664, -2545.440608436416, -2483.3153883324403, -2363.3293781686702, -2359.766277178773, -2506.94906299147, -2463.0004197585877, -2436.5987670277086, -2403.4149267544194, -2385.022180228617, -2431.704427285287, -2481.437928404916, -2468.99410632492, -2394.74959547923, -2477.7503473806037, -2438.072783305417, -2408.6683755390486, -2528.9642926872575, -2398.8840899290653, -2313.992087744758, -2383.218597726837, -2356.8705117191703, -2408.0008686239676, -2316.8831596885902, -2381.41965677147, -2357.4245071818314, -2305.2122191902163, -2342.248428589117, -2385.5058376841826, -2462.301767269676, -2329.773008442034], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 180.94198243467687, "mean_raw_obs_processing_ms": 18.022024866943084, "mean_inference_ms": 17.890922057006705, "mean_action_processing_ms": 0.10824804524623408}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 344000, "timers": {"sample_time_ms": 432589.498, "sample_throughput": 9.247, "learn_time_ms": 24673.19, "learn_throughput": 162.119, "update_time_ms": 3.646}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.06243350129807368, "policy_loss": -0.015545539383310825, "vf_loss": 745.2217454910278, "vf_explained_var": 0.8414584398269653, "kl": 0.010053114470792934, "entropy": 55.345489621162415, "entropy_coeff": 0.001}}, "num_steps_sampled": 344000, "num_steps_trained": 344000}, "done": false, "episodes_total": 344, "training_iteration": 86, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_22-37-24", "timestamp": 1618065444, "time_this_iter_s": 460.2729585170746, "time_total_s": 42699.59897327423, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23460.912308454514, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 25.71293759512938, "ram_util_percent": 83.01841704718416}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2305.2122191902163, "episode_reward_min": -2685.9646837808577, "episode_reward_mean": -2473.6708721325335, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2322.8496879480367, -2438.9867389253645, -2340.0145380970675, -2426.0061915964175, -2605.5528431565444, -2542.2796434836628, -2540.3833747658778, -2640.907847401659, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418, -2529.7949907798848, -2593.4524220424014, -2495.9865957267234, -2480.611139213084, -2622.341833501327, -2652.1814513614922, -2432.233243254026, -2531.289889567548, -2473.0977646427973, -2535.4959919378975, -2559.9370980000635, -2457.1157706556614, -2523.3222158665976, -2522.685673090176, -2446.4899098709866, -2555.6565108590376, -2510.673000465015, -2511.577049427904, -2407.881807413378, -2380.985792588075, -2470.257187822342, -2423.3731840433693, -2469.0691400010364, -2461.196827156067, -2414.9750409323815, -2463.010285069388, -2442.6747122672596, -2422.036876566856, -2388.0396322123133, -2432.4589640355634, -2528.9481168883103, -2448.587777516334, -2378.8211380460034, -2423.7021581597664, -2545.440608436416, -2483.3153883324403, -2363.3293781686702, -2359.766277178773, -2506.94906299147, -2463.0004197585877, -2436.5987670277086, -2403.4149267544194, -2385.022180228617, -2431.704427285287, -2481.437928404916, -2468.99410632492, -2394.74959547923, -2477.7503473806037, -2438.072783305417, -2408.6683755390486, -2528.9642926872575, -2398.8840899290653, -2313.992087744758, -2383.218597726837, -2356.8705117191703, -2408.0008686239676, -2316.8831596885902, -2381.41965677147, -2357.4245071818314, -2305.2122191902163, -2342.248428589117, -2385.5058376841826, -2462.301767269676, -2329.773008442034, -2436.1881768968537, -2464.9689906888657, -2412.0994954041, -2369.953370014333], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 180.91226375784777, "mean_raw_obs_processing_ms": 18.01863732463582, "mean_inference_ms": 17.890059868900615, "mean_action_processing_ms": 0.1082432919893381}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 348000, "timers": {"sample_time_ms": 432609.971, "sample_throughput": 9.246, "learn_time_ms": 24665.759, "learn_throughput": 162.168, "update_time_ms": 3.673}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05673055350780487, "policy_loss": -0.011124905082397163, "vf_loss": 813.8324699401855, "vf_explained_var": 0.8352084159851074, "kl": 0.014176778873661533, "entropy": 55.16165053844452, "entropy_coeff": 0.001}}, "num_steps_sampled": 348000, "num_steps_trained": 348000}, "done": false, "episodes_total": 348, "training_iteration": 87, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_22-45-01", "timestamp": 1618065901, "time_this_iter_s": 456.78526425361633, "time_total_s": 43156.38423752785, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23917.69757270813, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 25.80230414746544, "ram_util_percent": 82.44654377880184}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2305.2122191902163, "episode_reward_min": -2685.9646837808577, "episode_reward_mean": -2464.674899959317, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2381.8731224816406, -2309.9406654647046, -2373.7762660811914, -2363.9364374585525, -2556.5010696755294, -2472.598526302547, -2624.508231289133, -2541.6068472080415, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418, -2529.7949907798848, -2593.4524220424014, -2495.9865957267234, -2480.611139213084, -2622.341833501327, -2652.1814513614922, -2432.233243254026, -2531.289889567548, -2473.0977646427973, -2535.4959919378975, -2559.9370980000635, -2457.1157706556614, -2523.3222158665976, -2522.685673090176, -2446.4899098709866, -2555.6565108590376, -2510.673000465015, -2511.577049427904, -2407.881807413378, -2380.985792588075, -2470.257187822342, -2423.3731840433693, -2469.0691400010364, -2461.196827156067, -2414.9750409323815, -2463.010285069388, -2442.6747122672596, -2422.036876566856, -2388.0396322123133, -2432.4589640355634, -2528.9481168883103, -2448.587777516334, -2378.8211380460034, -2423.7021581597664, -2545.440608436416, -2483.3153883324403, -2363.3293781686702, -2359.766277178773, -2506.94906299147, -2463.0004197585877, -2436.5987670277086, -2403.4149267544194, -2385.022180228617, -2431.704427285287, -2481.437928404916, -2468.99410632492, -2394.74959547923, -2477.7503473806037, -2438.072783305417, -2408.6683755390486, -2528.9642926872575, -2398.8840899290653, -2313.992087744758, -2383.218597726837, -2356.8705117191703, -2408.0008686239676, -2316.8831596885902, -2381.41965677147, -2357.4245071818314, -2305.2122191902163, -2342.248428589117, -2385.5058376841826, -2462.301767269676, -2329.773008442034, -2436.1881768968537, -2464.9689906888657, -2412.0994954041, -2369.953370014333, -2322.8496879480367, -2438.9867389253645, -2340.0145380970675, -2426.0061915964175], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 180.8833341767422, "mean_raw_obs_processing_ms": 18.015775645265467, "mean_inference_ms": 17.8892380357253, "mean_action_processing_ms": 0.10823876764090735}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 352000, "timers": {"sample_time_ms": 432643.032, "sample_throughput": 9.245, "learn_time_ms": 24663.322, "learn_throughput": 162.184, "update_time_ms": 3.678}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05046247021527961, "policy_loss": -0.007391416380414739, "vf_loss": 1104.879644393921, "vf_explained_var": 0.7634397745132446, "kl": 0.00950582891528029, "entropy": 55.070430636405945, "entropy_coeff": 0.001}}, "num_steps_sampled": 352000, "num_steps_trained": 352000}, "done": false, "episodes_total": 352, "training_iteration": 88, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_22-52-40", "timestamp": 1618066360, "time_this_iter_s": 459.1354820728302, "time_total_s": 43615.51971960068, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 24376.83305478096, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 25.685954198473286, "ram_util_percent": 82.57603053435115}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2305.2122191902163, "episode_reward_min": -2685.9646837808577, "episode_reward_mean": -2457.43571138603, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2478.953939730812, -2319.4262759240105, -2319.5241401128446, -2353.391461378923, -2528.572537690816, -2545.793620665409, -2507.3543125475007, -2563.2527982530364, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418, -2529.7949907798848, -2593.4524220424014, -2495.9865957267234, -2480.611139213084, -2622.341833501327, -2652.1814513614922, -2432.233243254026, -2531.289889567548, -2473.0977646427973, -2535.4959919378975, -2559.9370980000635, -2457.1157706556614, -2523.3222158665976, -2522.685673090176, -2446.4899098709866, -2555.6565108590376, -2510.673000465015, -2511.577049427904, -2407.881807413378, -2380.985792588075, -2470.257187822342, -2423.3731840433693, -2469.0691400010364, -2461.196827156067, -2414.9750409323815, -2463.010285069388, -2442.6747122672596, -2422.036876566856, -2388.0396322123133, -2432.4589640355634, -2528.9481168883103, -2448.587777516334, -2378.8211380460034, -2423.7021581597664, -2545.440608436416, -2483.3153883324403, -2363.3293781686702, -2359.766277178773, -2506.94906299147, -2463.0004197585877, -2436.5987670277086, -2403.4149267544194, -2385.022180228617, -2431.704427285287, -2481.437928404916, -2468.99410632492, -2394.74959547923, -2477.7503473806037, -2438.072783305417, -2408.6683755390486, -2528.9642926872575, -2398.8840899290653, -2313.992087744758, -2383.218597726837, -2356.8705117191703, -2408.0008686239676, -2316.8831596885902, -2381.41965677147, -2357.4245071818314, -2305.2122191902163, -2342.248428589117, -2385.5058376841826, -2462.301767269676, -2329.773008442034, -2436.1881768968537, -2464.9689906888657, -2412.0994954041, -2369.953370014333, -2322.8496879480367, -2438.9867389253645, -2340.0145380970675, -2426.0061915964175, -2381.8731224816406, -2309.9406654647046, -2373.7762660811914, -2363.9364374585525], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 180.85559144213963, "mean_raw_obs_processing_ms": 18.0127408921569, "mean_inference_ms": 17.88838950264156, "mean_action_processing_ms": 0.10823411417373667}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 356000, "timers": {"sample_time_ms": 432876.324, "sample_throughput": 9.241, "learn_time_ms": 24653.382, "learn_throughput": 162.25, "update_time_ms": 3.616}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.055432444089092314, "policy_loss": -0.010238985443720594, "vf_loss": 833.5711812973022, "vf_explained_var": 0.812836229801178, "kl": 0.013158949906937778, "entropy": 54.84506177902222, "entropy_coeff": 0.001}}, "num_steps_sampled": 356000, "num_steps_trained": 356000}, "done": false, "episodes_total": 356, "training_iteration": 89, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_23-00-19", "timestamp": 1618066819, "time_this_iter_s": 459.15633034706116, "time_total_s": 44074.67604994774, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 24835.98938512802, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 25.779541984732823, "ram_util_percent": 82.53648854961831}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2305.2122191902163, "episode_reward_min": -2685.9646837808577, "episode_reward_mean": -2450.9008123676763, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2437.655258612289, -2383.174992745685, -2328.9985630256524, -2341.654552937711, -2479.845008770124, -2603.852179177814, -2496.3029201232584, -2654.455142420137, -2572.463146342878, -2569.689387113995, -2507.226062910115, -2601.6786125042395, -2496.2095622443558, -2448.525994963044, -2520.436253409262, -2685.9646837808577, -2518.6458309164173, -2517.339790617371, -2547.5353433944933, -2557.663655728418, -2529.7949907798848, -2593.4524220424014, -2495.9865957267234, -2480.611139213084, -2622.341833501327, -2652.1814513614922, -2432.233243254026, -2531.289889567548, -2473.0977646427973, -2535.4959919378975, -2559.9370980000635, -2457.1157706556614, -2523.3222158665976, -2522.685673090176, -2446.4899098709866, -2555.6565108590376, -2510.673000465015, -2511.577049427904, -2407.881807413378, -2380.985792588075, -2470.257187822342, -2423.3731840433693, -2469.0691400010364, -2461.196827156067, -2414.9750409323815, -2463.010285069388, -2442.6747122672596, -2422.036876566856, -2388.0396322123133, -2432.4589640355634, -2528.9481168883103, -2448.587777516334, -2378.8211380460034, -2423.7021581597664, -2545.440608436416, -2483.3153883324403, -2363.3293781686702, -2359.766277178773, -2506.94906299147, -2463.0004197585877, -2436.5987670277086, -2403.4149267544194, -2385.022180228617, -2431.704427285287, -2481.437928404916, -2468.99410632492, -2394.74959547923, -2477.7503473806037, -2438.072783305417, -2408.6683755390486, -2528.9642926872575, -2398.8840899290653, -2313.992087744758, -2383.218597726837, -2356.8705117191703, -2408.0008686239676, -2316.8831596885902, -2381.41965677147, -2357.4245071818314, -2305.2122191902163, -2342.248428589117, -2385.5058376841826, -2462.301767269676, -2329.773008442034, -2436.1881768968537, -2464.9689906888657, -2412.0994954041, -2369.953370014333, -2322.8496879480367, -2438.9867389253645, -2340.0145380970675, -2426.0061915964175, -2381.8731224816406, -2309.9406654647046, -2373.7762660811914, -2363.9364374585525, -2478.953939730812, -2319.4262759240105, -2319.5241401128446, -2353.391461378923], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 180.82468355568002, "mean_raw_obs_processing_ms": 18.009300024677778, "mean_inference_ms": 17.887418677796592, "mean_action_processing_ms": 0.10822921584523167}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 360000, "timers": {"sample_time_ms": 432971.236, "sample_throughput": 9.238, "learn_time_ms": 24650.125, "learn_throughput": 162.271, "update_time_ms": 3.619}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05001464392989874, "policy_loss": -0.005584588565398008, "vf_loss": 950.5649681091309, "vf_explained_var": 0.8099378347396851, "kl": 0.011218775194720365, "entropy": 55.05757999420166, "entropy_coeff": 0.001}}, "num_steps_sampled": 360000, "num_steps_trained": 360000}, "done": false, "episodes_total": 360, "training_iteration": 90, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-10_23-07-56", "timestamp": 1618067276, "time_this_iter_s": 456.68941736221313, "time_total_s": 44531.36546730995, "pid": 3474, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 25292.678802490234, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 25.755674846625762, "ram_util_percent": 82.46487730061351}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2356.5937468684706, "episode_reward_mean": -2304.23686148684, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331], "episode_lengths": [1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 210.27520547682855, "mean_raw_obs_processing_ms": 22.53241732024003, "mean_inference_ms": 20.822238648074798, "mean_action_processing_ms": 0.12128988186875801}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 344000, "timers": {"sample_time_ms": 509864.792, "sample_throughput": 7.845, "learn_time_ms": 31086.822, "learn_throughput": 128.672, "update_time_ms": 30.729}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05690411519026384, "policy_loss": -0.010095283098053187, "vf_loss": 688.6862363815308, "vf_explained_var": 0.8402681350708008, "kl": 0.007578607212053612, "entropy": 55.21141016483307, "entropy_coeff": 0.001}}, "num_steps_sampled": 344000, "num_steps_trained": 344000}, "done": false, "episodes_total": 344, "training_iteration": 86, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_08-08-59", "timestamp": 1618099739, "time_this_iter_s": 541.1945173740387, "time_total_s": 42780.520532131195, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 541.1945173740387, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 39.806985769728335, "ram_util_percent": 78.97335058214748}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2473.125090579776, "episode_reward_mean": -2370.670146313804, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 210.35199341028422, "mean_raw_obs_processing_ms": 21.858120858204604, "mean_inference_ms": 20.809471121586057, "mean_action_processing_ms": 0.12124680523404352}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 348000, "timers": {"sample_time_ms": 507156.916, "sample_throughput": 7.887, "learn_time_ms": 30200.154, "learn_throughput": 132.45, "update_time_ms": 17.14}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06177106552058831, "policy_loss": -0.017147328006103635, "vf_loss": 847.9633359909058, "vf_explained_var": 0.8126212358474731, "kl": 0.008854233790771104, "entropy": 54.874213457107544, "entropy_coeff": 0.001}}, "num_steps_sampled": 348000, "num_steps_trained": 348000}, "done": false, "episodes_total": 348, "training_iteration": 87, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_08-17-53", "timestamp": 1618100273, "time_this_iter_s": 533.7728936672211, "time_total_s": 43314.293425798416, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1074.9674110412598, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 40.07936925098554, "ram_util_percent": 83.56780551905388}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2473.125090579776, "episode_reward_mean": -2384.460246213263, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 210.44941251014893, "mean_raw_obs_processing_ms": 21.52236913452224, "mean_inference_ms": 20.818028888811533, "mean_action_processing_ms": 0.12122312882373655}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 352000, "timers": {"sample_time_ms": 506893.481, "sample_throughput": 7.891, "learn_time_ms": 29893.674, "learn_throughput": 133.808, "update_time_ms": 12.568}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05145553589682095, "policy_loss": -0.006206400750670582, "vf_loss": 802.273937702179, "vf_explained_var": 0.8343568444252014, "kl": 0.00794658406812232, "entropy": 54.86118817329407, "entropy_coeff": 0.001}}, "num_steps_sampled": 352000, "num_steps_trained": 352000}, "done": false, "episodes_total": 352, "training_iteration": 88, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_08-26-49", "timestamp": 1618100809, "time_this_iter_s": 535.6598801612854, "time_total_s": 43849.9533059597, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1610.6272912025452, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 40.073725490196075, "ram_util_percent": 84.2637908496732}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2473.125090579776, "episode_reward_mean": -2385.598024776091, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 210.50163677368153, "mean_raw_obs_processing_ms": 21.290445986952392, "mean_inference_ms": 20.819141133642002, "mean_action_processing_ms": 0.12121110002685734}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 356000, "timers": {"sample_time_ms": 506333.394, "sample_throughput": 7.9, "learn_time_ms": 29711.373, "learn_throughput": 134.629, "update_time_ms": 10.269}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.04877182835480198, "policy_loss": -0.003263614111347124, "vf_loss": 820.7889976501465, "vf_explained_var": 0.8246806859970093, "kl": 0.006410573230823502, "entropy": 54.99821734428406, "entropy_coeff": 0.001}}, "num_steps_sampled": 356000, "num_steps_trained": 356000}, "done": false, "episodes_total": 356, "training_iteration": 89, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_08-35-43", "timestamp": 1618101343, "time_this_iter_s": 533.8276352882385, "time_total_s": 44383.78094124794, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2144.4549264907837, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 40.05795006570302, "ram_util_percent": 84.26320630749015}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2513.201940286156, "episode_reward_mean": -2397.8470079886656, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 210.545694938813, "mean_raw_obs_processing_ms": 21.118715274074788, "mean_inference_ms": 20.82117160295013, "mean_action_processing_ms": 0.12121766344850202}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 360000, "timers": {"sample_time_ms": 506535.804, "sample_throughput": 7.897, "learn_time_ms": 29613.825, "learn_throughput": 135.072, "update_time_ms": 12.279}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.04562682972755283, "policy_loss": -0.0027794280322268605, "vf_loss": 1004.4874773025513, "vf_explained_var": 0.7840760946273804, "kl": 0.00901999679626897, "entropy": 54.696274399757385, "entropy_coeff": 0.001}}, "num_steps_sampled": 360000, "num_steps_trained": 360000}, "done": false, "episodes_total": 360, "training_iteration": 90, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_08-44-39", "timestamp": 1618101879, "time_this_iter_s": 536.5963850021362, "time_total_s": 44920.377326250076, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2681.05131149292, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 39.995169712793725, "ram_util_percent": 84.35456919060051}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2513.201940286156, "episode_reward_mean": -2402.446843627156, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 210.57533077040648, "mean_raw_obs_processing_ms": 20.99569348847679, "mean_inference_ms": 20.821548798086386, "mean_action_processing_ms": 0.1212203381767536}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 364000, "timers": {"sample_time_ms": 506576.984, "sample_throughput": 7.896, "learn_time_ms": 29497.919, "learn_throughput": 135.603, "update_time_ms": 10.801}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.056917476089438424, "policy_loss": -0.012961794855073094, "vf_loss": 931.2272319793701, "vf_explained_var": 0.8223985433578491, "kl": 0.007286267515155487, "entropy": 54.725202202796936, "entropy_coeff": 0.001}}, "num_steps_sampled": 364000, "num_steps_trained": 364000}, "done": false, "episodes_total": 364, "training_iteration": 91, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_08-53-35", "timestamp": 1618102415, "time_this_iter_s": 535.7127614021301, "time_total_s": 45456.09008765221, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3216.76407289505, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 40.04209150326797, "ram_util_percent": 84.61581699346405}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2513.201940286156, "episode_reward_mean": -2402.5010985916556, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 211.82035078403547, "mean_raw_obs_processing_ms": 21.151230002792975, "mean_inference_ms": 20.8994121100429, "mean_action_processing_ms": 0.12183808105068335}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 368000, "timers": {"sample_time_ms": 528192.414, "sample_throughput": 7.573, "learn_time_ms": 31890.853, "learn_throughput": 125.428, "update_time_ms": 9.867}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05560574756236747, "policy_loss": -0.009554648568155244, "vf_loss": 688.8584566116333, "vf_explained_var": 0.854479193687439, "kl": 0.00889472957351245, "entropy": 54.71862840652466, "entropy_coeff": 0.001}}, "num_steps_sampled": 368000, "num_steps_trained": 368000}, "done": false, "episodes_total": 368, "training_iteration": 92, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_09-05-20", "timestamp": 1618103120, "time_this_iter_s": 704.264181137085, "time_total_s": 46160.35426878929, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3921.028254032135, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 51.92061752988048, "ram_util_percent": 88.48416334661356}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2513.201940286156, "episode_reward_mean": -2400.859089220642, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 215.12861816102566, "mean_raw_obs_processing_ms": 21.45516967423154, "mean_inference_ms": 21.153453023402747, "mean_action_processing_ms": 0.12385571515605209}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 372000, "timers": {"sample_time_ms": 572317.257, "sample_throughput": 6.989, "learn_time_ms": 33328.213, "learn_throughput": 120.018, "update_time_ms": 9.194}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05704107275232673, "policy_loss": -0.015218586078844965, "vf_loss": 1094.86563205719, "vf_explained_var": 0.7822654247283936, "kl": 0.01106261029781308, "entropy": 54.983659863471985, "entropy_coeff": 0.001}}, "num_steps_sampled": 372000, "num_steps_trained": 372000}, "done": false, "episodes_total": 372, "training_iteration": 93, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_09-20-45", "timestamp": 1618104045, "time_this_iter_s": 924.6235847473145, "time_total_s": 47084.977853536606, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4845.6518387794495, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 63.72693474962064, "ram_util_percent": 88.28573596358117}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2513.201940286156, "episode_reward_mean": -2396.4374127688748, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 218.2086680439847, "mean_raw_obs_processing_ms": 21.690760867993916, "mean_inference_ms": 21.403727217447916, "mean_action_processing_ms": 0.12589372775488586}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 376000, "timers": {"sample_time_ms": 582333.901, "sample_throughput": 6.869, "learn_time_ms": 32904.118, "learn_throughput": 121.565, "update_time_ms": 8.576}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06357049933285452, "policy_loss": -0.019927472225390375, "vf_loss": 805.1237773895264, "vf_explained_var": 0.8257824778556824, "kl": 0.01658482541097328, "entropy": 55.011228799819946, "entropy_coeff": 0.001}}, "num_steps_sampled": 376000, "num_steps_trained": 376000}, "done": false, "episodes_total": 376, "training_iteration": 94, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_09-32-17", "timestamp": 1618104737, "time_this_iter_s": 691.9894866943359, "time_total_s": 47776.96734023094, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5537.641325473785, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 52.40364372469636, "ram_util_percent": 85.37914979757086}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2513.201940286156, "episode_reward_mean": -2390.8469149473713, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 221.69023195471368, "mean_raw_obs_processing_ms": 21.99766081564285, "mean_inference_ms": 21.68005922973846, "mean_action_processing_ms": 0.12806665323476193}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 380000, "timers": {"sample_time_ms": 606521.768, "sample_throughput": 6.595, "learn_time_ms": 34299.17, "learn_throughput": 116.621, "update_time_ms": 8.454}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.053266216040356085, "policy_loss": -0.006704719096887857, "vf_loss": 704.8389277458191, "vf_explained_var": 0.8548011779785156, "kl": 0.009714715357404202, "entropy": 55.55282366275787, "entropy_coeff": 0.001}}, "num_steps_sampled": 380000, "num_steps_trained": 380000}, "done": false, "episodes_total": 380, "training_iteration": 95, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_09-46-48", "timestamp": 1618105608, "time_this_iter_s": 871.1035618782043, "time_total_s": 48648.070902109146, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6408.74488735199, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 64.14911433172303, "ram_util_percent": 85.91658615136876}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2513.201940286156, "episode_reward_mean": -2384.5924552157517, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 225.2878965334197, "mean_raw_obs_processing_ms": 22.300066814290943, "mean_inference_ms": 21.970046908339132, "mean_action_processing_ms": 0.13037519764686897}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 384000, "timers": {"sample_time_ms": 637114.276, "sample_throughput": 6.278, "learn_time_ms": 35622.376, "learn_throughput": 112.289, "update_time_ms": 5.945}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.061940052546560764, "policy_loss": -0.01900546738761477, "vf_loss": 1070.522605895996, "vf_explained_var": 0.7771456837654114, "kl": 0.010420496808364987, "entropy": 55.723907113075256, "entropy_coeff": 0.001}}, "num_steps_sampled": 384000, "num_steps_trained": 384000}, "done": false, "episodes_total": 384, "training_iteration": 96, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_10-01-09", "timestamp": 1618106469, "time_this_iter_s": 860.148952960968, "time_total_s": 49508.219855070114, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7268.893840312958, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 61.96161369193153, "ram_util_percent": 86.42860635696822}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2513.201940286156, "episode_reward_mean": -2377.8316718350957, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 228.74447612654672, "mean_raw_obs_processing_ms": 22.589779255746254, "mean_inference_ms": 22.25531510733406, "mean_action_processing_ms": 0.13265685162363802}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 388000, "timers": {"sample_time_ms": 664745.99, "sample_throughput": 6.017, "learn_time_ms": 36970.023, "learn_throughput": 108.196, "update_time_ms": 6.173}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05538306519156322, "policy_loss": -0.011826349247712642, "vf_loss": 1073.4747104644775, "vf_explained_var": 0.7666704654693604, "kl": 0.007487269584089518, "entropy": 55.7889164686203, "entropy_coeff": 0.001}}, "num_steps_sampled": 388000, "num_steps_trained": 388000}, "done": false, "episodes_total": 388, "training_iteration": 97, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_10-14-52", "timestamp": 1618107292, "time_this_iter_s": 823.6002397537231, "time_total_s": 50331.82009482384, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8092.494080066681, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 60.56609880749575, "ram_util_percent": 86.15144804088587}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2513.201940286156, "episode_reward_mean": -2376.359562969435, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 232.61092870588885, "mean_raw_obs_processing_ms": 22.887405241455756, "mean_inference_ms": 22.563885133481815, "mean_action_processing_ms": 0.13504347112938822}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 392000, "timers": {"sample_time_ms": 713971.365, "sample_throughput": 5.602, "learn_time_ms": 39083.643, "learn_throughput": 102.345, "update_time_ms": 6.605}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.053922008897643536, "policy_loss": -0.009186679613776505, "vf_loss": 919.2773962020874, "vf_explained_var": 0.8322780728340149, "kl": 0.009529013535939157, "entropy": 55.83390247821808, "entropy_coeff": 0.001}}, "num_steps_sampled": 392000, "num_steps_trained": 392000}, "done": false, "episodes_total": 392, "training_iteration": 98, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_10-32-22", "timestamp": 1618108342, "time_this_iter_s": 1049.0666325092316, "time_total_s": 51380.88672733307, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9141.560712575912, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 72.79959893048128, "ram_util_percent": 86.8802807486631}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2513.201940286156, "episode_reward_mean": -2375.214245016887, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 236.09903978478658, "mean_raw_obs_processing_ms": 23.14765384197528, "mean_inference_ms": 22.851707379987737, "mean_action_processing_ms": 0.1372515300833724}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 396000, "timers": {"sample_time_ms": 738210.017, "sample_throughput": 5.419, "learn_time_ms": 39119.391, "learn_throughput": 102.251, "update_time_ms": 6.657}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.04829990764847025, "policy_loss": -0.002218330802861601, "vf_loss": 769.7463302612305, "vf_explained_var": 0.835121214389801, "kl": 0.008995190990390256, "entropy": 55.57807791233063, "entropy_coeff": 0.001}}, "num_steps_sampled": 396000, "num_steps_trained": 396000}, "done": false, "episodes_total": 396, "training_iteration": 99, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_10-45-18", "timestamp": 1618109118, "time_this_iter_s": 776.5867395401001, "time_total_s": 52157.47346687317, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9918.147452116013, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 60.474074074074075, "ram_util_percent": 84.34444444444445}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2513.201940286156, "episode_reward_mean": -2372.839756740919, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 238.80933372837046, "mean_raw_obs_processing_ms": 23.347993050922227, "mean_inference_ms": 23.075716529292176, "mean_action_processing_ms": 0.13896742389322608}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 400000, "timers": {"sample_time_ms": 738265.798, "sample_throughput": 5.418, "learn_time_ms": 39133.834, "learn_throughput": 102.213, "update_time_ms": 5.041}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05021873678197153, "policy_loss": -0.00678391702240333, "vf_loss": 1077.6371564865112, "vf_explained_var": 0.7586516737937927, "kl": 0.007774028563289903, "entropy": 55.76599395275116, "entropy_coeff": 0.001}}, "num_steps_sampled": 400000, "num_steps_trained": 400000}, "done": false, "episodes_total": 400, "training_iteration": 100, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_10-54-16", "timestamp": 1618109656, "time_this_iter_s": 537.2944271564484, "time_total_s": 52694.76789402962, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10455.441879272461, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 39.96023468057366, "ram_util_percent": 76.71056062581486}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2513.201940286156, "episode_reward_mean": -2374.183564412324, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 240.92522839876057, "mean_raw_obs_processing_ms": 23.501982011698964, "mean_inference_ms": 23.250889232285967, "mean_action_processing_ms": 0.14030624194827168}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 404000, "timers": {"sample_time_ms": 738372.011, "sample_throughput": 5.417, "learn_time_ms": 39180.879, "learn_throughput": 102.091, "update_time_ms": 5.039}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05478915001731366, "policy_loss": -0.006327231676550582, "vf_loss": 499.4695301055908, "vf_explained_var": 0.890649676322937, "kl": 0.010198348871199414, "entropy": 55.496278524398804, "entropy_coeff": 0.001}}, "num_steps_sampled": 404000, "num_steps_trained": 404000}, "done": false, "episodes_total": 404, "training_iteration": 101, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_11-03-13", "timestamp": 1618110193, "time_this_iter_s": 537.2440061569214, "time_total_s": 53232.01190018654, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10992.685885429382, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 40.00104302477184, "ram_util_percent": 78.22607561929595}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2513.201940286156, "episode_reward_mean": -2372.075132622728, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 242.58122189124765, "mean_raw_obs_processing_ms": 23.61874905445318, "mean_inference_ms": 23.38800792266578, "mean_action_processing_ms": 0.14135126395800893}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 408000, "timers": {"sample_time_ms": 723478.167, "sample_throughput": 5.529, "learn_time_ms": 37438.891, "learn_throughput": 106.841, "update_time_ms": 4.957}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05495691782562062, "policy_loss": -0.00884624884929508, "vf_loss": 689.1988048553467, "vf_explained_var": 0.8449588418006897, "kl": 0.010842463292647153, "entropy": 55.17114877700806, "entropy_coeff": 0.001}}, "num_steps_sampled": 408000, "num_steps_trained": 408000}, "done": false, "episodes_total": 408, "training_iteration": 102, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_11-12-11", "timestamp": 1618110731, "time_this_iter_s": 537.8004925251007, "time_total_s": 53769.81239271164, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11530.486377954483, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 39.99595827900913, "ram_util_percent": 78.40208604954368}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2513.201940286156, "episode_reward_mean": -2373.0951211101897, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2440.7932941106205, -2402.7465099641167, -2329.243960598445, -2388.9559369149883, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 243.87323856308387, "mean_raw_obs_processing_ms": 23.70517266977145, "mean_inference_ms": 23.495072096378877, "mean_action_processing_ms": 0.14216696046133595}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 412000, "timers": {"sample_time_ms": 685919.465, "sample_throughput": 5.832, "learn_time_ms": 36011.149, "learn_throughput": 111.077, "update_time_ms": 4.912}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05054625135380775, "policy_loss": -0.004511873645242304, "vf_loss": 736.9123611450195, "vf_explained_var": 0.8458263874053955, "kl": 0.009404819182236679, "entropy": 55.28446388244629, "entropy_coeff": 0.001}}, "num_steps_sampled": 412000, "num_steps_trained": 412000}, "done": false, "episodes_total": 412, "training_iteration": 103, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_11-21-05", "timestamp": 1618111265, "time_this_iter_s": 534.7272388935089, "time_total_s": 54304.53963160515, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12065.213616847992, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 40.080733944954126, "ram_util_percent": 79.09069462647444}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2513.201940286156, "episode_reward_mean": -2374.022243456979, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2365.961951712187, -2424.767198784174, -2376.7075188179065, -2395.405113482473, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113, -2440.7932941106205, -2402.7465099641167, -2329.243960598445, -2388.9559369149883], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 244.87673421789327, "mean_raw_obs_processing_ms": 23.768747201850548, "mean_inference_ms": 23.578433629449925, "mean_action_processing_ms": 0.14280032242153248}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 416000, "timers": {"sample_time_ms": 670270.72, "sample_throughput": 5.968, "learn_time_ms": 36001.478, "learn_throughput": 111.107, "update_time_ms": 4.932}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05363136256346479, "policy_loss": -0.008519785013049841, "vf_loss": 810.3124303817749, "vf_explained_var": 0.8394711017608643, "kl": 0.00950778799597174, "entropy": 55.11625576019287, "entropy_coeff": 0.001}}, "num_steps_sampled": 416000, "num_steps_trained": 416000}, "done": false, "episodes_total": 416, "training_iteration": 104, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_11-30-01", "timestamp": 1618111801, "time_this_iter_s": 535.4243078231812, "time_total_s": 54839.96393942833, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 12600.637924671173, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 40.02434554973822, "ram_util_percent": 78.9887434554974}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2513.201940286156, "episode_reward_mean": -2371.674467619248, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2356.145123349575, -2276.8752325122796, -2254.1804784684387, -2421.06607247913, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113, -2440.7932941106205, -2402.7465099641167, -2329.243960598445, -2388.9559369149883, -2365.961951712187, -2424.767198784174, -2376.7075188179065, -2395.405113482473], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 245.88671882213356, "mean_raw_obs_processing_ms": 23.852649764660434, "mean_inference_ms": 23.66017991950074, "mean_action_processing_ms": 0.14341769219907752}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 420000, "timers": {"sample_time_ms": 661799.355, "sample_throughput": 6.044, "learn_time_ms": 35928.288, "learn_throughput": 111.333, "update_time_ms": 9.528}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.055851602606708184, "policy_loss": -0.011111012368928641, "vf_loss": 833.6555552482605, "vf_explained_var": 0.8162197470664978, "kl": 0.009632437460822985, "entropy": 55.0036301612854, "entropy_coeff": 0.001}}, "num_steps_sampled": 420000, "num_steps_trained": 420000}, "done": false, "episodes_total": 420, "training_iteration": 105, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_11-43-07", "timestamp": 1618112587, "time_this_iter_s": 785.8655376434326, "time_total_s": 55625.82947707176, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 13386.503462314606, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 60.35691347011597, "ram_util_percent": 85.20178412132026}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2513.201940286156, "episode_reward_mean": -2372.0386983129047, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2403.06974794096, -2371.9800703600745, -2355.2073600817503, -2387.036070361375, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113, -2440.7932941106205, -2402.7465099641167, -2329.243960598445, -2388.9559369149883, -2365.961951712187, -2424.767198784174, -2376.7075188179065, -2395.405113482473, -2356.145123349575, -2276.8752325122796, -2254.1804784684387, -2421.06607247913], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 247.03174482361368, "mean_raw_obs_processing_ms": 23.946490859830732, "mean_inference_ms": 23.75211251912004, "mean_action_processing_ms": 0.1441161700095039}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 424000, "timers": {"sample_time_ms": 667079.821, "sample_throughput": 5.996, "learn_time_ms": 36069.182, "learn_throughput": 110.898, "update_time_ms": 9.514}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.07140342239290476, "policy_loss": -0.026462401059689, "vf_loss": 698.3863534927368, "vf_explained_var": 0.8513440489768982, "kl": 0.014853250002488494, "entropy": 54.895530223846436, "entropy_coeff": 0.001}}, "num_steps_sampled": 424000, "num_steps_trained": 424000}, "done": false, "episodes_total": 424, "training_iteration": 106, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_11-58-21", "timestamp": 1618113501, "time_this_iter_s": 914.3505549430847, "time_total_s": 56540.18003201485, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 14300.85401725769, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 65.78918711656442, "ram_util_percent": 86.3433282208589}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2513.201940286156, "episode_reward_mean": -2373.8941085824135, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2418.8109494202545, -2434.63167599695, -2458.9931970569737, -2338.995074494234, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113, -2440.7932941106205, -2402.7465099641167, -2329.243960598445, -2388.9559369149883, -2365.961951712187, -2424.767198784174, -2376.7075188179065, -2395.405113482473, -2356.145123349575, -2276.8752325122796, -2254.1804784684387, -2421.06607247913, -2403.06974794096, -2371.9800703600745, -2355.2073600817503, -2387.036070361375], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 248.13265707869698, "mean_raw_obs_processing_ms": 24.0195058503434, "mean_inference_ms": 23.840581141793553, "mean_action_processing_ms": 0.14478543916970485}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 428000, "timers": {"sample_time_ms": 658582.412, "sample_throughput": 6.074, "learn_time_ms": 34721.902, "learn_throughput": 115.201, "update_time_ms": 9.279}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.04586641807691194, "policy_loss": -0.004999194177798927, "vf_loss": 1251.8691730499268, "vf_explained_var": 0.7917928099632263, "kl": 0.007905191072495654, "entropy": 54.9669531583786, "entropy_coeff": 0.001}}, "num_steps_sampled": 428000, "num_steps_trained": 428000}, "done": false, "episodes_total": 428, "training_iteration": 107, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_12-10-27", "timestamp": 1618114227, "time_this_iter_s": 725.1476485729218, "time_total_s": 57265.32768058777, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 15026.001665830612, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 56.16054158607349, "ram_util_percent": 82.91972920696325}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2513.201940286156, "episode_reward_mean": -2375.500610725496, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2434.5140520144455, -2437.657641449069, -2376.0700105925603, -2395.132927437134, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113, -2440.7932941106205, -2402.7465099641167, -2329.243960598445, -2388.9559369149883, -2365.961951712187, -2424.767198784174, -2376.7075188179065, -2395.405113482473, -2356.145123349575, -2276.8752325122796, -2254.1804784684387, -2421.06607247913, -2403.06974794096, -2371.9800703600745, -2355.2073600817503, -2387.036070361375, -2418.8109494202545, -2434.63167599695, -2458.9931970569737, -2338.995074494234], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 249.0222898329422, "mean_raw_obs_processing_ms": 24.076044813862342, "mean_inference_ms": 23.911969003950833, "mean_action_processing_ms": 0.14532582295789134}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 432000, "timers": {"sample_time_ms": 609136.645, "sample_throughput": 6.567, "learn_time_ms": 32590.485, "learn_throughput": 122.735, "update_time_ms": 8.851}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05395828458131291, "policy_loss": -0.00969327738857828, "vf_loss": 826.9422769546509, "vf_explained_var": 0.8422597646713257, "kl": 0.0117984848911874, "entropy": 54.89412248134613, "entropy_coeff": 0.001}}, "num_steps_sampled": 432000, "num_steps_trained": 432000}, "done": false, "episodes_total": 432, "training_iteration": 108, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_12-19-20", "timestamp": 1618114760, "time_this_iter_s": 533.2755153179169, "time_total_s": 57798.603195905685, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 15559.277181148529, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 40.026281208935615, "ram_util_percent": 79.59237844940867}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2513.201940286156, "episode_reward_mean": -2377.253368921167, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2408.8098421951668, -2468.8670208897797, -2453.248252673887, -2339.342113927541, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113, -2440.7932941106205, -2402.7465099641167, -2329.243960598445, -2388.9559369149883, -2365.961951712187, -2424.767198784174, -2376.7075188179065, -2395.405113482473, -2356.145123349575, -2276.8752325122796, -2254.1804784684387, -2421.06607247913, -2403.06974794096, -2371.9800703600745, -2355.2073600817503, -2387.036070361375, -2418.8109494202545, -2434.63167599695, -2458.9931970569737, -2338.995074494234, -2434.5140520144455, -2437.657641449069, -2376.0700105925603, -2395.132927437134], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 249.73650013074038, "mean_raw_obs_processing_ms": 24.118502578229652, "mean_inference_ms": 23.96937059837194, "mean_action_processing_ms": 0.14575909847096716}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 436000, "timers": {"sample_time_ms": 585018.266, "sample_throughput": 6.837, "learn_time_ms": 32537.691, "learn_throughput": 122.934, "update_time_ms": 8.899}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.055060061742551625, "policy_loss": -0.014217380725312978, "vf_loss": 1220.0045585632324, "vf_explained_var": 0.7588559985160828, "kl": 0.010092858123243786, "entropy": 55.06129503250122, "entropy_coeff": 0.001}}, "num_steps_sampled": 436000, "num_steps_trained": 436000}, "done": false, "episodes_total": 436, "training_iteration": 109, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_12-28-15", "timestamp": 1618115295, "time_this_iter_s": 534.8617925643921, "time_total_s": 58333.46498847008, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16094.138973712921, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 40.034993446920055, "ram_util_percent": 80.22319790301442}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2183.9909477229994, "episode_reward_min": -2516.793892429438, "episode_reward_mean": -2379.2669946259916, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2354.5916039543004, -2516.793892429438, -2444.992134155023, -2393.998415628431, -2356.5937468684706, -2183.9909477229994, -2341.703932819559, -2334.658818536331, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113, -2440.7932941106205, -2402.7465099641167, -2329.243960598445, -2388.9559369149883, -2365.961951712187, -2424.767198784174, -2376.7075188179065, -2395.405113482473, -2356.145123349575, -2276.8752325122796, -2254.1804784684387, -2421.06607247913, -2403.06974794096, -2371.9800703600745, -2355.2073600817503, -2387.036070361375, -2418.8109494202545, -2434.63167599695, -2458.9931970569737, -2338.995074494234, -2434.5140520144455, -2437.657641449069, -2376.0700105925603, -2395.132927437134, -2408.8098421951668, -2468.8670208897797, -2453.248252673887, -2339.342113927541], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 250.30547997905248, "mean_raw_obs_processing_ms": 24.1510070607721, "mean_inference_ms": 24.0149753092867, "mean_action_processing_ms": 0.14610210950441785}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 440000, "timers": {"sample_time_ms": 585043.742, "sample_throughput": 6.837, "learn_time_ms": 32534.204, "learn_throughput": 122.948, "update_time_ms": 8.835}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05448316043475643, "policy_loss": -0.008705471322173253, "vf_loss": 736.6292848587036, "vf_explained_var": 0.8504513502120972, "kl": 0.010044404509244487, "entropy": 55.15286159515381, "entropy_coeff": 0.001}}, "num_steps_sampled": 440000, "num_steps_trained": 440000}, "done": false, "episodes_total": 440, "training_iteration": 110, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_12-37-12", "timestamp": 1618115832, "time_this_iter_s": 537.5181977748871, "time_total_s": 58870.983186244965, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 16631.65717148781, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 39.95332464146023, "ram_util_percent": 80.12764015645372}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2254.1804784684387, "episode_reward_min": -2516.793892429438, "episode_reward_mean": -2381.9253166030276, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2391.6607110855434, -2457.135495498463, -2313.586424383731, -2320.3970126831828, -2401.1138904637164, -2473.125090579776, -2421.5650517674208, -2452.6096917521577, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113, -2440.7932941106205, -2402.7465099641167, -2329.243960598445, -2388.9559369149883, -2365.961951712187, -2424.767198784174, -2376.7075188179065, -2395.405113482473, -2356.145123349575, -2276.8752325122796, -2254.1804784684387, -2421.06607247913, -2403.06974794096, -2371.9800703600745, -2355.2073600817503, -2387.036070361375, -2418.8109494202545, -2434.63167599695, -2458.9931970569737, -2338.995074494234, -2434.5140520144455, -2437.657641449069, -2376.0700105925603, -2395.132927437134, -2408.8098421951668, -2468.8670208897797, -2453.248252673887, -2339.342113927541, -2354.5916039543004, -2516.793892429438, -2444.992134155023, -2393.998415628431], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 252.37039413469043, "mean_raw_obs_processing_ms": 24.240544788511578, "mean_inference_ms": 24.17972230077383, "mean_action_processing_ms": 0.1473726524634535}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 444000, "timers": {"sample_time_ms": 584993.082, "sample_throughput": 6.838, "learn_time_ms": 32512.487, "learn_throughput": 123.03, "update_time_ms": 8.849}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.056047317397315055, "policy_loss": -0.010930524149443954, "vf_loss": 759.5470333099365, "vf_explained_var": 0.8298718929290771, "kl": 0.013515505008399487, "entropy": 55.415361762046814, "entropy_coeff": 0.001}}, "num_steps_sampled": 444000, "num_steps_trained": 444000}, "done": false, "episodes_total": 444, "training_iteration": 111, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_12-46-09", "timestamp": 1618116369, "time_this_iter_s": 536.5207595825195, "time_total_s": 59407.503945827484, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 17168.177931070328, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 39.92483660130719, "ram_util_percent": 81.36614379084968}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2254.1804784684387, "episode_reward_min": -2516.793892429438, "episode_reward_mean": -2379.374469992139, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2353.0642588638298, -2302.4560267215134, -2387.8027647010485, -2450.0060131878377, -2437.817770761931, -2414.7677616823635, -2426.028214110547, -2369.5480374938816, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113, -2440.7932941106205, -2402.7465099641167, -2329.243960598445, -2388.9559369149883, -2365.961951712187, -2424.767198784174, -2376.7075188179065, -2395.405113482473, -2356.145123349575, -2276.8752325122796, -2254.1804784684387, -2421.06607247913, -2403.06974794096, -2371.9800703600745, -2355.2073600817503, -2387.036070361375, -2418.8109494202545, -2434.63167599695, -2458.9931970569737, -2338.995074494234, -2434.5140520144455, -2437.657641449069, -2376.0700105925603, -2395.132927437134, -2408.8098421951668, -2468.8670208897797, -2453.248252673887, -2339.342113927541, -2354.5916039543004, -2516.793892429438, -2444.992134155023, -2393.998415628431, -2391.6607110855434, -2457.135495498463, -2313.586424383731, -2320.3970126831828], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 254.3529959921175, "mean_raw_obs_processing_ms": 24.37820268245468, "mean_inference_ms": 24.339448060377837, "mean_action_processing_ms": 0.1485994815637605}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 448000, "timers": {"sample_time_ms": 584702.924, "sample_throughput": 6.841, "learn_time_ms": 32535.02, "learn_throughput": 122.944, "update_time_ms": 8.857}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05342417475185357, "policy_loss": -0.008354905468877405, "vf_loss": 662.9532341957092, "vf_explained_var": 0.8611516952514648, "kl": 0.016775143187260255, "entropy": 55.05382549762726, "entropy_coeff": 0.001}}, "num_steps_sampled": 448000, "num_steps_trained": 448000}, "done": false, "episodes_total": 448, "training_iteration": 112, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_12-55-04", "timestamp": 1618116904, "time_this_iter_s": 535.1205327510834, "time_total_s": 59942.62447857857, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 17703.29846382141, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 39.98887434554974, "ram_util_percent": 81.20994764397905}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2254.1804784684387, "episode_reward_min": -2516.793892429438, "episode_reward_mean": -2378.222942521488, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2395.6503879184656, -2377.6304251481565, -2366.611808634805, -2393.1164152822007, -2377.855266387255, -2426.977939587511, -2355.8508558608983, -2395.3613800226326, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113, -2440.7932941106205, -2402.7465099641167, -2329.243960598445, -2388.9559369149883, -2365.961951712187, -2424.767198784174, -2376.7075188179065, -2395.405113482473, -2356.145123349575, -2276.8752325122796, -2254.1804784684387, -2421.06607247913, -2403.06974794096, -2371.9800703600745, -2355.2073600817503, -2387.036070361375, -2418.8109494202545, -2434.63167599695, -2458.9931970569737, -2338.995074494234, -2434.5140520144455, -2437.657641449069, -2376.0700105925603, -2395.132927437134, -2408.8098421951668, -2468.8670208897797, -2453.248252673887, -2339.342113927541, -2354.5916039543004, -2516.793892429438, -2444.992134155023, -2393.998415628431, -2391.6607110855434, -2457.135495498463, -2313.586424383731, -2320.3970126831828, -2353.0642588638298, -2302.4560267215134, -2387.8027647010485, -2450.0060131878377], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 256.3034686355181, "mean_raw_obs_processing_ms": 24.523209426155777, "mean_inference_ms": 24.495399176647975, "mean_action_processing_ms": 0.14981442849858487}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 452000, "timers": {"sample_time_ms": 591802.404, "sample_throughput": 6.759, "learn_time_ms": 32550.225, "learn_throughput": 122.887, "update_time_ms": 8.818}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.057205020857509226, "policy_loss": -0.012000101065495983, "vf_loss": 828.5443897247314, "vf_explained_var": 0.82539963722229, "kl": 0.008865171854267828, "entropy": 55.26339936256409, "entropy_coeff": 0.001}}, "num_steps_sampled": 452000, "num_steps_trained": 452000}, "done": false, "episodes_total": 452, "training_iteration": 113, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_13-05-10", "timestamp": 1618117510, "time_this_iter_s": 605.8767058849335, "time_total_s": 60548.5011844635, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 18309.175169706345, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 45.05034722222222, "ram_util_percent": 83.08414351851852}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2254.1804784684387, "episode_reward_min": -2516.793892429438, "episode_reward_mean": -2376.329783721581, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2268.137492066668, -2377.7269829341053, -2291.920265770661, -2428.9448210962014, -2434.4528814338837, -2391.483445597278, -2513.201940286156, -2448.2334960385538, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113, -2440.7932941106205, -2402.7465099641167, -2329.243960598445, -2388.9559369149883, -2365.961951712187, -2424.767198784174, -2376.7075188179065, -2395.405113482473, -2356.145123349575, -2276.8752325122796, -2254.1804784684387, -2421.06607247913, -2403.06974794096, -2371.9800703600745, -2355.2073600817503, -2387.036070361375, -2418.8109494202545, -2434.63167599695, -2458.9931970569737, -2338.995074494234, -2434.5140520144455, -2437.657641449069, -2376.0700105925603, -2395.132927437134, -2408.8098421951668, -2468.8670208897797, -2453.248252673887, -2339.342113927541, -2354.5916039543004, -2516.793892429438, -2444.992134155023, -2393.998415628431, -2391.6607110855434, -2457.135495498463, -2313.586424383731, -2320.3970126831828, -2353.0642588638298, -2302.4560267215134, -2387.8027647010485, -2450.0060131878377, -2395.6503879184656, -2377.6304251481565, -2366.611808634805, -2393.1164152822007], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 258.18775615155266, "mean_raw_obs_processing_ms": 24.67273154818668, "mean_inference_ms": 24.646502923705494, "mean_action_processing_ms": 0.1509870585983582}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 456000, "timers": {"sample_time_ms": 592082.313, "sample_throughput": 6.756, "learn_time_ms": 32515.494, "learn_throughput": 123.018, "update_time_ms": 8.875}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.060695227002725005, "policy_loss": -0.014842402946669608, "vf_loss": 738.5205707550049, "vf_explained_var": 0.8478132486343384, "kl": 0.010650175594491884, "entropy": 55.36806261539459, "entropy_coeff": 0.001}}, "num_steps_sampled": 456000, "num_steps_trained": 456000}, "done": false, "episodes_total": 456, "training_iteration": 114, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_13-14-08", "timestamp": 1618118048, "time_this_iter_s": 537.865850687027, "time_total_s": 61086.36703515053, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 18847.04102039337, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 40.01002604166667, "ram_util_percent": 82.23385416666667}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2254.1804784684387, "episode_reward_min": -2516.793892429438, "episode_reward_mean": -2372.4334281154247, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2329.922690710349, -2366.1827789356967, -2275.1999913456443, -2426.4307417485334, -2393.179884818481, -2431.1260166494617, -2449.7974081995358, -2427.6807776109426, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113, -2440.7932941106205, -2402.7465099641167, -2329.243960598445, -2388.9559369149883, -2365.961951712187, -2424.767198784174, -2376.7075188179065, -2395.405113482473, -2356.145123349575, -2276.8752325122796, -2254.1804784684387, -2421.06607247913, -2403.06974794096, -2371.9800703600745, -2355.2073600817503, -2387.036070361375, -2418.8109494202545, -2434.63167599695, -2458.9931970569737, -2338.995074494234, -2434.5140520144455, -2437.657641449069, -2376.0700105925603, -2395.132927437134, -2408.8098421951668, -2468.8670208897797, -2453.248252673887, -2339.342113927541, -2354.5916039543004, -2516.793892429438, -2444.992134155023, -2393.998415628431, -2391.6607110855434, -2457.135495498463, -2313.586424383731, -2320.3970126831828, -2353.0642588638298, -2302.4560267215134, -2387.8027647010485, -2450.0060131878377, -2395.6503879184656, -2377.6304251481565, -2366.611808634805, -2393.1164152822007, -2268.137492066668, -2377.7269829341053, -2291.920265770661, -2428.9448210962014], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 260.0068861356955, "mean_raw_obs_processing_ms": 24.8229725960185, "mean_inference_ms": 24.79229003173876, "mean_action_processing_ms": 0.15211811936853847}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 460000, "timers": {"sample_time_ms": 568665.957, "sample_throughput": 7.034, "learn_time_ms": 30821.7, "learn_throughput": 129.779, "update_time_ms": 3.986}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05329048749990761, "policy_loss": -0.00436811608960852, "vf_loss": 502.8496322631836, "vf_explained_var": 0.8912142515182495, "kl": 0.008982084531453438, "entropy": 55.74728071689606, "entropy_coeff": 0.001}}, "num_steps_sampled": 460000, "num_steps_trained": 460000}, "done": false, "episodes_total": 460, "training_iteration": 115, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_13-23-03", "timestamp": 1618118583, "time_this_iter_s": 534.5464904308319, "time_total_s": 61620.91352558136, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 19381.587510824203, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 40.10196850393701, "ram_util_percent": 82.6291338582677}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2254.1804784684387, "episode_reward_min": -2516.793892429438, "episode_reward_mean": -2370.256397597295, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2280.7052464673643, -2390.922479168638, -2377.1408948485528, -2435.312414980863, -2452.6646656247312, -2370.3456300293183, -2365.5705520641072, -2422.725665796446, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113, -2440.7932941106205, -2402.7465099641167, -2329.243960598445, -2388.9559369149883, -2365.961951712187, -2424.767198784174, -2376.7075188179065, -2395.405113482473, -2356.145123349575, -2276.8752325122796, -2254.1804784684387, -2421.06607247913, -2403.06974794096, -2371.9800703600745, -2355.2073600817503, -2387.036070361375, -2418.8109494202545, -2434.63167599695, -2458.9931970569737, -2338.995074494234, -2434.5140520144455, -2437.657641449069, -2376.0700105925603, -2395.132927437134, -2408.8098421951668, -2468.8670208897797, -2453.248252673887, -2339.342113927541, -2354.5916039543004, -2516.793892429438, -2444.992134155023, -2393.998415628431, -2391.6607110855434, -2457.135495498463, -2313.586424383731, -2320.3970126831828, -2353.0642588638298, -2302.4560267215134, -2387.8027647010485, -2450.0060131878377, -2395.6503879184656, -2377.6304251481565, -2366.611808634805, -2393.1164152822007, -2268.137492066668, -2377.7269829341053, -2291.920265770661, -2428.9448210962014, -2329.922690710349, -2366.1827789356967, -2275.1999913456443, -2426.4307417485334], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 261.76734221874244, "mean_raw_obs_processing_ms": 24.98122427340695, "mean_inference_ms": 24.933712191724954, "mean_action_processing_ms": 0.1532130993872721}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 464000, "timers": {"sample_time_ms": 534097.279, "sample_throughput": 7.489, "learn_time_ms": 29154.129, "learn_throughput": 137.202, "update_time_ms": 3.773}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.04496340488549322, "policy_loss": -2.7136207791045308e-05, "vf_loss": 904.2294120788574, "vf_explained_var": 0.83319091796875, "kl": 0.007655922046978958, "entropy": 55.509745359420776, "entropy_coeff": 0.001}}, "num_steps_sampled": 464000, "num_steps_trained": 464000}, "done": false, "episodes_total": 464, "training_iteration": 116, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_13-32-15", "timestamp": 1618119135, "time_this_iter_s": 551.9848392009735, "time_total_s": 62172.89836478233, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 19933.572350025177, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 39.74035532994924, "ram_util_percent": 83.16713197969544}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2254.1804784684387, "episode_reward_min": -2516.793892429438, "episode_reward_mean": -2368.9486669427515, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2373.296881958498, -2288.147880038209, -2415.806738140626, -2403.2819479229306, -2473.787313178577, -2272.7722451401287, -2426.6315505704647, -2384.2689856050365, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113, -2440.7932941106205, -2402.7465099641167, -2329.243960598445, -2388.9559369149883, -2365.961951712187, -2424.767198784174, -2376.7075188179065, -2395.405113482473, -2356.145123349575, -2276.8752325122796, -2254.1804784684387, -2421.06607247913, -2403.06974794096, -2371.9800703600745, -2355.2073600817503, -2387.036070361375, -2418.8109494202545, -2434.63167599695, -2458.9931970569737, -2338.995074494234, -2434.5140520144455, -2437.657641449069, -2376.0700105925603, -2395.132927437134, -2408.8098421951668, -2468.8670208897797, -2453.248252673887, -2339.342113927541, -2354.5916039543004, -2516.793892429438, -2444.992134155023, -2393.998415628431, -2391.6607110855434, -2457.135495498463, -2313.586424383731, -2320.3970126831828, -2353.0642588638298, -2302.4560267215134, -2387.8027647010485, -2450.0060131878377, -2395.6503879184656, -2377.6304251481565, -2366.611808634805, -2393.1164152822007, -2268.137492066668, -2377.7269829341053, -2291.920265770661, -2428.9448210962014, -2329.922690710349, -2366.1827789356967, -2275.1999913456443, -2426.4307417485334, -2280.7052464673643, -2390.922479168638, -2377.1408948485528, -2435.312414980863], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 263.12923004789616, "mean_raw_obs_processing_ms": 25.06583748577442, "mean_inference_ms": 25.04883221149063, "mean_action_processing_ms": 0.15410141019172444}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 468000, "timers": {"sample_time_ms": 514864.854, "sample_throughput": 7.769, "learn_time_ms": 29148.776, "learn_throughput": 137.227, "update_time_ms": 3.761}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06407186377327889, "policy_loss": -0.018158172839321196, "vf_loss": 780.6254663467407, "vf_explained_var": 0.8387547731399536, "kl": 0.010311269856174476, "entropy": 55.78219723701477, "entropy_coeff": 0.001}}, "num_steps_sampled": 468000, "num_steps_trained": 468000}, "done": false, "episodes_total": 468, "training_iteration": 117, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_13-41-08", "timestamp": 1618119668, "time_this_iter_s": 532.7572376728058, "time_total_s": 62705.65560245514, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 20466.329587697983, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 40.07171052631579, "ram_util_percent": 82.31381578947368}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2254.1804784684387, "episode_reward_min": -2516.793892429438, "episode_reward_mean": -2370.534946233538, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2452.7944549899184, -2425.975893766115, -2427.3977352128804, -2409.9199396039658, -2286.5721545928614, -2329.61258219595, -2395.7155985875966, -2432.355669242521, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113, -2440.7932941106205, -2402.7465099641167, -2329.243960598445, -2388.9559369149883, -2365.961951712187, -2424.767198784174, -2376.7075188179065, -2395.405113482473, -2356.145123349575, -2276.8752325122796, -2254.1804784684387, -2421.06607247913, -2403.06974794096, -2371.9800703600745, -2355.2073600817503, -2387.036070361375, -2418.8109494202545, -2434.63167599695, -2458.9931970569737, -2338.995074494234, -2434.5140520144455, -2437.657641449069, -2376.0700105925603, -2395.132927437134, -2408.8098421951668, -2468.8670208897797, -2453.248252673887, -2339.342113927541, -2354.5916039543004, -2516.793892429438, -2444.992134155023, -2393.998415628431, -2391.6607110855434, -2457.135495498463, -2313.586424383731, -2320.3970126831828, -2353.0642588638298, -2302.4560267215134, -2387.8027647010485, -2450.0060131878377, -2395.6503879184656, -2377.6304251481565, -2366.611808634805, -2393.1164152822007, -2268.137492066668, -2377.7269829341053, -2291.920265770661, -2428.9448210962014, -2329.922690710349, -2366.1827789356967, -2275.1999913456443, -2426.4307417485334, -2280.7052464673643, -2390.922479168638, -2377.1408948485528, -2435.312414980863, -2373.296881958498, -2288.147880038209, -2415.806738140626, -2403.2819479229306], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 263.6797007948703, "mean_raw_obs_processing_ms": 25.085377716916632, "mean_inference_ms": 25.09712749519904, "mean_action_processing_ms": 0.1544597136627007}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 472000, "timers": {"sample_time_ms": 514995.208, "sample_throughput": 7.767, "learn_time_ms": 29172.961, "learn_throughput": 137.113, "update_time_ms": 3.759}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.0582073315163143, "policy_loss": -0.013473281520418823, "vf_loss": 864.329195022583, "vf_explained_var": 0.8281323313713074, "kl": 0.012144536653067917, "entropy": 55.806246519088745, "entropy_coeff": 0.001}}, "num_steps_sampled": 472000, "num_steps_trained": 472000}, "done": false, "episodes_total": 472, "training_iteration": 118, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_13-50-02", "timestamp": 1618120202, "time_this_iter_s": 534.848072052002, "time_total_s": 63240.50367450714, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 21001.177659749985, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 40.06959370904325, "ram_util_percent": 82.1737876802097}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2254.1804784684387, "episode_reward_min": -2516.793892429438, "episode_reward_mean": -2369.608085717943, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2332.0023363575333, -2314.3098261878677, -2308.107898323795, -2397.149892190253, -2288.814240764647, -2325.010194914537, -2432.5196384652063, -2315.785664070966, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113, -2440.7932941106205, -2402.7465099641167, -2329.243960598445, -2388.9559369149883, -2365.961951712187, -2424.767198784174, -2376.7075188179065, -2395.405113482473, -2356.145123349575, -2276.8752325122796, -2254.1804784684387, -2421.06607247913, -2403.06974794096, -2371.9800703600745, -2355.2073600817503, -2387.036070361375, -2418.8109494202545, -2434.63167599695, -2458.9931970569737, -2338.995074494234, -2434.5140520144455, -2437.657641449069, -2376.0700105925603, -2395.132927437134, -2408.8098421951668, -2468.8670208897797, -2453.248252673887, -2339.342113927541, -2354.5916039543004, -2516.793892429438, -2444.992134155023, -2393.998415628431, -2391.6607110855434, -2457.135495498463, -2313.586424383731, -2320.3970126831828, -2353.0642588638298, -2302.4560267215134, -2387.8027647010485, -2450.0060131878377, -2395.6503879184656, -2377.6304251481565, -2366.611808634805, -2393.1164152822007, -2268.137492066668, -2377.7269829341053, -2291.920265770661, -2428.9448210962014, -2329.922690710349, -2366.1827789356967, -2275.1999913456443, -2426.4307417485334, -2280.7052464673643, -2390.922479168638, -2377.1408948485528, -2435.312414980863, -2373.296881958498, -2288.147880038209, -2415.806738140626, -2403.2819479229306, -2452.7944549899184, -2425.975893766115, -2427.3977352128804, -2409.9199396039658], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 263.9985715547475, "mean_raw_obs_processing_ms": 25.100404182813968, "mean_inference_ms": 25.12246265015201, "mean_action_processing_ms": 0.15461910661329734}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 476000, "timers": {"sample_time_ms": 514866.721, "sample_throughput": 7.769, "learn_time_ms": 29167.957, "learn_throughput": 137.137, "update_time_ms": 3.672}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05770163825945929, "policy_loss": -0.009613254049327224, "vf_loss": 557.911030292511, "vf_explained_var": 0.8874516487121582, "kl": 0.011649636668153107, "entropy": 55.99741768836975, "entropy_coeff": 0.001}}, "num_steps_sampled": 476000, "num_steps_trained": 476000}, "done": false, "episodes_total": 476, "training_iteration": 119, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_13-58-56", "timestamp": 1618120736, "time_this_iter_s": 533.5341074466705, "time_total_s": 63774.03778195381, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 21534.711767196655, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 40.04507227332457, "ram_util_percent": 82.20932982917215}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2254.1804784684387, "episode_reward_min": -2516.793892429438, "episode_reward_mean": -2371.956451433065, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2387.7061186118945, -2448.8441916066145, -2375.6380928448866, -2384.777906664142, -2377.817056118266, -2274.683680506413, -2341.915867846388, -2293.7748271271644, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113, -2440.7932941106205, -2402.7465099641167, -2329.243960598445, -2388.9559369149883, -2365.961951712187, -2424.767198784174, -2376.7075188179065, -2395.405113482473, -2356.145123349575, -2276.8752325122796, -2254.1804784684387, -2421.06607247913, -2403.06974794096, -2371.9800703600745, -2355.2073600817503, -2387.036070361375, -2418.8109494202545, -2434.63167599695, -2458.9931970569737, -2338.995074494234, -2434.5140520144455, -2437.657641449069, -2376.0700105925603, -2395.132927437134, -2408.8098421951668, -2468.8670208897797, -2453.248252673887, -2339.342113927541, -2354.5916039543004, -2516.793892429438, -2444.992134155023, -2393.998415628431, -2391.6607110855434, -2457.135495498463, -2313.586424383731, -2320.3970126831828, -2353.0642588638298, -2302.4560267215134, -2387.8027647010485, -2450.0060131878377, -2395.6503879184656, -2377.6304251481565, -2366.611808634805, -2393.1164152822007, -2268.137492066668, -2377.7269829341053, -2291.920265770661, -2428.9448210962014, -2329.922690710349, -2366.1827789356967, -2275.1999913456443, -2426.4307417485334, -2280.7052464673643, -2390.922479168638, -2377.1408948485528, -2435.312414980863, -2373.296881958498, -2288.147880038209, -2415.806738140626, -2403.2819479229306, -2452.7944549899184, -2425.975893766115, -2427.3977352128804, -2409.9199396039658, -2332.0023363575333, -2314.3098261878677, -2308.107898323795, -2397.149892190253], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 263.8639256596145, "mean_raw_obs_processing_ms": 25.06399295005628, "mean_inference_ms": 25.113645694535617, "mean_action_processing_ms": 0.15453381361086696}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 480000, "timers": {"sample_time_ms": 514539.773, "sample_throughput": 7.774, "learn_time_ms": 29154.873, "learn_throughput": 137.198, "update_time_ms": 3.693}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.049099383875727654, "policy_loss": -0.0031244316196534783, "vf_loss": 818.1369762420654, "vf_explained_var": 0.8352322578430176, "kl": 0.008176258721505292, "entropy": 55.79156827926636, "entropy_coeff": 0.001}}, "num_steps_sampled": 480000, "num_steps_trained": 480000}, "done": false, "episodes_total": 480, "training_iteration": 120, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_14-07-50", "timestamp": 1618121270, "time_this_iter_s": 534.1023690700531, "time_total_s": 64308.140151023865, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22068.81413626671, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 40.00997375328084, "ram_util_percent": 83.0229658792651}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2254.1804784684387, "episode_reward_min": -2516.793892429438, "episode_reward_mean": -2372.3715725441834, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2414.201442515523, -2337.8976542100404, -2263.044604560695, -2314.559841423755, -2325.6226523738183, -2286.0081416785933, -2266.9275903201305, -2335.293834218975, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113, -2440.7932941106205, -2402.7465099641167, -2329.243960598445, -2388.9559369149883, -2365.961951712187, -2424.767198784174, -2376.7075188179065, -2395.405113482473, -2356.145123349575, -2276.8752325122796, -2254.1804784684387, -2421.06607247913, -2403.06974794096, -2371.9800703600745, -2355.2073600817503, -2387.036070361375, -2418.8109494202545, -2434.63167599695, -2458.9931970569737, -2338.995074494234, -2434.5140520144455, -2437.657641449069, -2376.0700105925603, -2395.132927437134, -2408.8098421951668, -2468.8670208897797, -2453.248252673887, -2339.342113927541, -2354.5916039543004, -2516.793892429438, -2444.992134155023, -2393.998415628431, -2391.6607110855434, -2457.135495498463, -2313.586424383731, -2320.3970126831828, -2353.0642588638298, -2302.4560267215134, -2387.8027647010485, -2450.0060131878377, -2395.6503879184656, -2377.6304251481565, -2366.611808634805, -2393.1164152822007, -2268.137492066668, -2377.7269829341053, -2291.920265770661, -2428.9448210962014, -2329.922690710349, -2366.1827789356967, -2275.1999913456443, -2426.4307417485334, -2280.7052464673643, -2390.922479168638, -2377.1408948485528, -2435.312414980863, -2373.296881958498, -2288.147880038209, -2415.806738140626, -2403.2819479229306, -2452.7944549899184, -2425.975893766115, -2427.3977352128804, -2409.9199396039658, -2332.0023363575333, -2314.3098261878677, -2308.107898323795, -2397.149892190253, -2387.7061186118945, -2448.8441916066145, -2375.6380928448866, -2384.777906664142], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 263.35561522381136, "mean_raw_obs_processing_ms": 25.000505030267604, "mean_inference_ms": 25.073170912617623, "mean_action_processing_ms": 0.1541881644960787}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 484000, "timers": {"sample_time_ms": 514182.054, "sample_throughput": 7.779, "learn_time_ms": 29145.253, "learn_throughput": 137.244, "update_time_ms": 3.689}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.04471997474320233, "policy_loss": 2.5943212676793337e-05, "vf_loss": 877.4842729568481, "vf_explained_var": 0.8148009777069092, "kl": 0.012299744033953175, "entropy": 55.98070466518402, "entropy_coeff": 0.001}}, "num_steps_sampled": 484000, "num_steps_trained": 484000}, "done": false, "episodes_total": 484, "training_iteration": 121, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_14-16-43", "timestamp": 1618121803, "time_this_iter_s": 532.8481910228729, "time_total_s": 64840.98834204674, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 22601.66232728958, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 40.05171052631579, "ram_util_percent": 83.4457894736842}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2254.1804784684387, "episode_reward_min": -2516.793892429438, "episode_reward_mean": -2374.9572973259224, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2385.0951114620793, -2405.739600791509, -2337.8219287910442, -2343.768055720763, -2446.849108574848, -2391.0264629233448, -2301.1800712601334, -2295.721383567721, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113, -2440.7932941106205, -2402.7465099641167, -2329.243960598445, -2388.9559369149883, -2365.961951712187, -2424.767198784174, -2376.7075188179065, -2395.405113482473, -2356.145123349575, -2276.8752325122796, -2254.1804784684387, -2421.06607247913, -2403.06974794096, -2371.9800703600745, -2355.2073600817503, -2387.036070361375, -2418.8109494202545, -2434.63167599695, -2458.9931970569737, -2338.995074494234, -2434.5140520144455, -2437.657641449069, -2376.0700105925603, -2395.132927437134, -2408.8098421951668, -2468.8670208897797, -2453.248252673887, -2339.342113927541, -2354.5916039543004, -2516.793892429438, -2444.992134155023, -2393.998415628431, -2391.6607110855434, -2457.135495498463, -2313.586424383731, -2320.3970126831828, -2353.0642588638298, -2302.4560267215134, -2387.8027647010485, -2450.0060131878377, -2395.6503879184656, -2377.6304251481565, -2366.611808634805, -2393.1164152822007, -2268.137492066668, -2377.7269829341053, -2291.920265770661, -2428.9448210962014, -2329.922690710349, -2366.1827789356967, -2275.1999913456443, -2426.4307417485334, -2280.7052464673643, -2390.922479168638, -2377.1408948485528, -2435.312414980863, -2373.296881958498, -2288.147880038209, -2415.806738140626, -2403.2819479229306, -2452.7944549899184, -2425.975893766115, -2427.3977352128804, -2409.9199396039658, -2332.0023363575333, -2314.3098261878677, -2308.107898323795, -2397.149892190253, -2387.7061186118945, -2448.8441916066145, -2375.6380928448866, -2384.777906664142, -2414.201442515523, -2337.8976542100404, -2263.044604560695, -2314.559841423755], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 262.58622960742906, "mean_raw_obs_processing_ms": 24.914995910857627, "mean_inference_ms": 25.008410282213916, "mean_action_processing_ms": 0.15364582492343593}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 488000, "timers": {"sample_time_ms": 514110.907, "sample_throughput": 7.78, "learn_time_ms": 29215.49, "learn_throughput": 136.914, "update_time_ms": 3.767}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06203517719404772, "policy_loss": -0.014538075949531049, "vf_loss": 652.0457830429077, "vf_explained_var": 0.8484150767326355, "kl": 0.00996372097870335, "entropy": 56.01030135154724, "entropy_coeff": 0.001}}, "num_steps_sampled": 488000, "num_steps_trained": 488000}, "done": false, "episodes_total": 488, "training_iteration": 122, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_14-25-38", "timestamp": 1618122338, "time_this_iter_s": 535.1010704040527, "time_total_s": 65376.08941245079, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 23136.763397693634, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 40.16178010471204, "ram_util_percent": 83.76596858638743}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2254.1804784684387, "episode_reward_min": -2516.793892429438, "episode_reward_mean": -2373.5935480601397, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2349.4863127606995, -2317.094037374689, -2303.804102566883, -2328.0176470456126, -2393.7219224827136, -2311.016563391373, -2317.836989306681, -2418.7249713543006, -2406.4220814758746, -2399.3662307068166, -2266.9996635919288, -2285.599707734804, -2485.125128096517, -2362.9810866399225, -2336.738098903991, -2392.518404293178, -2404.2161810890543, -2362.896397076612, -2328.0122796263804, -2258.2360381647113, -2440.7932941106205, -2402.7465099641167, -2329.243960598445, -2388.9559369149883, -2365.961951712187, -2424.767198784174, -2376.7075188179065, -2395.405113482473, -2356.145123349575, -2276.8752325122796, -2254.1804784684387, -2421.06607247913, -2403.06974794096, -2371.9800703600745, -2355.2073600817503, -2387.036070361375, -2418.8109494202545, -2434.63167599695, -2458.9931970569737, -2338.995074494234, -2434.5140520144455, -2437.657641449069, -2376.0700105925603, -2395.132927437134, -2408.8098421951668, -2468.8670208897797, -2453.248252673887, -2339.342113927541, -2354.5916039543004, -2516.793892429438, -2444.992134155023, -2393.998415628431, -2391.6607110855434, -2457.135495498463, -2313.586424383731, -2320.3970126831828, -2353.0642588638298, -2302.4560267215134, -2387.8027647010485, -2450.0060131878377, -2395.6503879184656, -2377.6304251481565, -2366.611808634805, -2393.1164152822007, -2268.137492066668, -2377.7269829341053, -2291.920265770661, -2428.9448210962014, -2329.922690710349, -2366.1827789356967, -2275.1999913456443, -2426.4307417485334, -2280.7052464673643, -2390.922479168638, -2377.1408948485528, -2435.312414980863, -2373.296881958498, -2288.147880038209, -2415.806738140626, -2403.2819479229306, -2452.7944549899184, -2425.975893766115, -2427.3977352128804, -2409.9199396039658, -2332.0023363575333, -2314.3098261878677, -2308.107898323795, -2397.149892190253, -2387.7061186118945, -2448.8441916066145, -2375.6380928448866, -2384.777906664142, -2414.201442515523, -2337.8976542100404, -2263.044604560695, -2314.559841423755, -2385.0951114620793, -2405.739600791509, -2337.8219287910442, -2343.768055720763], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 261.4401276450576, "mean_raw_obs_processing_ms": 24.808468117153623, "mean_inference_ms": 24.91792900722429, "mean_action_processing_ms": 0.15293289816616643}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 492000, "timers": {"sample_time_ms": 540029.379, "sample_throughput": 7.407, "learn_time_ms": 29470.89, "learn_throughput": 135.727, "update_time_ms": 5.418}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05169569299323484, "policy_loss": -0.008282480936031789, "vf_loss": 1004.9120721817017, "vf_explained_var": 0.7816879749298096, "kl": 0.012193470785859972, "entropy": 55.90102171897888, "entropy_coeff": 0.001}}, "num_steps_sampled": 492000, "num_steps_trained": 492000}, "done": false, "episodes_total": 492, "training_iteration": 123, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_14-40-06", "timestamp": 1618123206, "time_this_iter_s": 867.8113870620728, "time_total_s": 66243.90079951286, "pid": 4342, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 24004.574784755707, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 62.389409862570744, "ram_util_percent": 88.83912691996767}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2306.4012027807935, "episode_reward_min": -2396.1933329120066, "episode_reward_mean": -2351.5875300434463, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2384.6785900046298, -2306.4012027807935, -2319.0769944763542, -2396.1933329120066], "episode_lengths": [1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 213.0540724339216, "mean_raw_obs_processing_ms": 26.31992682524171, "mean_inference_ms": 20.49779629838401, "mean_action_processing_ms": 0.12285687934154871}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 484000, "timers": {"sample_time_ms": 525093.325, "sample_throughput": 7.618, "learn_time_ms": 30241.535, "learn_throughput": 132.268, "update_time_ms": 27.117}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05739420326426625, "policy_loss": -0.016170175455044955, "vf_loss": 1227.5293273925781, "vf_explained_var": 0.7556034922599792, "kl": 0.013313962932443246, "entropy": 56.16211545467377, "entropy_coeff": 0.001}}, "num_steps_sampled": 484000, "num_steps_trained": 484000}, "done": false, "episodes_total": 484, "training_iteration": 121, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_15-51-57", "timestamp": 1618127517, "time_this_iter_s": 555.5890867710114, "time_total_s": 64863.729237794876, "pid": 16048, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 555.5890867710114, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 39.41160151324085, "ram_util_percent": 87.57250945775536}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2306.4012027807935, "episode_reward_min": -2409.8268208366717, "episode_reward_mean": -2356.531536324713, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2409.8268208366717, -2337.0356988550006, -2334.1342143300185, -2364.9054364022295, -2384.6785900046298, -2306.4012027807935, -2319.0769944763542, -2396.1933329120066], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 213.56583067524568, "mean_raw_obs_processing_ms": 26.191504268747458, "mean_inference_ms": 20.51648280856534, "mean_action_processing_ms": 0.12281766330202322}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 488000, "timers": {"sample_time_ms": 526133.096, "sample_throughput": 7.603, "learn_time_ms": 30094.255, "learn_throughput": 132.916, "update_time_ms": 66.455}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05420901864999905, "policy_loss": -0.0070577741134911776, "vf_loss": 666.8320708274841, "vf_explained_var": 0.8625748157501221, "kl": 0.010899141489062458, "entropy": 55.99939048290253, "entropy_coeff": 0.001}}, "num_steps_sampled": 488000, "num_steps_trained": 488000}, "done": false, "episodes_total": 488, "training_iteration": 122, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_16-01-15", "timestamp": 1618128075, "time_this_iter_s": 557.4947454929352, "time_total_s": 65421.22398328781, "pid": 16048, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1113.0838322639465, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.663316582914575, "ram_util_percent": 90.17273869346734}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2306.4012027807935, "episode_reward_min": -2453.6599420129796, "episode_reward_mean": -2381.3340776708137, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2438.504146270282, -2388.310876247856, -2443.281676920943, -2453.6599420129796, -2384.6785900046298, -2306.4012027807935, -2319.0769944763542, -2396.1933329120066, -2409.8268208366717, -2337.0356988550006, -2334.1342143300185, -2364.9054364022295], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 213.80057033098765, "mean_raw_obs_processing_ms": 25.746916744704578, "mean_inference_ms": 20.510942403042147, "mean_action_processing_ms": 0.12279154978152941}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 492000, "timers": {"sample_time_ms": 524166.247, "sample_throughput": 7.631, "learn_time_ms": 29344.033, "learn_throughput": 136.314, "update_time_ms": 45.485}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.055941960017662495, "policy_loss": -0.009458405955228955, "vf_loss": 767.3095021247864, "vf_explained_var": 0.8589047193527222, "kl": 0.01041660108603537, "entropy": 56.23996722698212, "entropy_coeff": 0.001}}, "num_steps_sampled": 492000, "num_steps_trained": 492000}, "done": false, "episodes_total": 492, "training_iteration": 123, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_16-10-24", "timestamp": 1618128624, "time_this_iter_s": 548.0868022441864, "time_total_s": 65969.310785532, "pid": 16048, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1661.170634508133, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 39.836015325670495, "ram_util_percent": 90.66424010217115}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2256.978601183921, "episode_reward_min": -2499.9771233136325, "episode_reward_mean": -2381.2597902454636, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2464.283997609752, -2302.9079897703514, -2499.9771233136325, -2256.978601183921, -2384.6785900046298, -2306.4012027807935, -2319.0769944763542, -2396.1933329120066, -2409.8268208366717, -2337.0356988550006, -2334.1342143300185, -2364.9054364022295, -2438.504146270282, -2388.310876247856, -2443.281676920943, -2453.6599420129796], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 213.93591067921693, "mean_raw_obs_processing_ms": 25.238261642159436, "mean_inference_ms": 20.503726685704788, "mean_action_processing_ms": 0.12275464248709429}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 496000, "timers": {"sample_time_ms": 522261.216, "sample_throughput": 7.659, "learn_time_ms": 28917.579, "learn_throughput": 138.324, "update_time_ms": 34.993}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05575885303551331, "policy_loss": -0.011669557716231793, "vf_loss": 1036.8964614868164, "vf_explained_var": 0.8026214838027954, "kl": 0.009423298382898793, "entropy": 56.342915415763855, "entropy_coeff": 0.001}}, "num_steps_sampled": 496000, "num_steps_trained": 496000}, "done": false, "episodes_total": 496, "training_iteration": 124, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_16-19-28", "timestamp": 1618129168, "time_this_iter_s": 544.2031593322754, "time_total_s": 66513.51394486427, "pid": 16048, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2205.3737938404083, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 39.98556701030928, "ram_util_percent": 89.81713917525774}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2256.978601183921, "episode_reward_min": -2552.269525239936, "episode_reward_mean": -2383.9602296685835, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2552.269525239936, -2383.8859695732135, -2290.616593298725, -2352.275861332363, -2384.6785900046298, -2306.4012027807935, -2319.0769944763542, -2396.1933329120066, -2409.8268208366717, -2337.0356988550006, -2334.1342143300185, -2364.9054364022295, -2438.504146270282, -2388.310876247856, -2443.281676920943, -2453.6599420129796, -2464.283997609752, -2302.9079897703514, -2499.9771233136325, -2256.978601183921], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.0218207445561, "mean_raw_obs_processing_ms": 24.794887488548316, "mean_inference_ms": 20.498433283606374, "mean_action_processing_ms": 0.12273891439266982}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 500000, "timers": {"sample_time_ms": 521352.09, "sample_throughput": 7.672, "learn_time_ms": 28699.189, "learn_throughput": 139.377, "update_time_ms": 28.807}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05994937114883214, "policy_loss": -0.011624937120359391, "vf_loss": 624.7825317382812, "vf_explained_var": 0.876205563545227, "kl": 0.009154309300356545, "entropy": 56.40311801433563, "entropy_coeff": 0.001}}, "num_steps_sampled": 500000, "num_steps_trained": 500000}, "done": false, "episodes_total": 500, "training_iteration": 125, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_16-28-33", "timestamp": 1618129713, "time_this_iter_s": 545.5521488189697, "time_total_s": 67059.06609368324, "pid": 16048, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2750.925942659378, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 39.914910025706945, "ram_util_percent": 89.60835475578406}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2256.978601183921, "episode_reward_min": -2552.269525239936, "episode_reward_mean": -2384.6034503785145, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2395.8274744546434, -2402.9812391196238, -2340.696948966798, -2411.772553171627, -2384.6785900046298, -2306.4012027807935, -2319.0769944763542, -2396.1933329120066, -2409.8268208366717, -2337.0356988550006, -2334.1342143300185, -2364.9054364022295, -2438.504146270282, -2388.310876247856, -2443.281676920943, -2453.6599420129796, -2464.283997609752, -2302.9079897703514, -2499.9771233136325, -2256.978601183921, -2552.269525239936, -2383.8859695732135, -2290.616593298725, -2352.275861332363], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.10966380751324, "mean_raw_obs_processing_ms": 24.45035085618022, "mean_inference_ms": 20.495524378134444, "mean_action_processing_ms": 0.1227254477148268}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 504000, "timers": {"sample_time_ms": 521095.634, "sample_throughput": 7.676, "learn_time_ms": 28550.312, "learn_throughput": 140.104, "update_time_ms": 24.577}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.059642080566845834, "policy_loss": -0.013409076607786119, "vf_loss": 764.2505941390991, "vf_explained_var": 0.8527988195419312, "kl": 0.010341442219214514, "entropy": 55.94379639625549, "entropy_coeff": 0.001}}, "num_steps_sampled": 504000, "num_steps_trained": 504000}, "done": false, "episodes_total": 504, "training_iteration": 126, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_16-37-41", "timestamp": 1618130261, "time_this_iter_s": 547.6301865577698, "time_total_s": 67606.69628024101, "pid": 16048, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3298.556129217148, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 39.96624040920716, "ram_util_percent": 89.13414322250638}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2256.978601183921, "episode_reward_min": -2552.269525239936, "episode_reward_mean": -2390.4444410859915, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2504.5985855847757, -2388.2822305211566, -2449.2405387015483, -2359.840186515937, -2384.6785900046298, -2306.4012027807935, -2319.0769944763542, -2396.1933329120066, -2409.8268208366717, -2337.0356988550006, -2334.1342143300185, -2364.9054364022295, -2438.504146270282, -2388.310876247856, -2443.281676920943, -2453.6599420129796, -2464.283997609752, -2302.9079897703514, -2499.9771233136325, -2256.978601183921, -2552.269525239936, -2383.8859695732135, -2290.616593298725, -2352.275861332363, -2395.8274744546434, -2402.9812391196238, -2340.696948966798, -2411.772553171627], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.1662760837799, "mean_raw_obs_processing_ms": 24.188672387106756, "mean_inference_ms": 20.490584624304322, "mean_action_processing_ms": 0.12270025875347086}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 508000, "timers": {"sample_time_ms": 520594.707, "sample_throughput": 7.684, "learn_time_ms": 28467.594, "learn_throughput": 140.511, "update_time_ms": 21.681}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.059848364151548594, "policy_loss": -0.013082173536531627, "vf_loss": 695.6619310379028, "vf_explained_var": 0.8614401817321777, "kl": 0.010629808472003788, "entropy": 55.8487663269043, "entropy_coeff": 0.001}}, "num_steps_sampled": 508000, "num_steps_trained": 508000}, "done": false, "episodes_total": 508, "training_iteration": 127, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_16-46-47", "timestamp": 1618130807, "time_this_iter_s": 545.5720822811127, "time_total_s": 68152.26836252213, "pid": 16048, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3844.1282114982605, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 39.89935732647815, "ram_util_percent": 89.24537275064267}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2256.978601183921, "episode_reward_min": -2552.269525239936, "episode_reward_mean": -2393.3085135510273, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2386.5763841703592, -2399.8345115766588, -2483.789714296602, -2383.227473181478, -2384.6785900046298, -2306.4012027807935, -2319.0769944763542, -2396.1933329120066, -2409.8268208366717, -2337.0356988550006, -2334.1342143300185, -2364.9054364022295, -2438.504146270282, -2388.310876247856, -2443.281676920943, -2453.6599420129796, -2464.283997609752, -2302.9079897703514, -2499.9771233136325, -2256.978601183921, -2552.269525239936, -2383.8859695732135, -2290.616593298725, -2352.275861332363, -2395.8274744546434, -2402.9812391196238, -2340.696948966798, -2411.772553171627, -2504.5985855847757, -2388.2822305211566, -2449.2405387015483, -2359.840186515937], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.2201660153184, "mean_raw_obs_processing_ms": 23.975067483660162, "mean_inference_ms": 20.488037796778244, "mean_action_processing_ms": 0.12268793604049076}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 512000, "timers": {"sample_time_ms": 520624.695, "sample_throughput": 7.683, "learn_time_ms": 28406.819, "learn_throughput": 140.811, "update_time_ms": 19.404}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.060115686792414635, "policy_loss": -0.014732844952959567, "vf_loss": 887.0581655502319, "vf_explained_var": 0.8263376355171204, "kl": 0.0077777750411769375, "entropy": 55.80897557735443, "entropy_coeff": 0.001}}, "num_steps_sampled": 512000, "num_steps_trained": 512000}, "done": false, "episodes_total": 512, "training_iteration": 128, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_16-55-56", "timestamp": 1618131356, "time_this_iter_s": 548.8266172409058, "time_total_s": 68701.09497976303, "pid": 16048, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4392.954828739166, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 39.91123882503193, "ram_util_percent": 89.1103448275862}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2256.978601183921, "episode_reward_min": -2552.269525239936, "episode_reward_mean": -2391.218523145808, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2350.6384385576575, -2371.493409406175, -2320.411796515889, -2455.4507551364973, -2384.6785900046298, -2306.4012027807935, -2319.0769944763542, -2396.1933329120066, -2409.8268208366717, -2337.0356988550006, -2334.1342143300185, -2364.9054364022295, -2438.504146270282, -2388.310876247856, -2443.281676920943, -2453.6599420129796, -2464.283997609752, -2302.9079897703514, -2499.9771233136325, -2256.978601183921, -2552.269525239936, -2383.8859695732135, -2290.616593298725, -2352.275861332363, -2395.8274744546434, -2402.9812391196238, -2340.696948966798, -2411.772553171627, -2504.5985855847757, -2388.2822305211566, -2449.2405387015483, -2359.840186515937, -2386.5763841703592, -2399.8345115766588, -2483.789714296602, -2383.227473181478], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.25495058966555, "mean_raw_obs_processing_ms": 23.790518574703697, "mean_inference_ms": 20.48556869092458, "mean_action_processing_ms": 0.12267703546215003}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 516000, "timers": {"sample_time_ms": 520230.495, "sample_throughput": 7.689, "learn_time_ms": 28362.974, "learn_throughput": 141.029, "update_time_ms": 17.717}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.054149642353877425, "policy_loss": -0.011074696958530694, "vf_loss": 1058.539155960083, "vf_explained_var": 0.7952689528465271, "kl": 0.011293036033748649, "entropy": 55.91894090175629, "entropy_coeff": 0.001}}, "num_steps_sampled": 516000, "num_steps_trained": 516000}, "done": false, "episodes_total": 516, "training_iteration": 129, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_17-05-01", "timestamp": 1618131901, "time_this_iter_s": 545.1004569530487, "time_total_s": 69246.19543671608, "pid": 16048, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4938.055285692215, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 39.91953727506427, "ram_util_percent": 87.97956298200515}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2256.978601183921, "episode_reward_min": -2552.269525239936, "episode_reward_mean": -2387.5217984592464, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2378.966760715304, -2399.64623314918, -2332.261545409782, -2306.1305658465085, -2384.6785900046298, -2306.4012027807935, -2319.0769944763542, -2396.1933329120066, -2409.8268208366717, -2337.0356988550006, -2334.1342143300185, -2364.9054364022295, -2438.504146270282, -2388.310876247856, -2443.281676920943, -2453.6599420129796, -2464.283997609752, -2302.9079897703514, -2499.9771233136325, -2256.978601183921, -2552.269525239936, -2383.8859695732135, -2290.616593298725, -2352.275861332363, -2395.8274744546434, -2402.9812391196238, -2340.696948966798, -2411.772553171627, -2504.5985855847757, -2388.2822305211566, -2449.2405387015483, -2359.840186515937, -2386.5763841703592, -2399.8345115766588, -2483.789714296602, -2383.227473181478, -2350.6384385576575, -2371.493409406175, -2320.411796515889, -2455.4507551364973], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.28609886848545, "mean_raw_obs_processing_ms": 23.620754626799293, "mean_inference_ms": 20.485234272832113, "mean_action_processing_ms": 0.12267500464780898}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 520000, "timers": {"sample_time_ms": 520147.144, "sample_throughput": 7.69, "learn_time_ms": 28324.297, "learn_throughput": 141.222, "update_time_ms": 16.294}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05994374520378187, "policy_loss": -0.018283318320754915, "vf_loss": 1193.7054917812347, "vf_explained_var": 0.7354281544685364, "kl": 0.011847956717247143, "entropy": 55.967069029808044, "entropy_coeff": 0.001}}, "num_steps_sampled": 520000, "num_steps_trained": 520000}, "done": false, "episodes_total": 520, "training_iteration": 130, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_17-14-09", "timestamp": 1618132449, "time_this_iter_s": 547.4044365882874, "time_total_s": 69793.59987330437, "pid": 16048, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5485.459722280502, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 39.90076824583867, "ram_util_percent": 88.04058898847633}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2256.978601183921, "episode_reward_min": -2552.269525239936, "episode_reward_mean": -2383.69311076338, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2311.3960439331995, -2379.0472049582327, -2343.9033873149215, -2347.2782990124947, -2384.6785900046298, -2306.4012027807935, -2319.0769944763542, -2396.1933329120066, -2409.8268208366717, -2337.0356988550006, -2334.1342143300185, -2364.9054364022295, -2438.504146270282, -2388.310876247856, -2443.281676920943, -2453.6599420129796, -2464.283997609752, -2302.9079897703514, -2499.9771233136325, -2256.978601183921, -2552.269525239936, -2383.8859695732135, -2290.616593298725, -2352.275861332363, -2395.8274744546434, -2402.9812391196238, -2340.696948966798, -2411.772553171627, -2504.5985855847757, -2388.2822305211566, -2449.2405387015483, -2359.840186515937, -2386.5763841703592, -2399.8345115766588, -2483.789714296602, -2383.227473181478, -2350.6384385576575, -2371.493409406175, -2320.411796515889, -2455.4507551364973, -2378.966760715304, -2399.64623314918, -2332.261545409782, -2306.1305658465085], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.32553538628716, "mean_raw_obs_processing_ms": 23.467178203455944, "mean_inference_ms": 20.484530677467212, "mean_action_processing_ms": 0.12266921654568841}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 524000, "timers": {"sample_time_ms": 519545.607, "sample_throughput": 7.699, "learn_time_ms": 28083.354, "learn_throughput": 142.433, "update_time_ms": 14.027}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05673834413755685, "policy_loss": -0.009592954971594736, "vf_loss": 675.0716724395752, "vf_explained_var": 0.8611108064651489, "kl": 0.010502162389457226, "entropy": 55.99653434753418, "entropy_coeff": 0.001}}, "num_steps_sampled": 524000, "num_steps_trained": 524000}, "done": false, "episodes_total": 524, "training_iteration": 131, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_17-23-16", "timestamp": 1618132996, "time_this_iter_s": 546.9216156005859, "time_total_s": 70340.52148890495, "pid": 16048, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6032.381337881088, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 40.000640204865554, "ram_util_percent": 88.69449423815622}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2256.978601183921, "episode_reward_min": -2649.175561927156, "episode_reward_mean": -2391.9050481357194, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2649.175561927156, -2326.2868026272577, -2481.100963839954, -2472.382108531454, -2384.6785900046298, -2306.4012027807935, -2319.0769944763542, -2396.1933329120066, -2409.8268208366717, -2337.0356988550006, -2334.1342143300185, -2364.9054364022295, -2438.504146270282, -2388.310876247856, -2443.281676920943, -2453.6599420129796, -2464.283997609752, -2302.9079897703514, -2499.9771233136325, -2256.978601183921, -2552.269525239936, -2383.8859695732135, -2290.616593298725, -2352.275861332363, -2395.8274744546434, -2402.9812391196238, -2340.696948966798, -2411.772553171627, -2504.5985855847757, -2388.2822305211566, -2449.2405387015483, -2359.840186515937, -2386.5763841703592, -2399.8345115766588, -2483.789714296602, -2383.227473181478, -2350.6384385576575, -2371.493409406175, -2320.411796515889, -2455.4507551364973, -2378.966760715304, -2399.64623314918, -2332.261545409782, -2306.1305658465085, -2311.3960439331995, -2379.0472049582327, -2343.9033873149215, -2347.2782990124947], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.36167185436761, "mean_raw_obs_processing_ms": 23.327131581695074, "mean_inference_ms": 20.484358587107078, "mean_action_processing_ms": 0.12266772014467646}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 528000, "timers": {"sample_time_ms": 518621.638, "sample_throughput": 7.713, "learn_time_ms": 27895.57, "learn_throughput": 143.392, "update_time_ms": 3.881}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.050646738440264016, "policy_loss": -0.006397993420250714, "vf_loss": 897.3797340393066, "vf_explained_var": 0.843542754650116, "kl": 0.012501865130616352, "entropy": 55.72291398048401, "entropy_coeff": 0.001}}, "num_steps_sampled": 528000, "num_steps_trained": 528000}, "done": false, "episodes_total": 528, "training_iteration": 132, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_17-32-22", "timestamp": 1618133542, "time_this_iter_s": 546.0134873390198, "time_total_s": 70886.53497624397, "pid": 16048, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6578.394825220108, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 39.983568677792036, "ram_util_percent": 89.19383825417202}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2256.978601183921, "episode_reward_min": -2649.175561927156, "episode_reward_mean": -2393.6794922585123, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2354.9157778609565, -2436.2588836521886, -2436.0510327632455, -2432.6655926516905, -2384.6785900046298, -2306.4012027807935, -2319.0769944763542, -2396.1933329120066, -2409.8268208366717, -2337.0356988550006, -2334.1342143300185, -2364.9054364022295, -2438.504146270282, -2388.310876247856, -2443.281676920943, -2453.6599420129796, -2464.283997609752, -2302.9079897703514, -2499.9771233136325, -2256.978601183921, -2552.269525239936, -2383.8859695732135, -2290.616593298725, -2352.275861332363, -2395.8274744546434, -2402.9812391196238, -2340.696948966798, -2411.772553171627, -2504.5985855847757, -2388.2822305211566, -2449.2405387015483, -2359.840186515937, -2386.5763841703592, -2399.8345115766588, -2483.789714296602, -2383.227473181478, -2350.6384385576575, -2371.493409406175, -2320.411796515889, -2455.4507551364973, -2378.966760715304, -2399.64623314918, -2332.261545409782, -2306.1305658465085, -2311.3960439331995, -2379.0472049582327, -2343.9033873149215, -2347.2782990124947, -2649.175561927156, -2326.2868026272577, -2481.100963839954, -2472.382108531454], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.38399507547368, "mean_raw_obs_processing_ms": 23.19906120482738, "mean_inference_ms": 20.482775547026833, "mean_action_processing_ms": 0.12265940477233511}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 532000, "timers": {"sample_time_ms": 517798.63, "sample_throughput": 7.725, "learn_time_ms": 27911.929, "learn_throughput": 143.308, "update_time_ms": 3.896}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05921160752768628, "policy_loss": -0.011059949814807624, "vf_loss": 512.9112720489502, "vf_explained_var": 0.8963350653648376, "kl": 0.0122103925968986, "entropy": 55.72284638881683, "entropy_coeff": 0.001}}, "num_steps_sampled": 532000, "num_steps_trained": 532000}, "done": false, "episodes_total": 532, "training_iteration": 133, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_17-41-22", "timestamp": 1618134082, "time_this_iter_s": 540.0207579135895, "time_total_s": 71426.55573415756, "pid": 16048, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7118.4155831336975, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 40.08298701298701, "ram_util_percent": 88.48077922077921}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2256.978601183921, "episode_reward_min": -2649.175561927156, "episode_reward_mean": -2395.7843895446863, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2496.3649339196413, -2439.1455724017037, -2399.0246414917165, -2358.0570692467695, -2384.6785900046298, -2306.4012027807935, -2319.0769944763542, -2396.1933329120066, -2409.8268208366717, -2337.0356988550006, -2334.1342143300185, -2364.9054364022295, -2438.504146270282, -2388.310876247856, -2443.281676920943, -2453.6599420129796, -2464.283997609752, -2302.9079897703514, -2499.9771233136325, -2256.978601183921, -2552.269525239936, -2383.8859695732135, -2290.616593298725, -2352.275861332363, -2395.8274744546434, -2402.9812391196238, -2340.696948966798, -2411.772553171627, -2504.5985855847757, -2388.2822305211566, -2449.2405387015483, -2359.840186515937, -2386.5763841703592, -2399.8345115766588, -2483.789714296602, -2383.227473181478, -2350.6384385576575, -2371.493409406175, -2320.411796515889, -2455.4507551364973, -2378.966760715304, -2399.64623314918, -2332.261545409782, -2306.1305658465085, -2311.3960439331995, -2379.0472049582327, -2343.9033873149215, -2347.2782990124947, -2649.175561927156, -2326.2868026272577, -2481.100963839954, -2472.382108531454, -2354.9157778609565, -2436.2588836521886, -2436.0510327632455, -2432.6655926516905], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.40372435404456, "mean_raw_obs_processing_ms": 23.085440910582026, "mean_inference_ms": 20.481671489230223, "mean_action_processing_ms": 0.1226554948661864}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 536000, "timers": {"sample_time_ms": 518143.877, "sample_throughput": 7.72, "learn_time_ms": 27920.143, "learn_throughput": 143.266, "update_time_ms": 3.919}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05876146626542322, "policy_loss": -0.016265909478534013, "vf_loss": 1104.2710800170898, "vf_explained_var": 0.8029290437698364, "kl": 0.010284172312822193, "entropy": 55.59510052204132, "entropy_coeff": 0.001}}, "num_steps_sampled": 536000, "num_steps_trained": 536000}, "done": false, "episodes_total": 536, "training_iteration": 134, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_17-50-30", "timestamp": 1618134630, "time_this_iter_s": 547.7295506000519, "time_total_s": 71974.28528475761, "pid": 16048, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7666.145133733749, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 39.83759590792839, "ram_util_percent": 89.26163682864451}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2256.978601183921, "episode_reward_min": -2649.175561927156, "episode_reward_mean": -2402.2870495036614, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2413.991077403896, -2394.6267170142287, -2557.4220182194767, -2607.2573430796597, -2384.6785900046298, -2306.4012027807935, -2319.0769944763542, -2396.1933329120066, -2409.8268208366717, -2337.0356988550006, -2334.1342143300185, -2364.9054364022295, -2438.504146270282, -2388.310876247856, -2443.281676920943, -2453.6599420129796, -2464.283997609752, -2302.9079897703514, -2499.9771233136325, -2256.978601183921, -2552.269525239936, -2383.8859695732135, -2290.616593298725, -2352.275861332363, -2395.8274744546434, -2402.9812391196238, -2340.696948966798, -2411.772553171627, -2504.5985855847757, -2388.2822305211566, -2449.2405387015483, -2359.840186515937, -2386.5763841703592, -2399.8345115766588, -2483.789714296602, -2383.227473181478, -2350.6384385576575, -2371.493409406175, -2320.411796515889, -2455.4507551364973, -2378.966760715304, -2399.64623314918, -2332.261545409782, -2306.1305658465085, -2311.3960439331995, -2379.0472049582327, -2343.9033873149215, -2347.2782990124947, -2649.175561927156, -2326.2868026272577, -2481.100963839954, -2472.382108531454, -2354.9157778609565, -2436.2588836521886, -2436.0510327632455, -2432.6655926516905, -2496.3649339196413, -2439.1455724017037, -2399.0246414917165, -2358.0570692467695], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.41789708408683, "mean_raw_obs_processing_ms": 22.987235221851154, "mean_inference_ms": 20.480736924068715, "mean_action_processing_ms": 0.12265195026347314}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 540000, "timers": {"sample_time_ms": 518119.17, "sample_throughput": 7.72, "learn_time_ms": 27943.551, "learn_throughput": 143.146, "update_time_ms": 3.904}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05765971154323779, "policy_loss": -0.012337088206550106, "vf_loss": 704.5804204940796, "vf_explained_var": 0.8782581090927124, "kl": 0.014395416103070602, "entropy": 55.247507095336914, "entropy_coeff": 0.001}}, "num_steps_sampled": 540000, "num_steps_trained": 540000}, "done": false, "episodes_total": 540, "training_iteration": 135, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_17-59-35", "timestamp": 1618135175, "time_this_iter_s": 545.550455570221, "time_total_s": 72519.83574032784, "pid": 16048, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8211.69558930397, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 39.88753213367609, "ram_util_percent": 89.41131105398456}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2256.978601183921, "episode_reward_min": -2649.175561927156, "episode_reward_mean": -2402.226693180913, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2482.4764255775335, -2388.174131066448, -2364.918589904125, -2369.7162468106258, -2384.6785900046298, -2306.4012027807935, -2319.0769944763542, -2396.1933329120066, -2409.8268208366717, -2337.0356988550006, -2334.1342143300185, -2364.9054364022295, -2438.504146270282, -2388.310876247856, -2443.281676920943, -2453.6599420129796, -2464.283997609752, -2302.9079897703514, -2499.9771233136325, -2256.978601183921, -2552.269525239936, -2383.8859695732135, -2290.616593298725, -2352.275861332363, -2395.8274744546434, -2402.9812391196238, -2340.696948966798, -2411.772553171627, -2504.5985855847757, -2388.2822305211566, -2449.2405387015483, -2359.840186515937, -2386.5763841703592, -2399.8345115766588, -2483.789714296602, -2383.227473181478, -2350.6384385576575, -2371.493409406175, -2320.411796515889, -2455.4507551364973, -2378.966760715304, -2399.64623314918, -2332.261545409782, -2306.1305658465085, -2311.3960439331995, -2379.0472049582327, -2343.9033873149215, -2347.2782990124947, -2649.175561927156, -2326.2868026272577, -2481.100963839954, -2472.382108531454, -2354.9157778609565, -2436.2588836521886, -2436.0510327632455, -2432.6655926516905, -2496.3649339196413, -2439.1455724017037, -2399.0246414917165, -2358.0570692467695, -2413.991077403896, -2394.6267170142287, -2557.4220182194767, -2607.2573430796597], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.42713675696965, "mean_raw_obs_processing_ms": 22.907834432423442, "mean_inference_ms": 20.4794226204873, "mean_action_processing_ms": 0.12264675432635161}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 544000, "timers": {"sample_time_ms": 518041.841, "sample_throughput": 7.721, "learn_time_ms": 27977.269, "learn_throughput": 142.973, "update_time_ms": 3.896}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05913151250570081, "policy_loss": -0.015199614863377064, "vf_loss": 958.4383850097656, "vf_explained_var": 0.8253623247146606, "kl": 0.009608382591977715, "entropy": 55.437957763671875, "entropy_coeff": 0.001}}, "num_steps_sampled": 544000, "num_steps_trained": 544000}, "done": false, "episodes_total": 544, "training_iteration": 136, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_18-08-43", "timestamp": 1618135723, "time_this_iter_s": 547.2039167881012, "time_total_s": 73067.03965711594, "pid": 16048, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8758.899506092072, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 39.82765685019206, "ram_util_percent": 89.92612035851472}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2256.978601183921, "episode_reward_min": -2649.175561927156, "episode_reward_mean": -2402.086525381393, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2378.130891764453, -2392.488857487042, -2385.1431229284567, -2443.612490176308, -2384.6785900046298, -2306.4012027807935, -2319.0769944763542, -2396.1933329120066, -2409.8268208366717, -2337.0356988550006, -2334.1342143300185, -2364.9054364022295, -2438.504146270282, -2388.310876247856, -2443.281676920943, -2453.6599420129796, -2464.283997609752, -2302.9079897703514, -2499.9771233136325, -2256.978601183921, -2552.269525239936, -2383.8859695732135, -2290.616593298725, -2352.275861332363, -2395.8274744546434, -2402.9812391196238, -2340.696948966798, -2411.772553171627, -2504.5985855847757, -2388.2822305211566, -2449.2405387015483, -2359.840186515937, -2386.5763841703592, -2399.8345115766588, -2483.789714296602, -2383.227473181478, -2350.6384385576575, -2371.493409406175, -2320.411796515889, -2455.4507551364973, -2378.966760715304, -2399.64623314918, -2332.261545409782, -2306.1305658465085, -2311.3960439331995, -2379.0472049582327, -2343.9033873149215, -2347.2782990124947, -2649.175561927156, -2326.2868026272577, -2481.100963839954, -2472.382108531454, -2354.9157778609565, -2436.2588836521886, -2436.0510327632455, -2432.6655926516905, -2496.3649339196413, -2439.1455724017037, -2399.0246414917165, -2358.0570692467695, -2413.991077403896, -2394.6267170142287, -2557.4220182194767, -2607.2573430796597, -2482.4764255775335, -2388.174131066448, -2364.918589904125, -2369.7162468106258], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.43529230851357, "mean_raw_obs_processing_ms": 22.84943576821362, "mean_inference_ms": 20.478154851005634, "mean_action_processing_ms": 0.12264204253233182}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 548000, "timers": {"sample_time_ms": 518881.747, "sample_throughput": 7.709, "learn_time_ms": 28022.12, "learn_throughput": 142.744, "update_time_ms": 3.854}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05465415393700823, "policy_loss": -0.009185531758703291, "vf_loss": 788.3676309585571, "vf_explained_var": 0.8386699557304382, "kl": 0.010314613580703735, "entropy": 55.41521894931793, "entropy_coeff": 0.001}}, "num_steps_sampled": 548000, "num_steps_trained": 548000}, "done": false, "episodes_total": 548, "training_iteration": 137, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_18-17-57", "timestamp": 1618136277, "time_this_iter_s": 554.4766879081726, "time_total_s": 73621.51634502411, "pid": 16048, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9313.376194000244, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 39.561820480404556, "ram_util_percent": 90.64020227560052}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2256.978601183921, "episode_reward_min": -2649.175561927156, "episode_reward_mean": -2403.9750840260854, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2358.3989322258612, -2520.8079228392094, -2472.5346640898474, -2392.580804788529, -2384.6785900046298, -2306.4012027807935, -2319.0769944763542, -2396.1933329120066, -2409.8268208366717, -2337.0356988550006, -2334.1342143300185, -2364.9054364022295, -2438.504146270282, -2388.310876247856, -2443.281676920943, -2453.6599420129796, -2464.283997609752, -2302.9079897703514, -2499.9771233136325, -2256.978601183921, -2552.269525239936, -2383.8859695732135, -2290.616593298725, -2352.275861332363, -2395.8274744546434, -2402.9812391196238, -2340.696948966798, -2411.772553171627, -2504.5985855847757, -2388.2822305211566, -2449.2405387015483, -2359.840186515937, -2386.5763841703592, -2399.8345115766588, -2483.789714296602, -2383.227473181478, -2350.6384385576575, -2371.493409406175, -2320.411796515889, -2455.4507551364973, -2378.966760715304, -2399.64623314918, -2332.261545409782, -2306.1305658465085, -2311.3960439331995, -2379.0472049582327, -2343.9033873149215, -2347.2782990124947, -2649.175561927156, -2326.2868026272577, -2481.100963839954, -2472.382108531454, -2354.9157778609565, -2436.2588836521886, -2436.0510327632455, -2432.6655926516905, -2496.3649339196413, -2439.1455724017037, -2399.0246414917165, -2358.0570692467695, -2413.991077403896, -2394.6267170142287, -2557.4220182194767, -2607.2573430796597, -2482.4764255775335, -2388.174131066448, -2364.918589904125, -2369.7162468106258, -2378.130891764453, -2392.488857487042, -2385.1431229284567, -2443.612490176308], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.44212031158713, "mean_raw_obs_processing_ms": 22.815233116177545, "mean_inference_ms": 20.479170328817577, "mean_action_processing_ms": 0.12263921902754202}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 552000, "timers": {"sample_time_ms": 520114.725, "sample_throughput": 7.691, "learn_time_ms": 28212.659, "learn_throughput": 141.78, "update_time_ms": 3.859}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.061746789317112416, "policy_loss": -0.016061884321970865, "vf_loss": 756.9663214683533, "vf_explained_var": 0.8471992015838623, "kl": 0.009929449675837532, "entropy": 55.24045658111572, "entropy_coeff": 0.001}}, "num_steps_sampled": 552000, "num_steps_trained": 552000}, "done": false, "episodes_total": 552, "training_iteration": 138, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_18-27-21", "timestamp": 1618136841, "time_this_iter_s": 563.1170303821564, "time_total_s": 74184.63337540627, "pid": 16048, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9876.4932243824, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 39.26828963795256, "ram_util_percent": 91.08476903870161}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2256.978601183921, "episode_reward_min": -2649.175561927156, "episode_reward_mean": -2405.609318866638, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2405.1996015160303, -2450.062358076617, -2471.8948629988145, -2412.945361394875, -2384.6785900046298, -2306.4012027807935, -2319.0769944763542, -2396.1933329120066, -2409.8268208366717, -2337.0356988550006, -2334.1342143300185, -2364.9054364022295, -2438.504146270282, -2388.310876247856, -2443.281676920943, -2453.6599420129796, -2464.283997609752, -2302.9079897703514, -2499.9771233136325, -2256.978601183921, -2552.269525239936, -2383.8859695732135, -2290.616593298725, -2352.275861332363, -2395.8274744546434, -2402.9812391196238, -2340.696948966798, -2411.772553171627, -2504.5985855847757, -2388.2822305211566, -2449.2405387015483, -2359.840186515937, -2386.5763841703592, -2399.8345115766588, -2483.789714296602, -2383.227473181478, -2350.6384385576575, -2371.493409406175, -2320.411796515889, -2455.4507551364973, -2378.966760715304, -2399.64623314918, -2332.261545409782, -2306.1305658465085, -2311.3960439331995, -2379.0472049582327, -2343.9033873149215, -2347.2782990124947, -2649.175561927156, -2326.2868026272577, -2481.100963839954, -2472.382108531454, -2354.9157778609565, -2436.2588836521886, -2436.0510327632455, -2432.6655926516905, -2496.3649339196413, -2439.1455724017037, -2399.0246414917165, -2358.0570692467695, -2413.991077403896, -2394.6267170142287, -2557.4220182194767, -2607.2573430796597, -2482.4764255775335, -2388.174131066448, -2364.918589904125, -2369.7162468106258, -2378.130891764453, -2392.488857487042, -2385.1431229284567, -2443.612490176308, -2358.3989322258612, -2520.8079228392094, -2472.5346640898474, -2392.580804788529], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.4499186091458, "mean_raw_obs_processing_ms": 22.80021547099514, "mean_inference_ms": 20.48224390826204, "mean_action_processing_ms": 0.1226379884207294}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 556000, "timers": {"sample_time_ms": 521853.713, "sample_throughput": 7.665, "learn_time_ms": 28540.085, "learn_throughput": 140.154, "update_time_ms": 3.817}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06180939346086234, "policy_loss": -0.018074679072014987, "vf_loss": 836.8674545288086, "vf_explained_var": 0.8412990570068359, "kl": 0.0142031995637808, "entropy": 54.94402599334717, "entropy_coeff": 0.001}}, "num_steps_sampled": 556000, "num_steps_trained": 556000}, "done": false, "episodes_total": 556, "training_iteration": 139, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_18-36-47", "timestamp": 1618137407, "time_this_iter_s": 565.832168340683, "time_total_s": 74750.46554374695, "pid": 16048, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10442.325392723083, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 39.19133663366336, "ram_util_percent": 91.9168316831683}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2256.978601183921, "episode_reward_min": -2649.175561927156, "episode_reward_mean": -2406.462849244383, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2318.8364944237937, -2459.0121773438614, -2473.6556435153875, -2439.2153904031215, -2384.6785900046298, -2306.4012027807935, -2319.0769944763542, -2396.1933329120066, -2409.8268208366717, -2337.0356988550006, -2334.1342143300185, -2364.9054364022295, -2438.504146270282, -2388.310876247856, -2443.281676920943, -2453.6599420129796, -2464.283997609752, -2302.9079897703514, -2499.9771233136325, -2256.978601183921, -2552.269525239936, -2383.8859695732135, -2290.616593298725, -2352.275861332363, -2395.8274744546434, -2402.9812391196238, -2340.696948966798, -2411.772553171627, -2504.5985855847757, -2388.2822305211566, -2449.2405387015483, -2359.840186515937, -2386.5763841703592, -2399.8345115766588, -2483.789714296602, -2383.227473181478, -2350.6384385576575, -2371.493409406175, -2320.411796515889, -2455.4507551364973, -2378.966760715304, -2399.64623314918, -2332.261545409782, -2306.1305658465085, -2311.3960439331995, -2379.0472049582327, -2343.9033873149215, -2347.2782990124947, -2649.175561927156, -2326.2868026272577, -2481.100963839954, -2472.382108531454, -2354.9157778609565, -2436.2588836521886, -2436.0510327632455, -2432.6655926516905, -2496.3649339196413, -2439.1455724017037, -2399.0246414917165, -2358.0570692467695, -2413.991077403896, -2394.6267170142287, -2557.4220182194767, -2607.2573430796597, -2482.4764255775335, -2388.174131066448, -2364.918589904125, -2369.7162468106258, -2378.130891764453, -2392.488857487042, -2385.1431229284567, -2443.612490176308, -2358.3989322258612, -2520.8079228392094, -2472.5346640898474, -2392.580804788529, -2405.1996015160303, -2450.062358076617, -2471.8948629988145, -2412.945361394875], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.4548633598638, "mean_raw_obs_processing_ms": 22.807347528289522, "mean_inference_ms": 20.487216036687308, "mean_action_processing_ms": 0.12263632978521151}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 560000, "timers": {"sample_time_ms": 523729.883, "sample_throughput": 7.638, "learn_time_ms": 28846.325, "learn_throughput": 138.666, "update_time_ms": 3.813}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05323606333695352, "policy_loss": -0.009869699279079214, "vf_loss": 953.9689998626709, "vf_explained_var": 0.8257664442062378, "kl": 0.01054567686514929, "entropy": 55.015186190605164, "entropy_coeff": 0.001}}, "num_steps_sampled": 560000, "num_steps_trained": 560000}, "done": false, "episodes_total": 560, "training_iteration": 140, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_18-46-17", "timestamp": 1618137977, "time_this_iter_s": 569.3065257072449, "time_total_s": 75319.7720694542, "pid": 16048, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11011.631918430328, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 38.95535055350553, "ram_util_percent": 92.02054120541207}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2256.978601183921, "episode_reward_min": -2649.175561927156, "episode_reward_mean": -2403.4868556128226, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2318.5816693731, -2432.276887923499, -2279.2918156671863, -2345.7175589626722, -2384.6785900046298, -2306.4012027807935, -2319.0769944763542, -2396.1933329120066, -2409.8268208366717, -2337.0356988550006, -2334.1342143300185, -2364.9054364022295, -2438.504146270282, -2388.310876247856, -2443.281676920943, -2453.6599420129796, -2464.283997609752, -2302.9079897703514, -2499.9771233136325, -2256.978601183921, -2552.269525239936, -2383.8859695732135, -2290.616593298725, -2352.275861332363, -2395.8274744546434, -2402.9812391196238, -2340.696948966798, -2411.772553171627, -2504.5985855847757, -2388.2822305211566, -2449.2405387015483, -2359.840186515937, -2386.5763841703592, -2399.8345115766588, -2483.789714296602, -2383.227473181478, -2350.6384385576575, -2371.493409406175, -2320.411796515889, -2455.4507551364973, -2378.966760715304, -2399.64623314918, -2332.261545409782, -2306.1305658465085, -2311.3960439331995, -2379.0472049582327, -2343.9033873149215, -2347.2782990124947, -2649.175561927156, -2326.2868026272577, -2481.100963839954, -2472.382108531454, -2354.9157778609565, -2436.2588836521886, -2436.0510327632455, -2432.6655926516905, -2496.3649339196413, -2439.1455724017037, -2399.0246414917165, -2358.0570692467695, -2413.991077403896, -2394.6267170142287, -2557.4220182194767, -2607.2573430796597, -2482.4764255775335, -2388.174131066448, -2364.918589904125, -2369.7162468106258, -2378.130891764453, -2392.488857487042, -2385.1431229284567, -2443.612490176308, -2358.3989322258612, -2520.8079228392094, -2472.5346640898474, -2392.580804788529, -2405.1996015160303, -2450.062358076617, -2471.8948629988145, -2412.945361394875, -2318.8364944237937, -2459.0121773438614, -2473.6556435153875, -2439.2153904031215], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.46446825581586, "mean_raw_obs_processing_ms": 22.863437199992354, "mean_inference_ms": 20.49401165566535, "mean_action_processing_ms": 0.1226356736324348}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 564000, "timers": {"sample_time_ms": 529156.403, "sample_throughput": 7.559, "learn_time_ms": 29160.316, "learn_throughput": 137.173, "update_time_ms": 3.737}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.054972475627437234, "policy_loss": -0.015725597564596683, "vf_loss": 1344.4668788909912, "vf_explained_var": 0.7235907316207886, "kl": 0.0128947772027459, "entropy": 55.27050244808197, "entropy_coeff": 0.001}}, "num_steps_sampled": 564000, "num_steps_trained": 564000}, "done": false, "episodes_total": 564, "training_iteration": 141, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-11_18-56-22", "timestamp": 1618138582, "time_this_iter_s": 604.4142036437988, "time_total_s": 75924.18627309799, "pid": 16048, "hostname": "male-Xuan-mai", "node_ip": "192.168.3.16", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 11616.046122074127, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 38.48512696493349, "ram_util_percent": 92.67170495767836}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2258.0079884674424, "episode_reward_min": -2442.7792196431997, "episode_reward_mean": -2337.727473764541, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2258.0079884674424, -2442.7792196431997, -2279.7072514715605, -2370.4154354759635], "episode_lengths": [1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 188.89966826031412, "mean_raw_obs_processing_ms": 22.321577074526548, "mean_inference_ms": 17.126738995328537, "mean_action_processing_ms": 0.107767044574484}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 564000, "timers": {"sample_time_ms": 458377.671, "sample_throughput": 8.726, "learn_time_ms": 21846.881, "learn_throughput": 183.093, "update_time_ms": 9.508}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.0667508410406299, "policy_loss": -0.021295233455020934, "vf_loss": 702.6615571975708, "vf_explained_var": 0.8604379892349243, "kl": 0.013906410604249686, "entropy": 55.263500452041626, "entropy_coeff": 0.001}}, "num_steps_sampled": 564000, "num_steps_trained": 564000}, "done": false, "episodes_total": 564, "training_iteration": 141, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-12_20-41-45", "timestamp": 1618231305, "time_this_iter_s": 480.2503390312195, "time_total_s": 75800.02240848541, "pid": 63732, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.225.249", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 480.2503390312195, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 28.500145772594756, "ram_util_percent": 86.74198250728863}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2258.0079884674424, "episode_reward_min": -2442.7792196431997, "episode_reward_mean": -2353.8622944029203, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2293.9247197344725, -2402.20979560469, -2401.175506321296, -2382.6784385047367, -2258.0079884674424, -2442.7792196431997, -2279.7072514715605, -2370.4154354759635], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 189.30623272322254, "mean_raw_obs_processing_ms": 22.350390727923113, "mean_inference_ms": 17.155751746111555, "mean_action_processing_ms": 0.10785392665689848}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 568000, "timers": {"sample_time_ms": 460154.352, "sample_throughput": 8.693, "learn_time_ms": 21632.711, "learn_throughput": 184.905, "update_time_ms": 6.782}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.0614812271669507, "policy_loss": -0.020647861645556986, "vf_loss": 1229.164894104004, "vf_explained_var": 0.7336881160736084, "kl": 0.010164530569454655, "entropy": 55.15791964530945, "entropy_coeff": 0.001}}, "num_steps_sampled": 568000, "num_steps_trained": 568000}, "done": false, "episodes_total": 568, "training_iteration": 142, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-12_20-49-48", "timestamp": 1618231788, "time_this_iter_s": 483.367671251297, "time_total_s": 76283.39007973671, "pid": 63732, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.225.249", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 963.6180102825165, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 28.490711175616834, "ram_util_percent": 86.844557329463}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2303.5265269490887, "episode_reward_min": -2383.879400369633, "episode_reward_mean": -2348.387765420808, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2303.5265269490887, -2348.7129016805734, -2383.879400369633, -2357.432232683938], "episode_lengths": [1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 217.30057100603904, "mean_raw_obs_processing_ms": 19.99200516376181, "mean_inference_ms": 19.14932244065879, "mean_action_processing_ms": 0.12135994190099775}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 564000, "timers": {"sample_time_ms": 514434.318, "sample_throughput": 7.776, "learn_time_ms": 30619.388, "learn_throughput": 130.636, "update_time_ms": 9.995}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05461793445283547, "policy_loss": -0.009365055419038981, "vf_loss": 733.397707939148, "vf_explained_var": 0.8567813634872437, "kl": 0.012075720209395513, "entropy": 55.00199627876282, "entropy_coeff": 0.001}}, "num_steps_sampled": 564000, "num_steps_trained": 564000}, "done": false, "episodes_total": 564, "training_iteration": 141, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_09-13-30", "timestamp": 1618276410, "time_this_iter_s": 545.0792410373688, "time_total_s": 75864.85131049156, "pid": 5634, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 545.0792410373688, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 33.38316195372751, "ram_util_percent": 85.75398457583546}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2303.5265269490887, "episode_reward_min": -2415.116926509436, "episode_reward_mean": -2361.9242689251564, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2326.2557313050197, -2374.072384905291, -2415.116926509436, -2386.398046998272, -2303.5265269490887, -2348.7129016805734, -2383.879400369633, -2357.432232683938], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 216.5218401999757, "mean_raw_obs_processing_ms": 19.72399358756462, "mean_inference_ms": 19.112460523278852, "mean_action_processing_ms": 0.1212803306090431}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 568000, "timers": {"sample_time_ms": 510381.937, "sample_throughput": 7.837, "learn_time_ms": 28624.624, "learn_throughput": 139.74, "update_time_ms": 9.928}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05738814047072083, "policy_loss": -0.012153022893471643, "vf_loss": 782.9213933944702, "vf_explained_var": 0.8415521383285522, "kl": 0.0095252649334725, "entropy": 54.96938443183899, "entropy_coeff": 0.001}}, "num_steps_sampled": 568000, "num_steps_trained": 568000}, "done": false, "episodes_total": 568, "training_iteration": 142, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_09-22-23", "timestamp": 1618276943, "time_this_iter_s": 532.9854075908661, "time_total_s": 76397.83671808243, "pid": 5634, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1078.0646486282349, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 32.03784494086728, "ram_util_percent": 89.511432325887}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2303.5265269490887, "episode_reward_min": -2436.1665298824505, "episode_reward_mean": -2357.9548998518453, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2337.229320032517, -2313.5968134899467, -2313.0719834159786, -2436.1665298824505, -2303.5265269490887, -2348.7129016805734, -2383.879400369633, -2357.432232683938, -2326.2557313050197, -2374.072384905291, -2415.116926509436, -2386.398046998272], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.0656728489482, "mean_raw_obs_processing_ms": 19.493180245589283, "mean_inference_ms": 18.94068341067415, "mean_action_processing_ms": 0.1203374543069697}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 572000, "timers": {"sample_time_ms": 495561.152, "sample_throughput": 8.072, "learn_time_ms": 27122.419, "learn_throughput": 147.479, "update_time_ms": 7.817}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05521887796930969, "policy_loss": -0.014294886030256748, "vf_loss": 1144.6969146728516, "vf_explained_var": 0.763725757598877, "kl": 0.01197294276789762, "entropy": 54.76554763317108, "entropy_coeff": 0.001}}, "num_steps_sampled": 572000, "num_steps_trained": 572000}, "done": false, "episodes_total": 572, "training_iteration": 143, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_09-30-34", "timestamp": 1618277434, "time_this_iter_s": 490.04640316963196, "time_total_s": 76887.88312125206, "pid": 5634, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1568.1110517978668, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 28.500572246065804, "ram_util_percent": 83.93719599427753}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2303.5265269490887, "episode_reward_min": -2436.1665298824505, "episode_reward_mean": -2361.578813169057, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2399.494712481843, -2396.6658521023246, -2381.1134447761274, -2312.5282031224688, -2303.5265269490887, -2348.7129016805734, -2383.879400369633, -2357.432232683938, -2326.2557313050197, -2374.072384905291, -2415.116926509436, -2386.398046998272, -2337.229320032517, -2313.5968134899467, -2313.0719834159786, -2436.1665298824505], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 211.9515750043178, "mean_raw_obs_processing_ms": 19.340176621035397, "mean_inference_ms": 18.77050947525845, "mean_action_processing_ms": 0.11941146169976147}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 576000, "timers": {"sample_time_ms": 487269.631, "sample_throughput": 8.209, "learn_time_ms": 26310.94, "learn_throughput": 152.028, "update_time_ms": 6.755}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05558820383157581, "policy_loss": -0.010373273718869314, "vf_loss": 698.4150199890137, "vf_explained_var": 0.8626111745834351, "kl": 0.012331320060184225, "entropy": 54.665343284606934, "entropy_coeff": 0.001}}, "num_steps_sampled": 576000, "num_steps_trained": 576000}, "done": false, "episodes_total": 576, "training_iteration": 144, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_09-38-40", "timestamp": 1618277920, "time_this_iter_s": 486.28473567962646, "time_total_s": 77374.16785693169, "pid": 5634, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2054.3957874774933, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 28.097982708933717, "ram_util_percent": 83.7742074927954}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2268.1177958401636, "episode_reward_min": -2590.377956753478, "episode_reward_mean": -2371.843456686328, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2301.6524423351034, -2268.1177958401636, -2491.459928092909, -2590.377956753478, -2303.5265269490887, -2348.7129016805734, -2383.879400369633, -2357.432232683938, -2326.2557313050197, -2374.072384905291, -2415.116926509436, -2386.398046998272, -2337.229320032517, -2313.5968134899467, -2313.0719834159786, -2436.1665298824505, -2399.494712481843, -2396.6658521023246, -2381.1134447761274, -2312.5282031224688], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 210.20867535968927, "mean_raw_obs_processing_ms": 19.22267829194548, "mean_inference_ms": 18.62397421268841, "mean_action_processing_ms": 0.11862133779646893}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 580000, "timers": {"sample_time_ms": 481679.225, "sample_throughput": 8.304, "learn_time_ms": 25695.838, "learn_throughput": 155.667, "update_time_ms": 6.168}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06673841853626072, "policy_loss": -0.024378589747357182, "vf_loss": 1048.0212306976318, "vf_explained_var": 0.824702262878418, "kl": 0.010629344906192273, "entropy": 54.96590518951416, "entropy_coeff": 0.001}}, "num_steps_sampled": 580000, "num_steps_trained": 580000}, "done": false, "episodes_total": 580, "training_iteration": 145, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_09-46-42", "timestamp": 1618278402, "time_this_iter_s": 482.5622045993805, "time_total_s": 77856.73006153107, "pid": 5634, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2536.957992076874, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 27.732558139534884, "ram_util_percent": 82.87209302325581}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2268.1177958401636, "episode_reward_min": -2590.377956753478, "episode_reward_mean": -2383.6178150019273, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2415.182838618385, -2450.0541070327754, -2499.925663211128, -2404.7958174574087, -2303.5265269490887, -2348.7129016805734, -2383.879400369633, -2357.432232683938, -2326.2557313050197, -2374.072384905291, -2415.116926509436, -2386.398046998272, -2337.229320032517, -2313.5968134899467, -2313.0719834159786, -2436.1665298824505, -2399.494712481843, -2396.6658521023246, -2381.1134447761274, -2312.5282031224688, -2301.6524423351034, -2268.1177958401636, -2491.459928092909, -2590.377956753478], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 208.91307618380822, "mean_raw_obs_processing_ms": 19.145041229265967, "mean_inference_ms": 18.511651364492188, "mean_action_processing_ms": 0.11801782498839945}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 584000, "timers": {"sample_time_ms": 479986.71, "sample_throughput": 8.334, "learn_time_ms": 24998.25, "learn_throughput": 160.011, "update_time_ms": 5.764}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06122482434147969, "policy_loss": -0.02037295009358786, "vf_loss": 1140.6585731506348, "vf_explained_var": 0.7821886539459229, "kl": 0.012819546303944662, "entropy": 54.8223694562912, "entropy_coeff": 0.001}}, "num_steps_sampled": 584000, "num_steps_trained": 584000}, "done": false, "episodes_total": 584, "training_iteration": 146, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_09-54-56", "timestamp": 1618278896, "time_this_iter_s": 493.0527629852295, "time_total_s": 78349.7828245163, "pid": 5634, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3030.0107550621033, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 29.158748221906116, "ram_util_percent": 85.93371266002845}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2249.034510908033, "episode_reward_min": -2590.377956753478, "episode_reward_mean": -2372.8513051003943, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2249.034510908033, -2349.9080708526644, -2325.3926478108115, -2308.6737531932763, -2303.5265269490887, -2348.7129016805734, -2383.879400369633, -2357.432232683938, -2326.2557313050197, -2374.072384905291, -2415.116926509436, -2386.398046998272, -2337.229320032517, -2313.5968134899467, -2313.0719834159786, -2436.1665298824505, -2399.494712481843, -2396.6658521023246, -2381.1134447761274, -2312.5282031224688, -2301.6524423351034, -2268.1177958401636, -2491.459928092909, -2590.377956753478, -2415.182838618385, -2450.0541070327754, -2499.925663211128, -2404.7958174574087], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 207.91909489590554, "mean_raw_obs_processing_ms": 19.08308618424707, "mean_inference_ms": 18.42174298510879, "mean_action_processing_ms": 0.11752896096211803}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 588000, "timers": {"sample_time_ms": 478765.418, "sample_throughput": 8.355, "learn_time_ms": 25863.154, "learn_throughput": 154.66, "update_time_ms": 5.537}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06230040855007246, "policy_loss": -0.01859300388605334, "vf_loss": 920.4191989898682, "vf_explained_var": 0.8040125370025635, "kl": 0.010341093176975846, "entropy": 54.97981286048889, "entropy_coeff": 0.001}}, "num_steps_sampled": 588000, "num_steps_trained": 588000}, "done": false, "episodes_total": 588, "training_iteration": 147, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_10-03-18", "timestamp": 1618279398, "time_this_iter_s": 502.50514960289, "time_total_s": 78852.28797411919, "pid": 5634, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3532.5159046649933, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 29.687447698744773, "ram_util_percent": 85.39274755927477}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2172.844496859012, "episode_reward_min": -2590.377956753478, "episode_reward_mean": -2363.1477776513057, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2424.921566476076, -2332.253470825914, -2250.872807869734, -2172.844496859012, -2303.5265269490887, -2348.7129016805734, -2383.879400369633, -2357.432232683938, -2326.2557313050197, -2374.072384905291, -2415.116926509436, -2386.398046998272, -2337.229320032517, -2313.5968134899467, -2313.0719834159786, -2436.1665298824505, -2399.494712481843, -2396.6658521023246, -2381.1134447761274, -2312.5282031224688, -2301.6524423351034, -2268.1177958401636, -2491.459928092909, -2590.377956753478, -2415.182838618385, -2450.0541070327754, -2499.925663211128, -2404.7958174574087, -2249.034510908033, -2349.9080708526644, -2325.3926478108115, -2308.6737531932763], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 207.57501282020317, "mean_raw_obs_processing_ms": 19.09291872360263, "mean_inference_ms": 18.38689608367539, "mean_action_processing_ms": 0.1173330210583987}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 592000, "timers": {"sample_time_ms": 486599.634, "sample_throughput": 8.22, "learn_time_ms": 26995.527, "learn_throughput": 148.173, "update_time_ms": 6.279}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05528050853172317, "policy_loss": -0.013711400097236037, "vf_loss": 1137.1519756317139, "vf_explained_var": 0.7690186500549316, "kl": 0.010459076598635875, "entropy": 55.03244364261627, "entropy_coeff": 0.001}}, "num_steps_sampled": 592000, "num_steps_trained": 592000}, "done": false, "episodes_total": 592, "training_iteration": 148, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_10-12-55", "timestamp": 1618279975, "time_this_iter_s": 576.3915259838104, "time_total_s": 79428.679500103, "pid": 5634, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4108.907430648804, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 36.309720534629406, "ram_util_percent": 86.29477521263668}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2172.844496859012, "episode_reward_min": -2590.377956753478, "episode_reward_mean": -2367.3902566782967, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2413.5124251592733, -2377.110382302049, -2376.179848692705, -2438.5176994228596, -2303.5265269490887, -2348.7129016805734, -2383.879400369633, -2357.432232683938, -2326.2557313050197, -2374.072384905291, -2415.116926509436, -2386.398046998272, -2337.229320032517, -2313.5968134899467, -2313.0719834159786, -2436.1665298824505, -2399.494712481843, -2396.6658521023246, -2381.1134447761274, -2312.5282031224688, -2301.6524423351034, -2268.1177958401636, -2491.459928092909, -2590.377956753478, -2415.182838618385, -2450.0541070327754, -2499.925663211128, -2404.7958174574087, -2249.034510908033, -2349.9080708526644, -2325.3926478108115, -2308.6737531932763, -2424.921566476076, -2332.253470825914, -2250.872807869734, -2172.844496859012], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 208.01025039100165, "mean_raw_obs_processing_ms": 19.1537187897669, "mean_inference_ms": 18.416150038510082, "mean_action_processing_ms": 0.11746128371342063}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 596000, "timers": {"sample_time_ms": 501205.378, "sample_throughput": 7.981, "learn_time_ms": 27904.533, "learn_throughput": 143.346, "update_time_ms": 6.116}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05912029783939943, "policy_loss": -0.011942733195610344, "vf_loss": 518.5447735786438, "vf_explained_var": 0.895696759223938, "kl": 0.012423478648997843, "entropy": 54.84770357608795, "entropy_coeff": 0.001}}, "num_steps_sampled": 596000, "num_steps_trained": 596000}, "done": false, "episodes_total": 596, "training_iteration": 149, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_10-23-48", "timestamp": 1618280628, "time_this_iter_s": 653.2413392066956, "time_total_s": 80081.92083930969, "pid": 5634, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4762.148769855499, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 42.203969957081554, "ram_util_percent": 87.19774678111588}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2172.844496859012, "episode_reward_min": -2590.377956753478, "episode_reward_mean": -2369.5350462646766, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2368.5158299136588, -2403.408834512407, -2262.541021434538, -2520.886924307777, -2303.5265269490887, -2348.7129016805734, -2383.879400369633, -2357.432232683938, -2326.2557313050197, -2374.072384905291, -2415.116926509436, -2386.398046998272, -2337.229320032517, -2313.5968134899467, -2313.0719834159786, -2436.1665298824505, -2399.494712481843, -2396.6658521023246, -2381.1134447761274, -2312.5282031224688, -2301.6524423351034, -2268.1177958401636, -2491.459928092909, -2590.377956753478, -2415.182838618385, -2450.0541070327754, -2499.925663211128, -2404.7958174574087, -2249.034510908033, -2349.9080708526644, -2325.3926478108115, -2308.6737531932763, -2424.921566476076, -2332.253470825914, -2250.872807869734, -2172.844496859012, -2413.5124251592733, -2377.110382302049, -2376.179848692705, -2438.5176994228596], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 208.81830652120175, "mean_raw_obs_processing_ms": 19.230385578996493, "mean_inference_ms": 18.478055763073076, "mean_action_processing_ms": 0.11775357050258121}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 600000, "timers": {"sample_time_ms": 511840.306, "sample_throughput": 7.815, "learn_time_ms": 28478.317, "learn_throughput": 140.458, "update_time_ms": 5.956}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06689372175605968, "policy_loss": -0.021277943975292146, "vf_loss": 704.7104878425598, "vf_explained_var": 0.8701944947242737, "kl": 0.010652272583683953, "entropy": 54.79333567619324, "entropy_coeff": 0.001}}, "num_steps_sampled": 600000, "num_steps_trained": 600000}, "done": false, "episodes_total": 600, "training_iteration": 150, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_10-34-29", "timestamp": 1618281269, "time_this_iter_s": 641.214254617691, "time_total_s": 80723.13509392738, "pid": 5634, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5403.36302447319, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 41.03807439824946, "ram_util_percent": 85.93227571115975}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2172.844496859012, "episode_reward_min": -2590.377956753478, "episode_reward_mean": -2373.689977733699, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2318.9128875431807, -2586.3580003227453, -2292.077825964473, -2463.6084558653074, -2303.5265269490887, -2348.7129016805734, -2383.879400369633, -2357.432232683938, -2326.2557313050197, -2374.072384905291, -2415.116926509436, -2386.398046998272, -2337.229320032517, -2313.5968134899467, -2313.0719834159786, -2436.1665298824505, -2399.494712481843, -2396.6658521023246, -2381.1134447761274, -2312.5282031224688, -2301.6524423351034, -2268.1177958401636, -2491.459928092909, -2590.377956753478, -2415.182838618385, -2450.0541070327754, -2499.925663211128, -2404.7958174574087, -2249.034510908033, -2349.9080708526644, -2325.3926478108115, -2308.6737531932763, -2424.921566476076, -2332.253470825914, -2250.872807869734, -2172.844496859012, -2413.5124251592733, -2377.110382302049, -2376.179848692705, -2438.5176994228596, -2368.5158299136588, -2403.408834512407, -2262.541021434538, -2520.886924307777], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 209.81933498734244, "mean_raw_obs_processing_ms": 19.321083413742443, "mean_inference_ms": 18.55705376104943, "mean_action_processing_ms": 0.11813406544364097}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 604000, "timers": {"sample_time_ms": 521271.397, "sample_throughput": 7.674, "learn_time_ms": 28868.768, "learn_throughput": 138.558, "update_time_ms": 5.588}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05204221876920201, "policy_loss": -0.011732516752090305, "vf_loss": 1139.4779586791992, "vf_explained_var": 0.7586826682090759, "kl": 0.013765677198534831, "entropy": 54.457613587379456, "entropy_coeff": 0.001}}, "num_steps_sampled": 604000, "num_steps_trained": 604000}, "done": false, "episodes_total": 604, "training_iteration": 151, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_10-45-12", "timestamp": 1618281912, "time_this_iter_s": 643.2868616580963, "time_total_s": 81366.42195558548, "pid": 5634, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6046.649886131287, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 41.44411764705882, "ram_util_percent": 85.01328976034857}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2172.844496859012, "episode_reward_min": -2590.377956753478, "episode_reward_mean": -2376.1306389768542, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2582.110378482414, -2263.8973352940607, -2397.643584759822, -2368.260352069934, -2303.5265269490887, -2348.7129016805734, -2383.879400369633, -2357.432232683938, -2326.2557313050197, -2374.072384905291, -2415.116926509436, -2386.398046998272, -2337.229320032517, -2313.5968134899467, -2313.0719834159786, -2436.1665298824505, -2399.494712481843, -2396.6658521023246, -2381.1134447761274, -2312.5282031224688, -2301.6524423351034, -2268.1177958401636, -2491.459928092909, -2590.377956753478, -2415.182838618385, -2450.0541070327754, -2499.925663211128, -2404.7958174574087, -2249.034510908033, -2349.9080708526644, -2325.3926478108115, -2308.6737531932763, -2424.921566476076, -2332.253470825914, -2250.872807869734, -2172.844496859012, -2413.5124251592733, -2377.110382302049, -2376.179848692705, -2438.5176994228596, -2368.5158299136588, -2403.408834512407, -2262.541021434538, -2520.886924307777, -2318.9128875431807, -2586.3580003227453, -2292.077825964473, -2463.6084558653074], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 210.9423903794664, "mean_raw_obs_processing_ms": 19.415950576118828, "mean_inference_ms": 18.646312489308453, "mean_action_processing_ms": 0.11857145765336742}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 608000, "timers": {"sample_time_ms": 532223.575, "sample_throughput": 7.516, "learn_time_ms": 29605.117, "learn_throughput": 135.112, "update_time_ms": 5.092}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.04496900655794889, "policy_loss": -0.014415147190447897, "vf_loss": 2095.6743812561035, "vf_explained_var": 0.5792312622070312, "kl": 0.013688118400750682, "entropy": 54.24822270870209, "entropy_coeff": 0.001}}, "num_steps_sampled": 608000, "num_steps_trained": 608000}, "done": false, "episodes_total": 608, "training_iteration": 152, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_10-56-02", "timestamp": 1618282562, "time_this_iter_s": 649.8608918190002, "time_total_s": 82016.28284740448, "pid": 5634, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6696.510777950287, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 42.11920172599784, "ram_util_percent": 84.86278317152104}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2172.844496859012, "episode_reward_min": -2590.377956753478, "episode_reward_mean": -2376.4813573252404, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2438.7552678573093, -2429.83468362838, -2274.486885177803, -2379.683073360039, -2303.5265269490887, -2348.7129016805734, -2383.879400369633, -2357.432232683938, -2326.2557313050197, -2374.072384905291, -2415.116926509436, -2386.398046998272, -2337.229320032517, -2313.5968134899467, -2313.0719834159786, -2436.1665298824505, -2399.494712481843, -2396.6658521023246, -2381.1134447761274, -2312.5282031224688, -2301.6524423351034, -2268.1177958401636, -2491.459928092909, -2590.377956753478, -2415.182838618385, -2450.0541070327754, -2499.925663211128, -2404.7958174574087, -2249.034510908033, -2349.9080708526644, -2325.3926478108115, -2308.6737531932763, -2424.921566476076, -2332.253470825914, -2250.872807869734, -2172.844496859012, -2413.5124251592733, -2377.110382302049, -2376.179848692705, -2438.5176994228596, -2368.5158299136588, -2403.408834512407, -2262.541021434538, -2520.886924307777, -2318.9128875431807, -2586.3580003227453, -2292.077825964473, -2463.6084558653074, -2582.110378482414, -2263.8973352940607, -2397.643584759822, -2368.260352069934], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 212.1195729214726, "mean_raw_obs_processing_ms": 19.513157452952363, "mean_inference_ms": 18.74105264086468, "mean_action_processing_ms": 0.11903797158405327}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 612000, "timers": {"sample_time_ms": 547352.813, "sample_throughput": 7.308, "learn_time_ms": 30652.22, "learn_throughput": 130.496, "update_time_ms": 5.195}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05967460456304252, "policy_loss": -0.014982203370891511, "vf_loss": 749.3870010375977, "vf_explained_var": 0.849604606628418, "kl": 0.011402013115002774, "entropy": 54.4666702747345, "entropy_coeff": 0.001}}, "num_steps_sampled": 612000, "num_steps_trained": 612000}, "done": false, "episodes_total": 612, "training_iteration": 153, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_11-06-54", "timestamp": 1618283214, "time_this_iter_s": 651.8175065517426, "time_total_s": 82668.10035395622, "pid": 5634, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7348.328284502029, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 42.37139784946236, "ram_util_percent": 84.9459139784946}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2172.844496859012, "episode_reward_min": -2590.377956753478, "episode_reward_mean": -2374.083116665147, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2349.2457874889674, -2293.993545568578, -2322.9785846805944, -2405.406034597556, -2303.5265269490887, -2348.7129016805734, -2383.879400369633, -2357.432232683938, -2326.2557313050197, -2374.072384905291, -2415.116926509436, -2386.398046998272, -2337.229320032517, -2313.5968134899467, -2313.0719834159786, -2436.1665298824505, -2399.494712481843, -2396.6658521023246, -2381.1134447761274, -2312.5282031224688, -2301.6524423351034, -2268.1177958401636, -2491.459928092909, -2590.377956753478, -2415.182838618385, -2450.0541070327754, -2499.925663211128, -2404.7958174574087, -2249.034510908033, -2349.9080708526644, -2325.3926478108115, -2308.6737531932763, -2424.921566476076, -2332.253470825914, -2250.872807869734, -2172.844496859012, -2413.5124251592733, -2377.110382302049, -2376.179848692705, -2438.5176994228596, -2368.5158299136588, -2403.408834512407, -2262.541021434538, -2520.886924307777, -2318.9128875431807, -2586.3580003227453, -2292.077825964473, -2463.6084558653074, -2582.110378482414, -2263.8973352940607, -2397.643584759822, -2368.260352069934, -2438.7552678573093, -2429.83468362838, -2274.486885177803, -2379.683073360039], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 213.31935971992775, "mean_raw_obs_processing_ms": 19.60892293049348, "mean_inference_ms": 18.837898544096838, "mean_action_processing_ms": 0.11951707691496528}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 616000, "timers": {"sample_time_ms": 563250.777, "sample_throughput": 7.102, "learn_time_ms": 31644.934, "learn_throughput": 126.403, "update_time_ms": 5.457}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.051607158209662884, "policy_loss": -0.007676017179619521, "vf_loss": 702.1451425552368, "vf_explained_var": 0.8468197584152222, "kl": 0.017666827596258372, "entropy": 54.48595380783081, "entropy_coeff": 0.001}}, "num_steps_sampled": 616000, "num_steps_trained": 616000}, "done": false, "episodes_total": 616, "training_iteration": 154, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_11-17-49", "timestamp": 1618283869, "time_this_iter_s": 655.1917400360107, "time_total_s": 83323.29209399223, "pid": 5634, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8003.52002453804, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 42.375401069518716, "ram_util_percent": 84.52780748663102}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2172.844496859012, "episode_reward_min": -2623.8774859201767, "episode_reward_mean": -2380.593994543361, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2410.189135736145, -2393.552455485158, -2459.3660622119687, -2623.8774859201767, -2303.5265269490887, -2348.7129016805734, -2383.879400369633, -2357.432232683938, -2326.2557313050197, -2374.072384905291, -2415.116926509436, -2386.398046998272, -2337.229320032517, -2313.5968134899467, -2313.0719834159786, -2436.1665298824505, -2399.494712481843, -2396.6658521023246, -2381.1134447761274, -2312.5282031224688, -2301.6524423351034, -2268.1177958401636, -2491.459928092909, -2590.377956753478, -2415.182838618385, -2450.0541070327754, -2499.925663211128, -2404.7958174574087, -2249.034510908033, -2349.9080708526644, -2325.3926478108115, -2308.6737531932763, -2424.921566476076, -2332.253470825914, -2250.872807869734, -2172.844496859012, -2413.5124251592733, -2377.110382302049, -2376.179848692705, -2438.5176994228596, -2368.5158299136588, -2403.408834512407, -2262.541021434538, -2520.886924307777, -2318.9128875431807, -2586.3580003227453, -2292.077825964473, -2463.6084558653074, -2582.110378482414, -2263.8973352940607, -2397.643584759822, -2368.260352069934, -2438.7552678573093, -2429.83468362838, -2274.486885177803, -2379.683073360039, -2349.2457874889674, -2293.993545568578, -2322.9785846805944, -2405.406034597556], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.49522645151652, "mean_raw_obs_processing_ms": 19.701581594161187, "mean_inference_ms": 18.933215523106675, "mean_action_processing_ms": 0.11999224180582352}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 620000, "timers": {"sample_time_ms": 578619.754, "sample_throughput": 6.913, "learn_time_ms": 32730.202, "learn_throughput": 122.211, "update_time_ms": 5.475}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05791327489714604, "policy_loss": -0.015815364487934858, "vf_loss": 955.8628673553467, "vf_explained_var": 0.819216251373291, "kl": 0.012471303634811193, "entropy": 54.150798201560974, "entropy_coeff": 0.001}}, "num_steps_sampled": 620000, "num_steps_trained": 620000}, "done": false, "episodes_total": 620, "training_iteration": 155, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_11-28-36", "timestamp": 1618284516, "time_this_iter_s": 647.1120088100433, "time_total_s": 83970.40410280228, "pid": 5634, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8650.632033348083, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 41.77681473456121, "ram_util_percent": 84.30877573131094}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2172.844496859012, "episode_reward_min": -2623.8774859201767, "episode_reward_mean": -2382.7161539201707, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2429.1147724475672, -2379.2968286752734, -2458.164425611106, -2391.618151555335, -2303.5265269490887, -2348.7129016805734, -2383.879400369633, -2357.432232683938, -2326.2557313050197, -2374.072384905291, -2415.116926509436, -2386.398046998272, -2337.229320032517, -2313.5968134899467, -2313.0719834159786, -2436.1665298824505, -2399.494712481843, -2396.6658521023246, -2381.1134447761274, -2312.5282031224688, -2301.6524423351034, -2268.1177958401636, -2491.459928092909, -2590.377956753478, -2415.182838618385, -2450.0541070327754, -2499.925663211128, -2404.7958174574087, -2249.034510908033, -2349.9080708526644, -2325.3926478108115, -2308.6737531932763, -2424.921566476076, -2332.253470825914, -2250.872807869734, -2172.844496859012, -2413.5124251592733, -2377.110382302049, -2376.179848692705, -2438.5176994228596, -2368.5158299136588, -2403.408834512407, -2262.541021434538, -2520.886924307777, -2318.9128875431807, -2586.3580003227453, -2292.077825964473, -2463.6084558653074, -2582.110378482414, -2263.8973352940607, -2397.643584759822, -2368.260352069934, -2438.7552678573093, -2429.83468362838, -2274.486885177803, -2379.683073360039, -2349.2457874889674, -2293.993545568578, -2322.9785846805944, -2405.406034597556, -2410.189135736145, -2393.552455485158, -2459.3660622119687, -2623.8774859201767], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 215.64521412433498, "mean_raw_obs_processing_ms": 19.791849276954235, "mean_inference_ms": 19.026273010085248, "mean_action_processing_ms": 0.12045557806927415}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 624000, "timers": {"sample_time_ms": 593321.33, "sample_throughput": 6.742, "learn_time_ms": 34136.874, "learn_throughput": 117.175, "update_time_ms": 5.593}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.04772980691632256, "policy_loss": -0.005174503923626617, "vf_loss": 852.6029081344604, "vf_explained_var": 0.8332438468933105, "kl": 0.015717290865723044, "entropy": 54.22478485107422, "entropy_coeff": 0.001}}, "num_steps_sampled": 624000, "num_steps_trained": 624000}, "done": false, "episodes_total": 624, "training_iteration": 156, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_11-39-31", "timestamp": 1618285171, "time_this_iter_s": 654.1289114952087, "time_total_s": 84624.53301429749, "pid": 5634, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9304.760944843292, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 42.22990353697749, "ram_util_percent": 84.23386923901394}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2331.11823579741, "episode_reward_min": -2443.714647724679, "episode_reward_mean": -2397.5489534219137, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2443.714647724679, -2418.4585886301625, -2331.11823579741, -2396.904341535403], "episode_lengths": [1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 205.28755600246294, "mean_raw_obs_processing_ms": 19.78321488888963, "mean_inference_ms": 27.013429458709673, "mean_action_processing_ms": 0.11312336042367001}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 624000, "timers": {"sample_time_ms": 507876.881, "sample_throughput": 7.876, "learn_time_ms": 21494.28, "learn_throughput": 186.096, "update_time_ms": 3.557}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.055586391245014966, "policy_loss": -0.013851273426553234, "vf_loss": 946.0380735397339, "vf_explained_var": 0.7925597429275513, "kl": 0.016143369139172137, "entropy": 54.42416775226593, "entropy_coeff": 0.001}}, "num_steps_sampled": 624000, "num_steps_trained": 624000}, "done": false, "episodes_total": 624, "training_iteration": 156, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_12-33-36", "timestamp": 1618288416, "time_this_iter_s": 529.39049077034, "time_total_s": 84499.79459357262, "pid": 27245, "hostname": "magicbook-ubuntu-20-10", "node_ip": "192.168.3.10", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 529.39049077034, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 30.667045454545452, "ram_util_percent": 83.89403409090909}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2331.11823579741, "episode_reward_min": -2443.714647724679, "episode_reward_mean": -2391.079151327768, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2433.195178509807, -2340.4075883461683, -2336.9750801577256, -2427.859549920787, -2443.714647724679, -2418.4585886301625, -2331.11823579741, -2396.904341535403], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 211.1804458381327, "mean_raw_obs_processing_ms": 20.285611290976355, "mean_inference_ms": 25.319890687679823, "mean_action_processing_ms": 0.11623671537626928}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 628000, "timers": {"sample_time_ms": 525677.709, "sample_throughput": 7.609, "learn_time_ms": 27292.06, "learn_throughput": 146.563, "update_time_ms": 3.809}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06149780421401374, "policy_loss": -0.01527178005198948, "vf_loss": 552.5990924835205, "vf_explained_var": 0.8826219439506531, "kl": 0.014154240401694551, "entropy": 54.58285892009735, "entropy_coeff": 0.001}}, "num_steps_sampled": 628000, "num_steps_trained": 628000}, "done": false, "episodes_total": 628, "training_iteration": 157, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_12-43-13", "timestamp": 1618288993, "time_this_iter_s": 576.5860416889191, "time_total_s": 85076.38063526154, "pid": 27245, "hostname": "magicbook-ubuntu-20-10", "node_ip": "192.168.3.10", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1105.976532459259, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 36.86269744835966, "ram_util_percent": 87.13462940461724}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2323.767013072187, "episode_reward_min": -2536.350854445979, "episode_reward_mean": -2391.600683474085, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2323.767013072187, -2334.0992400455198, -2536.350854445979, -2376.357883503188, -2443.714647724679, -2418.4585886301625, -2331.11823579741, -2396.904341535403, -2433.195178509807, -2340.4075883461683, -2336.9750801577256, -2427.859549920787], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.34110548253977, "mean_raw_obs_processing_ms": 20.65818172588178, "mean_inference_ms": 24.37602766642735, "mean_action_processing_ms": 0.11794872904826464}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 632000, "timers": {"sample_time_ms": 531395.315, "sample_throughput": 7.527, "learn_time_ms": 30725.003, "learn_throughput": 130.187, "update_time_ms": 4.361}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06472516362555325, "policy_loss": -0.01757831178838387, "vf_loss": 466.18145275115967, "vf_explained_var": 0.9092103242874146, "kl": 0.012844571785535663, "entropy": 54.377577900886536, "entropy_coeff": 0.001}}, "num_steps_sampled": 632000, "num_steps_trained": 632000}, "done": false, "episodes_total": 632, "training_iteration": 158, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_12-52-53", "timestamp": 1618289573, "time_this_iter_s": 580.4348616600037, "time_total_s": 85656.81549692154, "pid": 27245, "hostname": "magicbook-ubuntu-20-10", "node_ip": "192.168.3.10", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1686.4113941192627, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 37.084420289855075, "ram_util_percent": 85.50833333333333}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2301.747586160604, "episode_reward_min": -2536.350854445979, "episode_reward_mean": -2375.979903985487, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2319.0114199444574, -2330.437326788305, -2301.747586160604, -2365.2739291854054, -2443.714647724679, -2418.4585886301625, -2331.11823579741, -2396.904341535403, -2433.195178509807, -2340.4075883461683, -2336.9750801577256, -2427.859549920787, -2323.767013072187, -2334.0992400455198, -2536.350854445979, -2376.357883503188], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 219.1366897921728, "mean_raw_obs_processing_ms": 21.00139255134635, "mean_inference_ms": 23.984679833401337, "mean_action_processing_ms": 0.12021461201440742}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 636000, "timers": {"sample_time_ms": 559186.74, "sample_throughput": 7.153, "learn_time_ms": 32560.338, "learn_throughput": 122.849, "update_time_ms": 4.589}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06318422078038566, "policy_loss": -0.02187891909852624, "vf_loss": 1068.1378364562988, "vf_explained_var": 0.7734133005142212, "kl": 0.012685297522693872, "entropy": 54.52373516559601, "entropy_coeff": 0.001}}, "num_steps_sampled": 636000, "num_steps_trained": 636000}, "done": false, "episodes_total": 636, "training_iteration": 159, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_13-04-14", "timestamp": 1618290254, "time_this_iter_s": 681.0713663101196, "time_total_s": 86337.88686323166, "pid": 27245, "hostname": "magicbook-ubuntu-20-10", "node_ip": "192.168.3.10", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2367.4827604293823, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 44.1961894953656, "ram_util_percent": 84.66416065911432}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2343.9517523083105, "episode_reward_min": -2457.9780257240955, "episode_reward_mean": -2380.00631497592, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2343.9517523083105, -2457.9780257240955, -2347.76988660997, -2370.3255952613044], "episode_lengths": [1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 238.29480905880754, "mean_raw_obs_processing_ms": 23.512150453722878, "mean_inference_ms": 20.627429817748748, "mean_action_processing_ms": 0.12739731751937142}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 624000, "timers": {"sample_time_ms": 567542.385, "sample_throughput": 7.048, "learn_time_ms": 35177.894, "learn_throughput": 113.708, "update_time_ms": 10.482}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05034292524214834, "policy_loss": -0.006165443570353091, "vf_loss": 816.5245227813721, "vf_explained_var": 0.8302778005599976, "kl": 0.010013181657996029, "entropy": 54.34536004066467, "entropy_coeff": 0.001}}, "num_steps_sampled": 624000, "num_steps_trained": 624000}, "done": false, "episodes_total": 624, "training_iteration": 156, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_14-37-45", "timestamp": 1618295865, "time_this_iter_s": 602.7403085231781, "time_total_s": 84573.14441132545, "pid": 2789, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 602.7403085231781, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 39.39023255813953, "ram_util_percent": 84.62081395348838}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2281.964551262594, "episode_reward_min": -2457.9780257240955, "episode_reward_mean": -2385.5654127785865, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2430.7960484133164, -2416.0944938811986, -2435.642948767905, -2281.964551262594, -2343.9517523083105, -2457.9780257240955, -2347.76988660997, -2370.3255952613044], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 245.38934934348367, "mean_raw_obs_processing_ms": 23.513142819861756, "mean_inference_ms": 21.256345186868916, "mean_action_processing_ms": 0.13082844580335753}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 628000, "timers": {"sample_time_ms": 598358.428, "sample_throughput": 6.685, "learn_time_ms": 34946.127, "learn_throughput": 114.462, "update_time_ms": 7.995}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.054871883388841525, "policy_loss": -0.01260389102390036, "vf_loss": 847.8555479049683, "vf_explained_var": 0.8331183791160583, "kl": 0.017478634108556435, "entropy": 54.24227178096771, "entropy_coeff": 0.001}}, "num_steps_sampled": 628000, "num_steps_trained": 628000}, "done": false, "episodes_total": 628, "training_iteration": 157, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_14-48-49", "timestamp": 1618296529, "time_this_iter_s": 663.9008750915527, "time_total_s": 85237.04528641701, "pid": 2789, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1266.6411836147308, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 43.186708860759495, "ram_util_percent": 85.9834388185654}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2281.964551262594, "episode_reward_min": -2457.9780257240955, "episode_reward_mean": -2372.6500447369062, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2369.2483625599557, -2320.7501826443427, -2386.8240228912036, -2310.4546665186776, -2343.9517523083105, -2457.9780257240955, -2347.76988660997, -2370.3255952613044, -2430.7960484133164, -2416.0944938811986, -2435.642948767905, -2281.964551262594], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 248.1986557618817, "mean_raw_obs_processing_ms": 23.40754371561293, "mean_inference_ms": 21.522474977050987, "mean_action_processing_ms": 0.13228553154609526}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 632000, "timers": {"sample_time_ms": 600429.411, "sample_throughput": 6.662, "learn_time_ms": 34536.803, "learn_throughput": 115.818, "update_time_ms": 6.944}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05758637469261885, "policy_loss": -0.014878117828629911, "vf_loss": 865.4598503112793, "vf_explained_var": 0.8336681127548218, "kl": 0.013623965322040021, "entropy": 54.08764338493347, "entropy_coeff": 0.001}}, "num_steps_sampled": 632000, "num_steps_trained": 632000}, "done": false, "episodes_total": 632, "training_iteration": 158, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_14-59-28", "timestamp": 1618297168, "time_this_iter_s": 638.3030595779419, "time_total_s": 85875.34834599495, "pid": 2789, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1904.9442431926727, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 40.902527472527474, "ram_util_percent": 84.86637362637362}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2281.964551262594, "episode_reward_min": -2635.5805321514677, "episode_reward_mean": -2390.8139547597666, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2457.740256178916, -2326.6687420757494, -2361.233208907261, -2635.5805321514677, -2343.9517523083105, -2457.9780257240955, -2347.76988660997, -2370.3255952613044, -2430.7960484133164, -2416.0944938811986, -2435.642948767905, -2281.964551262594, -2369.2483625599557, -2320.7501826443427, -2386.8240228912036, -2310.4546665186776], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 249.65382288763345, "mean_raw_obs_processing_ms": 23.325977979372613, "mean_inference_ms": 21.66335120762617, "mean_action_processing_ms": 0.13304499187452978}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 636000, "timers": {"sample_time_ms": 600593.879, "sample_throughput": 6.66, "learn_time_ms": 34434.234, "learn_throughput": 116.163, "update_time_ms": 6.782}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06206221369211562, "policy_loss": -0.020417356630787253, "vf_loss": 987.4314737319946, "vf_explained_var": 0.8171156048774719, "kl": 0.013069732289295644, "entropy": 54.13311409950256, "entropy_coeff": 0.001}}, "num_steps_sampled": 636000, "num_steps_trained": 636000}, "done": false, "episodes_total": 636, "training_iteration": 159, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_15-10-03", "timestamp": 1618297803, "time_this_iter_s": 635.2262275218964, "time_total_s": 86510.57457351685, "pid": 2789, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2540.170470714569, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 40.51059602649006, "ram_util_percent": 85.74183222958058}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2281.964551262594, "episode_reward_min": -2635.5805321514677, "episode_reward_mean": -2395.334531461191, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2396.6391007933526, -2306.0147563400697, -2476.970969352799, -2474.042526581328, -2343.9517523083105, -2457.9780257240955, -2347.76988660997, -2370.3255952613044, -2430.7960484133164, -2416.0944938811986, -2435.642948767905, -2281.964551262594, -2369.2483625599557, -2320.7501826443427, -2386.8240228912036, -2310.4546665186776, -2457.740256178916, -2326.6687420757494, -2361.233208907261, -2635.5805321514677], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 250.58526247922765, "mean_raw_obs_processing_ms": 23.249457031391273, "mean_inference_ms": 21.753144896751785, "mean_action_processing_ms": 0.1335291384675062}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 640000, "timers": {"sample_time_ms": 600916.749, "sample_throughput": 6.656, "learn_time_ms": 34316.686, "learn_throughput": 116.561, "update_time_ms": 6.46}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.0641232629714068, "policy_loss": -0.02045871247537434, "vf_loss": 782.7864246368408, "vf_explained_var": 0.8514364361763, "kl": 0.012891598657006398, "entropy": 54.07073175907135, "entropy_coeff": 0.001}}, "num_steps_sampled": 640000, "num_steps_trained": 640000}, "done": false, "episodes_total": 640, "training_iteration": 160, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_15-20-39", "timestamp": 1618298439, "time_this_iter_s": 636.0680553913116, "time_total_s": 87146.64262890816, "pid": 2789, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3176.2385261058807, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 40.434471365638764, "ram_util_percent": 85.61883259911893}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2281.964551262594, "episode_reward_min": -2635.5805321514677, "episode_reward_mean": -2388.8179187967908, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2310.50243984741, -2308.986227888451, -2397.195920798595, -2408.254833364705, -2343.9517523083105, -2457.9780257240955, -2347.76988660997, -2370.3255952613044, -2430.7960484133164, -2416.0944938811986, -2435.642948767905, -2281.964551262594, -2369.2483625599557, -2320.7501826443427, -2386.8240228912036, -2310.4546665186776, -2457.740256178916, -2326.6687420757494, -2361.233208907261, -2635.5805321514677, -2396.6391007933526, -2306.0147563400697, -2476.970969352799, -2474.042526581328], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 251.24283762862692, "mean_raw_obs_processing_ms": 23.175711415059464, "mean_inference_ms": 21.816222619599802, "mean_action_processing_ms": 0.1338657436857675}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 644000, "timers": {"sample_time_ms": 601103.848, "sample_throughput": 6.654, "learn_time_ms": 33847.824, "learn_throughput": 118.176, "update_time_ms": 6.073}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.061741149664158, "policy_loss": -0.018111684898030944, "vf_loss": 733.4739561080933, "vf_explained_var": 0.8522288203239441, "kl": 0.01555042594554834, "entropy": 54.074289202690125, "entropy_coeff": 0.001}}, "num_steps_sampled": 644000, "num_steps_trained": 644000}, "done": false, "episodes_total": 644, "training_iteration": 161, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_15-31-13", "timestamp": 1618299073, "time_this_iter_s": 633.5638754367828, "time_total_s": 87780.20650434494, "pid": 2789, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3809.8024015426636, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 40.75387168141593, "ram_util_percent": 86.77234513274335}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2281.964551262594, "episode_reward_min": -2635.5805321514677, "episode_reward_mean": -2391.684630171676, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2421.9225781927353, -2368.2575445113303, -2332.305034211252, -2513.0544367686243, -2343.9517523083105, -2457.9780257240955, -2347.76988660997, -2370.3255952613044, -2430.7960484133164, -2416.0944938811986, -2435.642948767905, -2281.964551262594, -2369.2483625599557, -2320.7501826443427, -2386.8240228912036, -2310.4546665186776, -2457.740256178916, -2326.6687420757494, -2361.233208907261, -2635.5805321514677, -2396.6391007933526, -2306.0147563400697, -2476.970969352799, -2474.042526581328, -2310.50243984741, -2308.986227888451, -2397.195920798595, -2408.254833364705], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 251.3180229190122, "mean_raw_obs_processing_ms": 23.130239687946673, "mean_inference_ms": 21.830039705583356, "mean_action_processing_ms": 0.13397046713156097}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 648000, "timers": {"sample_time_ms": 595207.225, "sample_throughput": 6.72, "learn_time_ms": 33846.088, "learn_throughput": 118.182, "update_time_ms": 6.74}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05854308628477156, "policy_loss": -0.01214643771527335, "vf_loss": 513.1525783538818, "vf_explained_var": 0.8996520042419434, "kl": 0.01293597323819995, "entropy": 54.115365624427795, "entropy_coeff": 0.001}}, "num_steps_sampled": 648000, "num_steps_trained": 648000}, "done": false, "episodes_total": 648, "training_iteration": 162, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_15-41-06", "timestamp": 1618299666, "time_this_iter_s": 593.6886932849884, "time_total_s": 88373.89519762993, "pid": 2789, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4403.491094827652, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 37.07685950413223, "ram_util_percent": 86.24663518299882}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2281.964551262594, "episode_reward_min": -2635.5805321514677, "episode_reward_mean": -2401.4170498068524, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2478.8331902935065, -2364.5232236739034, -2578.8019515748965, -2456.017583470036, -2343.9517523083105, -2457.9780257240955, -2347.76988660997, -2370.3255952613044, -2430.7960484133164, -2416.0944938811986, -2435.642948767905, -2281.964551262594, -2369.2483625599557, -2320.7501826443427, -2386.8240228912036, -2310.4546665186776, -2457.740256178916, -2326.6687420757494, -2361.233208907261, -2635.5805321514677, -2396.6391007933526, -2306.0147563400697, -2476.970969352799, -2474.042526581328, -2310.50243984741, -2308.986227888451, -2397.195920798595, -2408.254833364705, -2421.9225781927353, -2368.2575445113303, -2332.305034211252, -2513.0544367686243], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 251.26537962997884, "mean_raw_obs_processing_ms": 23.089209517516068, "mean_inference_ms": 21.83206355531545, "mean_action_processing_ms": 0.13402094767340775}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 652000, "timers": {"sample_time_ms": 593248.887, "sample_throughput": 6.743, "learn_time_ms": 33649.903, "learn_throughput": 118.871, "update_time_ms": 7.5}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.054620909271761775, "policy_loss": -0.015235337719786912, "vf_loss": 1203.3119974136353, "vf_explained_var": 0.7936146855354309, "kl": 0.015597233694279566, "entropy": 54.53813624382019, "entropy_coeff": 0.001}}, "num_steps_sampled": 652000, "num_steps_trained": 652000}, "done": false, "episodes_total": 652, "training_iteration": 163, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_15-51-18", "timestamp": 1618300278, "time_this_iter_s": 611.8401226997375, "time_total_s": 88985.73532032967, "pid": 2789, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5015.3312175273895, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 38.120847651775485, "ram_util_percent": 85.29621993127148}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2262.964828888551, "episode_reward_min": -2635.5805321514677, "episode_reward_mean": -2398.4329928503003, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2262.964828888551, -2442.5627454981145, -2437.049165243967, -2355.6654091609, -2343.9517523083105, -2457.9780257240955, -2347.76988660997, -2370.3255952613044, -2430.7960484133164, -2416.0944938811986, -2435.642948767905, -2281.964551262594, -2369.2483625599557, -2320.7501826443427, -2386.8240228912036, -2310.4546665186776, -2457.740256178916, -2326.6687420757494, -2361.233208907261, -2635.5805321514677, -2396.6391007933526, -2306.0147563400697, -2476.970969352799, -2474.042526581328, -2310.50243984741, -2308.986227888451, -2397.195920798595, -2408.254833364705, -2421.9225781927353, -2368.2575445113303, -2332.305034211252, -2513.0544367686243, -2478.8331902935065, -2364.5232236739034, -2578.8019515748965, -2456.017583470036], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 251.1434398398806, "mean_raw_obs_processing_ms": 23.05253256434453, "mean_inference_ms": 21.82633709850458, "mean_action_processing_ms": 0.13403710571417105}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 656000, "timers": {"sample_time_ms": 591552.438, "sample_throughput": 6.762, "learn_time_ms": 33726.802, "learn_throughput": 118.6, "update_time_ms": 7.678}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06193116202484816, "policy_loss": -0.015732702187960967, "vf_loss": 620.7630367279053, "vf_explained_var": 0.879176676273346, "kl": 0.010469782369909808, "entropy": 54.50004506111145, "entropy_coeff": 0.001}}, "num_steps_sampled": 656000, "num_steps_trained": 656000}, "done": false, "episodes_total": 656, "training_iteration": 164, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_16-01-31", "timestamp": 1618300891, "time_this_iter_s": 612.3401157855988, "time_total_s": 89598.07543611526, "pid": 2789, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5627.671333312988, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 38.468384879725086, "ram_util_percent": 86.01443298969073}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2262.964828888551, "episode_reward_min": -2635.5805321514677, "episode_reward_mean": -2396.517371050149, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2303.603170293296, -2370.4460757529428, -2452.4895867422965, -2390.5682666066327, -2343.9517523083105, -2457.9780257240955, -2347.76988660997, -2370.3255952613044, -2430.7960484133164, -2416.0944938811986, -2435.642948767905, -2281.964551262594, -2369.2483625599557, -2320.7501826443427, -2386.8240228912036, -2310.4546665186776, -2457.740256178916, -2326.6687420757494, -2361.233208907261, -2635.5805321514677, -2396.6391007933526, -2306.0147563400697, -2476.970969352799, -2474.042526581328, -2310.50243984741, -2308.986227888451, -2397.195920798595, -2408.254833364705, -2421.9225781927353, -2368.2575445113303, -2332.305034211252, -2513.0544367686243, -2478.8331902935065, -2364.5232236739034, -2578.8019515748965, -2456.017583470036, -2262.964828888551, -2442.5627454981145, -2437.049165243967, -2355.6654091609], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 250.99874589135712, "mean_raw_obs_processing_ms": 23.018439489238936, "mean_inference_ms": 21.81812847205503, "mean_action_processing_ms": 0.13403184400140078}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 660000, "timers": {"sample_time_ms": 590526.718, "sample_throughput": 6.774, "learn_time_ms": 33804.637, "learn_throughput": 118.327, "update_time_ms": 7.81}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.0620254595996812, "policy_loss": -0.017582505010068417, "vf_loss": 742.6994848251343, "vf_explained_var": 0.8599679470062256, "kl": 0.013189221193897538, "entropy": 54.507789850234985, "entropy_coeff": 0.001}}, "num_steps_sampled": 660000, "num_steps_trained": 660000}, "done": false, "episodes_total": 660, "training_iteration": 165, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_16-11-46", "timestamp": 1618301506, "time_this_iter_s": 615.8164489269257, "time_total_s": 90213.89188504219, "pid": 2789, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6243.487782239914, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 38.490443686006834, "ram_util_percent": 83.90250284414107}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2262.964828888551, "episode_reward_min": -2635.5805321514677, "episode_reward_mean": -2390.126813442851, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2326.164351913688, -2348.873904464269, -2295.7863177569393, -2334.0603753445844, -2343.9517523083105, -2457.9780257240955, -2347.76988660997, -2370.3255952613044, -2430.7960484133164, -2416.0944938811986, -2435.642948767905, -2281.964551262594, -2369.2483625599557, -2320.7501826443427, -2386.8240228912036, -2310.4546665186776, -2457.740256178916, -2326.6687420757494, -2361.233208907261, -2635.5805321514677, -2396.6391007933526, -2306.0147563400697, -2476.970969352799, -2474.042526581328, -2310.50243984741, -2308.986227888451, -2397.195920798595, -2408.254833364705, -2421.9225781927353, -2368.2575445113303, -2332.305034211252, -2513.0544367686243, -2478.8331902935065, -2364.5232236739034, -2578.8019515748965, -2456.017583470036, -2262.964828888551, -2442.5627454981145, -2437.049165243967, -2355.6654091609, -2303.603170293296, -2370.4460757529428, -2452.4895867422965, -2390.5682666066327], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 250.9025912353216, "mean_raw_obs_processing_ms": 22.97222516264549, "mean_inference_ms": 21.81319038286164, "mean_action_processing_ms": 0.13403671337354275}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 664000, "timers": {"sample_time_ms": 592910.619, "sample_throughput": 6.746, "learn_time_ms": 32374.125, "learn_throughput": 123.555, "update_time_ms": 7.661}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06329120724694803, "policy_loss": -0.01846715368446894, "vf_loss": 713.5111045837402, "vf_explained_var": 0.8493196368217468, "kl": 0.012602552305907011, "entropy": 54.47967171669006, "entropy_coeff": 0.001}}, "num_steps_sampled": 664000, "num_steps_trained": 664000}, "done": false, "episodes_total": 664, "training_iteration": 166, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_16-21-59", "timestamp": 1618302119, "time_this_iter_s": 612.2703745365143, "time_total_s": 90826.1622595787, "pid": 2789, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6855.758156776428, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 39.32462772050402, "ram_util_percent": 84.08006872852233}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2262.964828888551, "episode_reward_min": -2635.5805321514677, "episode_reward_mean": -2392.4239695271604, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2390.206225607047, -2425.3458957532516, -2405.813908564603, -2449.4047158933354, -2343.9517523083105, -2457.9780257240955, -2347.76988660997, -2370.3255952613044, -2430.7960484133164, -2416.0944938811986, -2435.642948767905, -2281.964551262594, -2369.2483625599557, -2320.7501826443427, -2386.8240228912036, -2310.4546665186776, -2457.740256178916, -2326.6687420757494, -2361.233208907261, -2635.5805321514677, -2396.6391007933526, -2306.0147563400697, -2476.970969352799, -2474.042526581328, -2310.50243984741, -2308.986227888451, -2397.195920798595, -2408.254833364705, -2421.9225781927353, -2368.2575445113303, -2332.305034211252, -2513.0544367686243, -2478.8331902935065, -2364.5232236739034, -2578.8019515748965, -2456.017583470036, -2262.964828888551, -2442.5627454981145, -2437.049165243967, -2355.6654091609, -2303.603170293296, -2370.4460757529428, -2452.4895867422965, -2390.5682666066327, -2326.164351913688, -2348.873904464269, -2295.7863177569393, -2334.0603753445844], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 250.66737059037777, "mean_raw_obs_processing_ms": 22.9290008003876, "mean_inference_ms": 21.79525312327516, "mean_action_processing_ms": 0.13396711374108178}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 668000, "timers": {"sample_time_ms": 584032.621, "sample_throughput": 6.849, "learn_time_ms": 32437.502, "learn_throughput": 123.314, "update_time_ms": 7.559}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05995553353568539, "policy_loss": -0.015780453861225396, "vf_loss": 772.0247812271118, "vf_explained_var": 0.8427534103393555, "kl": 0.013966452883323655, "entropy": 54.68861532211304, "entropy_coeff": 0.001}}, "num_steps_sampled": 668000, "num_steps_trained": 668000}, "done": false, "episodes_total": 668, "training_iteration": 167, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_16-31-35", "timestamp": 1618302695, "time_this_iter_s": 575.753036737442, "time_total_s": 91401.91529631615, "pid": 2789, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7431.51119351387, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 35.76642335766423, "ram_util_percent": 82.8428223844282}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2257.1027501247822, "episode_reward_min": -2635.5805321514677, "episode_reward_mean": -2393.308039762484, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2400.3412881414874, -2257.1027501247822, -2486.1383805622895, -2472.085111516918, -2343.9517523083105, -2457.9780257240955, -2347.76988660997, -2370.3255952613044, -2430.7960484133164, -2416.0944938811986, -2435.642948767905, -2281.964551262594, -2369.2483625599557, -2320.7501826443427, -2386.8240228912036, -2310.4546665186776, -2457.740256178916, -2326.6687420757494, -2361.233208907261, -2635.5805321514677, -2396.6391007933526, -2306.0147563400697, -2476.970969352799, -2474.042526581328, -2310.50243984741, -2308.986227888451, -2397.195920798595, -2408.254833364705, -2421.9225781927353, -2368.2575445113303, -2332.305034211252, -2513.0544367686243, -2478.8331902935065, -2364.5232236739034, -2578.8019515748965, -2456.017583470036, -2262.964828888551, -2442.5627454981145, -2437.049165243967, -2355.6654091609, -2303.603170293296, -2370.4460757529428, -2452.4895867422965, -2390.5682666066327, -2326.164351913688, -2348.873904464269, -2295.7863177569393, -2334.0603753445844, -2390.206225607047, -2425.3458957532516, -2405.813908564603, -2449.4047158933354], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 250.4961850851591, "mean_raw_obs_processing_ms": 22.891531183567455, "mean_inference_ms": 21.782217427419905, "mean_action_processing_ms": 0.1339219780253667}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 672000, "timers": {"sample_time_ms": 583306.23, "sample_throughput": 6.857, "learn_time_ms": 32506.908, "learn_throughput": 123.051, "update_time_ms": 8.212}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.0689091922249645, "policy_loss": -0.027519819035660475, "vf_loss": 997.1005115509033, "vf_explained_var": 0.796352207660675, "kl": 0.015565286303171888, "entropy": 54.47343194484711, "entropy_coeff": 0.001}}, "num_steps_sampled": 672000, "num_steps_trained": 672000}, "done": false, "episodes_total": 672, "training_iteration": 168, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_16-42-06", "timestamp": 1618303326, "time_this_iter_s": 631.7425503730774, "time_total_s": 92033.65784668922, "pid": 2789, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8063.253743886948, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 40.05238623751387, "ram_util_percent": 83.3984461709212}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2257.1027501247822, "episode_reward_min": -2635.5805321514677, "episode_reward_mean": -2393.2893399180202, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2427.149712251443, -2385.0676016684565, -2429.4868462023674, -2330.480807637706, -2343.9517523083105, -2457.9780257240955, -2347.76988660997, -2370.3255952613044, -2430.7960484133164, -2416.0944938811986, -2435.642948767905, -2281.964551262594, -2369.2483625599557, -2320.7501826443427, -2386.8240228912036, -2310.4546665186776, -2457.740256178916, -2326.6687420757494, -2361.233208907261, -2635.5805321514677, -2396.6391007933526, -2306.0147563400697, -2476.970969352799, -2474.042526581328, -2310.50243984741, -2308.986227888451, -2397.195920798595, -2408.254833364705, -2421.9225781927353, -2368.2575445113303, -2332.305034211252, -2513.0544367686243, -2478.8331902935065, -2364.5232236739034, -2578.8019515748965, -2456.017583470036, -2262.964828888551, -2442.5627454981145, -2437.049165243967, -2355.6654091609, -2303.603170293296, -2370.4460757529428, -2452.4895867422965, -2390.5682666066327, -2326.164351913688, -2348.873904464269, -2295.7863177569393, -2334.0603753445844, -2390.206225607047, -2425.3458957532516, -2405.813908564603, -2449.4047158933354, -2400.3412881414874, -2257.1027501247822, -2486.1383805622895, -2472.085111516918], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 250.34747460939943, "mean_raw_obs_processing_ms": 22.854007390976896, "mean_inference_ms": 21.771794810591164, "mean_action_processing_ms": 0.13388595294069738}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 676000, "timers": {"sample_time_ms": 581620.883, "sample_throughput": 6.877, "learn_time_ms": 31856.942, "learn_throughput": 125.561, "update_time_ms": 8.442}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06839745334582403, "policy_loss": -0.020719849737361073, "vf_loss": 406.94624185562134, "vf_explained_var": 0.9214411377906799, "kl": 0.013014747062698007, "entropy": 54.350013852119446, "entropy_coeff": 0.001}}, "num_steps_sampled": 676000, "num_steps_trained": 676000}, "done": false, "episodes_total": 676, "training_iteration": 169, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_16-52-18", "timestamp": 1618303938, "time_this_iter_s": 611.8749268054962, "time_total_s": 92645.53277349472, "pid": 2789, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8675.128670692444, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 38.66345933562428, "ram_util_percent": 83.25750286368843}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2251.9070913768223, "episode_reward_min": -2635.5805321514677, "episode_reward_mean": -2391.3689025134167, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2424.2679010818238, -2340.6557155549212, -2441.1004073823237, -2251.9070913768223, -2343.9517523083105, -2457.9780257240955, -2347.76988660997, -2370.3255952613044, -2430.7960484133164, -2416.0944938811986, -2435.642948767905, -2281.964551262594, -2369.2483625599557, -2320.7501826443427, -2386.8240228912036, -2310.4546665186776, -2457.740256178916, -2326.6687420757494, -2361.233208907261, -2635.5805321514677, -2396.6391007933526, -2306.0147563400697, -2476.970969352799, -2474.042526581328, -2310.50243984741, -2308.986227888451, -2397.195920798595, -2408.254833364705, -2421.9225781927353, -2368.2575445113303, -2332.305034211252, -2513.0544367686243, -2478.8331902935065, -2364.5232236739034, -2578.8019515748965, -2456.017583470036, -2262.964828888551, -2442.5627454981145, -2437.049165243967, -2355.6654091609, -2303.603170293296, -2370.4460757529428, -2452.4895867422965, -2390.5682666066327, -2326.164351913688, -2348.873904464269, -2295.7863177569393, -2334.0603753445844, -2390.206225607047, -2425.3458957532516, -2405.813908564603, -2449.4047158933354, -2400.3412881414874, -2257.1027501247822, -2486.1383805622895, -2472.085111516918, -2427.149712251443, -2385.0676016684565, -2429.4868462023674, -2330.480807637706], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 250.21478730285028, "mean_raw_obs_processing_ms": 22.821927600623734, "mean_inference_ms": 21.761338959545956, "mean_action_processing_ms": 0.13384743097604943}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 680000, "timers": {"sample_time_ms": 579886.945, "sample_throughput": 6.898, "learn_time_ms": 31915.466, "learn_throughput": 125.331, "update_time_ms": 8.818}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.054543922597076744, "policy_loss": -0.01061047095572576, "vf_loss": 751.2568283081055, "vf_explained_var": 0.8555998802185059, "kl": 0.014347517862915993, "entropy": 54.31552040576935, "entropy_coeff": 0.001}}, "num_steps_sampled": 680000, "num_steps_trained": 680000}, "done": false, "episodes_total": 680, "training_iteration": 170, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_17-02-38", "timestamp": 1618304558, "time_this_iter_s": 619.3159108161926, "time_total_s": 93264.84868431091, "pid": 2789, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9294.444581508636, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 38.78257918552036, "ram_util_percent": 83.93450226244344}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2251.9070913768223, "episode_reward_min": -2635.5805321514677, "episode_reward_mean": -2388.391084940028, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2451.0787261547493, -2305.1637278280296, -2343.974682674894, -2274.6781486991053, -2343.9517523083105, -2457.9780257240955, -2347.76988660997, -2370.3255952613044, -2430.7960484133164, -2416.0944938811986, -2435.642948767905, -2281.964551262594, -2369.2483625599557, -2320.7501826443427, -2386.8240228912036, -2310.4546665186776, -2457.740256178916, -2326.6687420757494, -2361.233208907261, -2635.5805321514677, -2396.6391007933526, -2306.0147563400697, -2476.970969352799, -2474.042526581328, -2310.50243984741, -2308.986227888451, -2397.195920798595, -2408.254833364705, -2421.9225781927353, -2368.2575445113303, -2332.305034211252, -2513.0544367686243, -2478.8331902935065, -2364.5232236739034, -2578.8019515748965, -2456.017583470036, -2262.964828888551, -2442.5627454981145, -2437.049165243967, -2355.6654091609, -2303.603170293296, -2370.4460757529428, -2452.4895867422965, -2390.5682666066327, -2326.164351913688, -2348.873904464269, -2295.7863177569393, -2334.0603753445844, -2390.206225607047, -2425.3458957532516, -2405.813908564603, -2449.4047158933354, -2400.3412881414874, -2257.1027501247822, -2486.1383805622895, -2472.085111516918, -2427.149712251443, -2385.0676016684565, -2429.4868462023674, -2330.480807637706, -2424.2679010818238, -2340.6557155549212, -2441.1004073823237, -2251.9070913768223], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 250.09948853313153, "mean_raw_obs_processing_ms": 22.7955786900997, "mean_inference_ms": 21.752397883067175, "mean_action_processing_ms": 0.13381190749386235}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 684000, "timers": {"sample_time_ms": 578579.901, "sample_throughput": 6.913, "learn_time_ms": 32218.518, "learn_throughput": 124.152, "update_time_ms": 8.985}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05285631728474982, "policy_loss": -0.009628696920117363, "vf_loss": 780.4287118911743, "vf_explained_var": 0.8502562046051025, "kl": 0.01633559144102037, "entropy": 54.29902267456055, "entropy_coeff": 0.001}}, "num_steps_sampled": 684000, "num_steps_trained": 684000}, "done": false, "episodes_total": 684, "training_iteration": 171, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_17-13-01", "timestamp": 1618305181, "time_this_iter_s": 623.5204589366913, "time_total_s": 93888.3691432476, "pid": 2789, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 9917.965040445328, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 39.33937007874015, "ram_util_percent": 82.64071991001126}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2251.9070913768223, "episode_reward_min": -2635.5805321514677, "episode_reward_mean": -2383.324217634966, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2338.8847122096954, -2287.841041167455, -2314.390984039683, -2267.900625599063, -2343.9517523083105, -2457.9780257240955, -2347.76988660997, -2370.3255952613044, -2430.7960484133164, -2416.0944938811986, -2435.642948767905, -2281.964551262594, -2369.2483625599557, -2320.7501826443427, -2386.8240228912036, -2310.4546665186776, -2457.740256178916, -2326.6687420757494, -2361.233208907261, -2635.5805321514677, -2396.6391007933526, -2306.0147563400697, -2476.970969352799, -2474.042526581328, -2310.50243984741, -2308.986227888451, -2397.195920798595, -2408.254833364705, -2421.9225781927353, -2368.2575445113303, -2332.305034211252, -2513.0544367686243, -2478.8331902935065, -2364.5232236739034, -2578.8019515748965, -2456.017583470036, -2262.964828888551, -2442.5627454981145, -2437.049165243967, -2355.6654091609, -2303.603170293296, -2370.4460757529428, -2452.4895867422965, -2390.5682666066327, -2326.164351913688, -2348.873904464269, -2295.7863177569393, -2334.0603753445844, -2390.206225607047, -2425.3458957532516, -2405.813908564603, -2449.4047158933354, -2400.3412881414874, -2257.1027501247822, -2486.1383805622895, -2472.085111516918, -2427.149712251443, -2385.0676016684565, -2429.4868462023674, -2330.480807637706, -2424.2679010818238, -2340.6557155549212, -2441.1004073823237, -2251.9070913768223, -2451.0787261547493, -2305.1637278280296, -2343.974682674894, -2274.6781486991053], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 250.0082166822433, "mean_raw_obs_processing_ms": 22.774707071320172, "mean_inference_ms": 21.7455825343183, "mean_action_processing_ms": 0.13378624521568708}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 688000, "timers": {"sample_time_ms": 582087.064, "sample_throughput": 6.872, "learn_time_ms": 32235.05, "learn_throughput": 124.089, "update_time_ms": 8.868}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.07317363517358899, "policy_loss": -0.027543499949388206, "vf_loss": 524.2827162742615, "vf_explained_var": 0.8870070576667786, "kl": 0.015731451829196885, "entropy": 54.01924955844879, "entropy_coeff": 0.001}}, "num_steps_sampled": 688000, "num_steps_trained": 688000}, "done": false, "episodes_total": 688, "training_iteration": 172, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_17-23-30", "timestamp": 1618305810, "time_this_iter_s": 628.9176435470581, "time_total_s": 94517.28678679466, "pid": 2789, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.239.170", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 10546.882683992386, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 40.05997770345597, "ram_util_percent": 82.69041248606466}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2309.6733305336243, "episode_reward_min": -2644.2564125560957, "episode_reward_mean": -2418.087810798092, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2381.433064252192, -2644.2564125560957, -2336.988435850457, -2309.6733305336243], "episode_lengths": [1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 242.72241841430133, "mean_raw_obs_processing_ms": 22.303925520893575, "mean_inference_ms": 21.335864710486096, "mean_action_processing_ms": 0.12752588006152563}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 684000, "timers": {"sample_time_ms": 574358.804, "sample_throughput": 6.964, "learn_time_ms": 33875.331, "learn_throughput": 118.08, "update_time_ms": 10.341}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.04550422669854015, "policy_loss": -0.010295614833012223, "vf_loss": 1526.1376991271973, "vf_explained_var": 0.7081812620162964, "kl": 0.019791739439824596, "entropy": 54.428329825401306, "entropy_coeff": 0.001}}, "num_steps_sampled": 684000, "num_steps_trained": 684000}, "done": false, "episodes_total": 684, "training_iteration": 171, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_18-44-36", "timestamp": 1618310676, "time_this_iter_s": 608.2576861381531, "time_total_s": 93873.10637044907, "pid": 2768, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 608.2576861381531, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 38.73755760368663, "ram_util_percent": 83.91394009216589}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2251.3561348708977, "episode_reward_min": -2644.2564125560957, "episode_reward_mean": -2367.7334973989728, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2375.4519886570906, -2307.2886403258626, -2335.4199721455657, -2251.3561348708977, -2381.433064252192, -2644.2564125560957, -2336.988435850457, -2309.6733305336243], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 242.07823830673306, "mean_raw_obs_processing_ms": 22.129632495158496, "mean_inference_ms": 21.363176780392408, "mean_action_processing_ms": 0.12778898018686913}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 688000, "timers": {"sample_time_ms": 571801.662, "sample_throughput": 6.995, "learn_time_ms": 34340.322, "learn_throughput": 116.481, "update_time_ms": 7.783}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.057534521678462625, "policy_loss": -0.015200213005300611, "vf_loss": 822.9118385314941, "vf_explained_var": 0.8222646117210388, "kl": 0.01799088905681856, "entropy": 54.16160237789154, "entropy_coeff": 0.001}}, "num_steps_sampled": 688000, "num_steps_trained": 688000}, "done": false, "episodes_total": 688, "training_iteration": 172, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_18-54-41", "timestamp": 1618311281, "time_this_iter_s": 604.0658929347992, "time_total_s": 94477.17226338387, "pid": 2768, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1212.3235790729523, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 37.547795823665886, "ram_util_percent": 85.13642691415313}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2251.3561348708977, "episode_reward_min": -2644.2564125560957, "episode_reward_mean": -2387.160825879823, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2375.7074568481794, -2437.8081055599505, -2403.7281136979923, -2486.818255259962, -2381.433064252192, -2644.2564125560957, -2336.988435850457, -2309.6733305336243, -2375.4519886570906, -2307.2886403258626, -2335.4199721455657, -2251.3561348708977], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 241.7112537678814, "mean_raw_obs_processing_ms": 22.015071560538413, "mean_inference_ms": 21.373949238535673, "mean_action_processing_ms": 0.12785723639000682}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 692000, "timers": {"sample_time_ms": 570554.315, "sample_throughput": 7.011, "learn_time_ms": 34104.881, "learn_throughput": 117.285, "update_time_ms": 7.086}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05453425319865346, "policy_loss": -0.013439996168017387, "vf_loss": 978.4141159057617, "vf_explained_var": 0.8147233128547668, "kl": 0.016146992391441017, "entropy": 54.10779309272766, "entropy_coeff": 0.001}}, "num_steps_sampled": 692000, "num_steps_trained": 692000}, "done": false, "episodes_total": 692, "training_iteration": 173, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_19-04-42", "timestamp": 1618311882, "time_this_iter_s": 601.7049787044525, "time_total_s": 95078.87724208832, "pid": 2768, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1814.0285577774048, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 37.66845168800931, "ram_util_percent": 84.60093131548314}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2251.3561348708977, "episode_reward_min": -2644.2564125560957, "episode_reward_mean": -2400.3454044158866, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2441.6932498720234, -2519.0265983577033, -2304.4948817341874, -2494.3818301324, -2381.433064252192, -2644.2564125560957, -2336.988435850457, -2309.6733305336243, -2375.4519886570906, -2307.2886403258626, -2335.4199721455657, -2251.3561348708977, -2375.7074568481794, -2437.8081055599505, -2403.7281136979923, -2486.818255259962], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 241.3980479002843, "mean_raw_obs_processing_ms": 21.944659157701174, "mean_inference_ms": 21.37375289455808, "mean_action_processing_ms": 0.12786247933200923}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 696000, "timers": {"sample_time_ms": 569446.743, "sample_throughput": 7.024, "learn_time_ms": 34332.751, "learn_throughput": 116.507, "update_time_ms": 6.58}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.0569361302186735, "policy_loss": -0.016008154780138284, "vf_loss": 1078.7010688781738, "vf_explained_var": 0.8139530420303345, "kl": 0.012907292693853378, "entropy": 54.29644000530243, "entropy_coeff": 0.001}}, "num_steps_sampled": 696000, "num_steps_trained": 696000}, "done": false, "episodes_total": 696, "training_iteration": 174, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_19-14-43", "timestamp": 1618312483, "time_this_iter_s": 601.1581830978394, "time_total_s": 95680.03542518616, "pid": 2768, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2415.186740875244, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 37.438623103850645, "ram_util_percent": 84.30455075845974}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2247.842415247238, "episode_reward_min": -2644.2564125560957, "episode_reward_mean": -2380.744544183574, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2332.8806059532294, -2334.101401427993, -2247.842415247238, -2294.5399903888297, -2381.433064252192, -2644.2564125560957, -2336.988435850457, -2309.6733305336243, -2375.4519886570906, -2307.2886403258626, -2335.4199721455657, -2251.3561348708977, -2375.7074568481794, -2437.8081055599505, -2403.7281136979923, -2486.818255259962, -2441.6932498720234, -2519.0265983577033, -2304.4948817341874, -2494.3818301324], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 241.36970129340972, "mean_raw_obs_processing_ms": 21.907545884138973, "mean_inference_ms": 21.391822898166463, "mean_action_processing_ms": 0.12795498421864487}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 700000, "timers": {"sample_time_ms": 571385.5, "sample_throughput": 7.001, "learn_time_ms": 34395.407, "learn_throughput": 116.295, "update_time_ms": 6.279}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05126020114403218, "policy_loss": -0.01119798794388771, "vf_loss": 1144.9003925323486, "vf_explained_var": 0.7929494976997375, "kl": 0.013928289554314688, "entropy": 54.296870827674866, "entropy_coeff": 0.001}}, "num_steps_sampled": 700000, "num_steps_trained": 700000}, "done": false, "episodes_total": 700, "training_iteration": 175, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_19-24-57", "timestamp": 1618313097, "time_this_iter_s": 613.7980830669403, "time_total_s": 96293.8335082531, "pid": 2768, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3028.9848239421844, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 38.595776255707754, "ram_util_percent": 84.44429223744294}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2224.455623908536, "episode_reward_min": -2644.2564125560957, "episode_reward_mean": -2369.1257668403323, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2386.7926304496555, -2298.691952114094, -2334.1873140242187, -2224.455623908536, -2381.433064252192, -2644.2564125560957, -2336.988435850457, -2309.6733305336243, -2375.4519886570906, -2307.2886403258626, -2335.4199721455657, -2251.3561348708977, -2375.7074568481794, -2437.8081055599505, -2403.7281136979923, -2486.818255259962, -2441.6932498720234, -2519.0265983577033, -2304.4948817341874, -2494.3818301324, -2332.8806059532294, -2334.101401427993, -2247.842415247238, -2294.5399903888297], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 241.49198029991544, "mean_raw_obs_processing_ms": 21.897686851107462, "mean_inference_ms": 21.417818150401047, "mean_action_processing_ms": 0.12807347861786889}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 704000, "timers": {"sample_time_ms": 573315.795, "sample_throughput": 6.977, "learn_time_ms": 34369.911, "learn_throughput": 116.381, "update_time_ms": 6.798}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06026219710474834, "policy_loss": -0.017812115547712892, "vf_loss": 966.6084623336792, "vf_explained_var": 0.8179117441177368, "kl": 0.011206368828425184, "entropy": 54.35743498802185, "entropy_coeff": 0.001}}, "num_steps_sampled": 704000, "num_steps_trained": 704000}, "done": false, "episodes_total": 704, "training_iteration": 176, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_19-35-15", "timestamp": 1618313715, "time_this_iter_s": 617.2250077724457, "time_total_s": 96911.05851602554, "pid": 2768, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3646.20983171463, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 39.2927355278093, "ram_util_percent": 85.04812712826333}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2220.369385492707, "episode_reward_min": -2644.2564125560957, "episode_reward_mean": -2358.657694020424, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2220.369385492707, -2262.6475235884186, -2318.2956888162257, -2382.0844305065457, -2381.433064252192, -2644.2564125560957, -2336.988435850457, -2309.6733305336243, -2375.4519886570906, -2307.2886403258626, -2335.4199721455657, -2251.3561348708977, -2375.7074568481794, -2437.8081055599505, -2403.7281136979923, -2486.818255259962, -2441.6932498720234, -2519.0265983577033, -2304.4948817341874, -2494.3818301324, -2332.8806059532294, -2334.101401427993, -2247.842415247238, -2294.5399903888297, -2386.7926304496555, -2298.691952114094, -2334.1873140242187, -2224.455623908536], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 241.66372189671105, "mean_raw_obs_processing_ms": 21.90491047583572, "mean_inference_ms": 21.44431701525759, "mean_action_processing_ms": 0.12817985526195638}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 708000, "timers": {"sample_time_ms": 574767.665, "sample_throughput": 6.959, "learn_time_ms": 34380.995, "learn_throughput": 116.343, "update_time_ms": 7.362}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05834579112706706, "policy_loss": -0.012905685376608744, "vf_loss": 627.0721864700317, "vf_explained_var": 0.8500375747680664, "kl": 0.012772088462952524, "entropy": 54.265244007110596, "entropy_coeff": 0.001}}, "num_steps_sampled": 708000, "num_steps_trained": 708000}, "done": false, "episodes_total": 708, "training_iteration": 177, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_19-45-33", "timestamp": 1618314333, "time_this_iter_s": 617.9539406299591, "time_total_s": 97529.0124566555, "pid": 2768, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4264.163772344589, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 39.25107832009081, "ram_util_percent": 84.71759364358682}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2220.369385492707, "episode_reward_min": -2644.2564125560957, "episode_reward_mean": -2351.589702552554, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2243.1909399853744, -2398.8240029581884, -2247.2962816453046, -2319.1438245209924, -2381.433064252192, -2644.2564125560957, -2336.988435850457, -2309.6733305336243, -2375.4519886570906, -2307.2886403258626, -2335.4199721455657, -2251.3561348708977, -2375.7074568481794, -2437.8081055599505, -2403.7281136979923, -2486.818255259962, -2441.6932498720234, -2519.0265983577033, -2304.4948817341874, -2494.3818301324, -2332.8806059532294, -2334.101401427993, -2247.842415247238, -2294.5399903888297, -2386.7926304496555, -2298.691952114094, -2334.1873140242187, -2224.455623908536, -2220.369385492707, -2262.6475235884186, -2318.2956888162257, -2382.0844305065457], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 241.91207055130593, "mean_raw_obs_processing_ms": 21.912546820563087, "mean_inference_ms": 21.47308961044239, "mean_action_processing_ms": 0.12830115319199378}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 712000, "timers": {"sample_time_ms": 576906.461, "sample_throughput": 6.934, "learn_time_ms": 34123.738, "learn_throughput": 117.22, "update_time_ms": 7.559}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.060449800395872444, "policy_loss": -0.013930278364568949, "vf_loss": 529.9356832504272, "vf_explained_var": 0.8844246864318848, "kl": 0.01278925992664881, "entropy": 54.37672793865204, "entropy_coeff": 0.001}}, "num_steps_sampled": 712000, "num_steps_trained": 712000}, "done": false, "episodes_total": 712, "training_iteration": 178, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_19-55-57", "timestamp": 1618314957, "time_this_iter_s": 624.2158880233765, "time_total_s": 98153.22834467888, "pid": 2768, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4888.379660367966, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 40.057014590347926, "ram_util_percent": 84.67351290684624}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2220.369385492707, "episode_reward_min": -2644.2564125560957, "episode_reward_mean": -2347.988909802692, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2365.246058080569, -2324.4501868543475, -2289.0217637538262, -2298.012262526437, -2381.433064252192, -2644.2564125560957, -2336.988435850457, -2309.6733305336243, -2375.4519886570906, -2307.2886403258626, -2335.4199721455657, -2251.3561348708977, -2375.7074568481794, -2437.8081055599505, -2403.7281136979923, -2486.818255259962, -2441.6932498720234, -2519.0265983577033, -2304.4948817341874, -2494.3818301324, -2332.8806059532294, -2334.101401427993, -2247.842415247238, -2294.5399903888297, -2386.7926304496555, -2298.691952114094, -2334.1873140242187, -2224.455623908536, -2220.369385492707, -2262.6475235884186, -2318.2956888162257, -2382.0844305065457, -2243.1909399853744, -2398.8240029581884, -2247.2962816453046, -2319.1438245209924], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 242.09056152708743, "mean_raw_obs_processing_ms": 21.926023775637013, "mean_inference_ms": 21.492897914572758, "mean_action_processing_ms": 0.12837879407634967}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 716000, "timers": {"sample_time_ms": 576855.329, "sample_throughput": 6.934, "learn_time_ms": 34230.053, "learn_throughput": 116.856, "update_time_ms": 7.724}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.0578876324580051, "policy_loss": -0.01310816261684522, "vf_loss": 673.9023847579956, "vf_explained_var": 0.8551411032676697, "kl": 0.013497713633114472, "entropy": 54.21803545951843, "entropy_coeff": 0.001}}, "num_steps_sampled": 716000, "num_steps_trained": 716000}, "done": false, "episodes_total": 716, "training_iteration": 179, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_20-06-08", "timestamp": 1618315568, "time_this_iter_s": 611.5431883335114, "time_total_s": 98764.77153301239, "pid": 2768, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5499.922848701477, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 38.64988532110091, "ram_util_percent": 84.51674311926607}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2217.902031633715, "episode_reward_min": -2644.2564125560957, "episode_reward_mean": -2346.3063132272428, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2453.9198505361937, -2361.9046954329865, -2217.902031633715, -2290.9251985899155, -2381.433064252192, -2644.2564125560957, -2336.988435850457, -2309.6733305336243, -2375.4519886570906, -2307.2886403258626, -2335.4199721455657, -2251.3561348708977, -2375.7074568481794, -2437.8081055599505, -2403.7281136979923, -2486.818255259962, -2441.6932498720234, -2519.0265983577033, -2304.4948817341874, -2494.3818301324, -2332.8806059532294, -2334.101401427993, -2247.842415247238, -2294.5399903888297, -2386.7926304496555, -2298.691952114094, -2334.1873140242187, -2224.455623908536, -2220.369385492707, -2262.6475235884186, -2318.2956888162257, -2382.0844305065457, -2243.1909399853744, -2398.8240029581884, -2247.2962816453046, -2319.1438245209924, -2365.246058080569, -2324.4501868543475, -2289.0217637538262, -2298.012262526437], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 242.31438381416552, "mean_raw_obs_processing_ms": 21.94959417367163, "mean_inference_ms": 21.516098977532796, "mean_action_processing_ms": 0.12847209720447472}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 720000, "timers": {"sample_time_ms": 578919.704, "sample_throughput": 6.909, "learn_time_ms": 34334.091, "learn_throughput": 116.502, "update_time_ms": 7.37}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05752435134490952, "policy_loss": -0.018431991746183485, "vf_loss": 1204.3277072906494, "vf_explained_var": 0.750383198261261, "kl": 0.015181219874648377, "entropy": 54.17187750339508, "entropy_coeff": 0.001}}, "num_steps_sampled": 720000, "num_steps_trained": 720000}, "done": false, "episodes_total": 720, "training_iteration": 180, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_20-16-41", "timestamp": 1618316201, "time_this_iter_s": 632.77996301651, "time_total_s": 99397.5514960289, "pid": 2768, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6132.702811717987, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 40.762679955703206, "ram_util_percent": 84.38028792912513}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2215.903825705339, "episode_reward_min": -2644.2564125560957, "episode_reward_mean": -2339.540174445339, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2252.6069058437465, -2215.903825705339, -2354.00861054378, -2264.9958044123264, -2381.433064252192, -2644.2564125560957, -2336.988435850457, -2309.6733305336243, -2375.4519886570906, -2307.2886403258626, -2335.4199721455657, -2251.3561348708977, -2375.7074568481794, -2437.8081055599505, -2403.7281136979923, -2486.818255259962, -2441.6932498720234, -2519.0265983577033, -2304.4948817341874, -2494.3818301324, -2332.8806059532294, -2334.101401427993, -2247.842415247238, -2294.5399903888297, -2386.7926304496555, -2298.691952114094, -2334.1873140242187, -2224.455623908536, -2220.369385492707, -2262.6475235884186, -2318.2956888162257, -2382.0844305065457, -2243.1909399853744, -2398.8240029581884, -2247.2962816453046, -2319.1438245209924, -2365.246058080569, -2324.4501868543475, -2289.0217637538262, -2298.012262526437, -2453.9198505361937, -2361.9046954329865, -2217.902031633715, -2290.9251985899155], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 242.57977913807156, "mean_raw_obs_processing_ms": 21.97718111440452, "mean_inference_ms": 21.542994347336514, "mean_action_processing_ms": 0.12858810667074017}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 724000, "timers": {"sample_time_ms": 581708.773, "sample_throughput": 6.876, "learn_time_ms": 34506.1, "learn_throughput": 115.922, "update_time_ms": 6.78}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06814521586056799, "policy_loss": -0.021739230025559664, "vf_loss": 541.1286888122559, "vf_explained_var": 0.8847655653953552, "kl": 0.011534108693012968, "entropy": 54.12409317493439, "entropy_coeff": 0.001}}, "num_steps_sampled": 724000, "num_steps_trained": 724000}, "done": false, "episodes_total": 724, "training_iteration": 181, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_20-27-19", "timestamp": 1618316839, "time_this_iter_s": 637.8556690216064, "time_total_s": 100035.4071650505, "pid": 2768, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6770.5584807395935, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 40.8389010989011, "ram_util_percent": 84.31505494505494}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2191.652599271468, "episode_reward_min": -2363.1643814336257, "episode_reward_mean": -2306.070143883193, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2362.188159361461, -2307.275435466216, -2191.652599271468, -2363.1643814336257], "episode_lengths": [1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 179.48969300540313, "mean_raw_obs_processing_ms": 16.9084334838158, "mean_inference_ms": 15.910898251035462, "mean_action_processing_ms": 0.10092028494419782}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 724000, "timers": {"sample_time_ms": 425642.933, "sample_throughput": 9.398, "learn_time_ms": 21338.79, "learn_throughput": 187.452, "update_time_ms": 3.629}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.057772527914494276, "policy_loss": -0.018589985091239214, "vf_loss": 1217.0083293914795, "vf_explained_var": 0.7779369950294495, "kl": 0.013411212683422491, "entropy": 54.03486454486847, "entropy_coeff": 0.001}}, "num_steps_sampled": 724000, "num_steps_trained": 724000}, "done": false, "episodes_total": 724, "training_iteration": 181, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_20-54-30", "timestamp": 1618318470, "time_this_iter_s": 447.0027210712433, "time_total_s": 99844.55421710014, "pid": 2165, "hostname": "magicbook-ubuntu-20-10", "node_ip": "192.168.3.10", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 447.0027210712433, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.79952978056426, "ram_util_percent": 75.26551724137931}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2191.652599271468, "episode_reward_min": -2438.173012761395, "episode_reward_mean": -2330.2639888253443, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2367.8823958017006, -2438.173012761395, -2221.2311941457347, -2390.5447323611547, -2362.188159361461, -2307.275435466216, -2191.652599271468, -2363.1643814336257], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 179.78333776346562, "mean_raw_obs_processing_ms": 16.88706233929304, "mean_inference_ms": 15.9542231748004, "mean_action_processing_ms": 0.10104269093631647}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 728000, "timers": {"sample_time_ms": 427811.27, "sample_throughput": 9.35, "learn_time_ms": 21324.298, "learn_throughput": 187.579, "update_time_ms": 3.584}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06039376408443786, "policy_loss": -0.01723155635409057, "vf_loss": 704.9091300964355, "vf_explained_var": 0.8651725053787231, "kl": 0.018027055892162025, "entropy": 53.81670928001404, "entropy_coeff": 0.001}}, "num_steps_sampled": 728000, "num_steps_trained": 728000}, "done": false, "episodes_total": 728, "training_iteration": 182, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_21-02-01", "timestamp": 1618318921, "time_this_iter_s": 451.2979667186737, "time_total_s": 100295.85218381882, "pid": 2165, "hostname": "magicbook-ubuntu-20-10", "node_ip": "192.168.3.10", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 898.300687789917, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 25.682298136645958, "ram_util_percent": 80.34208074534162}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2191.652599271468, "episode_reward_min": -2438.173012761395, "episode_reward_mean": -2329.619274713285, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2385.160216166352, -2379.2356020114116, -2305.19869866727, -2243.724869111629, -2362.188159361461, -2307.275435466216, -2191.652599271468, -2363.1643814336257, -2367.8823958017006, -2438.173012761395, -2221.2311941457347, -2390.5447323611547], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 179.89441347052386, "mean_raw_obs_processing_ms": 16.86183722612083, "mean_inference_ms": 15.985323127871682, "mean_action_processing_ms": 0.10116724546959632}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 732000, "timers": {"sample_time_ms": 427890.989, "sample_throughput": 9.348, "learn_time_ms": 21299.421, "learn_throughput": 187.799, "update_time_ms": 3.582}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.0593485789722763, "policy_loss": -0.018383059708867222, "vf_loss": 990.5606327056885, "vf_explained_var": 0.8008826971054077, "kl": 0.015336975484387949, "entropy": 53.93851721286774, "entropy_coeff": 0.001}}, "num_steps_sampled": 732000, "num_steps_trained": 732000}, "done": false, "episodes_total": 732, "training_iteration": 183, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_21-09-31", "timestamp": 1618319371, "time_this_iter_s": 449.31012511253357, "time_total_s": 100745.16230893135, "pid": 2165, "hostname": "magicbook-ubuntu-20-10", "node_ip": "192.168.3.10", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1347.6108129024506, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 25.701404056162243, "ram_util_percent": 79.91575663026521}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2191.652599271468, "episode_reward_min": -2438.173012761395, "episode_reward_mean": -2320.282747098129, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2319.38741940676, -2321.664697914438, -2201.278129951779, -2326.7624097376693, -2362.188159361461, -2307.275435466216, -2191.652599271468, -2363.1643814336257, -2367.8823958017006, -2438.173012761395, -2221.2311941457347, -2390.5447323611547, -2385.160216166352, -2379.2356020114116, -2305.19869866727, -2243.724869111629], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 180.01911720551726, "mean_raw_obs_processing_ms": 16.854037381598143, "mean_inference_ms": 16.004012870118125, "mean_action_processing_ms": 0.10124956569764051}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 736000, "timers": {"sample_time_ms": 428405.919, "sample_throughput": 9.337, "learn_time_ms": 21334.086, "learn_throughput": 187.493, "update_time_ms": 3.606}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06756809377111495, "policy_loss": -0.02342533861519769, "vf_loss": 674.666784286499, "vf_explained_var": 0.8377780914306641, "kl": 0.014376072387676686, "entropy": 53.764636278152466, "entropy_coeff": 0.001}}, "num_steps_sampled": 736000, "num_steps_trained": 736000}, "done": false, "episodes_total": 736, "training_iteration": 184, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_21-17-02", "timestamp": 1618319822, "time_this_iter_s": 451.3972465991974, "time_total_s": 101196.55955553055, "pid": 2165, "hostname": "magicbook-ubuntu-20-10", "node_ip": "192.168.3.10", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1799.008059501648, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.745962732919256, "ram_util_percent": 79.42251552795031}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2225.086256245478, "episode_reward_min": -2459.6895605680375, "episode_reward_mean": -2343.627938860095, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2459.6895605680375, -2429.8549039206837, -2259.8810347061803, -2225.086256245478], "episode_lengths": [1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 180.1713076548121, "mean_raw_obs_processing_ms": 16.921136451923267, "mean_inference_ms": 15.847743004337065, "mean_action_processing_ms": 0.10230748549751614}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 724000, "timers": {"sample_time_ms": 428606.203, "sample_throughput": 9.333, "learn_time_ms": 20754.557, "learn_throughput": 192.729, "update_time_ms": 3.704}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05498790953424759, "policy_loss": -0.011721339571522549, "vf_loss": 846.5649356842041, "vf_explained_var": 0.8275644183158875, "kl": 0.012086837727110833, "entropy": 54.14958941936493, "entropy_coeff": 0.001}}, "num_steps_sampled": 724000, "num_steps_trained": 724000}, "done": false, "episodes_total": 724, "training_iteration": 181, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_22-24-33", "timestamp": 1618323873, "time_this_iter_s": 449.37492084503174, "time_total_s": 99846.92641687393, "pid": 5225, "hostname": "magicbook-ubuntu-20-10", "node_ip": "192.168.3.10", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 449.37492084503174, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.710124610591897, "ram_util_percent": 75.79096573208723}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2225.086256245478, "episode_reward_min": -2459.6895605680375, "episode_reward_mean": -2339.5458676634835, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2344.334916017332, -2243.4125462105535, -2455.373311229639, -2298.734412409963, -2459.6895605680375, -2429.8549039206837, -2259.8810347061803, -2225.086256245478], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 180.50669662190325, "mean_raw_obs_processing_ms": 16.895786493419116, "mean_inference_ms": 15.909948197883176, "mean_action_processing_ms": 0.10257528506062884}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 728000, "timers": {"sample_time_ms": 430042.924, "sample_throughput": 9.301, "learn_time_ms": 20868.604, "learn_throughput": 191.675, "update_time_ms": 3.659}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05367544706678018, "policy_loss": -0.012604161514900625, "vf_loss": 1008.2891178131104, "vf_explained_var": 0.8006253242492676, "kl": 0.01608122285688296, "entropy": 54.37041997909546, "entropy_coeff": 0.001}}, "num_steps_sampled": 728000, "num_steps_trained": 728000}, "done": false, "episodes_total": 728, "training_iteration": 182, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_22-32-06", "timestamp": 1618324326, "time_this_iter_s": 452.47125339508057, "time_total_s": 100299.39767026901, "pid": 5225, "hostname": "magicbook-ubuntu-20-10", "node_ip": "192.168.3.10", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 901.8461742401123, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 25.775813953488374, "ram_util_percent": 80.50945736434109}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2204.9115791481186, "episode_reward_min": -2459.6895605680375, "episode_reward_mean": -2333.354824301363, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2204.9115791481186, -2419.022451144579, -2333.256623165786, -2326.700296850003, -2459.6895605680375, -2429.8549039206837, -2259.8810347061803, -2225.086256245478, -2344.334916017332, -2243.4125462105535, -2455.373311229639, -2298.734412409963], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 180.48980818937108, "mean_raw_obs_processing_ms": 16.876174061650115, "mean_inference_ms": 15.941330450834128, "mean_action_processing_ms": 0.10269652318575832}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 732000, "timers": {"sample_time_ms": 429312.122, "sample_throughput": 9.317, "learn_time_ms": 20901.279, "learn_throughput": 191.376, "update_time_ms": 3.645}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.0643452814547345, "policy_loss": -0.020160178566584364, "vf_loss": 804.5846319198608, "vf_explained_var": 0.8269863128662109, "kl": 0.011092802276834846, "entropy": 54.449504137039185, "entropy_coeff": 0.001}}, "num_steps_sampled": 732000, "num_steps_trained": 732000}, "done": false, "episodes_total": 732, "training_iteration": 183, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_22-39-35", "timestamp": 1618324775, "time_this_iter_s": 448.8259119987488, "time_total_s": 100748.22358226776, "pid": 5225, "hostname": "magicbook-ubuntu-20-10", "node_ip": "192.168.3.10", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1350.672086238861, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 25.721684867394693, "ram_util_percent": 80.38127925117004}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2168.435431989754, "episode_reward_min": -2459.6895605680375, "episode_reward_mean": -2306.6984087458204, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2213.190026578392, -2168.435431989754, -2284.740350492915, -2240.550839255713, -2459.6895605680375, -2429.8549039206837, -2259.8810347061803, -2225.086256245478, -2344.334916017332, -2243.4125462105535, -2455.373311229639, -2298.734412409963, -2204.9115791481186, -2419.022451144579, -2333.256623165786, -2326.700296850003], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 180.47610395807243, "mean_raw_obs_processing_ms": 16.85555677869652, "mean_inference_ms": 15.960897916797183, "mean_action_processing_ms": 0.10278770134944559}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 736000, "timers": {"sample_time_ms": 429278.959, "sample_throughput": 9.318, "learn_time_ms": 20936.664, "learn_throughput": 191.052, "update_time_ms": 3.618}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05924874095944688, "policy_loss": -0.015376823488622904, "vf_loss": 716.2507605552673, "vf_explained_var": 0.8526843190193176, "kl": 0.017978653573663905, "entropy": 54.63015329837799, "entropy_coeff": 0.001}}, "num_steps_sampled": 736000, "num_steps_trained": 736000}, "done": false, "episodes_total": 736, "training_iteration": 184, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_22-47-05", "timestamp": 1618325225, "time_this_iter_s": 450.2307651042938, "time_total_s": 101198.45434737206, "pid": 5225, "hostname": "magicbook-ubuntu-20-10", "node_ip": "192.168.3.10", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1800.902851343155, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.739096573208723, "ram_util_percent": 80.64236760124611}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2168.435431989754, "episode_reward_min": -2459.6895605680375, "episode_reward_mean": -2304.7479768979124, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2200.584808074865, -2277.843350469702, -2275.134948489541, -2434.221890991009, -2459.6895605680375, -2429.8549039206837, -2259.8810347061803, -2225.086256245478, -2344.334916017332, -2243.4125462105535, -2455.373311229639, -2298.734412409963, -2204.9115791481186, -2419.022451144579, -2333.256623165786, -2326.700296850003, -2213.190026578392, -2168.435431989754, -2284.740350492915, -2240.550839255713], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 180.4590307800108, "mean_raw_obs_processing_ms": 16.840706376413568, "mean_inference_ms": 15.975779524291317, "mean_action_processing_ms": 0.10286208149957501}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 740000, "timers": {"sample_time_ms": 429254.225, "sample_throughput": 9.318, "learn_time_ms": 20946.278, "learn_throughput": 190.965, "update_time_ms": 3.602}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05929907865356654, "policy_loss": -0.017829860880738124, "vf_loss": 1047.3061599731445, "vf_explained_var": 0.7847558259963989, "kl": 0.012886216805782169, "entropy": 54.51952052116394, "entropy_coeff": 0.001}}, "num_steps_sampled": 740000, "num_steps_trained": 740000}, "done": false, "episodes_total": 740, "training_iteration": 185, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_22-54-35", "timestamp": 1618325675, "time_this_iter_s": 450.1485722064972, "time_total_s": 101648.60291957855, "pid": 5225, "hostname": "magicbook-ubuntu-20-10", "node_ip": "192.168.3.10", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2251.051423549652, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 25.727570093457942, "ram_util_percent": 79.43130841121494}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2168.435431989754, "episode_reward_min": -2701.733442859894, "episode_reward_mean": -2320.656862688697, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2308.1616358557026, -2300.2419679433715, -2701.733442859894, -2290.668119911511, -2459.6895605680375, -2429.8549039206837, -2259.8810347061803, -2225.086256245478, -2344.334916017332, -2243.4125462105535, -2455.373311229639, -2298.734412409963, -2204.9115791481186, -2419.022451144579, -2333.256623165786, -2326.700296850003, -2213.190026578392, -2168.435431989754, -2284.740350492915, -2240.550839255713, -2200.584808074865, -2277.843350469702, -2275.134948489541, -2434.221890991009], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 180.46575291786118, "mean_raw_obs_processing_ms": 16.834585208187963, "mean_inference_ms": 15.98729312812587, "mean_action_processing_ms": 0.10292003220883468}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 744000, "timers": {"sample_time_ms": 429286.787, "sample_throughput": 9.318, "learn_time_ms": 20924.851, "learn_throughput": 191.16, "update_time_ms": 3.593}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05587270046817139, "policy_loss": -0.01317046515760012, "vf_loss": 869.1576585769653, "vf_explained_var": 0.8391806483268738, "kl": 0.01596041291486472, "entropy": 54.58589148521423, "entropy_coeff": 0.001}}, "num_steps_sampled": 744000, "num_steps_trained": 744000}, "done": false, "episodes_total": 744, "training_iteration": 186, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_23-02-05", "timestamp": 1618326125, "time_this_iter_s": 450.2760534286499, "time_total_s": 102098.8789730072, "pid": 5225, "hostname": "magicbook-ubuntu-20-10", "node_ip": "192.168.3.10", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2701.327476978302, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 25.820249221183804, "ram_util_percent": 80.53271028037383}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2168.435431989754, "episode_reward_min": -2701.733442859894, "episode_reward_mean": -2318.0248503789812, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2184.419380133585, -2406.780702008315, -2304.875921945015, -2312.85510199583, -2459.6895605680375, -2429.8549039206837, -2259.8810347061803, -2225.086256245478, -2344.334916017332, -2243.4125462105535, -2455.373311229639, -2298.734412409963, -2204.9115791481186, -2419.022451144579, -2333.256623165786, -2326.700296850003, -2213.190026578392, -2168.435431989754, -2284.740350492915, -2240.550839255713, -2200.584808074865, -2277.843350469702, -2275.134948489541, -2434.221890991009, -2308.1616358557026, -2300.2419679433715, -2701.733442859894, -2290.668119911511], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 180.48484644257215, "mean_raw_obs_processing_ms": 16.831564759196933, "mean_inference_ms": 15.9964949200354, "mean_action_processing_ms": 0.10296763511934036}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 748000, "timers": {"sample_time_ms": 429417.054, "sample_throughput": 9.315, "learn_time_ms": 20927.495, "learn_throughput": 191.136, "update_time_ms": 3.596}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.0702454152633436, "policy_loss": -0.026328240433940664, "vf_loss": 802.6999416351318, "vf_explained_var": 0.8292071223258972, "kl": 0.013146336015779525, "entropy": 54.57343590259552, "entropy_coeff": 0.001}}, "num_steps_sampled": 748000, "num_steps_trained": 748000}, "done": false, "episodes_total": 748, "training_iteration": 187, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_23-09-36", "timestamp": 1618326576, "time_this_iter_s": 451.1508560180664, "time_total_s": 102550.02982902527, "pid": 5225, "hostname": "magicbook-ubuntu-20-10", "node_ip": "192.168.3.10", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3152.4783329963684, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 25.787577639751554, "ram_util_percent": 80.14425465838511}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2168.435431989754, "episode_reward_min": -2701.733442859894, "episode_reward_mean": -2313.8918862744986, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2298.4928253239536, -2292.7730900406123, -2328.6668392847882, -2219.911795523127, -2459.6895605680375, -2429.8549039206837, -2259.8810347061803, -2225.086256245478, -2344.334916017332, -2243.4125462105535, -2455.373311229639, -2298.734412409963, -2204.9115791481186, -2419.022451144579, -2333.256623165786, -2326.700296850003, -2213.190026578392, -2168.435431989754, -2284.740350492915, -2240.550839255713, -2200.584808074865, -2277.843350469702, -2275.134948489541, -2434.221890991009, -2308.1616358557026, -2300.2419679433715, -2701.733442859894, -2290.668119911511, -2184.419380133585, -2406.780702008315, -2304.875921945015, -2312.85510199583], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 180.51477478311648, "mean_raw_obs_processing_ms": 16.831104603718664, "mean_inference_ms": 16.004032365754405, "mean_action_processing_ms": 0.10300895923228386}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 752000, "timers": {"sample_time_ms": 429687.925, "sample_throughput": 9.309, "learn_time_ms": 20927.603, "learn_throughput": 191.135, "update_time_ms": 3.596}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06200278698815964, "policy_loss": -0.018452740856446326, "vf_loss": 782.2730722427368, "vf_explained_var": 0.8212184906005859, "kl": 0.016199224308365956, "entropy": 54.61261868476868, "entropy_coeff": 0.001}}, "num_steps_sampled": 752000, "num_steps_trained": 752000}, "done": false, "episodes_total": 752, "training_iteration": 188, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_23-17-09", "timestamp": 1618327029, "time_this_iter_s": 452.520840883255, "time_total_s": 103002.55066990852, "pid": 5225, "hostname": "magicbook-ubuntu-20-10", "node_ip": "192.168.3.10", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3604.9991738796234, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 25.796904024767805, "ram_util_percent": 80.33467492260061}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2168.435431989754, "episode_reward_min": -2701.733442859894, "episode_reward_mean": -2311.5093117899264, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2343.9601070136014, -2252.3311057095343, -2325.942019691379, -2247.561631238896, -2459.6895605680375, -2429.8549039206837, -2259.8810347061803, -2225.086256245478, -2344.334916017332, -2243.4125462105535, -2455.373311229639, -2298.734412409963, -2204.9115791481186, -2419.022451144579, -2333.256623165786, -2326.700296850003, -2213.190026578392, -2168.435431989754, -2284.740350492915, -2240.550839255713, -2200.584808074865, -2277.843350469702, -2275.134948489541, -2434.221890991009, -2308.1616358557026, -2300.2419679433715, -2701.733442859894, -2290.668119911511, -2184.419380133585, -2406.780702008315, -2304.875921945015, -2312.85510199583, -2298.4928253239536, -2292.7730900406123, -2328.6668392847882, -2219.911795523127], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 180.53010238726569, "mean_raw_obs_processing_ms": 16.828655056135933, "mean_inference_ms": 16.010427930713636, "mean_action_processing_ms": 0.10304322695828493}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 756000, "timers": {"sample_time_ms": 429465.945, "sample_throughput": 9.314, "learn_time_ms": 20927.974, "learn_throughput": 191.132, "update_time_ms": 3.583}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06743250112049282, "policy_loss": -0.02101943112211302, "vf_loss": 481.28892040252686, "vf_explained_var": 0.8974609375, "kl": 0.017570240539498627, "entropy": 54.740004777908325, "entropy_coeff": 0.001}}, "num_steps_sampled": 756000, "num_steps_trained": 756000}, "done": false, "episodes_total": 756, "training_iteration": 189, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_23-24-38", "timestamp": 1618327478, "time_this_iter_s": 448.6296503543854, "time_total_s": 103451.18032026291, "pid": 5225, "hostname": "magicbook-ubuntu-20-10", "node_ip": "192.168.3.10", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4053.628824234009, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 25.76125, "ram_util_percent": 79.88125}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2168.435431989754, "episode_reward_min": -2701.733442859894, "episode_reward_mean": -2307.726692831164, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2206.1629877303544, -2369.471637872109, -2273.707513250233, -2245.39034995651, -2459.6895605680375, -2429.8549039206837, -2259.8810347061803, -2225.086256245478, -2344.334916017332, -2243.4125462105535, -2455.373311229639, -2298.734412409963, -2204.9115791481186, -2419.022451144579, -2333.256623165786, -2326.700296850003, -2213.190026578392, -2168.435431989754, -2284.740350492915, -2240.550839255713, -2200.584808074865, -2277.843350469702, -2275.134948489541, -2434.221890991009, -2308.1616358557026, -2300.2419679433715, -2701.733442859894, -2290.668119911511, -2184.419380133585, -2406.780702008315, -2304.875921945015, -2312.85510199583, -2298.4928253239536, -2292.7730900406123, -2328.6668392847882, -2219.911795523127, -2343.9601070136014, -2252.3311057095343, -2325.942019691379, -2247.561631238896], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 180.55288785943358, "mean_raw_obs_processing_ms": 16.827390511663474, "mean_inference_ms": 16.015738812940416, "mean_action_processing_ms": 0.10307220937073006}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 760000, "timers": {"sample_time_ms": 429725.918, "sample_throughput": 9.308, "learn_time_ms": 20932.697, "learn_throughput": 191.089, "update_time_ms": 3.589}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.058398148481501266, "policy_loss": -0.0149045858415775, "vf_loss": 825.9394025802612, "vf_explained_var": 0.8379430770874023, "kl": 0.015450201055500656, "entropy": 54.84299623966217, "entropy_coeff": 0.001}}, "num_steps_sampled": 760000, "num_steps_trained": 760000}, "done": false, "episodes_total": 760, "training_iteration": 190, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-13_23-32-11", "timestamp": 1618327931, "time_this_iter_s": 453.0510070323944, "time_total_s": 103904.2313272953, "pid": 5225, "hostname": "magicbook-ubuntu-20-10", "node_ip": "192.168.3.10", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4506.679831266403, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 25.757739938080494, "ram_util_percent": 80.6859133126935}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2182.9690478670036, "episode_reward_min": -2391.3617660280433, "episode_reward_mean": -2274.777796529296, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2182.9690478670036, -2290.623203973452, -2234.157168248686, -2391.3617660280433], "episode_lengths": [1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 188.11605353167153, "mean_raw_obs_processing_ms": 18.132725279072652, "mean_inference_ms": 16.79307833008621, "mean_action_processing_ms": 0.10423508958182652}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 744000, "timers": {"sample_time_ms": 447606.723, "sample_throughput": 8.936, "learn_time_ms": 20820.264, "learn_throughput": 192.121, "update_time_ms": 9.685}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05594362906413153, "policy_loss": -0.00993231192114763, "vf_loss": 643.217658996582, "vf_explained_var": 0.8531970977783203, "kl": 0.011076293245423585, "entropy": 54.658748149871826, "entropy_coeff": 0.001}}, "num_steps_sampled": 744000, "num_steps_trained": 744000}, "done": false, "episodes_total": 744, "training_iteration": 186, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-14_08-17-04", "timestamp": 1618359424, "time_this_iter_s": 468.4554588794708, "time_total_s": 102117.05837845802, "pid": 2796, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 468.4554588794708, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 28.961136023916293, "ram_util_percent": 80.66606875934231}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2182.9690478670036, "episode_reward_min": -2391.3617660280433, "episode_reward_mean": -2274.3014750532834, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2270.130440194368, -2226.0843877942757, -2388.429573693172, -2210.6562126272665, -2182.9690478670036, -2290.623203973452, -2234.157168248686, -2391.3617660280433], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 186.43012992456204, "mean_raw_obs_processing_ms": 18.49409911304887, "mean_inference_ms": 16.660215056272897, "mean_action_processing_ms": 0.10379551668301867}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 748000, "timers": {"sample_time_ms": 442295.979, "sample_throughput": 9.044, "learn_time_ms": 20800.131, "learn_throughput": 192.306, "update_time_ms": 6.675}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06214528845157474, "policy_loss": -0.017291465890593827, "vf_loss": 686.9676260948181, "vf_explained_var": 0.8511551022529602, "kl": 0.013666217448189855, "entropy": 54.456740736961365, "entropy_coeff": 0.001}}, "num_steps_sampled": 748000, "num_steps_trained": 748000}, "done": false, "episodes_total": 748, "training_iteration": 187, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-14_08-24-42", "timestamp": 1618359882, "time_this_iter_s": 457.7738947868347, "time_total_s": 102574.83227324486, "pid": 2796, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 926.2293536663055, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 26.87871362940276, "ram_util_percent": 87.09035222052067}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2182.9690478670036, "episode_reward_min": -2404.909559260344, "episode_reward_mean": -2289.162452600547, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2404.909559260344, -2343.2667635118014, -2285.8320404130736, -2241.5292675950827, -2182.9690478670036, -2290.623203973452, -2234.157168248686, -2391.3617660280433, -2270.130440194368, -2226.0843877942757, -2388.429573693172, -2210.6562126272665], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 190.1365741021996, "mean_raw_obs_processing_ms": 19.49592662988395, "mean_inference_ms": 16.97685310021153, "mean_action_processing_ms": 0.10551765084603619}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 752000, "timers": {"sample_time_ms": 475470.985, "sample_throughput": 8.413, "learn_time_ms": 25535.627, "learn_throughput": 156.644, "update_time_ms": 7.72}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05444717354839668, "policy_loss": -0.010963994136545807, "vf_loss": 845.9177932739258, "vf_explained_var": 0.8443304300308228, "kl": 0.014909098797943443, "entropy": 54.92417645454407, "entropy_coeff": 0.001}}, "num_steps_sampled": 752000, "num_steps_trained": 752000}, "done": false, "episodes_total": 752, "training_iteration": 188, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-14_08-34-19", "timestamp": 1618360459, "time_this_iter_s": 576.8543839454651, "time_total_s": 103151.68665719032, "pid": 2796, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 1503.0837376117706, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 37.64690157958688, "ram_util_percent": 88.08869987849332}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2182.9690478670036, "episode_reward_min": -2404.909559260344, "episode_reward_mean": -2288.755763126127, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2290.5185491546204, -2287.3167755520167, -2217.2171811075, -2355.0902729973295, -2182.9690478670036, -2290.623203973452, -2234.157168248686, -2391.3617660280433, -2270.130440194368, -2226.0843877942757, -2388.429573693172, -2210.6562126272665, -2404.909559260344, -2343.2667635118014, -2285.8320404130736, -2241.5292675950827], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 195.16068511148347, "mean_raw_obs_processing_ms": 20.296982495546022, "mean_inference_ms": 17.40436291521592, "mean_action_processing_ms": 0.10783034672316835}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 756000, "timers": {"sample_time_ms": 505479.938, "sample_throughput": 7.913, "learn_time_ms": 27389.978, "learn_throughput": 146.039, "update_time_ms": 6.865}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06761529366485775, "policy_loss": -0.021012918441556394, "vf_loss": 588.4780368804932, "vf_explained_var": 0.8768250942230225, "kl": 0.011250713374465704, "entropy": 54.73729622364044, "entropy_coeff": 0.001}}, "num_steps_sampled": 756000, "num_steps_trained": 756000}, "done": false, "episodes_total": 756, "training_iteration": 189, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-14_08-44-47", "timestamp": 1618361087, "time_this_iter_s": 628.4817216396332, "time_total_s": 103780.16837882996, "pid": 2796, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2131.565459251404, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 40.22943143812709, "ram_util_percent": 86.05863991081382}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2182.9690478670036, "episode_reward_min": -2406.917572338621, "episode_reward_mean": -2299.097388346584, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2370.3923887627475, -2283.432763770436, -2406.917572338621, -2301.1128320418306, -2182.9690478670036, -2290.623203973452, -2234.157168248686, -2391.3617660280433, -2270.130440194368, -2226.0843877942757, -2388.429573693172, -2210.6562126272665, -2404.909559260344, -2343.2667635118014, -2285.8320404130736, -2241.5292675950827, -2290.5185491546204, -2287.3167755520167, -2217.2171811075, -2355.0902729973295], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 199.66009654042455, "mean_raw_obs_processing_ms": 20.924490865424865, "mean_inference_ms": 17.787549138179493, "mean_action_processing_ms": 0.10989752081993762}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 760000, "timers": {"sample_time_ms": 523143.788, "sample_throughput": 7.646, "learn_time_ms": 28873.695, "learn_throughput": 138.534, "update_time_ms": 6.666}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.057770211657043546, "policy_loss": -0.012551520427223295, "vf_loss": 727.8188152313232, "vf_explained_var": 0.8492807149887085, "kl": 0.012150744179962203, "entropy": 54.92702293395996, "entropy_coeff": 0.001}}, "num_steps_sampled": 760000, "num_steps_trained": 760000}, "done": false, "episodes_total": 760, "training_iteration": 190, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-14_08-55-16", "timestamp": 1618361716, "time_this_iter_s": 628.6244692802429, "time_total_s": 104408.7928481102, "pid": 2796, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 2760.1899285316467, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 40.38171683389075, "ram_util_percent": 85.58082497212932}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2182.9690478670036, "episode_reward_min": -2458.9219018124472, "episode_reward_mean": -2308.2579944588406, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2332.8063457008243, -2284.1544579932315, -2458.9219018124472, -2340.3613945740026, -2182.9690478670036, -2290.623203973452, -2234.157168248686, -2391.3617660280433, -2270.130440194368, -2226.0843877942757, -2388.429573693172, -2210.6562126272665, -2404.909559260344, -2343.2667635118014, -2285.8320404130736, -2241.5292675950827, -2290.5185491546204, -2287.3167755520167, -2217.2171811075, -2355.0902729973295, -2370.3923887627475, -2283.432763770436, -2406.917572338621, -2301.1128320418306], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 203.60907339286578, "mean_raw_obs_processing_ms": 21.42420992444381, "mean_inference_ms": 18.122469660601173, "mean_action_processing_ms": 0.1116867568714689}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 764000, "timers": {"sample_time_ms": 536639.533, "sample_throughput": 7.454, "learn_time_ms": 29876.462, "learn_throughput": 133.885, "update_time_ms": 6.236}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.056850951455999166, "policy_loss": -0.014117615588475019, "vf_loss": 988.4844303131104, "vf_explained_var": 0.8190328478813171, "kl": 0.01211069233249873, "entropy": 55.040319204330444, "entropy_coeff": 0.001}}, "num_steps_sampled": 764000, "num_steps_trained": 764000}, "done": false, "episodes_total": 764, "training_iteration": 191, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-14_09-05-55", "timestamp": 1618362355, "time_this_iter_s": 639.0262525081635, "time_total_s": 105047.81910061836, "pid": 2796, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 3399.21618103981, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 41.49132821075741, "ram_util_percent": 85.75345773874862}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2182.9690478670036, "episode_reward_min": -2479.112294471735, "episode_reward_mean": -2312.3177741440018, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2283.530682244974, -2350.3566740751585, -2233.706158228009, -2479.112294471735, -2182.9690478670036, -2290.623203973452, -2234.157168248686, -2391.3617660280433, -2270.130440194368, -2226.0843877942757, -2388.429573693172, -2210.6562126272665, -2404.909559260344, -2343.2667635118014, -2285.8320404130736, -2241.5292675950827, -2290.5185491546204, -2287.3167755520167, -2217.2171811075, -2355.0902729973295, -2370.3923887627475, -2283.432763770436, -2406.917572338621, -2301.1128320418306, -2332.8063457008243, -2284.1544579932315, -2458.9219018124472, -2340.3613945740026], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 207.1366595603467, "mean_raw_obs_processing_ms": 21.839934640481108, "mean_inference_ms": 18.422436201410353, "mean_action_processing_ms": 0.11331292813896357}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 768000, "timers": {"sample_time_ms": 548353.854, "sample_throughput": 7.295, "learn_time_ms": 30623.111, "learn_throughput": 130.62, "update_time_ms": 5.921}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.0618170291709248, "policy_loss": -0.021164299047086388, "vf_loss": 1133.3534660339355, "vf_explained_var": 0.7504876852035522, "kl": 0.014877155103022233, "entropy": 54.96169197559357, "entropy_coeff": 0.001}}, "num_steps_sampled": 768000, "num_steps_trained": 768000}, "done": false, "episodes_total": 768, "training_iteration": 192, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-14_09-16-49", "timestamp": 1618363009, "time_this_iter_s": 653.7705924510956, "time_total_s": 105701.58969306946, "pid": 2796, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4052.9867734909058, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 43.35380493033226, "ram_util_percent": 84.85905680600214}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2182.9690478670036, "episode_reward_min": -2479.112294471735, "episode_reward_mean": -2317.579256579502, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2306.2305628452423, -2287.6406050159035, -2398.2660209033115, -2425.5013457475466, -2182.9690478670036, -2290.623203973452, -2234.157168248686, -2391.3617660280433, -2270.130440194368, -2226.0843877942757, -2388.429573693172, -2210.6562126272665, -2404.909559260344, -2343.2667635118014, -2285.8320404130736, -2241.5292675950827, -2290.5185491546204, -2287.3167755520167, -2217.2171811075, -2355.0902729973295, -2370.3923887627475, -2283.432763770436, -2406.917572338621, -2301.1128320418306, -2332.8063457008243, -2284.1544579932315, -2458.9219018124472, -2340.3613945740026, -2283.530682244974, -2350.3566740751585, -2233.706158228009, -2479.112294471735], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 209.97645967350846, "mean_raw_obs_processing_ms": 22.156418137530505, "mean_inference_ms": 18.662985777150162, "mean_action_processing_ms": 0.11461169335849469}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 772000, "timers": {"sample_time_ms": 551730.454, "sample_throughput": 7.25, "learn_time_ms": 30724.544, "learn_throughput": 130.189, "update_time_ms": 5.915}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06846858415519819, "policy_loss": -0.021499652415513992, "vf_loss": 517.3747615814209, "vf_explained_var": 0.8905925154685974, "kl": 0.014566169993486255, "entropy": 55.055912017822266, "entropy_coeff": 0.001}}, "num_steps_sampled": 772000, "num_steps_trained": 772000}, "done": false, "episodes_total": 772, "training_iteration": 193, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-14_09-26-56", "timestamp": 1618363616, "time_this_iter_s": 606.817875623703, "time_total_s": 106308.40756869316, "pid": 2796, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 4659.804649114609, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 38.4972286374134, "ram_util_percent": 83.29919168591223}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2182.9690478670036, "episode_reward_min": -2479.112294471735, "episode_reward_mean": -2316.1409084652337, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2361.390246788224, -2219.7619599140503, -2312.547643035166, -2324.836644466929, -2182.9690478670036, -2290.623203973452, -2234.157168248686, -2391.3617660280433, -2270.130440194368, -2226.0843877942757, -2388.429573693172, -2210.6562126272665, -2404.909559260344, -2343.2667635118014, -2285.8320404130736, -2241.5292675950827, -2290.5185491546204, -2287.3167755520167, -2217.2171811075, -2355.0902729973295, -2370.3923887627475, -2283.432763770436, -2406.917572338621, -2301.1128320418306, -2332.8063457008243, -2284.1544579932315, -2458.9219018124472, -2340.3613945740026, -2283.530682244974, -2350.3566740751585, -2233.706158228009, -2479.112294471735, -2306.2305628452423, -2287.6406050159035, -2398.2660209033115, -2425.5013457475466], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 212.17828289995998, "mean_raw_obs_processing_ms": 22.41763669582708, "mean_inference_ms": 18.852182241885814, "mean_action_processing_ms": 0.11564378488977699}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 776000, "timers": {"sample_time_ms": 551840.024, "sample_throughput": 7.248, "learn_time_ms": 31073.842, "learn_throughput": 128.726, "update_time_ms": 5.694}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06365308270324022, "policy_loss": -0.016456270299386233, "vf_loss": 571.7703056335449, "vf_explained_var": 0.8915573358535767, "kl": 0.010977948200888932, "entropy": 55.11010205745697, "entropy_coeff": 0.001}}, "num_steps_sampled": 776000, "num_steps_trained": 776000}, "done": false, "episodes_total": 776, "training_iteration": 194, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-14_09-36-42", "timestamp": 1618364202, "time_this_iter_s": 586.6008992195129, "time_total_s": 106895.00846791267, "pid": 2796, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5246.405548334122, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 36.438397129186605, "ram_util_percent": 82.51495215311004}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2179.993148252286, "episode_reward_min": -2479.112294471735, "episode_reward_mean": -2310.612974567435, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2179.993148252286, -2390.94176557071, -2232.56417687062, -2239.9471872553577, -2182.9690478670036, -2290.623203973452, -2234.157168248686, -2391.3617660280433, -2270.130440194368, -2226.0843877942757, -2388.429573693172, -2210.6562126272665, -2404.909559260344, -2343.2667635118014, -2285.8320404130736, -2241.5292675950827, -2290.5185491546204, -2287.3167755520167, -2217.2171811075, -2355.0902729973295, -2370.3923887627475, -2283.432763770436, -2406.917572338621, -2301.1128320418306, -2332.8063457008243, -2284.1544579932315, -2458.9219018124472, -2340.3613945740026, -2283.530682244974, -2350.3566740751585, -2233.706158228009, -2479.112294471735, -2306.2305628452423, -2287.6406050159035, -2398.2660209033115, -2425.5013457475466, -2361.390246788224, -2219.7619599140503, -2312.547643035166, -2324.836644466929], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 213.69263476578777, "mean_raw_obs_processing_ms": 22.605293004792255, "mean_inference_ms": 18.982779315751834, "mean_action_processing_ms": 0.11636360571412618}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 780000, "timers": {"sample_time_ms": 545977.493, "sample_throughput": 7.326, "learn_time_ms": 30051.184, "learn_throughput": 133.106, "update_time_ms": 5.484}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05273267853772268, "policy_loss": -0.00896370699047111, "vf_loss": 838.6639099121094, "vf_explained_var": 0.835347056388855, "kl": 0.01448930855258368, "entropy": 55.0534702539444, "entropy_coeff": 0.001}}, "num_steps_sampled": 780000, "num_steps_trained": 780000}, "done": false, "episodes_total": 780, "training_iteration": 195, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-14_09-45-17", "timestamp": 1618364717, "time_this_iter_s": 514.0753996372223, "time_total_s": 107409.0838675499, "pid": 2796, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 5760.480947971344, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 32.317029972752046, "ram_util_percent": 77.48991825613079}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2179.993148252286, "episode_reward_min": -2479.112294471735, "episode_reward_mean": -2315.797723530654, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2393.857403916259, -2473.095204479192, -2256.4284296071414, -2347.199814648798, -2182.9690478670036, -2290.623203973452, -2234.157168248686, -2391.3617660280433, -2270.130440194368, -2226.0843877942757, -2388.429573693172, -2210.6562126272665, -2404.909559260344, -2343.2667635118014, -2285.8320404130736, -2241.5292675950827, -2290.5185491546204, -2287.3167755520167, -2217.2171811075, -2355.0902729973295, -2370.3923887627475, -2283.432763770436, -2406.917572338621, -2301.1128320418306, -2332.8063457008243, -2284.1544579932315, -2458.9219018124472, -2340.3613945740026, -2283.530682244974, -2350.3566740751585, -2233.706158228009, -2479.112294471735, -2306.2305628452423, -2287.6406050159035, -2398.2660209033115, -2425.5013457475466, -2361.390246788224, -2219.7619599140503, -2312.547643035166, -2324.836644466929, -2179.993148252286, -2390.94176557071, -2232.56417687062, -2239.9471872553577], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 214.61233478707825, "mean_raw_obs_processing_ms": 22.72211013604278, "mean_inference_ms": 19.063417336041514, "mean_action_processing_ms": 0.11681440965698436}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 784000, "timers": {"sample_time_ms": 546483.514, "sample_throughput": 7.32, "learn_time_ms": 30067.186, "learn_throughput": 133.035, "update_time_ms": 4.882}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.0599128081521485, "policy_loss": -0.012344702205155045, "vf_loss": 487.84145402908325, "vf_explained_var": 0.8997527360916138, "kl": 0.012013554864097387, "entropy": 54.84922742843628, "entropy_coeff": 0.001}}, "num_steps_sampled": 784000, "num_steps_trained": 784000}, "done": false, "episodes_total": 784, "training_iteration": 196, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-14_09-53-10", "timestamp": 1618365190, "time_this_iter_s": 473.66248893737793, "time_total_s": 107882.74635648727, "pid": 2796, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6234.143436908722, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 28.497928994082837, "ram_util_percent": 72.32588757396451}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2179.993148252286, "episode_reward_min": -2483.719565742222, "episode_reward_mean": -2321.29780507804, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2332.0523447554924, -2302.9753168850034, -2483.719565742222, -2408.4475810144004, -2182.9690478670036, -2290.623203973452, -2234.157168248686, -2391.3617660280433, -2270.130440194368, -2226.0843877942757, -2388.429573693172, -2210.6562126272665, -2404.909559260344, -2343.2667635118014, -2285.8320404130736, -2241.5292675950827, -2290.5185491546204, -2287.3167755520167, -2217.2171811075, -2355.0902729973295, -2370.3923887627475, -2283.432763770436, -2406.917572338621, -2301.1128320418306, -2332.8063457008243, -2284.1544579932315, -2458.9219018124472, -2340.3613945740026, -2283.530682244974, -2350.3566740751585, -2233.706158228009, -2479.112294471735, -2306.2305628452423, -2287.6406050159035, -2398.2660209033115, -2425.5013457475466, -2361.390246788224, -2219.7619599140503, -2312.547643035166, -2324.836644466929, -2179.993148252286, -2390.94176557071, -2232.56417687062, -2239.9471872553577, -2393.857403916259, -2473.095204479192, -2256.4284296071414, -2347.199814648798], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 215.1614018172254, "mean_raw_obs_processing_ms": 22.804417463192483, "mean_inference_ms": 19.111588080296695, "mean_action_processing_ms": 0.1170932335747746}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 788000, "timers": {"sample_time_ms": 549301.414, "sample_throughput": 7.282, "learn_time_ms": 30288.621, "learn_throughput": 132.063, "update_time_ms": 4.893}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06285057554487139, "policy_loss": -0.017573655932210386, "vf_loss": 657.3591823577881, "vf_explained_var": 0.8670896291732788, "kl": 0.015408430394018069, "entropy": 54.932194113731384, "entropy_coeff": 0.001}}, "num_steps_sampled": 788000, "num_steps_trained": 788000}, "done": false, "episodes_total": 788, "training_iteration": 197, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-14_10-01-19", "timestamp": 1618365679, "time_this_iter_s": 488.16806745529175, "time_total_s": 108370.91442394257, "pid": 2796, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 6722.311504364014, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 28.76580459770115, "ram_util_percent": 74.60330459770114}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2179.993148252286, "episode_reward_min": -2483.719565742222, "episode_reward_mean": -2322.2426948801776, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2328.2251153370225, -2293.973305398026, -2347.1196916685735, -2365.0073776196928, -2182.9690478670036, -2290.623203973452, -2234.157168248686, -2391.3617660280433, -2270.130440194368, -2226.0843877942757, -2388.429573693172, -2210.6562126272665, -2404.909559260344, -2343.2667635118014, -2285.8320404130736, -2241.5292675950827, -2290.5185491546204, -2287.3167755520167, -2217.2171811075, -2355.0902729973295, -2370.3923887627475, -2283.432763770436, -2406.917572338621, -2301.1128320418306, -2332.8063457008243, -2284.1544579932315, -2458.9219018124472, -2340.3613945740026, -2283.530682244974, -2350.3566740751585, -2233.706158228009, -2479.112294471735, -2306.2305628452423, -2287.6406050159035, -2398.2660209033115, -2425.5013457475466, -2361.390246788224, -2219.7619599140503, -2312.547643035166, -2324.836644466929, -2179.993148252286, -2390.94176557071, -2232.56417687062, -2239.9471872553577, -2393.857403916259, -2473.095204479192, -2256.4284296071414, -2347.199814648798, -2332.0523447554924, -2302.9753168850034, -2483.719565742222, -2408.4475810144004], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 215.50363824503984, "mean_raw_obs_processing_ms": 22.84240746396783, "mean_inference_ms": 19.141756793911327, "mean_action_processing_ms": 0.11727467534404366}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 792000, "timers": {"sample_time_ms": 542569.274, "sample_throughput": 7.372, "learn_time_ms": 29406.358, "learn_throughput": 136.025, "update_time_ms": 4.284}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.0708176220068708, "policy_loss": -0.024486221722327173, "vf_loss": 588.0558910369873, "vf_explained_var": 0.8822046518325806, "kl": 0.012039676861604676, "entropy": 54.619895339012146, "entropy_coeff": 0.001}}, "num_steps_sampled": 792000, "num_steps_trained": 792000}, "done": false, "episodes_total": 792, "training_iteration": 198, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-14_10-09-39", "timestamp": 1618366179, "time_this_iter_s": 500.7021851539612, "time_total_s": 108871.61660909653, "pid": 2796, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7223.013689517975, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 30.79789915966386, "ram_util_percent": 70.537675070028}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2179.993148252286, "episode_reward_min": -2483.719565742222, "episode_reward_mean": -2327.427604524761, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2310.9215435689594, -2455.0735113231426, -2466.41456066758, -2346.916104057698, -2182.9690478670036, -2290.623203973452, -2234.157168248686, -2391.3617660280433, -2270.130440194368, -2226.0843877942757, -2388.429573693172, -2210.6562126272665, -2404.909559260344, -2343.2667635118014, -2285.8320404130736, -2241.5292675950827, -2290.5185491546204, -2287.3167755520167, -2217.2171811075, -2355.0902729973295, -2370.3923887627475, -2283.432763770436, -2406.917572338621, -2301.1128320418306, -2332.8063457008243, -2284.1544579932315, -2458.9219018124472, -2340.3613945740026, -2283.530682244974, -2350.3566740751585, -2233.706158228009, -2479.112294471735, -2306.2305628452423, -2287.6406050159035, -2398.2660209033115, -2425.5013457475466, -2361.390246788224, -2219.7619599140503, -2312.547643035166, -2324.836644466929, -2179.993148252286, -2390.94176557071, -2232.56417687062, -2239.9471872553577, -2393.857403916259, -2473.095204479192, -2256.4284296071414, -2347.199814648798, -2332.0523447554924, -2302.9753168850034, -2483.719565742222, -2408.4475810144004, -2328.2251153370225, -2293.973305398026, -2347.1196916685735, -2365.0073776196928], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 215.71604368237195, "mean_raw_obs_processing_ms": 22.84855652091324, "mean_inference_ms": 19.16014376793504, "mean_action_processing_ms": 0.11739621320495995}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 796000, "timers": {"sample_time_ms": 531167.584, "sample_throughput": 7.531, "learn_time_ms": 28504.516, "learn_throughput": 140.329, "update_time_ms": 4.329}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.0660405759117566, "policy_loss": -0.021813122380990535, "vf_loss": 720.9834499359131, "vf_explained_var": 0.8641059398651123, "kl": 0.015593086020089686, "entropy": 54.55590069293976, "entropy_coeff": 0.001}}, "num_steps_sampled": 796000, "num_steps_trained": 796000}, "done": false, "episodes_total": 796, "training_iteration": 199, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-14_10-18-05", "timestamp": 1618366685, "time_this_iter_s": 505.4364106655121, "time_total_s": 109377.05301976204, "pid": 2796, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 7728.450100183487, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 30.68781163434903, "ram_util_percent": 77.98476454293629}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2179.993148252286, "episode_reward_min": -2517.472101218552, "episode_reward_mean": -2334.401386046948, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2417.9891492559414, -2517.472101218552, -2495.6652508494317, -2297.010808106337, -2182.9690478670036, -2290.623203973452, -2234.157168248686, -2391.3617660280433, -2270.130440194368, -2226.0843877942757, -2388.429573693172, -2210.6562126272665, -2404.909559260344, -2343.2667635118014, -2285.8320404130736, -2241.5292675950827, -2290.5185491546204, -2287.3167755520167, -2217.2171811075, -2355.0902729973295, -2370.3923887627475, -2283.432763770436, -2406.917572338621, -2301.1128320418306, -2332.8063457008243, -2284.1544579932315, -2458.9219018124472, -2340.3613945740026, -2283.530682244974, -2350.3566740751585, -2233.706158228009, -2479.112294471735, -2306.2305628452423, -2287.6406050159035, -2398.2660209033115, -2425.5013457475466, -2361.390246788224, -2219.7619599140503, -2312.547643035166, -2324.836644466929, -2179.993148252286, -2390.94176557071, -2232.56417687062, -2239.9471872553577, -2393.857403916259, -2473.095204479192, -2256.4284296071414, -2347.199814648798, -2332.0523447554924, -2302.9753168850034, -2483.719565742222, -2408.4475810144004, -2328.2251153370225, -2293.973305398026, -2347.1196916685735, -2365.0073776196928, -2310.9215435689594, -2455.0735113231426, -2466.41456066758, -2346.916104057698], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 215.89060885812225, "mean_raw_obs_processing_ms": 22.8406755996744, "mean_inference_ms": 19.174869127321966, "mean_action_processing_ms": 0.11749823383266943}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 800000, "timers": {"sample_time_ms": 522977.121, "sample_throughput": 7.649, "learn_time_ms": 27712.924, "learn_throughput": 144.337, "update_time_ms": 4.749}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06457341695204377, "policy_loss": -0.01821611259947531, "vf_loss": 529.0302495956421, "vf_explained_var": 0.9027112722396851, "kl": 0.013412224914645776, "entropy": 54.33005166053772, "entropy_coeff": 0.001}}, "num_steps_sampled": 800000, "num_steps_trained": 800000}, "done": false, "episodes_total": 800, "training_iteration": 200, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-14_10-27-04", "timestamp": 1618367224, "time_this_iter_s": 538.8182685375214, "time_total_s": 109915.87128829956, "pid": 2796, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8267.268368721008, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 33.748046875, "ram_util_percent": 83.53502604166668}, "trial_id": "75b7d_00000"}
{"episode_reward_max": -2179.993148252286, "episode_reward_min": -2517.472101218552, "episode_reward_mean": -2334.015920914242, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2294.1280309207355, -2331.966884693012, -2364.850137545893, -2321.9907225349866, -2182.9690478670036, -2290.623203973452, -2234.157168248686, -2391.3617660280433, -2270.130440194368, -2226.0843877942757, -2388.429573693172, -2210.6562126272665, -2404.909559260344, -2343.2667635118014, -2285.8320404130736, -2241.5292675950827, -2290.5185491546204, -2287.3167755520167, -2217.2171811075, -2355.0902729973295, -2370.3923887627475, -2283.432763770436, -2406.917572338621, -2301.1128320418306, -2332.8063457008243, -2284.1544579932315, -2458.9219018124472, -2340.3613945740026, -2283.530682244974, -2350.3566740751585, -2233.706158228009, -2479.112294471735, -2306.2305628452423, -2287.6406050159035, -2398.2660209033115, -2425.5013457475466, -2361.390246788224, -2219.7619599140503, -2312.547643035166, -2324.836644466929, -2179.993148252286, -2390.94176557071, -2232.56417687062, -2239.9471872553577, -2393.857403916259, -2473.095204479192, -2256.4284296071414, -2347.199814648798, -2332.0523447554924, -2302.9753168850034, -2483.719565742222, -2408.4475810144004, -2328.2251153370225, -2293.973305398026, -2347.1196916685735, -2365.0073776196928, -2310.9215435689594, -2455.0735113231426, -2466.41456066758, -2346.916104057698, -2417.9891492559414, -2517.472101218552, -2495.6652508494317, -2297.010808106337], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 216.00485966192633, "mean_raw_obs_processing_ms": 22.817124835601085, "mean_inference_ms": 19.184080085777776, "mean_action_processing_ms": 0.11756943130596104}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 804000, "timers": {"sample_time_ms": 511858.13, "sample_throughput": 7.815, "learn_time_ms": 26579.559, "learn_throughput": 150.492, "update_time_ms": 4.712}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.061062143242452294, "policy_loss": -0.015761446236865595, "vf_loss": 644.7682104110718, "vf_explained_var": 0.8684529662132263, "kl": 0.012827422993723303, "entropy": 54.31386041641235, "entropy_coeff": 0.001}}, "num_steps_sampled": 804000, "num_steps_trained": 804000}, "done": false, "episodes_total": 804, "training_iteration": 201, "experiment_id": "c54b8a2e579642c096adf0dc0665b584", "date": "2021-04-14_10-35-40", "timestamp": 1618367740, "time_this_iter_s": 516.4991536140442, "time_total_s": 110432.3704419136, "pid": 2796, "hostname": "magicbook-ubuntu-20-10", "node_ip": "113.54.243.178", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTraffiLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false, "vf_share_layers": -1}, "time_since_restore": 8783.767522335052, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 31.648303934871098, "ram_util_percent": 81.28141112618725}, "trial_id": "75b7d_00000"}
