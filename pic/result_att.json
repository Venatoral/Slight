{"episode_reward_max": -2895.899974414185, "episode_reward_min": -3150.1920204916087, "episode_reward_mean": -3032.6259627622235, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755], "episode_lengths": [1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 712.2121136644851, "mean_raw_obs_processing_ms": 2.6558964089236814, "mean_inference_ms": 146.98756831339273, "mean_action_processing_ms": 0.2895168874455594}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 4000, "timers": {"sample_time_ms": 1731973.252, "sample_throughput": 2.31, "learn_time_ms": 129889.037, "learn_throughput": 30.796, "update_time_ms": 8.37}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 0.28293025703169405, "policy_loss": -0.009938838076777756, "vf_loss": 34037.385314941406, "vf_explained_var": -0.02658839523792267, "kl": 0.008326708571985364, "entropy": 49.170090436935425, "entropy_coeff": 0.001}}, "num_steps_sampled": 4000, "num_steps_trained": 4000}, "done": false, "episodes_total": 4, "training_iteration": 1, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-07_18-30-03", "timestamp": 1617791403, "time_this_iter_s": 1861.8785874843597, "time_total_s": 1861.8785874843597, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 1861.8785874843597, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 15.479743493021502, "ram_util_percent": 16.020369671821953}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2895.899974414185, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -3066.254495042991, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 744.7958127936495, "mean_raw_obs_processing_ms": 2.7335273138873273, "mean_inference_ms": 155.67737044451067, "mean_action_processing_ms": 0.3375134888234278}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 8000, "timers": {"sample_time_ms": 1897942.246, "sample_throughput": 2.108, "learn_time_ms": 146169.37, "learn_throughput": 27.366, "update_time_ms": 13.93}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 0.24736280160141177, "policy_loss": -0.006863617920316756, "vf_loss": 30200.57891845703, "vf_explained_var": -0.0582556277513504, "kl": 0.006845609750598669, "entropy": 49.148478627204895, "entropy_coeff": 0.001}}, "num_steps_sampled": 8000, "num_steps_trained": 8000}, "done": false, "episodes_total": 8, "training_iteration": 2, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-07_19-07-09", "timestamp": 1617793629, "time_this_iter_s": 2226.3882915973663, "time_total_s": 4088.266879081726, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 4088.266879081726, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 15.096403785488958, "ram_util_percent": 17.369621451104102}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2895.899974414185, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -3040.2700841118753, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 766.7653014157223, "mean_raw_obs_processing_ms": 2.814587385716242, "mean_inference_ms": 160.72994568548623, "mean_action_processing_ms": 0.3844388329063695}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 12000, "timers": {"sample_time_ms": 1978131.328, "sample_throughput": 2.022, "learn_time_ms": 172190.346, "learn_throughput": 23.23, "update_time_ms": 20.42}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 0.1802074246807024, "policy_loss": 0.0036563719040714204, "vf_loss": 22428.07000732422, "vf_explained_var": -0.07772526144981384, "kl": 0.007124701518478105, "entropy": 49.15458130836487, "entropy_coeff": 0.001}}, "num_steps_sampled": 12000, "num_steps_trained": 12000}, "done": false, "episodes_total": 12, "training_iteration": 3, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-07_19-46-32", "timestamp": 1617795992, "time_this_iter_s": 2362.783578634262, "time_total_s": 6451.050457715988, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 6451.050457715988, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 22.448483045806064, "ram_util_percent": 23.804848304580606}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2895.899974414185, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -3047.2663748822456, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 780.7296101409609, "mean_raw_obs_processing_ms": 2.8730395974644107, "mean_inference_ms": 164.13929081356736, "mean_action_processing_ms": 0.41208806410647725}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 16000, "timers": {"sample_time_ms": 2009808.766, "sample_throughput": 1.99, "learn_time_ms": 176061.535, "learn_throughput": 22.719, "update_time_ms": 26.131}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 0.151030698325485, "policy_loss": 0.0015271236770786345, "vf_loss": 19762.129638671875, "vf_explained_var": -0.07712557911872864, "kl": 0.0022548719571204856, "entropy": 48.56869077682495, "entropy_coeff": 0.001}}, "num_steps_sampled": 16000, "num_steps_trained": 16000}, "done": false, "episodes_total": 16, "training_iteration": 4, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-07_20-24-45", "timestamp": 1617798285, "time_this_iter_s": 2292.58376288414, "time_total_s": 8743.634220600128, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 8743.634220600128, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 21.880269607843136, "ram_util_percent": 27.154013480392155}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2895.899974414185, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -3052.188594979705, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 791.3027161377729, "mean_raw_obs_processing_ms": 2.912748624668125, "mean_inference_ms": 166.6771996034212, "mean_action_processing_ms": 0.4327140814962879}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 20000, "timers": {"sample_time_ms": 2037167.025, "sample_throughput": 1.964, "learn_time_ms": 175646.536, "learn_throughput": 22.773, "update_time_ms": 24.924}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": 0.11450963123934343, "policy_loss": -0.008115642645861953, "vf_loss": 17047.527374267578, "vf_explained_var": -0.040837109088897705, "kl": 0.009161268928437494, "entropy": 48.76612079143524, "entropy_coeff": 0.001}}, "num_steps_sampled": 20000, "num_steps_trained": 20000}, "done": false, "episodes_total": 20, "training_iteration": 5, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-07_21-03-25", "timestamp": 1617800605, "time_this_iter_s": 2320.615233182907, "time_total_s": 11064.249453783035, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 11064.249453783035, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 20.96634382566586, "ram_util_percent": 27.551422518159804}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2895.899974414185, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -3048.0244486983597, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 798.6545739529669, "mean_raw_obs_processing_ms": 2.930905511181166, "mean_inference_ms": 168.5217494513056, "mean_action_processing_ms": 0.4506636411703622}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 24000, "timers": {"sample_time_ms": 2042909.082, "sample_throughput": 1.958, "learn_time_ms": 175464.27, "learn_throughput": 22.797, "update_time_ms": 24.646}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": 0.08193552686134353, "policy_loss": -0.004262416739948094, "vf_loss": 13434.466278076172, "vf_explained_var": 0.003601161763072014, "kl": 0.007182937042671256, "entropy": 48.86500883102417, "entropy_coeff": 0.001}}, "num_steps_sampled": 24000, "num_steps_trained": 24000}, "done": false, "episodes_total": 24, "training_iteration": 6, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-07_21-40-51", "timestamp": 1617802851, "time_this_iter_s": 2246.20361995697, "time_total_s": 13310.453073740005, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 13310.453073740005, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 16.908197747183983, "ram_util_percent": 29.148591989987484}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2895.899974414185, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -3046.4774275076156, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 804.1356582352691, "mean_raw_obs_processing_ms": 2.9454634871713137, "mean_inference_ms": 169.98269642993634, "mean_action_processing_ms": 0.46572516000529013}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 28000, "timers": {"sample_time_ms": 2048540.959, "sample_throughput": 1.953, "learn_time_ms": 175993.531, "learn_throughput": 22.728, "update_time_ms": 24.294}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": 0.0640983211924322, "policy_loss": -0.00011768995318561792, "vf_loss": 11245.768829345703, "vf_explained_var": 0.0759173333644867, "kl": 0.00465514049938065, "entropy": 48.70718514919281, "entropy_coeff": 0.001}}, "num_steps_sampled": 28000, "num_steps_trained": 28000}, "done": false, "episodes_total": 28, "training_iteration": 7, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-07_22-18-33", "timestamp": 1617805113, "time_this_iter_s": 2261.5314116477966, "time_total_s": 15571.984485387802, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 15571.984485387802, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.616060888474685, "ram_util_percent": 30.164523143833485}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2895.899974414185, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -3040.449072513747, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 808.1857394964322, "mean_raw_obs_processing_ms": 2.9547612199436686, "mean_inference_ms": 171.08904245509422, "mean_action_processing_ms": 0.4763642634958711}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 32000, "timers": {"sample_time_ms": 2048002.202, "sample_throughput": 1.953, "learn_time_ms": 176145.188, "learn_throughput": 22.709, "update_time_ms": 22.952}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": 0.02743241935968399, "policy_loss": -0.007263053965289146, "vf_loss": 8305.994583129883, "vf_explained_var": 0.15282300114631653, "kl": 0.011135084670968354, "entropy": 48.921225786209106, "entropy_coeff": 0.001}}, "num_steps_sampled": 32000, "num_steps_trained": 32000}, "done": false, "episodes_total": 32, "training_iteration": 8, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-07_22-55-35", "timestamp": 1617807335, "time_this_iter_s": 2221.4593710899353, "time_total_s": 17793.443856477737, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 17793.443856477737, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 16.528738539361367, "ram_util_percent": 31.194245969016755}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2895.899974414185, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -3040.0146586428455, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 811.3645561211785, "mean_raw_obs_processing_ms": 2.9629678406814004, "mean_inference_ms": 171.97235175094156, "mean_action_processing_ms": 0.4845077200273153}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 36000, "timers": {"sample_time_ms": 2048750.427, "sample_throughput": 1.952, "learn_time_ms": 175884.236, "learn_throughput": 22.742, "update_time_ms": 23.192}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": 0.022317929193377495, "policy_loss": -0.0047488117415923625, "vf_loss": 7538.951065063477, "vf_explained_var": 0.2070525884628296, "kl": 0.014356640371261165, "entropy": 49.04059636592865, "entropy_coeff": 0.001}}, "num_steps_sampled": 36000, "num_steps_trained": 36000}, "done": false, "episodes_total": 36, "training_iteration": 9, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-07_23-32-43", "timestamp": 1617809563, "time_this_iter_s": 2228.5661964416504, "time_total_s": 20022.010052919388, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 20022.010052919388, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.67985498108449, "ram_util_percent": 26.625662042875156}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2832.542930840234, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -3021.3253025588447, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 813.7765590496929, "mean_raw_obs_processing_ms": 2.967194694295512, "mean_inference_ms": 172.65385633195862, "mean_action_processing_ms": 0.49286393893667296}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 40000, "timers": {"sample_time_ms": 2045411.443, "sample_throughput": 1.956, "learn_time_ms": 175635.754, "learn_throughput": 22.774, "update_time_ms": 25.747}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.012481305340770632, "policy_loss": -0.008049515425227582, "vf_loss": 4420.734443664551, "vf_explained_var": 0.28721070289611816, "kl": 0.012691946511040442, "entropy": 49.27372896671295, "entropy_coeff": 0.001}}, "num_steps_sampled": 40000, "num_steps_trained": 40000}, "done": false, "episodes_total": 40, "training_iteration": 10, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_00-09-12", "timestamp": 1617811752, "time_this_iter_s": 2188.8168201446533, "time_total_s": 22210.82687306404, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 22210.82687306404, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 15.504813863928113, "ram_util_percent": 25.123523748395378}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2832.542930840234, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -3012.9427641642087, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 815.6293761216948, "mean_raw_obs_processing_ms": 2.9708963720380597, "mean_inference_ms": 173.21850788938085, "mean_action_processing_ms": 0.49947475716253964}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 44000, "timers": {"sample_time_ms": 2074166.125, "sample_throughput": 1.928, "learn_time_ms": 179956.866, "learn_throughput": 22.228, "update_time_ms": 26.694}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": 0.0012714125914499164, "policy_loss": 0.006317473715171218, "vf_loss": 4391.250152587891, "vf_explained_var": 0.32857316732406616, "kl": 0.008235629757109564, "entropy": 49.37034010887146, "entropy_coeff": 0.001}}, "num_steps_sampled": 44000, "num_steps_trained": 44000}, "done": false, "episodes_total": 44, "training_iteration": 11, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_00-45-45", "timestamp": 1617813945, "time_this_iter_s": 2192.6476876735687, "time_total_s": 24403.47456073761, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 24403.47456073761, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 15.510057655349136, "ram_util_percent": 25.155381165919277}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2832.542930840234, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -3008.7808559210757, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 817.0739745407426, "mean_raw_obs_processing_ms": 2.9738393916455927, "mean_inference_ms": 173.69615314740633, "mean_action_processing_ms": 0.5056338750033466}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 48000, "timers": {"sample_time_ms": 2069166.766, "sample_throughput": 1.933, "learn_time_ms": 181356.837, "learn_throughput": 22.056, "update_time_ms": 26.892}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.00403257689322345, "policy_loss": 0.0030554189870599657, "vf_loss": 4198.39697265625, "vf_explained_var": 0.35723304748535156, "kl": 0.011026837106328458, "entropy": 49.62330210208893, "entropy_coeff": 0.001}}, "num_steps_sampled": 48000, "num_steps_trained": 48000}, "done": false, "episodes_total": 48, "training_iteration": 12, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_01-22-15", "timestamp": 1617816135, "time_this_iter_s": 2190.396679162979, "time_total_s": 26593.87123990059, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 26593.87123990059, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 15.507119948685054, "ram_util_percent": 25.20914047466324}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2821.875776852676, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -3000.372175226447, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 818.193230960866, "mean_raw_obs_processing_ms": 2.9763079584720082, "mean_inference_ms": 174.10709458904137, "mean_action_processing_ms": 0.5107081057000522}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 52000, "timers": {"sample_time_ms": 2056004.636, "sample_throughput": 1.946, "learn_time_ms": 176395.606, "learn_throughput": 22.676, "update_time_ms": 27.09}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.02728284348268062, "policy_loss": -0.009409871679963544, "vf_loss": 3102.234607696533, "vf_explained_var": 0.4191376566886902, "kl": 0.0072741940239211544, "entropy": 49.2590252161026, "entropy_coeff": 0.001}}, "num_steps_sampled": 52000, "num_steps_trained": 52000}, "done": false, "episodes_total": 52, "training_iteration": 13, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_01-58-37", "timestamp": 1617818317, "time_this_iter_s": 2181.551748275757, "time_total_s": 28775.422988176346, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 28775.422988176346, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 15.522826786864131, "ram_util_percent": 25.257533805537673}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2782.7556580944424, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -2991.637900268605, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 819.1458470983855, "mean_raw_obs_processing_ms": 2.97797235535722, "mean_inference_ms": 174.47649834608325, "mean_action_processing_ms": 0.5153469084177709}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 56000, "timers": {"sample_time_ms": 2049575.2, "sample_throughput": 1.952, "learn_time_ms": 172164.486, "learn_throughput": 23.234, "update_time_ms": 24.674}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.021202618605457246, "policy_loss": -0.005236828583292663, "vf_loss": 3277.8306045532227, "vf_explained_var": 0.44260069727897644, "kl": 0.011591616290388629, "entropy": 49.32367277145386, "entropy_coeff": 0.001}}, "num_steps_sampled": 56000, "num_steps_trained": 56000}, "done": false, "episodes_total": 56, "training_iteration": 14, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_02-35-03", "timestamp": 1617820503, "time_this_iter_s": 2185.938609600067, "time_total_s": 30961.361597776413, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 30961.361597776413, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 15.523907455012854, "ram_util_percent": 25.237339331619538}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2782.7556580944424, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -2982.9139052149844, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 819.9963970986681, "mean_raw_obs_processing_ms": 2.9797425093307215, "mean_inference_ms": 174.83697402309, "mean_action_processing_ms": 0.519296096828223}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 60000, "timers": {"sample_time_ms": 2041522.264, "sample_throughput": 1.959, "learn_time_ms": 167349.897, "learn_throughput": 23.902, "update_time_ms": 25.454}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.016483674757182598, "policy_loss": 0.0033214183640666306, "vf_loss": 2868.257480621338, "vf_explained_var": 0.5062880516052246, "kl": 0.013922299520345405, "entropy": 49.18377864360809, "entropy_coeff": 0.001}}, "num_steps_sampled": 60000, "num_steps_trained": 60000}, "done": false, "episodes_total": 60, "training_iteration": 15, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_03-11-35", "timestamp": 1617822695, "time_this_iter_s": 2191.947409391403, "time_total_s": 33153.309007167816, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 33153.309007167816, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 15.525728933034285, "ram_util_percent": 25.180615187439923}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2782.7556580944424, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -2981.1113028502423, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 820.8085416503106, "mean_raw_obs_processing_ms": 2.981961779777044, "mean_inference_ms": 175.17204638494516, "mean_action_processing_ms": 0.52285865087464}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 64000, "timers": {"sample_time_ms": 2043496.136, "sample_throughput": 1.957, "learn_time_ms": 162893.007, "learn_throughput": 24.556, "update_time_ms": 24.768}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.026473624573554844, "policy_loss": -0.009312305715866387, "vf_loss": 3126.6323890686035, "vf_explained_var": 0.5073880553245544, "kl": 0.011521207154146396, "entropy": 49.003697633743286, "entropy_coeff": 0.001}}, "num_steps_sampled": 64000, "num_steps_trained": 64000}, "done": false, "episodes_total": 64, "training_iteration": 16, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_03-48-36", "timestamp": 1617824916, "time_this_iter_s": 2221.3667118549347, "time_total_s": 35374.67571902275, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 35374.67571902275, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 15.520841239721696, "ram_util_percent": 25.19835547122074}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2782.7556580944424, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -2979.5146116513883, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 821.5375898647764, "mean_raw_obs_processing_ms": 2.9841075454379373, "mean_inference_ms": 175.467430924708, "mean_action_processing_ms": 0.5262191813336815}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 68000, "timers": {"sample_time_ms": 2040004.826, "sample_throughput": 1.961, "learn_time_ms": 162408.683, "learn_throughput": 24.629, "update_time_ms": 24.579}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.02664696768624708, "policy_loss": -0.007026030740235001, "vf_loss": 2814.8357696533203, "vf_explained_var": 0.5625647902488708, "kl": 0.012695646786596626, "entropy": 48.404075026512146, "entropy_coeff": 0.001}}, "num_steps_sampled": 68000, "num_steps_trained": 68000}, "done": false, "episodes_total": 68, "training_iteration": 17, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_04-25-38", "timestamp": 1617827138, "time_this_iter_s": 2221.7733199596405, "time_total_s": 37596.44903898239, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 37596.44903898239, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 15.497628833386026, "ram_util_percent": 25.25336705659184}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2782.7556580944424, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -2980.0923902799823, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 822.1410679506254, "mean_raw_obs_processing_ms": 2.9856935866935452, "mean_inference_ms": 175.71911166427887, "mean_action_processing_ms": 0.5289881636765646}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 72000, "timers": {"sample_time_ms": 2036270.934, "sample_throughput": 1.964, "learn_time_ms": 161087.839, "learn_throughput": 24.831, "update_time_ms": 24.892}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.02023148030275479, "policy_loss": -0.0027529893559403718, "vf_loss": 3036.404525756836, "vf_explained_var": 0.5253127813339233, "kl": 0.008990377813461237, "entropy": 48.29205322265625, "entropy_coeff": 0.001}}, "num_steps_sampled": 72000, "num_steps_trained": 72000}, "done": false, "episodes_total": 72, "training_iteration": 18, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_05-01-49", "timestamp": 1617829309, "time_this_iter_s": 2170.915424823761, "time_total_s": 39767.36446380615, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 39767.36446380615, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 15.531618122977346, "ram_util_percent": 25.24271844660194}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2782.7556580944424, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -2978.159599163983, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 822.6407881141815, "mean_raw_obs_processing_ms": 2.9872926880492034, "mean_inference_ms": 175.94280876871645, "mean_action_processing_ms": 0.5317564349172802}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 76000, "timers": {"sample_time_ms": 2032043.834, "sample_throughput": 1.968, "learn_time_ms": 161067.273, "learn_throughput": 24.834, "update_time_ms": 24.578}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.032684326404705644, "policy_loss": -0.01043230079812929, "vf_loss": 2521.8364448547363, "vf_explained_var": 0.622490406036377, "kl": 0.011052337315049954, "entropy": 48.02300536632538, "entropy_coeff": 0.001}}, "num_steps_sampled": 76000, "num_steps_trained": 76000}, "done": false, "episodes_total": 76, "training_iteration": 19, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_05-38-15", "timestamp": 1617831495, "time_this_iter_s": 2186.086530685425, "time_total_s": 41953.45099449158, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 41953.45099449158, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 15.51658630665381, "ram_util_percent": 25.303471552555454}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2782.7556580944424, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -2977.2034203969583, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 823.0637333642202, "mean_raw_obs_processing_ms": 2.9884013134498266, "mean_inference_ms": 176.14389598853896, "mean_action_processing_ms": 0.5341343213915056}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 80000, "timers": {"sample_time_ms": 2032742.718, "sample_throughput": 1.968, "learn_time_ms": 161466.977, "learn_throughput": 24.773, "update_time_ms": 20.78}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.031971397693268955, "policy_loss": -0.006857555941678584, "vf_loss": 2252.281913757324, "vf_explained_var": 0.626818835735321, "kl": 0.008544963682652451, "entropy": 48.06390702724457, "entropy_coeff": 0.001}}, "num_steps_sampled": 80000, "num_steps_trained": 80000}, "done": false, "episodes_total": 80, "training_iteration": 20, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_06-14-55", "timestamp": 1617833695, "time_this_iter_s": 2199.7747991085052, "time_total_s": 44153.22579360008, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 44153.22579360008, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 15.547748323219421, "ram_util_percent": 25.30194825934207}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2782.7556580944424, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -2977.3653122173087, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 823.4122260382892, "mean_raw_obs_processing_ms": 2.989658890494725, "mean_inference_ms": 176.32847080927968, "mean_action_processing_ms": 0.5365246296655397}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 84000, "timers": {"sample_time_ms": 2032572.419, "sample_throughput": 1.968, "learn_time_ms": 161649.346, "learn_throughput": 24.745, "update_time_ms": 21.622}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.029322699032491073, "policy_loss": -0.012020643800497055, "vf_loss": 3029.817768096924, "vf_explained_var": 0.544883131980896, "kl": 0.009978749192669056, "entropy": 48.09916806221008, "entropy_coeff": 0.001}}, "num_steps_sampled": 84000, "num_steps_trained": 84000}, "done": false, "episodes_total": 84, "training_iteration": 21, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_06-51-28", "timestamp": 1617835888, "time_this_iter_s": 2192.775634765625, "time_total_s": 46346.00142836571, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 46346.00142836571, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 15.732543241511852, "ram_util_percent": 25.341479820627804}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2782.7556580944424, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -2973.706224547671, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 823.7077571330112, "mean_raw_obs_processing_ms": 2.9907127234035253, "mean_inference_ms": 176.49064917085445, "mean_action_processing_ms": 0.5388282797222157}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 88000, "timers": {"sample_time_ms": 2033041.727, "sample_throughput": 1.967, "learn_time_ms": 161397.987, "learn_throughput": 24.783, "update_time_ms": 21.026}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.025694941694382578, "policy_loss": -0.002991455898154527, "vf_loss": 2483.127655029297, "vf_explained_var": 0.6233282089233398, "kl": 0.012270410283235833, "entropy": 48.148282170295715, "entropy_coeff": 0.001}}, "num_steps_sampled": 88000, "num_steps_trained": 88000}, "done": false, "episodes_total": 88, "training_iteration": 22, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_07-28-00", "timestamp": 1617838080, "time_this_iter_s": 2192.570325613022, "time_total_s": 48538.57175397873, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 48538.57175397873, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 15.531720602371035, "ram_util_percent": 25.37504005126562}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2782.7556580944424, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -2972.085011656524, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 823.9563213226089, "mean_raw_obs_processing_ms": 2.9914488357982485, "mean_inference_ms": 176.63601435111966, "mean_action_processing_ms": 0.5410619234480941}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 92000, "timers": {"sample_time_ms": 2034235.47, "sample_throughput": 1.966, "learn_time_ms": 161435.868, "learn_throughput": 24.778, "update_time_ms": 19.049}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.022575174196390435, "policy_loss": -0.01034916186472401, "vf_loss": 3537.0323944091797, "vf_explained_var": 0.5566376447677612, "kl": 0.012632920406758785, "entropy": 48.2279794216156, "entropy_coeff": 0.001}}, "num_steps_sampled": 92000, "num_steps_trained": 92000}, "done": false, "episodes_total": 92, "training_iteration": 23, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_08-04-34", "timestamp": 1617840274, "time_this_iter_s": 2193.8481965065002, "time_total_s": 50732.41995048523, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 50732.41995048523, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 15.524431636247199, "ram_util_percent": 25.441402497598464}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2782.7556580944424, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -2967.8806129046134, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 824.1668967573505, "mean_raw_obs_processing_ms": 2.9921150770910927, "mean_inference_ms": 176.76532522233046, "mean_action_processing_ms": 0.5430092911122294}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 96000, "timers": {"sample_time_ms": 2031257.276, "sample_throughput": 1.969, "learn_time_ms": 164182.92, "learn_throughput": 24.363, "update_time_ms": 19.185}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.02728349997778423, "policy_loss": -0.0050079612410627306, "vf_loss": 2500.4123191833496, "vf_explained_var": 0.6240633726119995, "kl": 0.01394699583761394, "entropy": 47.97701132297516, "entropy_coeff": 0.001}}, "num_steps_sampled": 96000, "num_steps_trained": 96000}, "done": false, "episodes_total": 96, "training_iteration": 24, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_08-40-58", "timestamp": 1617842458, "time_this_iter_s": 2183.6280550956726, "time_total_s": 52916.0480055809, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 52916.0480055809, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 15.52113219684786, "ram_util_percent": 25.483853329044706}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2782.7556580944424, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -2965.692428053307, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516, -2895.899974414185, -3150.1920204916087, -3030.802682511024, -3053.6091736320755, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 824.346091584564, "mean_raw_obs_processing_ms": 2.9929972812114958, "mean_inference_ms": 176.8834954546028, "mean_action_processing_ms": 0.5448120945959736}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 100000, "timers": {"sample_time_ms": 2026211.674, "sample_throughput": 1.974, "learn_time_ms": 169049.333, "learn_throughput": 23.662, "update_time_ms": 18.565}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.040634484321344644, "policy_loss": -0.020189212111290544, "vf_loss": 2701.9602661132812, "vf_explained_var": 0.6043810844421387, "kl": 0.009196571074426174, "entropy": 47.9246963262558, "entropy_coeff": 0.001}}, "num_steps_sampled": 100000, "num_steps_trained": 100000}, "done": false, "episodes_total": 100, "training_iteration": 25, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_09-17-28", "timestamp": 1617844648, "time_this_iter_s": 2190.14940738678, "time_total_s": 55106.19741296768, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 55106.19741296768, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 15.689512508017959, "ram_util_percent": 25.502245028864657}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2782.7556580944424, "episode_reward_min": -3177.831743467252, "episode_reward_mean": -2960.0667010501597, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2959.325562467125, -2829.005848999284, -2953.0822450454107, -2826.5174942223657, -3043.336218924645, -3177.831743467252, -3111.8664146769233, -3066.497732226216, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 828.9795811535924, "mean_raw_obs_processing_ms": 3.007448334192755, "mean_inference_ms": 178.1925873858919, "mean_action_processing_ms": 0.5568149162906595}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 104000, "timers": {"sample_time_ms": 2017357.166, "sample_throughput": 1.983, "learn_time_ms": 173454.141, "learn_throughput": 23.061, "update_time_ms": 18.426}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.023198459879495203, "policy_loss": -0.0025387386849615723, "vf_loss": 2651.197521209717, "vf_explained_var": 0.6136859655380249, "kl": 0.015001930354628712, "entropy": 47.92178928852081, "entropy_coeff": 0.001}}, "num_steps_sampled": 104000, "num_steps_trained": 104000}, "done": false, "episodes_total": 104, "training_iteration": 26, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_09-53-45", "timestamp": 1617846825, "time_this_iter_s": 2176.868501663208, "time_total_s": 57283.06591463089, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 57283.06591463089, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 15.5911555842479, "ram_util_percent": 25.43089089735313}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2782.7556580944424, "episode_reward_min": -3158.4614831046993, "episode_reward_mean": -2951.3099420603376, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2849.7310064034277, -2825.4324060428603, -2908.16199546307, -2940.530802403475, -3079.9769373656836, -2961.390037937324, -2952.765144541929, -2959.0729291536422, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516, -2959.325562467125, -2829.005848999284, -2953.0822450454107, -2826.5174942223657], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 830.9895161449249, "mean_raw_obs_processing_ms": 3.0154836768569933, "mean_inference_ms": 178.81035767422816, "mean_action_processing_ms": 0.5648917714400647}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 108000, "timers": {"sample_time_ms": 2013902.354, "sample_throughput": 1.986, "learn_time_ms": 173782.569, "learn_throughput": 23.017, "update_time_ms": 17.519}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.042605376307619736, "policy_loss": -0.020139943284448236, "vf_loss": 2459.455945968628, "vf_explained_var": 0.6458077430725098, "kl": 0.016582475800532848, "entropy": 47.88911581039429, "entropy_coeff": 0.001}}, "num_steps_sampled": 108000, "num_steps_trained": 108000}, "done": false, "episodes_total": 108, "training_iteration": 27, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_10-30-15", "timestamp": 1617849015, "time_this_iter_s": 2190.5004262924194, "time_total_s": 59473.56634092331, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 59473.56634092331, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 15.833664636101314, "ram_util_percent": 25.399807630650848}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2782.7556580944424, "episode_reward_min": -3158.4614831046993, "episode_reward_mean": -2947.4352418143126, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2921.129597432222, -2827.375368481126, -3029.737003873573, -2787.493054609166, -3099.287425895808, -3108.337243639392, -3019.0378242727656, -3046.3584949654546, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516, -2959.325562467125, -2829.005848999284, -2953.0822450454107, -2826.5174942223657, -2849.7310064034277, -2825.4324060428603, -2908.16199546307, -2940.530802403475], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 831.7409067480202, "mean_raw_obs_processing_ms": 3.0168730879395156, "mean_inference_ms": 179.18385910825845, "mean_action_processing_ms": 0.5694712594341751}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 112000, "timers": {"sample_time_ms": 2028923.723, "sample_throughput": 1.971, "learn_time_ms": 181899.398, "learn_throughput": 21.99, "update_time_ms": 21.027}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.03577096332446672, "policy_loss": -0.010298972512828186, "vf_loss": 2181.8776092529297, "vf_explained_var": 0.6838879585266113, "kl": 0.012150982511229813, "entropy": 47.89831018447876, "entropy_coeff": 0.001}}, "num_steps_sampled": 112000, "num_steps_trained": 112000}, "done": false, "episodes_total": 112, "training_iteration": 28, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_11-10-18", "timestamp": 1617851418, "time_this_iter_s": 2402.3323950767517, "time_total_s": 61875.89873600006, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 61875.89873600006, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 25.453846153846158, "ram_util_percent": 30.344457443696985}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2687.393013430355, "episode_reward_min": -3158.4614831046993, "episode_reward_mean": -2936.748139596087, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3000.6425592061764, -2776.6408391595774, -2687.393013430355, -2739.634355154821, -3158.4614831046993, -2956.7336374842494, -3046.6971070569084, -3125.6176738323147, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516, -2959.325562467125, -2829.005848999284, -2953.0822450454107, -2826.5174942223657, -2849.7310064034277, -2825.4324060428603, -2908.16199546307, -2940.530802403475, -2921.129597432222, -2827.375368481126, -3029.737003873573, -2787.493054609166], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 832.1369489472874, "mean_raw_obs_processing_ms": 3.0156900687498056, "mean_inference_ms": 179.43743543981725, "mean_action_processing_ms": 0.5735335581106455}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 116000, "timers": {"sample_time_ms": 2052228.355, "sample_throughput": 1.949, "learn_time_ms": 192127.41, "learn_throughput": 20.82, "update_time_ms": 20.658}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.03833140496863052, "policy_loss": -0.01204314231290482, "vf_loss": 2067.23836517334, "vf_explained_var": 0.6627552509307861, "kl": 0.015278540144208819, "entropy": 47.724570870399475, "entropy_coeff": 0.001}}, "num_steps_sampled": 116000, "num_steps_trained": 116000}, "done": false, "episodes_total": 116, "training_iteration": 29, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_11-52-19", "timestamp": 1617853939, "time_this_iter_s": 2521.4095063209534, "time_total_s": 64397.308242321014, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 64397.308242321014, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 30.154694901086653, "ram_util_percent": 32.782362775146275}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2687.393013430355, "episode_reward_min": -3150.6050395854318, "episode_reward_mean": -2928.7802356412785, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2844.4237213769857, -2895.633559486737, -2911.2970692050635, -2839.3651559284986, -3150.6050395854318, -2902.491891619771, -3048.720227965327, -3006.9977099960115, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516, -2959.325562467125, -2829.005848999284, -2953.0822450454107, -2826.5174942223657, -2849.7310064034277, -2825.4324060428603, -2908.16199546307, -2940.530802403475, -2921.129597432222, -2827.375368481126, -3029.737003873573, -2787.493054609166, -3000.6425592061764, -2776.6408391595774, -2687.393013430355, -2739.634355154821], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 832.2764022822407, "mean_raw_obs_processing_ms": 3.0140497236219574, "mean_inference_ms": 179.62525116920295, "mean_action_processing_ms": 0.5769051173131821}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 120000, "timers": {"sample_time_ms": 2086385.647, "sample_throughput": 1.917, "learn_time_ms": 201120.609, "learn_throughput": 19.889, "update_time_ms": 23.904}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.027539082220755517, "policy_loss": 0.00340023054741323, "vf_loss": 1641.5558338165283, "vf_explained_var": 0.7466431856155396, "kl": 0.010477425414137542, "entropy": 47.87874221801758, "entropy_coeff": 0.001}}, "num_steps_sampled": 120000, "num_steps_trained": 120000}, "done": false, "episodes_total": 120, "training_iteration": 30, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_12-36-11", "timestamp": 1617856571, "time_this_iter_s": 2631.302515745163, "time_total_s": 67028.61075806618, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 67028.61075806618, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 34.191430859583555, "ram_util_percent": 37.56767218366257}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2687.393013430355, "episode_reward_min": -3092.6674899765976, "episode_reward_mean": -2916.554421011483, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2699.006916375293, -2717.689338996511, -2741.4569138387055, -2728.080236976486, -3048.311656424824, -3012.6134970971802, -3043.101309864098, -3044.754738066491, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516, -2959.325562467125, -2829.005848999284, -2953.0822450454107, -2826.5174942223657, -2849.7310064034277, -2825.4324060428603, -2908.16199546307, -2940.530802403475, -2921.129597432222, -2827.375368481126, -3029.737003873573, -2787.493054609166, -3000.6425592061764, -2776.6408391595774, -2687.393013430355, -2739.634355154821, -2844.4237213769857, -2895.633559486737, -2911.2970692050635, -2839.3651559284986], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 832.5010692028072, "mean_raw_obs_processing_ms": 3.0148980287178144, "mean_inference_ms": 179.8056771497, "mean_action_processing_ms": 0.5795323225299888}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 124000, "timers": {"sample_time_ms": 2119388.133, "sample_throughput": 1.887, "learn_time_ms": 210496.984, "learn_throughput": 19.003, "update_time_ms": 23.952}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.036422723409486935, "policy_loss": -0.00642129237530753, "vf_loss": 1789.9208393096924, "vf_explained_var": 0.7135903835296631, "kl": 0.008374312063097022, "entropy": 48.319350242614746, "entropy_coeff": 0.001}}, "num_steps_sampled": 124000, "num_steps_trained": 124000}, "done": false, "episodes_total": 124, "training_iteration": 31, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_13-19-47", "timestamp": 1617859187, "time_this_iter_s": 2616.564616918564, "time_total_s": 69645.17537498474, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 69645.17537498474, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 34.16351677852349, "ram_util_percent": 37.599409395973154}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2675.6460293656933, "episode_reward_min": -3092.6674899765976, "episode_reward_mean": -2905.32824040108, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2675.6460293656933, -2777.5841212320847, -2853.1263994904666, -2719.8065903240836, -3010.788512862507, -2980.049800072329, -3032.359718126894, -2969.8043191649376, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516, -2959.325562467125, -2829.005848999284, -2953.0822450454107, -2826.5174942223657, -2849.7310064034277, -2825.4324060428603, -2908.16199546307, -2940.530802403475, -2921.129597432222, -2827.375368481126, -3029.737003873573, -2787.493054609166, -3000.6425592061764, -2776.6408391595774, -2687.393013430355, -2739.634355154821, -2844.4237213769857, -2895.633559486737, -2911.2970692050635, -2839.3651559284986, -2699.006916375293, -2717.689338996511, -2741.4569138387055, -2728.080236976486], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 832.8104602085438, "mean_raw_obs_processing_ms": 3.0159500832274904, "mean_inference_ms": 179.97308651936743, "mean_action_processing_ms": 0.5816763563639681}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 128000, "timers": {"sample_time_ms": 2152878.218, "sample_throughput": 1.858, "learn_time_ms": 213919.449, "learn_throughput": 18.699, "update_time_ms": 24.688}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.04155583638930693, "policy_loss": -0.012565189332235605, "vf_loss": 1873.696195602417, "vf_explained_var": 0.7411433458328247, "kl": 0.013690141175175086, "entropy": 48.41211211681366, "entropy_coeff": 0.001}}, "num_steps_sampled": 128000, "num_steps_trained": 128000}, "done": false, "episodes_total": 128, "training_iteration": 32, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_14-02-29", "timestamp": 1617861749, "time_this_iter_s": 2561.703072309494, "time_total_s": 72206.87844729424, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 72206.87844729424, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 33.743033461327485, "ram_util_percent": 37.82462973121229}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2659.397627838248, "episode_reward_min": -3092.6674899765976, "episode_reward_mean": -2893.1750468743144, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2737.091824407038, -2705.3707526802796, -2659.397627838248, -2675.822792624471, -3092.6674899765976, -3065.6050336248677, -2896.2323533877848, -3091.6525137132767, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516, -2959.325562467125, -2829.005848999284, -2953.0822450454107, -2826.5174942223657, -2849.7310064034277, -2825.4324060428603, -2908.16199546307, -2940.530802403475, -2921.129597432222, -2827.375368481126, -3029.737003873573, -2787.493054609166, -3000.6425592061764, -2776.6408391595774, -2687.393013430355, -2739.634355154821, -2844.4237213769857, -2895.633559486737, -2911.2970692050635, -2839.3651559284986, -2699.006916375293, -2717.689338996511, -2741.4569138387055, -2728.080236976486, -2675.6460293656933, -2777.5841212320847, -2853.1263994904666, -2719.8065903240836], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 833.1992165181684, "mean_raw_obs_processing_ms": 3.017456537973959, "mean_inference_ms": 180.15212415060734, "mean_action_processing_ms": 0.584220392193481}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 132000, "timers": {"sample_time_ms": 2170784.048, "sample_throughput": 1.843, "learn_time_ms": 208743.301, "learn_throughput": 19.162, "update_time_ms": 27.497}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.043359680159483105, "policy_loss": -0.01201558846514672, "vf_loss": 1668.0909690856934, "vf_explained_var": 0.7471261024475098, "kl": 0.014215842413250357, "entropy": 48.73578929901123, "entropy_coeff": 0.001}}, "num_steps_sampled": 132000, "num_steps_trained": 132000}, "done": false, "episodes_total": 132, "training_iteration": 33, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_14-41-10", "timestamp": 1617864070, "time_this_iter_s": 2321.173233270645, "time_total_s": 74528.05168056488, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 74528.05168056488, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 23.885779122541603, "ram_util_percent": 34.78689863842663}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2577.280776118091, "episode_reward_min": -3070.9873460909503, "episode_reward_mean": -2878.246924191963, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2577.280776118091, -2745.015490696467, -2671.197468061297, -2659.851387591582, -2832.542930840234, -2866.0981400535306, -2838.1408097067847, -2875.7025106108117, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516, -2959.325562467125, -2829.005848999284, -2953.0822450454107, -2826.5174942223657, -2849.7310064034277, -2825.4324060428603, -2908.16199546307, -2940.530802403475, -2921.129597432222, -2827.375368481126, -3029.737003873573, -2787.493054609166, -3000.6425592061764, -2776.6408391595774, -2687.393013430355, -2739.634355154821, -2844.4237213769857, -2895.633559486737, -2911.2970692050635, -2839.3651559284986, -2699.006916375293, -2717.689338996511, -2741.4569138387055, -2728.080236976486, -2675.6460293656933, -2777.5841212320847, -2853.1263994904666, -2719.8065903240836, -2737.091824407038, -2705.3707526802796, -2659.397627838248, -2675.822792624471], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 833.5846188861237, "mean_raw_obs_processing_ms": 3.0185989137287708, "mean_inference_ms": 180.3258272075839, "mean_action_processing_ms": 0.5869010899262846}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 136000, "timers": {"sample_time_ms": 2178855.395, "sample_throughput": 1.836, "learn_time_ms": 206402.595, "learn_throughput": 19.38, "update_time_ms": 27.356}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.03683357741101645, "policy_loss": -0.00981900654733181, "vf_loss": 2083.787971496582, "vf_explained_var": 0.6668235063552856, "kl": 0.012673149380134419, "entropy": 48.48610579967499, "entropy_coeff": 0.001}}, "num_steps_sampled": 136000, "num_steps_trained": 136000}, "done": false, "episodes_total": 136, "training_iteration": 34, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_15-18-31", "timestamp": 1617866311, "time_this_iter_s": 2240.932873249054, "time_total_s": 76768.98455381393, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 76768.98455381393, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 16.94967074317968, "ram_util_percent": 32.15145813734713}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2574.732717256704, "episode_reward_min": -3070.9873460909503, "episode_reward_mean": -2870.763417245567, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2574.732717256704, -2676.1702739076577, -2699.3956049471053, -2713.8351004602737, -2925.2677596882154, -2942.4423729720647, -2866.4205217347835, -2982.338866476332, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516, -2959.325562467125, -2829.005848999284, -2953.0822450454107, -2826.5174942223657, -2849.7310064034277, -2825.4324060428603, -2908.16199546307, -2940.530802403475, -2921.129597432222, -2827.375368481126, -3029.737003873573, -2787.493054609166, -3000.6425592061764, -2776.6408391595774, -2687.393013430355, -2739.634355154821, -2844.4237213769857, -2895.633559486737, -2911.2970692050635, -2839.3651559284986, -2699.006916375293, -2717.689338996511, -2741.4569138387055, -2728.080236976486, -2675.6460293656933, -2777.5841212320847, -2853.1263994904666, -2719.8065903240836, -2737.091824407038, -2705.3707526802796, -2659.397627838248, -2675.822792624471, -2577.280776118091, -2745.015490696467, -2671.197468061297, -2659.851387591582], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 834.0255230306758, "mean_raw_obs_processing_ms": 3.0206300659370515, "mean_inference_ms": 180.50842333433116, "mean_action_processing_ms": 0.5888175929381005}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 140000, "timers": {"sample_time_ms": 2185273.61, "sample_throughput": 1.83, "learn_time_ms": 211104.116, "learn_throughput": 18.948, "update_time_ms": 26.792}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.038049028371460736, "policy_loss": -0.011163575894897804, "vf_loss": 2101.8785972595215, "vf_explained_var": 0.6477953195571899, "kl": 0.011277345882263035, "entropy": 48.46810293197632, "entropy_coeff": 0.001}}, "num_steps_sampled": 140000, "num_steps_trained": 140000}, "done": false, "episodes_total": 140, "training_iteration": 35, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_15-56-52", "timestamp": 1617868612, "time_this_iter_s": 2301.342253923416, "time_total_s": 79070.32680773735, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 79070.32680773735, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 19.20897435897436, "ram_util_percent": 33.53208180708181}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2574.732717256704, "episode_reward_min": -3070.9873460909503, "episode_reward_mean": -2862.877026724652, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2701.591929297077, -2704.7423325597506, -2781.948744086715, -2739.5474628363386, -2844.186792023954, -3007.7868314733314, -2965.947935570776, -3034.077901918402, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516, -2959.325562467125, -2829.005848999284, -2953.0822450454107, -2826.5174942223657, -2849.7310064034277, -2825.4324060428603, -2908.16199546307, -2940.530802403475, -2921.129597432222, -2827.375368481126, -3029.737003873573, -2787.493054609166, -3000.6425592061764, -2776.6408391595774, -2687.393013430355, -2739.634355154821, -2844.4237213769857, -2895.633559486737, -2911.2970692050635, -2839.3651559284986, -2699.006916375293, -2717.689338996511, -2741.4569138387055, -2728.080236976486, -2675.6460293656933, -2777.5841212320847, -2853.1263994904666, -2719.8065903240836, -2737.091824407038, -2705.3707526802796, -2659.397627838248, -2675.822792624471, -2577.280776118091, -2745.015490696467, -2671.197468061297, -2659.851387591582, -2574.732717256704, -2676.1702739076577, -2699.3956049471053, -2713.8351004602737], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 834.5560819007069, "mean_raw_obs_processing_ms": 3.0225262998855307, "mean_inference_ms": 180.69111985007765, "mean_action_processing_ms": 0.5908742695622553}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 144000, "timers": {"sample_time_ms": 2199586.814, "sample_throughput": 1.819, "learn_time_ms": 216596.654, "learn_throughput": 18.468, "update_time_ms": 27.903}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.03856059943791479, "policy_loss": -0.004712911584647372, "vf_loss": 1362.798496246338, "vf_explained_var": 0.7603752613067627, "kl": 0.012447229732060805, "entropy": 48.098031878471375, "entropy_coeff": 0.001}}, "num_steps_sampled": 144000, "num_steps_trained": 144000}, "done": false, "episodes_total": 144, "training_iteration": 36, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_16-36-27", "timestamp": 1617870987, "time_this_iter_s": 2374.937004804611, "time_total_s": 81445.26381254196, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 81445.26381254196, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 26.13448683821355, "ram_util_percent": 45.51783496007098}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2574.732717256704, "episode_reward_min": -3070.9873460909503, "episode_reward_mean": -2854.042857175231, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2715.436580913053, -2847.394102055752, -2747.6539005207615, -2658.097922554784, -2977.6008375995393, -2875.0732257331615, -2821.875776852676, -2923.322187378212, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516, -2959.325562467125, -2829.005848999284, -2953.0822450454107, -2826.5174942223657, -2849.7310064034277, -2825.4324060428603, -2908.16199546307, -2940.530802403475, -2921.129597432222, -2827.375368481126, -3029.737003873573, -2787.493054609166, -3000.6425592061764, -2776.6408391595774, -2687.393013430355, -2739.634355154821, -2844.4237213769857, -2895.633559486737, -2911.2970692050635, -2839.3651559284986, -2699.006916375293, -2717.689338996511, -2741.4569138387055, -2728.080236976486, -2675.6460293656933, -2777.5841212320847, -2853.1263994904666, -2719.8065903240836, -2737.091824407038, -2705.3707526802796, -2659.397627838248, -2675.822792624471, -2577.280776118091, -2745.015490696467, -2671.197468061297, -2659.851387591582, -2574.732717256704, -2676.1702739076577, -2699.3956049471053, -2713.8351004602737, -2701.591929297077, -2704.7423325597506, -2781.948744086715, -2739.5474628363386], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 835.1231678847236, "mean_raw_obs_processing_ms": 3.0245592453176537, "mean_inference_ms": 180.8713609502004, "mean_action_processing_ms": 0.5926260207099361}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 148000, "timers": {"sample_time_ms": 2203890.606, "sample_throughput": 1.815, "learn_time_ms": 216530.469, "learn_throughput": 18.473, "update_time_ms": 28.12}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.04436539561720565, "policy_loss": -0.009598166885552928, "vf_loss": 1273.0853805541992, "vf_explained_var": 0.7870928049087524, "kl": 0.012449337576981634, "entropy": 48.120548129081726, "entropy_coeff": 0.001}}, "num_steps_sampled": 148000, "num_steps_trained": 148000}, "done": false, "episodes_total": 148, "training_iteration": 37, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_17-13-40", "timestamp": 1617873220, "time_this_iter_s": 2232.879154443741, "time_total_s": 83678.1429669857, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 83678.1429669857, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 19.494021397105097, "ram_util_percent": 41.30210824417874}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2574.732717256704, "episode_reward_min": -3070.9873460909503, "episode_reward_mean": -2845.7853454088845, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2790.728776710785, -2602.386579754148, -2675.8961138017403, -2703.1093806623558, -2852.0377455438324, -2960.9213124855232, -2916.6545871428507, -2782.7556580944424, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516, -2959.325562467125, -2829.005848999284, -2953.0822450454107, -2826.5174942223657, -2849.7310064034277, -2825.4324060428603, -2908.16199546307, -2940.530802403475, -2921.129597432222, -2827.375368481126, -3029.737003873573, -2787.493054609166, -3000.6425592061764, -2776.6408391595774, -2687.393013430355, -2739.634355154821, -2844.4237213769857, -2895.633559486737, -2911.2970692050635, -2839.3651559284986, -2699.006916375293, -2717.689338996511, -2741.4569138387055, -2728.080236976486, -2675.6460293656933, -2777.5841212320847, -2853.1263994904666, -2719.8065903240836, -2737.091824407038, -2705.3707526802796, -2659.397627838248, -2675.822792624471, -2577.280776118091, -2745.015490696467, -2671.197468061297, -2659.851387591582, -2574.732717256704, -2676.1702739076577, -2699.3956049471053, -2713.8351004602737, -2701.591929297077, -2704.7423325597506, -2781.948744086715, -2739.5474628363386, -2715.436580913053, -2847.394102055752, -2747.6539005207615, -2658.097922554784], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 835.7130522981493, "mean_raw_obs_processing_ms": 3.0265970177250527, "mean_inference_ms": 181.04615257890757, "mean_action_processing_ms": 0.5943082361889265}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 152000, "timers": {"sample_time_ms": 2189967.01, "sample_throughput": 1.827, "learn_time_ms": 209979.21, "learn_throughput": 19.05, "update_time_ms": 25.284}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.048416410107165575, "policy_loss": -0.019041690684389323, "vf_loss": 1797.6707878112793, "vf_explained_var": 0.7191094160079956, "kl": 0.01579427206888795, "entropy": 48.141138553619385, "entropy_coeff": 0.001}}, "num_steps_sampled": 152000, "num_steps_trained": 152000}, "done": false, "episodes_total": 152, "training_iteration": 38, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_17-50-18", "timestamp": 1617875418, "time_this_iter_s": 2197.555558681488, "time_total_s": 85875.69852566719, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 85875.69852566719, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 17.05557686161713, "ram_util_percent": 39.34870565675935}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2574.732717256704, "episode_reward_min": -3070.9873460909503, "episode_reward_mean": -2836.863936304743, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2642.160886968417, -2643.6517642546733, -2675.943101288677, -2658.4726403406617, -2937.9961920894593, -2786.929203017695, -2870.4697612649347, -2847.7167414850896, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516, -2959.325562467125, -2829.005848999284, -2953.0822450454107, -2826.5174942223657, -2849.7310064034277, -2825.4324060428603, -2908.16199546307, -2940.530802403475, -2921.129597432222, -2827.375368481126, -3029.737003873573, -2787.493054609166, -3000.6425592061764, -2776.6408391595774, -2687.393013430355, -2739.634355154821, -2844.4237213769857, -2895.633559486737, -2911.2970692050635, -2839.3651559284986, -2699.006916375293, -2717.689338996511, -2741.4569138387055, -2728.080236976486, -2675.6460293656933, -2777.5841212320847, -2853.1263994904666, -2719.8065903240836, -2737.091824407038, -2705.3707526802796, -2659.397627838248, -2675.822792624471, -2577.280776118091, -2745.015490696467, -2671.197468061297, -2659.851387591582, -2574.732717256704, -2676.1702739076577, -2699.3956049471053, -2713.8351004602737, -2701.591929297077, -2704.7423325597506, -2781.948744086715, -2739.5474628363386, -2715.436580913053, -2847.394102055752, -2747.6539005207615, -2658.097922554784, -2790.728776710785, -2602.386579754148, -2675.8961138017403, -2703.1093806623558], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 836.3120200500962, "mean_raw_obs_processing_ms": 3.029043079517186, "mean_inference_ms": 181.21615409834862, "mean_action_processing_ms": 0.595911142237373}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 156000, "timers": {"sample_time_ms": 2174880.749, "sample_throughput": 1.839, "learn_time_ms": 200141.905, "learn_throughput": 19.986, "update_time_ms": 26.467}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.035348286415683106, "policy_loss": -0.004787174053490162, "vf_loss": 1699.9361057281494, "vf_explained_var": 0.6971275806427002, "kl": 0.014485650201095268, "entropy": 48.284754276275635, "entropy_coeff": 0.001}}, "num_steps_sampled": 156000, "num_steps_trained": 156000}, "done": false, "episodes_total": 156, "training_iteration": 39, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_18-28-10", "timestamp": 1617877690, "time_this_iter_s": 2272.1857013702393, "time_total_s": 88147.88422703743, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 88147.88422703743, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 21.022225656877897, "ram_util_percent": 42.84680061823802}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2571.6709182592876, "episode_reward_min": -3070.9873460909503, "episode_reward_mean": -2828.6774005613593, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2571.6709182592876, -2704.60576289243, -2716.2283028052634, -2631.9533395617805, -3022.9201029846186, -3000.4405357067667, -2982.341661784306, -2810.5867690407304, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516, -2959.325562467125, -2829.005848999284, -2953.0822450454107, -2826.5174942223657, -2849.7310064034277, -2825.4324060428603, -2908.16199546307, -2940.530802403475, -2921.129597432222, -2827.375368481126, -3029.737003873573, -2787.493054609166, -3000.6425592061764, -2776.6408391595774, -2687.393013430355, -2739.634355154821, -2844.4237213769857, -2895.633559486737, -2911.2970692050635, -2839.3651559284986, -2699.006916375293, -2717.689338996511, -2741.4569138387055, -2728.080236976486, -2675.6460293656933, -2777.5841212320847, -2853.1263994904666, -2719.8065903240836, -2737.091824407038, -2705.3707526802796, -2659.397627838248, -2675.822792624471, -2577.280776118091, -2745.015490696467, -2671.197468061297, -2659.851387591582, -2574.732717256704, -2676.1702739076577, -2699.3956049471053, -2713.8351004602737, -2701.591929297077, -2704.7423325597506, -2781.948744086715, -2739.5474628363386, -2715.436580913053, -2847.394102055752, -2747.6539005207615, -2658.097922554784, -2790.728776710785, -2602.386579754148, -2675.8961138017403, -2703.1093806623558, -2642.160886968417, -2643.6517642546733, -2675.943101288677, -2658.4726403406617], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 836.8933765027595, "mean_raw_obs_processing_ms": 3.031283951067104, "mean_inference_ms": 181.360772078862, "mean_action_processing_ms": 0.5974806033925277}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 160000, "timers": {"sample_time_ms": 2145573.492, "sample_throughput": 1.864, "learn_time_ms": 191185.257, "learn_throughput": 20.922, "update_time_ms": 23.819}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.03362551092868671, "policy_loss": 0.0015683105157222599, "vf_loss": 1233.1808528900146, "vf_explained_var": 0.7763550877571106, "kl": 0.013668444124050438, "entropy": 48.209049105644226, "entropy_coeff": 0.001}}, "num_steps_sampled": 160000, "num_steps_trained": 160000}, "done": false, "episodes_total": 160, "training_iteration": 40, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_19-05-39", "timestamp": 1617879939, "time_this_iter_s": 2248.6367428302765, "time_total_s": 90396.5209698677, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 90396.5209698677, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 18.52218056857232, "ram_util_percent": 43.10849734457982}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2571.6709182592876, "episode_reward_min": -3070.9873460909503, "episode_reward_mean": -2817.9634179303644, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2720.0110995116042, -2622.343155153126, -2703.596020512435, -2698.9405312398535, -2941.306736172803, -2887.790465013963, -3070.9873460909503, -2915.7856626012035, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516, -2959.325562467125, -2829.005848999284, -2953.0822450454107, -2826.5174942223657, -2849.7310064034277, -2825.4324060428603, -2908.16199546307, -2940.530802403475, -2921.129597432222, -2827.375368481126, -3029.737003873573, -2787.493054609166, -3000.6425592061764, -2776.6408391595774, -2687.393013430355, -2739.634355154821, -2844.4237213769857, -2895.633559486737, -2911.2970692050635, -2839.3651559284986, -2699.006916375293, -2717.689338996511, -2741.4569138387055, -2728.080236976486, -2675.6460293656933, -2777.5841212320847, -2853.1263994904666, -2719.8065903240836, -2737.091824407038, -2705.3707526802796, -2659.397627838248, -2675.822792624471, -2577.280776118091, -2745.015490696467, -2671.197468061297, -2659.851387591582, -2574.732717256704, -2676.1702739076577, -2699.3956049471053, -2713.8351004602737, -2701.591929297077, -2704.7423325597506, -2781.948744086715, -2739.5474628363386, -2715.436580913053, -2847.394102055752, -2747.6539005207615, -2658.097922554784, -2790.728776710785, -2602.386579754148, -2675.8961138017403, -2703.1093806623558, -2642.160886968417, -2643.6517642546733, -2675.943101288677, -2658.4726403406617, -2571.6709182592876, -2704.60576289243, -2716.2283028052634, -2631.9533395617805], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 837.416585051614, "mean_raw_obs_processing_ms": 3.0330676025294863, "mean_inference_ms": 181.49204084045388, "mean_action_processing_ms": 0.5990176146178628}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 164000, "timers": {"sample_time_ms": 2114921.848, "sample_throughput": 1.891, "learn_time_ms": 182114.451, "learn_throughput": 21.964, "update_time_ms": 25.859}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.04781852898304351, "policy_loss": -0.016342732909834012, "vf_loss": 1610.1940879821777, "vf_explained_var": 0.7386691570281982, "kl": 0.015147208294365555, "entropy": 48.33509147167206, "entropy_coeff": 0.001}}, "num_steps_sampled": 164000, "num_steps_trained": 164000}, "done": false, "episodes_total": 164, "training_iteration": 41, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_19-42-38", "timestamp": 1617882158, "time_this_iter_s": 2219.377215385437, "time_total_s": 92615.89818525314, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 92615.89818525314, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 18.331370686926242, "ram_util_percent": 60.4002849002849}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2571.6709182592876, "episode_reward_min": -3056.60612458796, "episode_reward_mean": -2808.4982818160865, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2707.445287909042, -2672.469825529467, -2725.5499856580745, -2763.8914993545222, -3042.95225650468, -3056.60612458796, -2968.0331495668206, -2892.066977204851, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516, -2959.325562467125, -2829.005848999284, -2953.0822450454107, -2826.5174942223657, -2849.7310064034277, -2825.4324060428603, -2908.16199546307, -2940.530802403475, -2921.129597432222, -2827.375368481126, -3029.737003873573, -2787.493054609166, -3000.6425592061764, -2776.6408391595774, -2687.393013430355, -2739.634355154821, -2844.4237213769857, -2895.633559486737, -2911.2970692050635, -2839.3651559284986, -2699.006916375293, -2717.689338996511, -2741.4569138387055, -2728.080236976486, -2675.6460293656933, -2777.5841212320847, -2853.1263994904666, -2719.8065903240836, -2737.091824407038, -2705.3707526802796, -2659.397627838248, -2675.822792624471, -2577.280776118091, -2745.015490696467, -2671.197468061297, -2659.851387591582, -2574.732717256704, -2676.1702739076577, -2699.3956049471053, -2713.8351004602737, -2701.591929297077, -2704.7423325597506, -2781.948744086715, -2739.5474628363386, -2715.436580913053, -2847.394102055752, -2747.6539005207615, -2658.097922554784, -2790.728776710785, -2602.386579754148, -2675.8961138017403, -2703.1093806623558, -2642.160886968417, -2643.6517642546733, -2675.943101288677, -2658.4726403406617, -2571.6709182592876, -2704.60576289243, -2716.2283028052634, -2631.9533395617805, -2720.0110995116042, -2622.343155153126, -2703.596020512435, -2698.9405312398535], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 837.9299957242195, "mean_raw_obs_processing_ms": 3.034550510630473, "mean_inference_ms": 181.6218170705146, "mean_action_processing_ms": 0.6004158597082752}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 168000, "timers": {"sample_time_ms": 2086655.115, "sample_throughput": 1.917, "learn_time_ms": 179094.046, "learn_throughput": 22.335, "update_time_ms": 28.341}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.05195738191832788, "policy_loss": -0.014944764465326443, "vf_loss": 1071.3764152526855, "vf_explained_var": 0.8235799074172974, "kl": 0.015587947971653193, "entropy": 48.505775690078735, "entropy_coeff": 0.001}}, "num_steps_sampled": 168000, "num_steps_trained": 168000}, "done": false, "episodes_total": 168, "training_iteration": 42, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_20-20-07", "timestamp": 1617884407, "time_this_iter_s": 2248.856629371643, "time_total_s": 94864.75481462479, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 94864.75481462479, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 18.451046547953762, "ram_util_percent": 50.16179318962824}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2571.6709182592876, "episode_reward_min": -3040.1097276649257, "episode_reward_mean": -2797.783366339904, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2758.491265897102, -2766.4493209097245, -2676.7177029649283, -2686.5086704742457, -3024.555489964834, -2883.7075669559226, -2845.3376463225995, -3019.876733060626, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516, -2959.325562467125, -2829.005848999284, -2953.0822450454107, -2826.5174942223657, -2849.7310064034277, -2825.4324060428603, -2908.16199546307, -2940.530802403475, -2921.129597432222, -2827.375368481126, -3029.737003873573, -2787.493054609166, -3000.6425592061764, -2776.6408391595774, -2687.393013430355, -2739.634355154821, -2844.4237213769857, -2895.633559486737, -2911.2970692050635, -2839.3651559284986, -2699.006916375293, -2717.689338996511, -2741.4569138387055, -2728.080236976486, -2675.6460293656933, -2777.5841212320847, -2853.1263994904666, -2719.8065903240836, -2737.091824407038, -2705.3707526802796, -2659.397627838248, -2675.822792624471, -2577.280776118091, -2745.015490696467, -2671.197468061297, -2659.851387591582, -2574.732717256704, -2676.1702739076577, -2699.3956049471053, -2713.8351004602737, -2701.591929297077, -2704.7423325597506, -2781.948744086715, -2739.5474628363386, -2715.436580913053, -2847.394102055752, -2747.6539005207615, -2658.097922554784, -2790.728776710785, -2602.386579754148, -2675.8961138017403, -2703.1093806623558, -2642.160886968417, -2643.6517642546733, -2675.943101288677, -2658.4726403406617, -2571.6709182592876, -2704.60576289243, -2716.2283028052634, -2631.9533395617805, -2720.0110995116042, -2622.343155153126, -2703.596020512435, -2698.9405312398535, -2707.445287909042, -2672.469825529467, -2725.5499856580745, -2763.8914993545222], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 838.4727965120179, "mean_raw_obs_processing_ms": 3.03660673740647, "mean_inference_ms": 181.759826040167, "mean_action_processing_ms": 0.6018387140209797}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 172000, "timers": {"sample_time_ms": 2074337.662, "sample_throughput": 1.928, "learn_time_ms": 184755.765, "learn_throughput": 21.65, "update_time_ms": 28.032}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.04326469835359603, "policy_loss": -0.008960357226897031, "vf_loss": 1318.5019130706787, "vf_explained_var": 0.7940685153007507, "kl": 0.01613966524018906, "entropy": 48.29633975028992, "entropy_coeff": 0.001}}, "num_steps_sampled": 172000, "num_steps_trained": 172000}, "done": false, "episodes_total": 172, "training_iteration": 43, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_20-57-42", "timestamp": 1617886662, "time_this_iter_s": 2254.612658262253, "time_total_s": 97119.36747288704, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 97119.36747288704, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 19.618785046728973, "ram_util_percent": 39.847071651090346}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2571.6709182592876, "episode_reward_min": -3040.1097276649257, "episode_reward_mean": -2785.2476226107447, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2687.758841670995, -2577.55066817213, -2601.7338164998996, -2652.859737045078, -2927.6168655714687, -2928.8091911832335, -2939.6083108743087, -3040.1097276649257, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516, -2959.325562467125, -2829.005848999284, -2953.0822450454107, -2826.5174942223657, -2849.7310064034277, -2825.4324060428603, -2908.16199546307, -2940.530802403475, -2921.129597432222, -2827.375368481126, -3029.737003873573, -2787.493054609166, -3000.6425592061764, -2776.6408391595774, -2687.393013430355, -2739.634355154821, -2844.4237213769857, -2895.633559486737, -2911.2970692050635, -2839.3651559284986, -2699.006916375293, -2717.689338996511, -2741.4569138387055, -2728.080236976486, -2675.6460293656933, -2777.5841212320847, -2853.1263994904666, -2719.8065903240836, -2737.091824407038, -2705.3707526802796, -2659.397627838248, -2675.822792624471, -2577.280776118091, -2745.015490696467, -2671.197468061297, -2659.851387591582, -2574.732717256704, -2676.1702739076577, -2699.3956049471053, -2713.8351004602737, -2701.591929297077, -2704.7423325597506, -2781.948744086715, -2739.5474628363386, -2715.436580913053, -2847.394102055752, -2747.6539005207615, -2658.097922554784, -2790.728776710785, -2602.386579754148, -2675.8961138017403, -2703.1093806623558, -2642.160886968417, -2643.6517642546733, -2675.943101288677, -2658.4726403406617, -2571.6709182592876, -2704.60576289243, -2716.2283028052634, -2631.9533395617805, -2720.0110995116042, -2622.343155153126, -2703.596020512435, -2698.9405312398535, -2707.445287909042, -2672.469825529467, -2725.5499856580745, -2763.8914993545222, -2758.491265897102, -2766.4493209097245, -2676.7177029649283, -2686.5086704742457], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 839.0636674483001, "mean_raw_obs_processing_ms": 3.038566398379875, "mean_inference_ms": 181.9027611947927, "mean_action_processing_ms": 0.6030402819831803}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 176000, "timers": {"sample_time_ms": 2077332.561, "sample_throughput": 1.926, "learn_time_ms": 201285.612, "learn_throughput": 19.872, "update_time_ms": 28.232}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.05085072270594537, "policy_loss": -0.016409420524723828, "vf_loss": 1316.6944904327393, "vf_explained_var": 0.7768758535385132, "kl": 0.013020560843870044, "entropy": 48.25927555561066, "entropy_coeff": 0.001}}, "num_steps_sampled": 176000, "num_steps_trained": 176000}, "done": false, "episodes_total": 176, "training_iteration": 44, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_21-38-18", "timestamp": 1617889098, "time_this_iter_s": 2436.185950279236, "time_total_s": 99555.55342316628, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 99555.55342316628, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 23.410095183155466, "ram_util_percent": 33.96383040092299}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2560.293275168181, "episode_reward_min": -3029.737003873573, "episode_reward_mean": -2772.3538153725663, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2560.293275168181, -2596.511371191166, -2755.3465608353254, -2634.6121642814674, -3019.18435043484, -2929.305149251693, -2994.202403871296, -2979.7206909394017, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516, -2959.325562467125, -2829.005848999284, -2953.0822450454107, -2826.5174942223657, -2849.7310064034277, -2825.4324060428603, -2908.16199546307, -2940.530802403475, -2921.129597432222, -2827.375368481126, -3029.737003873573, -2787.493054609166, -3000.6425592061764, -2776.6408391595774, -2687.393013430355, -2739.634355154821, -2844.4237213769857, -2895.633559486737, -2911.2970692050635, -2839.3651559284986, -2699.006916375293, -2717.689338996511, -2741.4569138387055, -2728.080236976486, -2675.6460293656933, -2777.5841212320847, -2853.1263994904666, -2719.8065903240836, -2737.091824407038, -2705.3707526802796, -2659.397627838248, -2675.822792624471, -2577.280776118091, -2745.015490696467, -2671.197468061297, -2659.851387591582, -2574.732717256704, -2676.1702739076577, -2699.3956049471053, -2713.8351004602737, -2701.591929297077, -2704.7423325597506, -2781.948744086715, -2739.5474628363386, -2715.436580913053, -2847.394102055752, -2747.6539005207615, -2658.097922554784, -2790.728776710785, -2602.386579754148, -2675.8961138017403, -2703.1093806623558, -2642.160886968417, -2643.6517642546733, -2675.943101288677, -2658.4726403406617, -2571.6709182592876, -2704.60576289243, -2716.2283028052634, -2631.9533395617805, -2720.0110995116042, -2622.343155153126, -2703.596020512435, -2698.9405312398535, -2707.445287909042, -2672.469825529467, -2725.5499856580745, -2763.8914993545222, -2758.491265897102, -2766.4493209097245, -2676.7177029649283, -2686.5086704742457, -2687.758841670995, -2577.55066817213, -2601.7338164998996, -2652.859737045078], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 839.7410724907252, "mean_raw_obs_processing_ms": 3.04097759102834, "mean_inference_ms": 182.0562314358662, "mean_action_processing_ms": 0.60426427197903}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 180000, "timers": {"sample_time_ms": 2094484.6, "sample_throughput": 1.91, "learn_time_ms": 214094.117, "learn_throughput": 18.683, "update_time_ms": 28.812}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.04226472356822342, "policy_loss": -0.008062801527557895, "vf_loss": 1330.716630935669, "vf_explained_var": 0.7826714515686035, "kl": 0.011267730500549078, "entropy": 48.07247066497803, "entropy_coeff": 0.001}}, "num_steps_sampled": 180000, "num_steps_trained": 180000}, "done": false, "episodes_total": 180, "training_iteration": 45, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_22-21-39", "timestamp": 1617891699, "time_this_iter_s": 2600.9644372463226, "time_total_s": 102156.5178604126, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 102156.5178604126, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 34.64662344678552, "ram_util_percent": 32.9182603997839}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2560.293275168181, "episode_reward_min": -3029.737003873573, "episode_reward_mean": -2760.7753708067094, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2601.587468318312, -2740.9142501578, -2688.865257826844, -2733.2011616085215, -2897.837315978723, -2802.9844688540243, -2938.0199102839433, -2948.619838824484, -3011.1592433770143, -2906.8153097290774, -2975.5006463285486, -2852.1981127704757, -2970.8186129053774, -2856.9844505488613, -2868.192194958899, -2788.7225080295834, -2947.364937481139, -2900.12440108537, -2950.2626707317872, -2854.9519571894516, -2959.325562467125, -2829.005848999284, -2953.0822450454107, -2826.5174942223657, -2849.7310064034277, -2825.4324060428603, -2908.16199546307, -2940.530802403475, -2921.129597432222, -2827.375368481126, -3029.737003873573, -2787.493054609166, -3000.6425592061764, -2776.6408391595774, -2687.393013430355, -2739.634355154821, -2844.4237213769857, -2895.633559486737, -2911.2970692050635, -2839.3651559284986, -2699.006916375293, -2717.689338996511, -2741.4569138387055, -2728.080236976486, -2675.6460293656933, -2777.5841212320847, -2853.1263994904666, -2719.8065903240836, -2737.091824407038, -2705.3707526802796, -2659.397627838248, -2675.822792624471, -2577.280776118091, -2745.015490696467, -2671.197468061297, -2659.851387591582, -2574.732717256704, -2676.1702739076577, -2699.3956049471053, -2713.8351004602737, -2701.591929297077, -2704.7423325597506, -2781.948744086715, -2739.5474628363386, -2715.436580913053, -2847.394102055752, -2747.6539005207615, -2658.097922554784, -2790.728776710785, -2602.386579754148, -2675.8961138017403, -2703.1093806623558, -2642.160886968417, -2643.6517642546733, -2675.943101288677, -2658.4726403406617, -2571.6709182592876, -2704.60576289243, -2716.2283028052634, -2631.9533395617805, -2720.0110995116042, -2622.343155153126, -2703.596020512435, -2698.9405312398535, -2707.445287909042, -2672.469825529467, -2725.5499856580745, -2763.8914993545222, -2758.491265897102, -2766.4493209097245, -2676.7177029649283, -2686.5086704742457, -2687.758841670995, -2577.55066817213, -2601.7338164998996, -2652.859737045078, -2560.293275168181, -2596.511371191166, -2755.3465608353254, -2634.6121642814674], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 840.5180110348956, "mean_raw_obs_processing_ms": 3.0434258809613994, "mean_inference_ms": 182.21846199737126, "mean_action_processing_ms": 0.6054178900726167}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 184000, "timers": {"sample_time_ms": 2107180.808, "sample_throughput": 1.898, "learn_time_ms": 227129.214, "learn_throughput": 17.611, "update_time_ms": 29.077}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05, "cur_lr": 5e-05, "total_loss": -0.035108549607684836, "policy_loss": -0.007425056304782629, "vf_loss": 1894.1212253570557, "vf_explained_var": 0.7193809151649475, "kl": 0.019533995335223153, "entropy": 47.60140311717987, "entropy_coeff": 0.001}}, "num_steps_sampled": 184000, "num_steps_trained": 184000}, "done": false, "episodes_total": 184, "training_iteration": 46, "experiment_id": "cf6832ffc29842cba5cf4dbb159b4d8c", "date": "2021-04-08_23-05-31", "timestamp": 1617894331, "time_this_iter_s": 2632.2556762695312, "time_total_s": 104788.77353668213, "pid": 15292, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 104788.77353668213, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 36.17602776294714, "ram_util_percent": 33.43454351308062}, "trial_id": "d606b_00000"}
{"episode_reward_max": -828.4379151682421, "episode_reward_min": -890.099127814791, "episode_reward_mean": -873.0391059566145, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-889.1205977118371, -890.099127814791, -828.4379151682421, -884.498783131588], "episode_lengths": [1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 223.704368337758, "mean_raw_obs_processing_ms": 1.9428286774047667, "mean_inference_ms": 87.42513345635456, "mean_action_processing_ms": 0.2158661594038186}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 4000, "timers": {"sample_time_ms": 634805.831, "sample_throughput": 6.301, "learn_time_ms": 93533.723, "learn_throughput": 42.765, "update_time_ms": 11.756}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.03256984584731981, "policy_loss": 0.0024247850524261594, "vf_loss": 1420.3929061889648, "vf_explained_var": -0.01575505919754505, "kl": 0.011072671004512813, "entropy": 51.4130893945694, "entropy_coeff": 0.001}}, "num_steps_sampled": 4000, "num_steps_trained": 4000}, "done": false, "episodes_total": 4, "training_iteration": 1, "experiment_id": "1ec17349006f4cfda53c6b9f1d4edcd2", "date": "2021-04-09_15-34-35", "timestamp": 1617953675, "time_this_iter_s": 728.3592231273651, "time_total_s": 728.3592231273651, "pid": 11994, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 728.3592231273651, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 12.398554913294799, "ram_util_percent": 14.340366088631981}, "trial_id": "d606b_00000"}
{"episode_reward_max": -828.4379151682421, "episode_reward_min": -981.9668147841352, "episode_reward_mean": -898.0539681565807, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-867.3387996020253, -921.6322686485158, -981.9668147841352, -921.3374383915115, -889.1205977118371, -890.099127814791, -828.4379151682421, -884.498783131588], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 233.54709746905738, "mean_raw_obs_processing_ms": 1.9672738759676491, "mean_inference_ms": 91.38034465976918, "mean_action_processing_ms": 0.2427793446466747}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 8000, "timers": {"sample_time_ms": 691808.985, "sample_throughput": 5.782, "learn_time_ms": 92749.955, "learn_throughput": 43.127, "update_time_ms": 12.35}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.041932122490834445, "policy_loss": -0.0005836360505782068, "vf_loss": 792.0126991271973, "vf_explained_var": -0.06394914537668228, "kl": 0.011232664000999648, "entropy": 51.51514256000519, "entropy_coeff": 0.001}}, "num_steps_sampled": 8000, "num_steps_trained": 8000}, "done": false, "episodes_total": 8, "training_iteration": 2, "experiment_id": "1ec17349006f4cfda53c6b9f1d4edcd2", "date": "2021-04-09_15-48-36", "timestamp": 1617954516, "time_this_iter_s": 840.7991290092468, "time_total_s": 1569.158352136612, "pid": 11994, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 1569.158352136612, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 11.91136173767753, "ram_util_percent": 14.812280701754386}, "trial_id": "d606b_00000"}
{"episode_reward_max": -828.4379151682421, "episode_reward_min": -981.9668147841352, "episode_reward_mean": -893.3516345163421, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-859.0612879342439, -931.8436137512389, -896.308232869976, -848.5747343880016, -889.1205977118371, -890.099127814791, -828.4379151682421, -884.498783131588, -867.3387996020253, -921.6322686485158, -981.9668147841352, -921.3374383915115], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 237.5562631981853, "mean_raw_obs_processing_ms": 1.9871996730640322, "mean_inference_ms": 93.49214949123989, "mean_action_processing_ms": 0.2527188149898594}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 12000, "timers": {"sample_time_ms": 699398.834, "sample_throughput": 5.719, "learn_time_ms": 92708.444, "learn_throughput": 43.146, "update_time_ms": 12.848}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05274107086006552, "policy_loss": -0.006025514972861856, "vf_loss": 274.7869396209717, "vf_explained_var": -0.016749311238527298, "kl": 0.008639042262075236, "entropy": 51.19122874736786, "entropy_coeff": 0.001}}, "num_steps_sampled": 12000, "num_steps_trained": 12000}, "done": false, "episodes_total": 12, "training_iteration": 3, "experiment_id": "1ec17349006f4cfda53c6b9f1d4edcd2", "date": "2021-04-09_16-02-03", "timestamp": 1617955323, "time_this_iter_s": 807.2255699634552, "time_total_s": 2376.383922100067, "pid": 11994, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 2376.383922100067, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 11.902086956521739, "ram_util_percent": 14.817999999999998}, "trial_id": "d606b_00000"}
{"episode_reward_max": -828.4379151682421, "episode_reward_min": -981.9668147841352, "episode_reward_mean": -901.9067140183067, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-937.0588388724707, -938.673743048183, -907.7193306702959, -926.8358975058528, -889.1205977118371, -890.099127814791, -828.4379151682421, -884.498783131588, -867.3387996020253, -921.6322686485158, -981.9668147841352, -921.3374383915115, -859.0612879342439, -931.8436137512389, -896.308232869976, -848.5747343880016], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 240.4484482852664, "mean_raw_obs_processing_ms": 2.0033012989219676, "mean_inference_ms": 94.92717346332375, "mean_action_processing_ms": 0.26147916484084116}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 16000, "timers": {"sample_time_ms": 709249.798, "sample_throughput": 5.64, "learn_time_ms": 90420.825, "learn_throughput": 44.238, "update_time_ms": 13.37}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05078690708614886, "policy_loss": -0.004712040536105633, "vf_loss": 241.83286476135254, "vf_explained_var": 0.07671350240707397, "kl": 0.009740790497744456, "entropy": 50.44134867191315, "entropy_coeff": 0.001}}, "num_steps_sampled": 16000, "num_steps_trained": 16000}, "done": false, "episodes_total": 16, "training_iteration": 4, "experiment_id": "1ec17349006f4cfda53c6b9f1d4edcd2", "date": "2021-04-09_16-15-46", "timestamp": 1617956146, "time_this_iter_s": 822.3858337402344, "time_total_s": 3198.7697558403015, "pid": 11994, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 3198.7697558403015, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 11.923228010247652, "ram_util_percent": 14.833817250213494}, "trial_id": "d606b_00000"}
{"episode_reward_max": -793.1167601156221, "episode_reward_min": -874.1155086257287, "episode_reward_mean": -825.5123407792773, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-874.1155086257287, -811.9422864480769, -793.1167601156221, -822.8748079276816], "episode_lengths": [1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 253.25548368832398, "mean_raw_obs_processing_ms": 2.0972750057046974, "mean_inference_ms": 103.92185969688722, "mean_action_processing_ms": 0.29674993045088177}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 4000, "timers": {"sample_time_ms": 727942.765, "sample_throughput": 5.495, "learn_time_ms": 91607.075, "learn_throughput": 43.665, "update_time_ms": 30.067}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.04532977956114337, "policy_loss": -0.006065859575755894, "vf_loss": 1207.4691467285156, "vf_explained_var": -0.008597834035754204, "kl": 0.005608802035567351, "entropy": 52.46036922931671, "entropy_coeff": 0.001}}, "num_steps_sampled": 4000, "num_steps_trained": 4000}, "done": false, "episodes_total": 4, "training_iteration": 1, "experiment_id": "b0622efac8f74ee0acf07515ac59d258", "date": "2021-04-09_16-42-24", "timestamp": 1617957744, "time_this_iter_s": 819.5879294872284, "time_total_s": 819.5879294872284, "pid": 15879, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 819.5879294872284, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 11.948801369863014, "ram_util_percent": 14.739640410958906}, "trial_id": "d606b_00000"}
{"episode_reward_max": -786.983407129278, "episode_reward_min": -875.880067829349, "episode_reward_mean": -825.6129010326919, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-786.983407129278, -844.3406311689769, -875.880067829349, -795.6497390168215, -874.1155086257287, -811.9422864480769, -793.1167601156221, -822.8748079276816], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 250.92990766110714, "mean_raw_obs_processing_ms": 2.0941144730339367, "mean_inference_ms": 103.81334497547203, "mean_action_processing_ms": 0.2858327359498816}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 8000, "timers": {"sample_time_ms": 721500.72, "sample_throughput": 5.544, "learn_time_ms": 91950.71, "learn_throughput": 43.502, "update_time_ms": 20.798}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05240742072055582, "policy_loss": -0.005646292527671903, "vf_loss": 461.8863639831543, "vf_explained_var": -0.024381622672080994, "kl": 0.005238553108938504, "entropy": 52.42770195007324, "entropy_coeff": 0.001}}, "num_steps_sampled": 8000, "num_steps_trained": 8000}, "done": false, "episodes_total": 8, "training_iteration": 2, "experiment_id": "b0622efac8f74ee0acf07515ac59d258", "date": "2021-04-09_16-55-51", "timestamp": 1617958551, "time_this_iter_s": 807.3725609779358, "time_total_s": 1626.9604904651642, "pid": 15879, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 1626.9604904651642, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 11.914882506527416, "ram_util_percent": 14.915404699738906}, "trial_id": "d606b_00000"}
{"episode_reward_max": -766.6749256568164, "episode_reward_min": -875.880067829349, "episode_reward_mean": -828.082266693323, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-834.7551143943117, -859.0820750311246, -766.6749256568164, -871.5718769760887, -874.1155086257287, -811.9422864480769, -793.1167601156221, -822.8748079276816, -786.983407129278, -844.3406311689769, -875.880067829349, -795.6497390168215], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 250.69292023112908, "mean_raw_obs_processing_ms": 2.103037375869191, "mean_inference_ms": 103.81030819802079, "mean_action_processing_ms": 0.2820139306784913}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 12000, "timers": {"sample_time_ms": 724488.699, "sample_throughput": 5.521, "learn_time_ms": 90897.075, "learn_throughput": 44.006, "update_time_ms": 16.92}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05356663535349071, "policy_loss": -0.004887707647867501, "vf_loss": 211.14343357086182, "vf_explained_var": 0.030314087867736816, "kl": 0.008658501152240206, "entropy": 52.52206110954285, "entropy_coeff": 0.001}}, "num_steps_sampled": 12000, "num_steps_trained": 12000}, "done": false, "episodes_total": 12, "training_iteration": 3, "experiment_id": "b0622efac8f74ee0acf07515ac59d258", "date": "2021-04-09_17-09-31", "timestamp": 1617959371, "time_this_iter_s": 819.271425485611, "time_total_s": 2446.231915950775, "pid": 15879, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 2446.231915950775, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 11.904113110539846, "ram_util_percent": 14.912767780634109}, "trial_id": "d606b_00000"}
{"episode_reward_max": -766.6749256568164, "episode_reward_min": -880.4537585439031, "episode_reward_mean": -836.1352235961427, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-835.3697728329932, -880.4537585439031, -855.5145131495972, -869.8383326919145, -874.1155086257287, -811.9422864480769, -793.1167601156221, -822.8748079276816, -786.983407129278, -844.3406311689769, -875.880067829349, -795.6497390168215, -834.7551143943117, -859.0820750311246, -766.6749256568164, -871.5718769760887], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 250.29709073476045, "mean_raw_obs_processing_ms": 2.1086915413063094, "mean_inference_ms": 103.72143005300697, "mean_action_processing_ms": 0.28419269527681673}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 16000, "timers": {"sample_time_ms": 722155.555, "sample_throughput": 5.539, "learn_time_ms": 90493.296, "learn_throughput": 44.202, "update_time_ms": 16.327}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.06428069330286235, "policy_loss": -0.016244149024714716, "vf_loss": 223.71804475784302, "vf_explained_var": 0.1409355103969574, "kl": 0.008446267151157372, "entropy": 51.962974190711975, "entropy_coeff": 0.001}}, "num_steps_sampled": 16000, "num_steps_trained": 16000}, "done": false, "episodes_total": 16, "training_iteration": 4, "experiment_id": "b0622efac8f74ee0acf07515ac59d258", "date": "2021-04-09_17-22-55", "timestamp": 1617960175, "time_this_iter_s": 804.4608843326569, "time_total_s": 3250.692800283432, "pid": 15879, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 3250.692800283432, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 11.908115183246075, "ram_util_percent": 14.914921465968586}, "trial_id": "d606b_00000"}
{"episode_reward_max": -762.0013906880869, "episode_reward_min": -880.4537585439031, "episode_reward_mean": -833.5384199744307, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-860.3363826707146, -832.5390446496361, -837.7280039418918, -762.0013906880869, -874.1155086257287, -811.9422864480769, -793.1167601156221, -822.8748079276816, -786.983407129278, -844.3406311689769, -875.880067829349, -795.6497390168215, -834.7551143943117, -859.0820750311246, -766.6749256568164, -871.5718769760887, -835.3697728329932, -880.4537585439031, -855.5145131495972, -869.8383326919145], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 250.14046308001463, "mean_raw_obs_processing_ms": 2.115031512768193, "mean_inference_ms": 103.7129330671675, "mean_action_processing_ms": 0.28687762758800084}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 20000, "timers": {"sample_time_ms": 723460.845, "sample_throughput": 5.529, "learn_time_ms": 89259.123, "learn_throughput": 44.813, "update_time_ms": 16.051}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05332216544775292, "policy_loss": -0.004619291605195031, "vf_loss": 167.8777642250061, "vf_explained_var": 0.26003316044807434, "kl": 0.009510482399491593, "entropy": 52.2837438583374, "entropy_coeff": 0.001}}, "num_steps_sampled": 20000, "num_steps_trained": 20000}, "done": false, "episodes_total": 20, "training_iteration": 5, "experiment_id": "b0622efac8f74ee0acf07515ac59d258", "date": "2021-04-09_17-36-28", "timestamp": 1617960988, "time_this_iter_s": 813.0274147987366, "time_total_s": 4063.7202150821686, "pid": 15879, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 4063.7202150821686, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 11.901555747623162, "ram_util_percent": 14.913310285220398}, "trial_id": "d606b_00000"}
{"episode_reward_max": -762.0013906880869, "episode_reward_min": -880.4537585439031, "episode_reward_mean": -832.098595071909, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-814.5551949580363, -848.1276965796851, -810.2652773745766, -826.6497133249071, -874.1155086257287, -811.9422864480769, -793.1167601156221, -822.8748079276816, -786.983407129278, -844.3406311689769, -875.880067829349, -795.6497390168215, -834.7551143943117, -859.0820750311246, -766.6749256568164, -871.5718769760887, -835.3697728329932, -880.4537585439031, -855.5145131495972, -869.8383326919145, -860.3363826707146, -832.5390446496361, -837.7280039418918, -762.0013906880869], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 250.03075879201427, "mean_raw_obs_processing_ms": 2.1201901506757506, "mean_inference_ms": 103.7007896451499, "mean_action_processing_ms": 0.29089194562226434}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 24000, "timers": {"sample_time_ms": 723012.85, "sample_throughput": 5.532, "learn_time_ms": 89444.517, "learn_throughput": 44.72, "update_time_ms": 16.271}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.04720160239958204, "policy_loss": 0.0018908982165157795, "vf_loss": 188.98956942558289, "vf_explained_var": 0.24471265077590942, "kl": 0.009974517604860011, "entropy": 52.97729444503784, "entropy_coeff": 0.001}}, "num_steps_sampled": 24000, "num_steps_trained": 24000}, "done": false, "episodes_total": 24, "training_iteration": 6, "experiment_id": "b0622efac8f74ee0acf07515ac59d258", "date": "2021-04-09_17-49-59", "timestamp": 1617961799, "time_this_iter_s": 811.1697249412537, "time_total_s": 4874.889940023422, "pid": 15879, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 4874.889940023422, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 11.833650519031142, "ram_util_percent": 14.923269896193775}, "trial_id": "d606b_00000"}
{"episode_reward_max": -762.0013906880869, "episode_reward_min": -880.4537585439031, "episode_reward_mean": -828.7397158731522, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-834.4184890705692, -771.8025860131776, -845.0146202798829, -783.1100673588168, -874.1155086257287, -811.9422864480769, -793.1167601156221, -822.8748079276816, -786.983407129278, -844.3406311689769, -875.880067829349, -795.6497390168215, -834.7551143943117, -859.0820750311246, -766.6749256568164, -871.5718769760887, -835.3697728329932, -880.4537585439031, -855.5145131495972, -869.8383326919145, -860.3363826707146, -832.5390446496361, -837.7280039418918, -762.0013906880869, -814.5551949580363, -848.1276965796851, -810.2652773745766, -826.6497133249071], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 249.90231623193742, "mean_raw_obs_processing_ms": 2.1252534246389976, "mean_inference_ms": 103.7063616951125, "mean_action_processing_ms": 0.2954701844155462}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 28000, "timers": {"sample_time_ms": 722579.978, "sample_throughput": 5.536, "learn_time_ms": 88431.423, "learn_throughput": 45.233, "update_time_ms": 17.196}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05665411171503365, "policy_loss": -0.007622931676451117, "vf_loss": 163.46386122703552, "vf_explained_var": 0.34914177656173706, "kl": 0.011429398859036155, "entropy": 52.95169544219971, "entropy_coeff": 0.001}}, "num_steps_sampled": 28000, "num_steps_trained": 28000}, "done": false, "episodes_total": 28, "training_iteration": 7, "experiment_id": "b0622efac8f74ee0acf07515ac59d258", "date": "2021-04-09_18-03-22", "timestamp": 1617962602, "time_this_iter_s": 802.366289138794, "time_total_s": 5677.256229162216, "pid": 15879, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 5677.256229162216, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 11.821891418563924, "ram_util_percent": 14.92224168126095}, "trial_id": "d606b_00000"}
{"episode_reward_max": -762.0013906880869, "episode_reward_min": -880.4537585439031, "episode_reward_mean": -827.7292839707451, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-796.6075889569329, -810.5116474243401, -841.9475371664539, -833.5582690678496, -874.1155086257287, -811.9422864480769, -793.1167601156221, -822.8748079276816, -786.983407129278, -844.3406311689769, -875.880067829349, -795.6497390168215, -834.7551143943117, -859.0820750311246, -766.6749256568164, -871.5718769760887, -835.3697728329932, -880.4537585439031, -855.5145131495972, -869.8383326919145, -860.3363826707146, -832.5390446496361, -837.7280039418918, -762.0013906880869, -814.5551949580363, -848.1276965796851, -810.2652773745766, -826.6497133249071, -834.4184890705692, -771.8025860131776, -845.0146202798829, -783.1100673588168], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 249.88790083019921, "mean_raw_obs_processing_ms": 2.128026315524635, "mean_inference_ms": 103.71240734990425, "mean_action_processing_ms": 0.29886453089647014}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 32000, "timers": {"sample_time_ms": 723182.528, "sample_throughput": 5.531, "learn_time_ms": 88672.197, "learn_throughput": 45.11, "update_time_ms": 16.613}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.05668210610747337, "policy_loss": -0.006976101431064308, "vf_loss": 140.2874345779419, "vf_explained_var": 0.3360065817832947, "kl": 0.01010935494559817, "entropy": 53.130746364593506, "entropy_coeff": 0.001}}, "num_steps_sampled": 32000, "num_steps_trained": 32000}, "done": false, "episodes_total": 32, "training_iteration": 8, "experiment_id": "b0622efac8f74ee0acf07515ac59d258", "date": "2021-04-09_18-17-00", "timestamp": 1617963420, "time_this_iter_s": 817.7784523963928, "time_total_s": 6495.034681558609, "pid": 15879, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 6495.034681558609, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 11.838369098712445, "ram_util_percent": 14.915021459227471}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2614.6069959981673, "episode_reward_min": -2807.695360917763, "episode_reward_mean": -2705.5946962121197, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018], "episode_lengths": [1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 552.7212430333448, "mean_raw_obs_processing_ms": 2.3128605675304135, "mean_inference_ms": 111.29142956874301, "mean_action_processing_ms": 0.372976734899152}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 4000, "timers": {"sample_time_ms": 1337854.509, "sample_throughput": 2.99, "learn_time_ms": 97612.725, "learn_throughput": 40.978, "update_time_ms": 20.374}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 0.21551551209995523, "policy_loss": -0.0027534255641512573, "vf_loss": 26942.541259765625, "vf_explained_var": -0.02552805095911026, "kl": 0.008633438665128779, "entropy": 52.8831502199173, "entropy_coeff": 0.001}}, "num_steps_sampled": 4000, "num_steps_trained": 4000}, "done": false, "episodes_total": 4, "training_iteration": 1, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-09_18-50-06", "timestamp": 1617965406, "time_this_iter_s": 1435.4953546524048, "time_total_s": 1435.4953546524048, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 1435.4953546524048, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 12.081800391389432, "ram_util_percent": 14.891487279843446}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2601.8795449892636, "episode_reward_min": -2807.695360917763, "episode_reward_mean": -2698.1558368657534, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 554.3021189984563, "mean_raw_obs_processing_ms": 2.3090572769440514, "mean_inference_ms": 112.04939071823418, "mean_action_processing_ms": 0.3638085804766491}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 8000, "timers": {"sample_time_ms": 1347010.889, "sample_throughput": 2.97, "learn_time_ms": 96305.529, "learn_throughput": 41.534, "update_time_ms": 15.332}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 0.1674559029052034, "policy_loss": 0.0014169924252200872, "vf_loss": 21665.325134277344, "vf_explained_var": -0.056060969829559326, "kl": 0.009373443564982153, "entropy": 52.489025592803955, "entropy_coeff": 0.001}}, "num_steps_sampled": 8000, "num_steps_trained": 8000}, "done": false, "episodes_total": 8, "training_iteration": 2, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-09_19-14-17", "timestamp": 1617966857, "time_this_iter_s": 1451.2045369148254, "time_total_s": 2886.69989156723, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 2886.69989156723, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 11.89080348499516, "ram_util_percent": 15.104114230396897}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2601.8795449892636, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2709.7220455218644, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 555.052181780544, "mean_raw_obs_processing_ms": 2.30262847847169, "mean_inference_ms": 112.65123948821537, "mean_action_processing_ms": 0.3638783045717597}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 12000, "timers": {"sample_time_ms": 1350310.583, "sample_throughput": 2.962, "learn_time_ms": 96343.944, "learn_throughput": 41.518, "update_time_ms": 17.781}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 0.1285314183915034, "policy_loss": -5.445966962724924e-05, "vf_loss": 18023.352111816406, "vf_explained_var": -0.07560533285140991, "kl": 0.0044013702718075365, "entropy": 52.52791237831116, "entropy_coeff": 0.001}}, "num_steps_sampled": 12000, "num_steps_trained": 12000}, "done": false, "episodes_total": 12, "training_iteration": 3, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-09_19-38-31", "timestamp": 1617968311, "time_this_iter_s": 1453.3612968921661, "time_total_s": 4340.061188459396, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 4340.061188459396, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 11.89100580270793, "ram_util_percent": 15.117601547388777}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2601.8795449892636, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2709.3461476833772, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 555.1351658232005, "mean_raw_obs_processing_ms": 2.2953662762204066, "mean_inference_ms": 112.89763225272364, "mean_action_processing_ms": 0.36047352766643753}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 16000, "timers": {"sample_time_ms": 1347963.088, "sample_throughput": 2.967, "learn_time_ms": 97313.206, "learn_throughput": 41.104, "update_time_ms": 18.706}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": 0.08204274962190539, "policy_loss": -0.009238443861249834, "vf_loss": 14320.543762207031, "vf_explained_var": -0.056864816695451736, "kl": 0.005369454680476338, "entropy": 52.461181640625, "entropy_coeff": 0.001}}, "num_steps_sampled": 16000, "num_steps_trained": 16000}, "done": false, "episodes_total": 16, "training_iteration": 4, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-09_20-02-32", "timestamp": 1617969752, "time_this_iter_s": 1441.1819596290588, "time_total_s": 5781.243148088455, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 5781.243148088455, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 11.904583130180399, "ram_util_percent": 15.124085811799118}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2601.8795449892636, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2706.247430805037, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 555.3261523446669, "mean_raw_obs_processing_ms": 2.287853008524629, "mean_inference_ms": 113.04295138536199, "mean_action_processing_ms": 0.35844912709529897}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 20000, "timers": {"sample_time_ms": 1350125.489, "sample_throughput": 2.963, "learn_time_ms": 97039.662, "learn_throughput": 41.22, "update_time_ms": 17.544}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": 0.05580661474959925, "policy_loss": -0.007176326063927263, "vf_loss": 11488.657165527344, "vf_explained_var": -0.003194529563188553, "kl": 0.0068439834140008315, "entropy": 52.588022351264954, "entropy_coeff": 0.001}}, "num_steps_sampled": 20000, "num_steps_trained": 20000}, "done": false, "episodes_total": 20, "training_iteration": 5, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-09_20-26-47", "timestamp": 1617971207, "time_this_iter_s": 1454.7414138317108, "time_total_s": 7235.984561920166, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 7235.984561920166, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 11.891887976822792, "ram_util_percent": 15.122694350555285}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2601.8795449892636, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2697.8064540835862, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 555.4979877255021, "mean_raw_obs_processing_ms": 2.28336302786089, "mean_inference_ms": 113.17658842257804, "mean_action_processing_ms": 0.3586473084897916}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 24000, "timers": {"sample_time_ms": 1351091.961, "sample_throughput": 2.961, "learn_time_ms": 97140.576, "learn_throughput": 41.177, "update_time_ms": 22.272}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": 0.026693070307374, "policy_loss": -0.007165606279158965, "vf_loss": 8507.21354675293, "vf_explained_var": 0.059974342584609985, "kl": 0.01035423761641141, "entropy": 52.24887931346893, "entropy_coeff": 0.001}}, "num_steps_sampled": 24000, "num_steps_trained": 24000}, "done": false, "episodes_total": 24, "training_iteration": 6, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-09_20-51-00", "timestamp": 1617972660, "time_this_iter_s": 1453.62331199646, "time_total_s": 8689.607873916626, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 8689.607873916626, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 11.88110198163364, "ram_util_percent": 15.122522957950697}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2600.38516898225, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2693.6475458358573, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 555.6457443158815, "mean_raw_obs_processing_ms": 2.2810974756546925, "mean_inference_ms": 113.26523967167053, "mean_action_processing_ms": 0.35681059350708455}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 28000, "timers": {"sample_time_ms": 1351352.934, "sample_throughput": 2.96, "learn_time_ms": 95821.4, "learn_throughput": 41.744, "update_time_ms": 20.676}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": 0.025295898783951998, "policy_loss": 0.007533681986387819, "vf_loss": 6934.805358886719, "vf_explained_var": 0.12717893719673157, "kl": 0.010197492156294174, "entropy": 52.60558211803436, "entropy_coeff": 0.001}}, "num_steps_sampled": 28000, "num_steps_trained": 28000}, "done": false, "episodes_total": 28, "training_iteration": 7, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-09_21-15-01", "timestamp": 1617974101, "time_this_iter_s": 1440.8444385528564, "time_total_s": 10130.452312469482, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 10130.452312469482, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 11.890151145782545, "ram_util_percent": 15.136665041443194}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2600.38516898225, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2690.958166357357, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 555.8162238054023, "mean_raw_obs_processing_ms": 2.28039218373705, "mean_inference_ms": 113.32980632508102, "mean_action_processing_ms": 0.35676216372645975}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 32000, "timers": {"sample_time_ms": 1352279.792, "sample_throughput": 2.958, "learn_time_ms": 95965.177, "learn_throughput": 41.682, "update_time_ms": 20.685}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": 0.0066356598399579525, "policy_loss": 0.0018047146149910986, "vf_loss": 5665.046661376953, "vf_explained_var": 0.1900804042816162, "kl": 0.007246839115396142, "entropy": 52.54420042037964, "entropy_coeff": 0.001}}, "num_steps_sampled": 32000, "num_steps_trained": 32000}, "done": false, "episodes_total": 32, "training_iteration": 8, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-09_21-39-17", "timestamp": 1617975557, "time_this_iter_s": 1455.7681591510773, "time_total_s": 11586.22047162056, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 11586.22047162056, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 11.8980694980695, "ram_util_percent": 15.118967181467179}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2600.38516898225, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2687.9031911740694, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 555.9746837200655, "mean_raw_obs_processing_ms": 2.279774568672216, "mean_inference_ms": 113.37402517336416, "mean_action_processing_ms": 0.35591875800573086}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 36000, "timers": {"sample_time_ms": 1352393.847, "sample_throughput": 2.958, "learn_time_ms": 95934.047, "learn_throughput": 41.695, "update_time_ms": 23.86}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.0170606528990902, "policy_loss": -0.009174947103019804, "vf_loss": 4383.884544372559, "vf_explained_var": 0.23184779286384583, "kl": 0.006549560617713723, "entropy": 52.3795040845871, "entropy_coeff": 0.001}}, "num_steps_sampled": 36000, "num_steps_trained": 36000}, "done": false, "episodes_total": 36, "training_iteration": 9, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-09_22-03-26", "timestamp": 1617977006, "time_this_iter_s": 1449.0486302375793, "time_total_s": 13035.269101858139, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 13035.269101858139, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 11.887154629180804, "ram_util_percent": 15.111100339311678}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2578.071375081434, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2686.1491050582586, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 556.1212707591046, "mean_raw_obs_processing_ms": 2.278867622755651, "mean_inference_ms": 113.39733973744224, "mean_action_processing_ms": 0.35609880600558946}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 40000, "timers": {"sample_time_ms": 1352421.892, "sample_throughput": 2.958, "learn_time_ms": 95876.297, "learn_throughput": 41.72, "update_time_ms": 26.824}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.03402110608294606, "policy_loss": -0.015315601776819676, "vf_loss": 3337.676124572754, "vf_explained_var": 0.3274339735507965, "kl": 0.008694409916643053, "entropy": 52.9517058134079, "entropy_coeff": 0.001}}, "num_steps_sampled": 40000, "num_steps_trained": 40000}, "done": false, "episodes_total": 40, "training_iteration": 10, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-09_22-27-34", "timestamp": 1617978454, "time_this_iter_s": 1448.0922803878784, "time_total_s": 14483.361382246017, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 14483.361382246017, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 12.153637245392822, "ram_util_percent": 15.173326867119298}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2505.91782594138, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2677.9200907927807, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 556.2015427517418, "mean_raw_obs_processing_ms": 2.278227462357242, "mean_inference_ms": 113.4107384720392, "mean_action_processing_ms": 0.3561359317971173}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 44000, "timers": {"sample_time_ms": 1353006.818, "sample_throughput": 2.956, "learn_time_ms": 95935.452, "learn_throughput": 41.695, "update_time_ms": 28.625}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.02695229311939329, "policy_loss": -0.00199545337818563, "vf_loss": 2679.1416091918945, "vf_explained_var": 0.3631059229373932, "kl": 0.010192749468842521, "entropy": 52.76752734184265, "entropy_coeff": 0.001}}, "num_steps_sampled": 44000, "num_steps_trained": 44000}, "done": false, "episodes_total": 44, "training_iteration": 11, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-09_22-51-36", "timestamp": 1617979896, "time_this_iter_s": 1441.9543669223785, "time_total_s": 15925.315749168396, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 15925.315749168396, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 11.886842105263158, "ram_util_percent": 15.202241715399607}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2505.91782594138, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2680.0848767052335, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 556.287599252087, "mean_raw_obs_processing_ms": 2.27760225143192, "mean_inference_ms": 113.42786522139495, "mean_action_processing_ms": 0.3562426884061926}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 48000, "timers": {"sample_time_ms": 1353187.55, "sample_throughput": 2.956, "learn_time_ms": 95963.302, "learn_throughput": 41.683, "update_time_ms": 28.502}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.028735606523696333, "policy_loss": -0.002597121230792254, "vf_loss": 2595.3316535949707, "vf_explained_var": 0.4510164260864258, "kl": 0.009900667282636277, "entropy": 53.08186376094818, "entropy_coeff": 0.001}}, "num_steps_sampled": 48000, "num_steps_trained": 48000}, "done": false, "episodes_total": 48, "training_iteration": 12, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-09_23-15-50", "timestamp": 1617981350, "time_this_iter_s": 1453.2685225009918, "time_total_s": 17378.584271669388, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 17378.584271669388, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 11.878492025132914, "ram_util_percent": 15.200386660222325}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2505.91782594138, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2680.1781066910185, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 556.3632007793568, "mean_raw_obs_processing_ms": 2.2775284862701235, "mean_inference_ms": 113.44649460142783, "mean_action_processing_ms": 0.3567160463057082}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 52000, "timers": {"sample_time_ms": 1352837.74, "sample_throughput": 2.957, "learn_time_ms": 96041.74, "learn_throughput": 41.649, "update_time_ms": 29.868}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04332529313978739, "policy_loss": -0.01859273889567703, "vf_loss": 2697.2973251342773, "vf_explained_var": 0.45786648988723755, "kl": 0.0116806126316078, "entropy": 52.87358570098877, "entropy_coeff": 0.001}}, "num_steps_sampled": 52000, "num_steps_trained": 52000}, "done": false, "episodes_total": 52, "training_iteration": 13, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-09_23-40-00", "timestamp": 1617982800, "time_this_iter_s": 1450.6613438129425, "time_total_s": 18829.24561548233, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 18829.24561548233, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 11.884067796610168, "ram_util_percent": 15.206343825665856}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2505.91782594138, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2675.7277079466003, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 556.448189945148, "mean_raw_obs_processing_ms": 2.2773772411335735, "mean_inference_ms": 113.46143466957324, "mean_action_processing_ms": 0.35717906432114}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 56000, "timers": {"sample_time_ms": 1354511.411, "sample_throughput": 2.953, "learn_time_ms": 94768.691, "learn_throughput": 42.208, "update_time_ms": 31.516}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.034005143970716745, "policy_loss": -0.0037022611359134316, "vf_loss": 2165.398181915283, "vf_explained_var": 0.5049459934234619, "kl": 0.00814172174432315, "entropy": 52.77103412151337, "entropy_coeff": 0.001}}, "num_steps_sampled": 56000, "num_steps_trained": 56000}, "done": false, "episodes_total": 56, "training_iteration": 14, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_00-04-06", "timestamp": 1617984246, "time_this_iter_s": 1445.198825597763, "time_total_s": 20274.444441080093, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 20274.444441080093, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 11.879581915410794, "ram_util_percent": 15.207389402041803}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2505.91782594138, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2675.6728916743386, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 556.5127511237804, "mean_raw_obs_processing_ms": 2.2774035790594973, "mean_inference_ms": 113.48033955579152, "mean_action_processing_ms": 0.3575178733983209}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 60000, "timers": {"sample_time_ms": 1353423.003, "sample_throughput": 2.955, "learn_time_ms": 94860.915, "learn_throughput": 42.167, "update_time_ms": 32.015}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.02549281090614386, "policy_loss": 0.002179470844566822, "vf_loss": 2398.435661315918, "vf_explained_var": 0.5370880961418152, "kl": 0.010002780982176773, "entropy": 52.65691268444061, "entropy_coeff": 0.001}}, "num_steps_sampled": 60000, "num_steps_trained": 60000}, "done": false, "episodes_total": 60, "training_iteration": 15, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_00-28-10", "timestamp": 1617985690, "time_this_iter_s": 1444.7847044467926, "time_total_s": 21719.229145526886, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 21719.229145526886, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 11.903015564202336, "ram_util_percent": 15.200486381322952}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2505.91782594138, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2676.074510697522, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 556.5710300692622, "mean_raw_obs_processing_ms": 2.277352657914548, "mean_inference_ms": 113.49436250473221, "mean_action_processing_ms": 0.35787034854798616}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 64000, "timers": {"sample_time_ms": 1352872.765, "sample_throughput": 2.957, "learn_time_ms": 95108.643, "learn_throughput": 42.057, "update_time_ms": 29.755}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.03276484626985621, "policy_loss": -0.002966574946185574, "vf_loss": 2166.4683151245117, "vf_explained_var": 0.54583740234375, "kl": 0.012388243994791992, "entropy": 52.701775908470154, "entropy_coeff": 0.001}}, "num_steps_sampled": 64000, "num_steps_trained": 64000}, "done": false, "episodes_total": 64, "training_iteration": 16, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_00-52-21", "timestamp": 1617987141, "time_this_iter_s": 1450.575945854187, "time_total_s": 23169.805091381073, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 23169.805091381073, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 11.876803874092008, "ram_util_percent": 15.199999999999996}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2505.91782594138, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2678.2312182657715, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 556.6287571705543, "mean_raw_obs_processing_ms": 2.277380983628124, "mean_inference_ms": 113.51184695040696, "mean_action_processing_ms": 0.3582804503956239}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 68000, "timers": {"sample_time_ms": 1353940.723, "sample_throughput": 2.954, "learn_time_ms": 95899.469, "learn_throughput": 41.71, "update_time_ms": 33.165}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.029577148205135018, "policy_loss": -0.0023055144702084363, "vf_loss": 2410.709312438965, "vf_explained_var": 0.527969479560852, "kl": 0.009459195382078178, "entropy": 52.324642300605774, "entropy_coeff": 0.001}}, "num_steps_sampled": 68000, "num_steps_trained": 68000}, "done": false, "episodes_total": 68, "training_iteration": 17, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_01-16-40", "timestamp": 1617988600, "time_this_iter_s": 1459.4662549495697, "time_total_s": 24629.271346330643, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 24629.271346330643, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 11.887867116032739, "ram_util_percent": 15.21097737120847}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2505.91782594138, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2677.7855880490974, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 556.6806984835259, "mean_raw_obs_processing_ms": 2.2775257161988067, "mean_inference_ms": 113.52965140877694, "mean_action_processing_ms": 0.35822845275492515}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 72000, "timers": {"sample_time_ms": 1353326.512, "sample_throughput": 2.956, "learn_time_ms": 95988.629, "learn_throughput": 41.672, "update_time_ms": 33.865}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.030941437871661037, "policy_loss": -0.001966099487617612, "vf_loss": 2233.669651031494, "vf_explained_var": 0.5802603960037231, "kl": 0.01023645483655855, "entropy": 52.33567798137665, "entropy_coeff": 0.001}}, "num_steps_sampled": 72000, "num_steps_trained": 72000}, "done": false, "episodes_total": 72, "training_iteration": 18, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_01-40-51", "timestamp": 1617990051, "time_this_iter_s": 1450.5388405323029, "time_total_s": 26079.810186862946, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 26079.810186862946, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 11.878450363196126, "ram_util_percent": 15.202324455205808}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2505.91782594138, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2673.9166688142363, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 556.7317490492588, "mean_raw_obs_processing_ms": 2.2776872509192123, "mean_inference_ms": 113.54641643816812, "mean_action_processing_ms": 0.3580526415949931}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 76000, "timers": {"sample_time_ms": 1353972.515, "sample_throughput": 2.954, "learn_time_ms": 95915.185, "learn_throughput": 41.704, "update_time_ms": 31.751}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.03879887182847597, "policy_loss": -0.007196138758445159, "vf_loss": 1997.1361351013184, "vf_explained_var": 0.601780116558075, "kl": 0.01161435576796066, "entropy": 52.73552763462067, "entropy_coeff": 0.001}}, "num_steps_sampled": 76000, "num_steps_trained": 76000}, "done": false, "episodes_total": 76, "training_iteration": 19, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_02-05-06", "timestamp": 1617991506, "time_this_iter_s": 1454.7684462070465, "time_total_s": 27534.578633069992, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 27534.578633069992, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 11.900627716079189, "ram_util_percent": 15.201158860453884}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2505.91782594138, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2669.452434145547, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 556.7815504050335, "mean_raw_obs_processing_ms": 2.277861325596927, "mean_inference_ms": 113.56675279322349, "mean_action_processing_ms": 0.35806355512462223}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 80000, "timers": {"sample_time_ms": 1354931.579, "sample_throughput": 2.952, "learn_time_ms": 96073.517, "learn_throughput": 41.635, "update_time_ms": 30.377}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.03971844183979556, "policy_loss": -0.009586271946318448, "vf_loss": 2101.452278137207, "vf_explained_var": 0.6173529624938965, "kl": 0.01366891419456806, "entropy": 52.513580083847046, "entropy_coeff": 0.001}}, "num_steps_sampled": 80000, "num_steps_trained": 80000}, "done": false, "episodes_total": 80, "training_iteration": 20, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_02-29-25", "timestamp": 1617992965, "time_this_iter_s": 1459.2543697357178, "time_total_s": 28993.83300280571, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 28993.83300280571, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 11.875830524795377, "ram_util_percent": 15.207847857486756}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2505.91782594138, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2668.492288311313, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 556.8140725175768, "mean_raw_obs_processing_ms": 2.278154503035979, "mean_inference_ms": 113.58632318277614, "mean_action_processing_ms": 0.3583265053126062}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 84000, "timers": {"sample_time_ms": 1354897.079, "sample_throughput": 2.952, "learn_time_ms": 96273.621, "learn_throughput": 41.548, "update_time_ms": 29.455}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.043941963696852326, "policy_loss": -0.014889505051542073, "vf_loss": 2218.2567405700684, "vf_explained_var": 0.60866379737854, "kl": 0.01232047364464961, "entropy": 52.467071294784546, "entropy_coeff": 0.001}}, "num_steps_sampled": 84000, "num_steps_trained": 84000}, "done": false, "episodes_total": 84, "training_iteration": 21, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_02-53-29", "timestamp": 1617994409, "time_this_iter_s": 1443.601381778717, "time_total_s": 30437.434384584427, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 30437.434384584427, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 11.897372262773722, "ram_util_percent": 15.203892944038927}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2505.91782594138, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2665.744291808552, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 556.8430734752974, "mean_raw_obs_processing_ms": 2.278222446787073, "mean_inference_ms": 113.605114029173, "mean_action_processing_ms": 0.35856152443775824}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 88000, "timers": {"sample_time_ms": 1354364.346, "sample_throughput": 2.953, "learn_time_ms": 96284.018, "learn_throughput": 41.544, "update_time_ms": 31.47}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.036678587523056194, "policy_loss": -0.0035416459140833467, "vf_loss": 1808.1875667572021, "vf_explained_var": 0.6510345339775085, "kl": 0.011523465858772397, "entropy": 52.37116193771362, "entropy_coeff": 0.001}}, "num_steps_sampled": 88000, "num_steps_trained": 88000}, "done": false, "episodes_total": 88, "training_iteration": 22, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_03-17-37", "timestamp": 1617995857, "time_this_iter_s": 1448.0659804344177, "time_total_s": 31885.500365018845, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 31885.500365018845, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 11.860378273520853, "ram_util_percent": 15.2011639185257}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2505.91782594138, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2665.1404629874596, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 556.8676107679992, "mean_raw_obs_processing_ms": 2.2784658435315928, "mean_inference_ms": 113.62089837819914, "mean_action_processing_ms": 0.3589002491254361}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 92000, "timers": {"sample_time_ms": 1354435.811, "sample_throughput": 2.953, "learn_time_ms": 96360.464, "learn_throughput": 41.511, "update_time_ms": 29.105}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.033580247312784195, "policy_loss": 0.0006241075461730361, "vf_loss": 1732.8902206420898, "vf_explained_var": 0.682754635810852, "kl": 0.008550537546398118, "entropy": 52.388309478759766, "entropy_coeff": 0.001}}, "num_steps_sampled": 92000, "num_steps_trained": 92000}, "done": false, "episodes_total": 92, "training_iteration": 23, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_03-41-49", "timestamp": 1617997309, "time_this_iter_s": 1452.1169197559357, "time_total_s": 33337.61728477478, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 33337.61728477478, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 11.892694726656991, "ram_util_percent": 15.206289308176098}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2505.91782594138, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2662.047094121839, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 556.8873881257833, "mean_raw_obs_processing_ms": 2.278806422168619, "mean_inference_ms": 113.63416264046685, "mean_action_processing_ms": 0.3590350804335771}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 96000, "timers": {"sample_time_ms": 1353423.062, "sample_throughput": 2.955, "learn_time_ms": 96261.842, "learn_throughput": 41.553, "update_time_ms": 27.25}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04888966237194836, "policy_loss": -0.012897402280941606, "vf_loss": 1518.6752853393555, "vf_explained_var": 0.6882086992263794, "kl": 0.010015730687882751, "entropy": 52.180582761764526, "entropy_coeff": 0.001}}, "num_steps_sampled": 96000, "num_steps_trained": 96000}, "done": false, "episodes_total": 96, "training_iteration": 24, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_04-05-43", "timestamp": 1617998743, "time_this_iter_s": 1434.0665981769562, "time_total_s": 34771.68388295174, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 34771.68388295174, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 11.895198432141106, "ram_util_percent": 15.211758941695244}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2505.91782594138, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2658.270101714486, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2614.6069959981673, -2692.0024409495463, -2807.695360917763, -2708.0739869830018, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 556.9107807318188, "mean_raw_obs_processing_ms": 2.2790769930257277, "mean_inference_ms": 113.64703010854686, "mean_action_processing_ms": 0.35923747094707337}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 100000, "timers": {"sample_time_ms": 1354630.611, "sample_throughput": 2.953, "learn_time_ms": 96239.693, "learn_throughput": 41.563, "update_time_ms": 26.411}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.043303050042595714, "policy_loss": -0.0072371382848359644, "vf_loss": 1553.1234645843506, "vf_explained_var": 0.6876608729362488, "kl": 0.007592458641738631, "entropy": 52.35638928413391, "entropy_coeff": 0.001}}, "num_steps_sampled": 100000, "num_steps_trained": 100000}, "done": false, "episodes_total": 100, "training_iteration": 25, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_04-30-00", "timestamp": 1618000200, "time_this_iter_s": 1456.6303532123566, "time_total_s": 36228.31423616409, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 36228.31423616409, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 11.883365477338476, "ram_util_percent": 15.209498553519765}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2505.91782594138, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2652.3765719634243, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2754.1605512095966, -2684.946670753624, -2601.8795449892636, -2721.881143125064, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 557.1021872427197, "mean_raw_obs_processing_ms": 2.2780404171216717, "mean_inference_ms": 113.7540085715181, "mean_action_processing_ms": 0.3589038262324356}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 104000, "timers": {"sample_time_ms": 1355183.254, "sample_throughput": 2.952, "learn_time_ms": 95999.964, "learn_throughput": 41.667, "update_time_ms": 25.612}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04878810598165728, "policy_loss": -0.012796696508303285, "vf_loss": 1569.6007766723633, "vf_explained_var": 0.6974236965179443, "kl": 0.008736189614864998, "entropy": 52.561036229133606, "entropy_coeff": 0.001}}, "num_steps_sampled": 104000, "num_steps_trained": 104000}, "done": false, "episodes_total": 104, "training_iteration": 26, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_04-54-14", "timestamp": 1618001654, "time_this_iter_s": 1453.6969802379608, "time_total_s": 37682.011216402054, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 37682.011216402054, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 11.86063829787234, "ram_util_percent": 15.204013539651834}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2464.3850902465424, "episode_reward_min": -2874.330254141122, "episode_reward_mean": -2645.7281724905747, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2677.435436059027, -2636.393348730926, -2743.258812405273, -2874.330254141122, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 557.1744327713511, "mean_raw_obs_processing_ms": 2.277406969619745, "mean_inference_ms": 113.80108070416182, "mean_action_processing_ms": 0.35922551830889105}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 108000, "timers": {"sample_time_ms": 1355005.53, "sample_throughput": 2.952, "learn_time_ms": 96023.397, "learn_throughput": 41.657, "update_time_ms": 24.287}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04113779330509715, "policy_loss": -0.005338060320354998, "vf_loss": 1602.9316730499268, "vf_explained_var": 0.6476467847824097, "kl": 0.007252416107803583, "entropy": 52.55429208278656, "entropy_coeff": 0.001}}, "num_steps_sampled": 108000, "num_steps_trained": 108000}, "done": false, "episodes_total": 108, "training_iteration": 27, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_05-18-32", "timestamp": 1618003112, "time_this_iter_s": 1457.92533493042, "time_total_s": 39139.936551332474, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 39139.936551332474, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 11.882803468208094, "ram_util_percent": 15.20780346820809}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2464.3850902465424, "episode_reward_min": -2816.912002008912, "episode_reward_mean": -2639.315217572774, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2659.7244465443205, -2703.3994905767695, -2744.4992929137957, -2725.250586636776, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 557.2177272917261, "mean_raw_obs_processing_ms": 2.277381842474721, "mean_inference_ms": 113.80407781462716, "mean_action_processing_ms": 0.35921287718578143}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 112000, "timers": {"sample_time_ms": 1354268.268, "sample_throughput": 2.954, "learn_time_ms": 96062.968, "learn_throughput": 41.639, "update_time_ms": 22.843}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04814281896688044, "policy_loss": -0.009193842503009364, "vf_loss": 1302.58109664917, "vf_explained_var": 0.7264108657836914, "kl": 0.008225458732340485, "entropy": 52.79732882976532, "entropy_coeff": 0.001}}, "num_steps_sampled": 112000, "num_steps_trained": 112000}, "done": false, "episodes_total": 112, "training_iteration": 28, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_05-42-35", "timestamp": 1618004555, "time_this_iter_s": 1443.5334746837616, "time_total_s": 40583.470026016235, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 40583.470026016235, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 11.873479318734793, "ram_util_percent": 15.206423357664228}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2464.3850902465424, "episode_reward_min": -2816.912002008912, "episode_reward_mean": -2631.6514355969766, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2766.079785209966, -2725.967709857252, -2664.2931720371807, -2619.069586062293, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 557.312156542299, "mean_raw_obs_processing_ms": 2.278221202381119, "mean_inference_ms": 113.81474735921678, "mean_action_processing_ms": 0.3597208702578898}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 116000, "timers": {"sample_time_ms": 1353911.39, "sample_throughput": 2.954, "learn_time_ms": 96050.109, "learn_throughput": 41.645, "update_time_ms": 21.32}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04597932891920209, "policy_loss": -0.009578970464644954, "vf_loss": 1539.7924041748047, "vf_explained_var": 0.6855063438415527, "kl": 0.008909863288863562, "entropy": 52.68926405906677, "entropy_coeff": 0.001}}, "num_steps_sampled": 116000, "num_steps_trained": 116000}, "done": false, "episodes_total": 116, "training_iteration": 29, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_06-06-46", "timestamp": 1618006006, "time_this_iter_s": 1451.040640592575, "time_total_s": 42034.51066660881, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 42034.51066660881, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 11.89156976744186, "ram_util_percent": 15.201211240310073}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2464.3850902465424, "episode_reward_min": -2816.912002008912, "episode_reward_mean": -2627.9215490494717, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2712.3289244097305, -2627.7417132832716, -2680.169503682529, -2602.1661405298128, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 557.3825205027119, "mean_raw_obs_processing_ms": 2.27970063168447, "mean_inference_ms": 113.82564380070723, "mean_action_processing_ms": 0.36027858319803735}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 120000, "timers": {"sample_time_ms": 1353625.036, "sample_throughput": 2.955, "learn_time_ms": 96092.543, "learn_throughput": 41.627, "update_time_ms": 22.413}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.045830185641534626, "policy_loss": -0.007887182815466076, "vf_loss": 1345.23588180542, "vf_explained_var": 0.7373912334442139, "kl": 0.011778534215409309, "entropy": 52.573212027549744, "entropy_coeff": 0.001}}, "num_steps_sampled": 120000, "num_steps_trained": 120000}, "done": false, "episodes_total": 120, "training_iteration": 30, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_06-31-03", "timestamp": 1618007463, "time_this_iter_s": 1456.8243551254272, "time_total_s": 43491.33502173424, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 43491.33502173424, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 11.885294117647058, "ram_util_percent": 15.219382835101252}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2464.3850902465424, "episode_reward_min": -2816.912002008912, "episode_reward_mean": -2627.5982022359785, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2614.2652116608238, -2682.7954277994068, -2777.3305769554563, -2600.38516898225, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 557.4509985522226, "mean_raw_obs_processing_ms": 2.2811113742560436, "mean_inference_ms": 113.83030150197038, "mean_action_processing_ms": 0.36040362091516975}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 124000, "timers": {"sample_time_ms": 1356475.201, "sample_throughput": 2.949, "learn_time_ms": 94706.667, "learn_throughput": 42.236, "update_time_ms": 20.931}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04362229129765183, "policy_loss": -0.003091509861405939, "vf_loss": 1132.3409957885742, "vf_explained_var": 0.7665372490882874, "kl": 0.009544543558149599, "entropy": 52.80864238739014, "entropy_coeff": 0.001}}, "num_steps_sampled": 124000, "num_steps_trained": 124000}, "done": false, "episodes_total": 124, "training_iteration": 31, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_06-55-21", "timestamp": 1618008921, "time_this_iter_s": 1458.229441165924, "time_total_s": 44949.56446290016, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 44949.56446290016, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 12.041666666666666, "ram_util_percent": 15.21994219653179}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2464.3850902465424, "episode_reward_min": -2816.912002008912, "episode_reward_mean": -2624.592142730115, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2693.5123443951875, -2679.5994798348997, -2620.6346288230516, -2694.783586978287, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 557.5144657248624, "mean_raw_obs_processing_ms": 2.282213482691873, "mean_inference_ms": 113.83946018907731, "mean_action_processing_ms": 0.36099397480897116}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 128000, "timers": {"sample_time_ms": 1357480.323, "sample_throughput": 2.947, "learn_time_ms": 94782.58, "learn_throughput": 42.202, "update_time_ms": 19.798}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.048623734270222485, "policy_loss": -0.008071739168372005, "vf_loss": 1114.884630203247, "vf_explained_var": 0.7828025221824646, "kl": 0.013709125254536048, "entropy": 53.07174825668335, "entropy_coeff": 0.001}}, "num_steps_sampled": 128000, "num_steps_trained": 128000}, "done": false, "episodes_total": 128, "training_iteration": 32, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_07-19-40", "timestamp": 1618010380, "time_this_iter_s": 1458.864345550537, "time_total_s": 46408.4288084507, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 46408.4288084507, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 11.613631984585743, "ram_util_percent": 15.203275529865122}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2464.3850902465424, "episode_reward_min": -2816.912002008912, "episode_reward_mean": -2619.7324104193613, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2600.5125596262483, -2709.1973252442403, -2664.9905347144754, -2679.1531392461043, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 557.5598753058272, "mean_raw_obs_processing_ms": 2.283002457804684, "mean_inference_ms": 113.84898478487469, "mean_action_processing_ms": 0.3611286000405556}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 132000, "timers": {"sample_time_ms": 1357597.016, "sample_throughput": 2.946, "learn_time_ms": 96986.661, "learn_throughput": 41.243, "update_time_ms": 20.569}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04149986774427816, "policy_loss": -0.007456506136804819, "vf_loss": 1704.6875133514404, "vf_explained_var": 0.6665226221084595, "kl": 0.014359575376147404, "entropy": 52.526188015937805, "entropy_coeff": 0.001}}, "num_steps_sampled": 132000, "num_steps_trained": 132000}, "done": false, "episodes_total": 132, "training_iteration": 33, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_07-44-16", "timestamp": 1618011856, "time_this_iter_s": 1475.3324420452118, "time_total_s": 47883.76125049591, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 47883.76125049591, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 13.175476190476191, "ram_util_percent": 15.449238095238094}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2464.3850902465424, "episode_reward_min": -2816.912002008912, "episode_reward_mean": -2613.9574029920627, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2754.757453541808, -2619.577450345285, -2578.071375081434, -2729.043041095309, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 557.6148413659657, "mean_raw_obs_processing_ms": 2.283837384937556, "mean_inference_ms": 113.86569507695738, "mean_action_processing_ms": 0.361541861221704}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 136000, "timers": {"sample_time_ms": 1362131.637, "sample_throughput": 2.937, "learn_time_ms": 100227.815, "learn_throughput": 39.909, "update_time_ms": 21.894}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.048923464375548065, "policy_loss": -0.011892316135345027, "vf_loss": 1485.226526260376, "vf_explained_var": 0.7348018884658813, "kl": 0.00878416457271669, "entropy": 52.76182758808136, "entropy_coeff": 0.001}}, "num_steps_sampled": 136000, "num_steps_trained": 136000}, "done": false, "episodes_total": 136, "training_iteration": 34, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_08-09-27", "timestamp": 1618013367, "time_this_iter_s": 1511.836168050766, "time_total_s": 49395.59741854668, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 49395.59741854668, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 21.852973977695168, "ram_util_percent": 18.11835501858736}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2464.3850902465424, "episode_reward_min": -2816.912002008912, "episode_reward_mean": -2608.7499255779053, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2505.91782594138, -2632.9016475139383, -2673.3238982065736, -2570.3764208901107, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 557.6796589149902, "mean_raw_obs_processing_ms": 2.284895002182222, "mean_inference_ms": 113.89048956053557, "mean_action_processing_ms": 0.3616139946121774}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 140000, "timers": {"sample_time_ms": 1365256.636, "sample_throughput": 2.93, "learn_time_ms": 102708.124, "learn_throughput": 38.945, "update_time_ms": 23.211}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.038138150091981515, "policy_loss": -0.0008845244301483035, "vf_loss": 1440.6611404418945, "vf_explained_var": 0.7130254507064819, "kl": 0.011927382845897228, "entropy": 52.852972865104675, "entropy_coeff": 0.001}}, "num_steps_sampled": 140000, "num_steps_trained": 140000}, "done": false, "episodes_total": 140, "training_iteration": 35, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_08-34-40", "timestamp": 1618014880, "time_this_iter_s": 1512.6965374946594, "time_total_s": 50908.293956041336, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 50908.293956041336, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 21.838504412447747, "ram_util_percent": 18.059916395726894}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2462.783791009869, "episode_reward_min": -2816.912002008912, "episode_reward_mean": -2605.029769006738, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2719.5377495952507, -2753.378035832629, -2709.098053282286, -2633.576248258686, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 557.7781898312164, "mean_raw_obs_processing_ms": 2.2858172090272024, "mean_inference_ms": 113.92043833547922, "mean_action_processing_ms": 0.36179043487853796}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 144000, "timers": {"sample_time_ms": 1369104.006, "sample_throughput": 2.922, "learn_time_ms": 104321.865, "learn_throughput": 38.343, "update_time_ms": 22.514}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05298691149801016, "policy_loss": -0.014334966253954917, "vf_loss": 1312.0251846313477, "vf_explained_var": 0.7178099155426025, "kl": 0.010389475181000307, "entropy": 52.8111412525177, "entropy_coeff": 0.001}}, "num_steps_sampled": 144000, "num_steps_trained": 144000}, "done": false, "episodes_total": 144, "training_iteration": 36, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_08-59-49", "timestamp": 1618016389, "time_this_iter_s": 1508.3015670776367, "time_total_s": 52416.59552311897, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 52416.59552311897, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 21.775314392175126, "ram_util_percent": 18.068607359105727}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2462.783791009869, "episode_reward_min": -2816.912002008912, "episode_reward_mean": -2598.8883412342784, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2816.912002008912, -2599.295013951124, -2652.9001122456802, -2656.0803378760593, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 557.8795180170204, "mean_raw_obs_processing_ms": 2.28674812149402, "mean_inference_ms": 113.9489965292978, "mean_action_processing_ms": 0.36187697269826524}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 148000, "timers": {"sample_time_ms": 1371004.417, "sample_throughput": 2.918, "learn_time_ms": 104464.095, "learn_throughput": 38.291, "update_time_ms": 21.287}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.043969293124973774, "policy_loss": -0.006016539759002626, "vf_loss": 1344.3229217529297, "vf_explained_var": 0.748270571231842, "kl": 0.012179809506051242, "entropy": 52.61396074295044, "entropy_coeff": 0.001}}, "num_steps_sampled": 148000, "num_steps_trained": 148000}, "done": false, "episodes_total": 148, "training_iteration": 37, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_09-24-27", "timestamp": 1618017867, "time_this_iter_s": 1478.324292421341, "time_total_s": 53894.919815540314, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 53894.919815540314, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 15.064591254752852, "ram_util_percent": 16.161026615969583}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2462.783791009869, "episode_reward_min": -2792.5686596704595, "episode_reward_mean": -2594.8176023594688, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2580.053173291325, -2730.8055656817905, -2617.511415351746, -2543.119942751797, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 557.9735373735888, "mean_raw_obs_processing_ms": 2.2874164854442767, "mean_inference_ms": 113.97439669481159, "mean_action_processing_ms": 0.3617725742586994}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 152000, "timers": {"sample_time_ms": 1370915.94, "sample_throughput": 2.918, "learn_time_ms": 104629.534, "learn_throughput": 38.23, "update_time_ms": 24.393}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04664922654046677, "policy_loss": -0.005744888330809772, "vf_loss": 1044.8743467330933, "vf_explained_var": 0.802911639213562, "kl": 0.01083320114412345, "entropy": 52.43639922142029, "entropy_coeff": 0.001}}, "num_steps_sampled": 152000, "num_steps_trained": 152000}, "done": false, "episodes_total": 152, "training_iteration": 38, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_09-48-31", "timestamp": 1618019311, "time_this_iter_s": 1444.3505351543427, "time_total_s": 55339.27035069466, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 55339.27035069466, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 12.514014598540145, "ram_util_percent": 15.37532846715329}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2462.783791009869, "episode_reward_min": -2792.5686596704595, "episode_reward_mean": -2593.780121049471, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2656.076865506737, -2675.691659923925, -2650.898871296136, -2716.9544587238806, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 558.0593827635358, "mean_raw_obs_processing_ms": 2.2881014072265695, "mean_inference_ms": 114.0004680556288, "mean_action_processing_ms": 0.36167335656135774}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 156000, "timers": {"sample_time_ms": 1371429.619, "sample_throughput": 2.917, "learn_time_ms": 104739.73, "learn_throughput": 38.19, "update_time_ms": 24.317}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.048375513491919264, "policy_loss": -0.008541544782929122, "vf_loss": 1144.9007396697998, "vf_explained_var": 0.7916677594184875, "kl": 0.009492017241427675, "entropy": 52.23217272758484, "entropy_coeff": 0.001}}, "num_steps_sampled": 156000, "num_steps_trained": 156000}, "done": false, "episodes_total": 156, "training_iteration": 39, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_10-12-49", "timestamp": 1618020769, "time_this_iter_s": 1457.2784383296967, "time_total_s": 56796.54878902435, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 56796.54878902435, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 12.535180722891566, "ram_util_percent": 15.36718072289157}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2456.846135561539, "episode_reward_min": -2792.5686596704595, "episode_reward_mean": -2586.8323800647545, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2676.3051496158237, -2634.3343012580326, -2759.5535755780184, -2658.202157729192, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 558.1497896124831, "mean_raw_obs_processing_ms": 2.288737094553065, "mean_inference_ms": 114.02486983574039, "mean_action_processing_ms": 0.3616468965889602}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 160000, "timers": {"sample_time_ms": 1371539.095, "sample_throughput": 2.916, "learn_time_ms": 104797.651, "learn_throughput": 38.169, "update_time_ms": 20.72}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.0444409676711075, "policy_loss": -0.005275492847431451, "vf_loss": 1212.5529861450195, "vf_explained_var": 0.7790847420692444, "kl": 0.01280395541107282, "entropy": 52.57139527797699, "entropy_coeff": 0.001}}, "num_steps_sampled": 160000, "num_steps_trained": 160000}, "done": false, "episodes_total": 160, "training_iteration": 40, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_10-37-07", "timestamp": 1618022227, "time_this_iter_s": 1458.4624450206757, "time_total_s": 58255.01123404503, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 58255.01123404503, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 12.525337186897882, "ram_util_percent": 15.365510597302508}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2456.846135561539, "episode_reward_min": -2792.5686596704595, "episode_reward_mean": -2581.3708555471253, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2707.605671685245, -2760.1784527723366, -2634.2184594746777, -2748.9515734988095, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 558.2404506257501, "mean_raw_obs_processing_ms": 2.2894468542214015, "mean_inference_ms": 114.05004023222125, "mean_action_processing_ms": 0.3616103489589386}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 164000, "timers": {"sample_time_ms": 1370360.356, "sample_throughput": 2.919, "learn_time_ms": 104935.492, "learn_throughput": 38.119, "update_time_ms": 21.748}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.042094017306226306, "policy_loss": -0.0034898356825578958, "vf_loss": 1321.6114349365234, "vf_explained_var": 0.7605166435241699, "kl": 0.009656251917476766, "entropy": 52.7859183549881, "entropy_coeff": 0.001}}, "num_steps_sampled": 164000, "num_steps_trained": 164000}, "done": false, "episodes_total": 164, "training_iteration": 41, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_11-01-15", "timestamp": 1618023675, "time_this_iter_s": 1447.830668926239, "time_total_s": 59702.84190297127, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 59702.84190297127, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 12.550315380883069, "ram_util_percent": 15.377195536147505}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2456.846135561539, "episode_reward_min": -2792.5686596704595, "episode_reward_mean": -2574.6515097631077, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2592.3141157308214, -2792.5686596704595, -2613.111147897101, -2682.845574164189, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 558.3271983607033, "mean_raw_obs_processing_ms": 2.290025887119717, "mean_inference_ms": 114.07130924018377, "mean_action_processing_ms": 0.36148806180541826}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 168000, "timers": {"sample_time_ms": 1369984.015, "sample_throughput": 2.92, "learn_time_ms": 104966.942, "learn_throughput": 38.107, "update_time_ms": 22.954}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.045844169275369495, "policy_loss": -0.00719073714572005, "vf_loss": 1324.2390403747559, "vf_explained_var": 0.7428600788116455, "kl": 0.012966425449121743, "entropy": 53.19246172904968, "entropy_coeff": 0.001}}, "num_steps_sampled": 168000, "num_steps_trained": 168000}, "done": false, "episodes_total": 168, "training_iteration": 42, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_11-25-30", "timestamp": 1618025130, "time_this_iter_s": 1455.4276127815247, "time_total_s": 61158.26951575279, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 61158.26951575279, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 12.55984555984556, "ram_util_percent": 15.367326254826258}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2443.804179345879, "episode_reward_min": -2725.3842604257056, "episode_reward_mean": -2569.129741655396, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2589.549921995221, -2608.6343746459497, -2617.7862391023373, -2601.133954603435, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 558.412272718462, "mean_raw_obs_processing_ms": 2.290624954726234, "mean_inference_ms": 114.0903733168569, "mean_action_processing_ms": 0.3616721162811156}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 172000, "timers": {"sample_time_ms": 1369816.677, "sample_throughput": 2.92, "learn_time_ms": 102986.737, "learn_throughput": 38.84, "update_time_ms": 22.194}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.06363110919483006, "policy_loss": -0.021038612292613834, "vf_loss": 906.044261932373, "vf_explained_var": 0.8200404644012451, "kl": 0.01199562958208844, "entropy": 52.85249876976013, "entropy_coeff": 0.001}}, "num_steps_sampled": 172000, "num_steps_trained": 172000}, "done": false, "episodes_total": 172, "training_iteration": 43, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_11-49-44", "timestamp": 1618026584, "time_this_iter_s": 1453.8496010303497, "time_total_s": 62612.11911678314, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 62612.11911678314, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 12.634992750120832, "ram_util_percent": 15.370710488158535}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2443.804179345879, "episode_reward_min": -2725.3842604257056, "episode_reward_mean": -2566.1643603666994, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2564.906856781015, -2550.44011283881, -2647.26897839473, -2575.9119537472584, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 558.4922156289505, "mean_raw_obs_processing_ms": 2.291285938015104, "mean_inference_ms": 114.11097159795298, "mean_action_processing_ms": 0.36197085489495706}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 176000, "timers": {"sample_time_ms": 1366357.55, "sample_throughput": 2.927, "learn_time_ms": 100693.753, "learn_throughput": 39.724, "update_time_ms": 21.537}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05750139561132528, "policy_loss": -0.017638160032220185, "vf_loss": 1182.0354690551758, "vf_explained_var": 0.7798888683319092, "kl": 0.009182091569527984, "entropy": 52.601794719696045, "entropy_coeff": 0.001}}, "num_steps_sampled": 176000, "num_steps_trained": 176000}, "done": false, "episodes_total": 176, "training_iteration": 44, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_12-13-59", "timestamp": 1618028039, "time_this_iter_s": 1454.3049747943878, "time_total_s": 64066.42409157753, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 64066.42409157753, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 12.63497584541063, "ram_util_percent": 15.364009661835752}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2443.804179345879, "episode_reward_min": -2725.3842604257056, "episode_reward_mean": -2564.216902067882, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2640.1702998423234, -2693.5389413137095, -2587.457221155578, -2675.991024194888, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 558.5662722338291, "mean_raw_obs_processing_ms": 2.2919243359289423, "mean_inference_ms": 114.12739996741071, "mean_action_processing_ms": 0.3621055092978873}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 180000, "timers": {"sample_time_ms": 1362310.322, "sample_throughput": 2.936, "learn_time_ms": 98348.716, "learn_throughput": 40.672, "update_time_ms": 20.693}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05439430457772687, "policy_loss": -0.01157953724032268, "vf_loss": 867.2305269241333, "vf_explained_var": 0.8313183784484863, "kl": 0.013610692491056398, "entropy": 52.848137974739075, "entropy_coeff": 0.001}}, "num_steps_sampled": 180000, "num_steps_trained": 180000}, "done": false, "episodes_total": 180, "training_iteration": 45, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_12-38-07", "timestamp": 1618029487, "time_this_iter_s": 1448.7655148506165, "time_total_s": 65515.18960642815, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 65515.18960642815, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 12.80998545807077, "ram_util_percent": 15.385845855550173}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2412.289621052074, "episode_reward_min": -2725.3842604257056, "episode_reward_mean": -2557.6618281703727, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2689.265106396148, -2609.1367401972457, -2538.9934003283097, -2594.7502140806064, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 558.6511260780949, "mean_raw_obs_processing_ms": 2.2925005360037427, "mean_inference_ms": 114.14233083707941, "mean_action_processing_ms": 0.3620513917450097}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 184000, "timers": {"sample_time_ms": 1358684.33, "sample_throughput": 2.944, "learn_time_ms": 96766.448, "learn_throughput": 41.337, "update_time_ms": 23.791}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.06437417928827927, "policy_loss": -0.02323196968063712, "vf_loss": 1046.0667991638184, "vf_explained_var": 0.7859196662902832, "kl": 0.0127700547745917, "entropy": 52.879881620407104, "entropy_coeff": 0.001}}, "num_steps_sampled": 184000, "num_steps_trained": 184000}, "done": false, "episodes_total": 184, "training_iteration": 46, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_13-02-24", "timestamp": 1618030944, "time_this_iter_s": 1456.2495698928833, "time_total_s": 66971.43917632103, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 66971.43917632103, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 12.956584659913169, "ram_util_percent": 15.395224312590452}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2401.482017540627, "episode_reward_min": -2725.3842604257056, "episode_reward_mean": -2551.4629890173524, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2609.3717246546416, -2665.4900510821612, -2607.178879531197, -2725.3842604257056, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 558.7532381997439, "mean_raw_obs_processing_ms": 2.293325164171675, "mean_inference_ms": 114.16002968280827, "mean_action_processing_ms": 0.3619317248945619}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 188000, "timers": {"sample_time_ms": 1361065.852, "sample_throughput": 2.939, "learn_time_ms": 98780.52, "learn_throughput": 40.494, "update_time_ms": 26.58}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05187674897024408, "policy_loss": -0.011937815754208714, "vf_loss": 1186.3239879608154, "vf_explained_var": 0.766923725605011, "kl": 0.010925982991466299, "entropy": 52.89476656913757, "entropy_coeff": 0.001}}, "num_steps_sampled": 188000, "num_steps_trained": 188000}, "done": false, "episodes_total": 188, "training_iteration": 47, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_13-27-46", "timestamp": 1618032466, "time_this_iter_s": 1522.3083081245422, "time_total_s": 68493.74748444557, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 68493.74748444557, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 20.733917858790957, "ram_util_percent": 17.993447161975084}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2401.482017540627, "episode_reward_min": -2721.1943308108725, "episode_reward_mean": -2546.267561963858, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2544.418904048552, -2583.3611094332846, -2548.161287860942, -2687.6571395074993, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 558.8683354467609, "mean_raw_obs_processing_ms": 2.293900068028839, "mean_inference_ms": 114.17983325270116, "mean_action_processing_ms": 0.3617006121029515}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 192000, "timers": {"sample_time_ms": 1365208.115, "sample_throughput": 2.93, "learn_time_ms": 100481.5, "learn_throughput": 39.808, "update_time_ms": 23.956}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04884953808505088, "policy_loss": -0.008042941568419337, "vf_loss": 1096.6023807525635, "vf_explained_var": 0.7856791019439697, "kl": 0.012291224877117202, "entropy": 53.00173795223236, "entropy_coeff": 0.001}}, "num_steps_sampled": 192000, "num_steps_trained": 192000}, "done": false, "episodes_total": 192, "training_iteration": 48, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_13-52-49", "timestamp": 1618033969, "time_this_iter_s": 1502.7404129505157, "time_total_s": 69996.48789739609, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 69996.48789739609, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 21.690790088826553, "ram_util_percent": 18.290229079008885}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2401.482017540627, "episode_reward_min": -2721.1943308108725, "episode_reward_mean": -2543.7208617132073, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2590.077664584129, -2566.623149003538, -2530.1035051589597, -2583.684817005386, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 559.0049328390722, "mean_raw_obs_processing_ms": 2.294428822348709, "mean_inference_ms": 114.20233522524893, "mean_action_processing_ms": 0.3616877347389703}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 196000, "timers": {"sample_time_ms": 1370296.082, "sample_throughput": 2.919, "learn_time_ms": 102614.322, "learn_throughput": 38.981, "update_time_ms": 25.593}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04532667330931872, "policy_loss": -0.006050640397006646, "vf_loss": 1264.8090744018555, "vf_explained_var": 0.7674132585525513, "kl": 0.012768246611813083, "entropy": 53.20094454288483, "entropy_coeff": 0.001}}, "num_steps_sampled": 196000, "num_steps_trained": 196000}, "done": false, "episodes_total": 196, "training_iteration": 49, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_14-18-18", "timestamp": 1618035498, "time_this_iter_s": 1529.5028579235077, "time_total_s": 71525.9907553196, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 71525.9907553196, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 21.734772622875518, "ram_util_percent": 18.27216352779054}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2401.482017540627, "episode_reward_min": -2721.1943308108725, "episode_reward_mean": -2540.8414727931986, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2542.2595027903017, -2566.608307807912, -2545.346528452848, -2578.811470691253, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 559.1496514455488, "mean_raw_obs_processing_ms": 2.295075238402164, "mean_inference_ms": 114.22650721505778, "mean_action_processing_ms": 0.36164587759304095}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 200000, "timers": {"sample_time_ms": 1374452.158, "sample_throughput": 2.91, "learn_time_ms": 104774.529, "learn_throughput": 38.177, "update_time_ms": 25.061}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04861136700492352, "policy_loss": -0.007023886137176305, "vf_loss": 1038.8148374557495, "vf_explained_var": 0.8151007294654846, "kl": 0.011269400012679398, "entropy": 53.102569341659546, "entropy_coeff": 0.001}}, "num_steps_sampled": 200000, "num_steps_trained": 200000}, "done": false, "episodes_total": 200, "training_iteration": 50, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_14-43-40", "timestamp": 1618037020, "time_this_iter_s": 1521.6385824680328, "time_total_s": 73047.62933778763, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 73047.62933778763, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 21.545198522622346, "ram_util_percent": 18.33093259464451}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2394.9754767673257, "episode_reward_min": -2721.1943308108725, "episode_reward_mean": -2537.8105924080787, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2504.232286683964, -2571.773852048895, -2557.636733813189, -2464.3850902465424, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 559.2921231945736, "mean_raw_obs_processing_ms": 2.2957502022232212, "mean_inference_ms": 114.25089467313464, "mean_action_processing_ms": 0.3616623010264415}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 204000, "timers": {"sample_time_ms": 1374530.832, "sample_throughput": 2.91, "learn_time_ms": 104754.896, "learn_throughput": 38.184, "update_time_ms": 24.8}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04727158724563196, "policy_loss": -0.008251090999692678, "vf_loss": 1324.9070205688477, "vf_explained_var": 0.7404521703720093, "kl": 0.011803333763964474, "entropy": 53.449896812438965, "entropy_coeff": 0.001}}, "num_steps_sampled": 204000, "num_steps_trained": 204000}, "done": false, "episodes_total": 204, "training_iteration": 51, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_15-07-49", "timestamp": 1618038469, "time_this_iter_s": 1448.418653011322, "time_total_s": 74496.04799079895, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 74496.04799079895, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 13.287002909796316, "ram_util_percent": 15.951406401551889}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2336.4098412973594, "episode_reward_min": -2721.1943308108725, "episode_reward_mean": -2533.456198681354, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2584.7171858041065, -2632.327404872144, -2525.5578429453767, -2547.519925934687, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 559.4257551645516, "mean_raw_obs_processing_ms": 2.2963326470620875, "mean_inference_ms": 114.27551427869804, "mean_action_processing_ms": 0.36173899433445456}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 208000, "timers": {"sample_time_ms": 1374838.324, "sample_throughput": 2.909, "learn_time_ms": 104831.279, "learn_throughput": 38.157, "update_time_ms": 24.618}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04765003308421001, "policy_loss": -0.003627945319749415, "vf_loss": 812.5352907180786, "vf_explained_var": 0.8284634351730347, "kl": 0.011392093903850764, "entropy": 53.28664422035217, "entropy_coeff": 0.001}}, "num_steps_sampled": 208000, "num_steps_trained": 208000}, "done": false, "episodes_total": 208, "training_iteration": 52, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_15-32-08", "timestamp": 1618039928, "time_this_iter_s": 1459.2646930217743, "time_total_s": 75955.31268382072, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 75955.31268382072, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 11.877997111218102, "ram_util_percent": 15.53991333654309}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2336.4098412973594, "episode_reward_min": -2721.1943308108725, "episode_reward_mean": -2527.5636420459264, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2529.4869289431763, -2504.113247924945, -2517.5971300945403, -2515.2983121292546, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 559.5567838312195, "mean_raw_obs_processing_ms": 2.2969145301162843, "mean_inference_ms": 114.30236029924565, "mean_action_processing_ms": 0.3617543083162225}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 212000, "timers": {"sample_time_ms": 1374572.938, "sample_throughput": 2.91, "learn_time_ms": 104801.689, "learn_throughput": 38.167, "update_time_ms": 26.332}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05595367669593543, "policy_loss": -0.014793795911828056, "vf_loss": 1119.057508468628, "vf_explained_var": 0.7734190225601196, "kl": 0.011838310660095885, "entropy": 53.534284830093384, "entropy_coeff": 0.001}}, "num_steps_sampled": 212000, "num_steps_trained": 212000}, "done": false, "episodes_total": 212, "training_iteration": 53, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_15-56-19", "timestamp": 1618041379, "time_this_iter_s": 1450.9169344902039, "time_total_s": 77406.22961831093, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 77406.22961831093, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 11.893801452784507, "ram_util_percent": 15.547457627118643}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2336.4098412973594, "episode_reward_min": -2721.1943308108725, "episode_reward_mean": -2524.382758645099, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2635.6894163072425, -2582.0840123906473, -2496.2523575068503, -2688.3958122114186, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 559.680270065022, "mean_raw_obs_processing_ms": 2.297255151448091, "mean_inference_ms": 114.3296277571806, "mean_action_processing_ms": 0.3618311812373085}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 216000, "timers": {"sample_time_ms": 1373862.94, "sample_throughput": 2.911, "learn_time_ms": 104774.388, "learn_throughput": 38.177, "update_time_ms": 25.459}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04885346698574722, "policy_loss": -0.007334440597333014, "vf_loss": 1070.6924324035645, "vf_explained_var": 0.7818416953086853, "kl": 0.013346225663553923, "entropy": 53.56057000160217, "entropy_coeff": 0.001}}, "num_steps_sampled": 216000, "num_steps_trained": 216000}, "done": false, "episodes_total": 216, "training_iteration": 54, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_16-20-26", "timestamp": 1618042826, "time_this_iter_s": 1446.9232890605927, "time_total_s": 78853.15290737152, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 78853.15290737152, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 11.897231665857213, "ram_util_percent": 15.559689169499755}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2336.4098412973594, "episode_reward_min": -2721.1943308108725, "episode_reward_mean": -2517.539727051327, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2721.1943308108725, -2689.375588684527, -2540.0018229133375, -2639.4998581473415, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 559.7933832891875, "mean_raw_obs_processing_ms": 2.297659720620382, "mean_inference_ms": 114.35595448531208, "mean_action_processing_ms": 0.3618752395831478}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 220000, "timers": {"sample_time_ms": 1372797.363, "sample_throughput": 2.914, "learn_time_ms": 104825.23, "learn_throughput": 38.159, "update_time_ms": 25.548}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.0507818998885341, "policy_loss": -0.008302435249788687, "vf_loss": 996.4845371246338, "vf_explained_var": 0.8082265257835388, "kl": 0.010723047773353755, "entropy": 53.51661479473114, "entropy_coeff": 0.001}}, "num_steps_sampled": 220000, "num_steps_trained": 220000}, "done": false, "episodes_total": 220, "training_iteration": 55, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_16-44-24", "timestamp": 1618044264, "time_this_iter_s": 1438.6192426681519, "time_total_s": 80291.77215003967, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 80291.77215003967, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 11.900732421875, "ram_util_percent": 15.555371093749997}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2328.654505545801, "episode_reward_min": -2664.2319216435762, "episode_reward_mean": -2509.429828577383, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2517.874533982404, -2605.0543890996655, -2610.3845628970666, -2640.856948832452, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 559.8966110797236, "mean_raw_obs_processing_ms": 2.2980003831482576, "mean_inference_ms": 114.37987154197664, "mean_action_processing_ms": 0.3620074748380845}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 224000, "timers": {"sample_time_ms": 1372642.988, "sample_throughput": 2.914, "learn_time_ms": 104512.802, "learn_throughput": 38.273, "update_time_ms": 23.048}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05615674995351583, "policy_loss": -0.015285542292986065, "vf_loss": 1109.305519104004, "vf_explained_var": 0.7857426404953003, "kl": 0.014629220415372401, "entropy": 53.42718195915222, "entropy_coeff": 0.001}}, "num_steps_sampled": 224000, "num_steps_trained": 224000}, "done": false, "episodes_total": 224, "training_iteration": 56, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_17-08-36", "timestamp": 1618045716, "time_this_iter_s": 1451.556637763977, "time_total_s": 81743.32878780365, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 81743.32878780365, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 12.155808325266216, "ram_util_percent": 15.578363988383346}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2328.654505545801, "episode_reward_min": -2664.2319216435762, "episode_reward_mean": -2502.731734174435, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2565.295988431209, -2571.7959042924567, -2518.7090281936216, -2546.755888038725, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.0142785772504, "mean_raw_obs_processing_ms": 2.2984468490409156, "mean_inference_ms": 114.40346226707055, "mean_action_processing_ms": 0.362214205372838}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 228000, "timers": {"sample_time_ms": 1373663.423, "sample_throughput": 2.912, "learn_time_ms": 105620.285, "learn_throughput": 37.872, "update_time_ms": 22.445}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05076237703906372, "policy_loss": -0.00990717625245452, "vf_loss": 1066.5304880142212, "vf_explained_var": 0.7979946136474609, "kl": 0.01511296394164674, "entropy": 53.031798362731934, "entropy_coeff": 0.001}}, "num_steps_sampled": 228000, "num_steps_trained": 228000}, "done": false, "episodes_total": 228, "training_iteration": 57, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_17-34-20", "timestamp": 1618047260, "time_this_iter_s": 1543.5814468860626, "time_total_s": 83286.91023468971, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 83286.91023468971, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 21.145015930814747, "ram_util_percent": 18.58152025489304}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2328.654505545801, "episode_reward_min": -2664.2319216435762, "episode_reward_mean": -2497.648423656453, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2519.434565926683, -2489.925291467031, -2555.6265942302325, -2511.366364477272, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.1450169031064, "mean_raw_obs_processing_ms": 2.298839831434334, "mean_inference_ms": 114.42880920449744, "mean_action_processing_ms": 0.3624689871172038}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 232000, "timers": {"sample_time_ms": 1375608.028, "sample_throughput": 2.908, "learn_time_ms": 106155.571, "learn_throughput": 37.681, "update_time_ms": 23.381}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05092235893243924, "policy_loss": -0.007151443685870618, "vf_loss": 818.6636009216309, "vf_explained_var": 0.8365870714187622, "kl": 0.013795233826385811, "entropy": 53.33707010746002, "entropy_coeff": 0.001}}, "num_steps_sampled": 232000, "num_steps_trained": 232000}, "done": false, "episodes_total": 232, "training_iteration": 58, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_17-59-47", "timestamp": 1618048787, "time_this_iter_s": 1527.548901796341, "time_total_s": 84814.45913648605, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 84814.45913648605, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 23.3272183908046, "ram_util_percent": 19.298620689655174}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2328.654505545801, "episode_reward_min": -2664.2319216435762, "episode_reward_mean": -2494.510739411019, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2580.2773795037115, -2517.337930286059, -2521.5735455563913, -2541.5127233019125, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.2782797636504, "mean_raw_obs_processing_ms": 2.2992393540824643, "mean_inference_ms": 114.45260399545656, "mean_action_processing_ms": 0.36272598890887464}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 236000, "timers": {"sample_time_ms": 1378050.158, "sample_throughput": 2.903, "learn_time_ms": 106884.651, "learn_throughput": 37.424, "update_time_ms": 22.838}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.04629058879800141, "policy_loss": -0.00421451055444777, "vf_loss": 1008.4901790618896, "vf_explained_var": 0.7923895120620728, "kl": 0.012224799516843632, "entropy": 53.38345944881439, "entropy_coeff": 0.001}}, "num_steps_sampled": 236000, "num_steps_trained": 236000}, "done": false, "episodes_total": 236, "training_iteration": 59, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_18-25-48", "timestamp": 1618050348, "time_this_iter_s": 1561.2096042633057, "time_total_s": 86375.66874074936, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 86375.66874074936, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 23.228127812781274, "ram_util_percent": 19.296759675967596}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2328.654505545801, "episode_reward_min": -2664.2319216435762, "episode_reward_mean": -2489.387479259788, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2470.3448863818676, -2577.204082598434, -2500.1713754451216, -2462.783791009869, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.4088917805685, "mean_raw_obs_processing_ms": 2.2997254032619496, "mean_inference_ms": 114.47601814061339, "mean_action_processing_ms": 0.36302919864712807}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 240000, "timers": {"sample_time_ms": 1379731.914, "sample_throughput": 2.899, "learn_time_ms": 107427.212, "learn_throughput": 37.235, "update_time_ms": 22.994}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.06527679646387696, "policy_loss": -0.023530316015239805, "vf_loss": 980.0165748596191, "vf_explained_var": 0.8236926198005676, "kl": 0.016265924263279885, "entropy": 53.17323577404022, "entropy_coeff": 0.001}}, "num_steps_sampled": 240000, "num_steps_trained": 240000}, "done": false, "episodes_total": 240, "training_iteration": 60, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_18-51-32", "timestamp": 1618051892, "time_this_iter_s": 1543.8648626804352, "time_total_s": 87919.5336034298, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 87919.5336034298, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 22.959171597633137, "ram_util_percent": 19.30405097860719}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2326.187853485285, "episode_reward_min": -2664.2319216435762, "episode_reward_mean": -2484.884037266381, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2587.7802571533057, -2580.5331747367673, -2489.5543945195022, -2543.579483313338, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.5276607708594, "mean_raw_obs_processing_ms": 2.3002993193644397, "mean_inference_ms": 114.49820061048591, "mean_action_processing_ms": 0.3632458542256121}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 244000, "timers": {"sample_time_ms": 1381787.265, "sample_throughput": 2.895, "learn_time_ms": 107505.245, "learn_throughput": 37.207, "update_time_ms": 23.154}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.055685722443740815, "policy_loss": -0.012017060158541426, "vf_loss": 796.1741323471069, "vf_explained_var": 0.8530449867248535, "kl": 0.012604528659721836, "entropy": 52.89085352420807, "entropy_coeff": 0.001}}, "num_steps_sampled": 244000, "num_steps_trained": 244000}, "done": false, "episodes_total": 244, "training_iteration": 61, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_19-16-02", "timestamp": 1618053362, "time_this_iter_s": 1469.75395321846, "time_total_s": 89389.28755664825, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 89389.28755664825, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 16.917773530817005, "ram_util_percent": 17.643717152412805}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2326.187853485285, "episode_reward_min": -2664.2319216435762, "episode_reward_mean": -2478.8472967275147, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2558.852362648062, -2633.3563203821045, -2610.4015746531263, -2515.5033209174712, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.6405045050025, "mean_raw_obs_processing_ms": 2.3009486248279365, "mean_inference_ms": 114.52019571420118, "mean_action_processing_ms": 0.3634651787551957}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 248000, "timers": {"sample_time_ms": 1384088.009, "sample_throughput": 2.89, "learn_time_ms": 110025.417, "learn_throughput": 36.355, "update_time_ms": 22.21}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05782491102581844, "policy_loss": -0.018392274039797485, "vf_loss": 1263.386703491211, "vf_explained_var": 0.7366461157798767, "kl": 0.013167711906135082, "entropy": 53.38327407836914, "entropy_coeff": 0.001}}, "num_steps_sampled": 248000, "num_steps_trained": 248000}, "done": false, "episodes_total": 248, "training_iteration": 62, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_19-41-10", "timestamp": 1618054870, "time_this_iter_s": 1507.4642417430878, "time_total_s": 90896.75179839134, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 90896.75179839134, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 15.866635601118361, "ram_util_percent": 17.2098788443616}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2285.208458109645, "episode_reward_min": -2664.2319216435762, "episode_reward_mean": -2469.001170803822, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2553.1451124958403, -2595.056261029569, -2660.1911080497703, -2559.349484501742, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.7710776194981, "mean_raw_obs_processing_ms": 2.301695214127622, "mean_inference_ms": 114.54427001999336, "mean_action_processing_ms": 0.3636818513738517}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 252000, "timers": {"sample_time_ms": 1389588.296, "sample_throughput": 2.879, "learn_time_ms": 112710.105, "learn_throughput": 35.489, "update_time_ms": 23.347}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05155722121708095, "policy_loss": -0.005755091842729598, "vf_loss": 652.3954696655273, "vf_explained_var": 0.8519794940948486, "kl": 0.010730360227171332, "entropy": 53.399118065834045, "entropy_coeff": 0.001}}, "num_steps_sampled": 252000, "num_steps_trained": 252000}, "done": false, "episodes_total": 252, "training_iteration": 63, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_20-06-42", "timestamp": 1618056402, "time_this_iter_s": 1532.7899768352509, "time_total_s": 92429.5417752266, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 92429.5417752266, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 22.971998166819432, "ram_util_percent": 19.545692025664525}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2249.7945648605446, "episode_reward_min": -2664.2319216435762, "episode_reward_mean": -2458.7400756914967, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2456.846135561539, -2493.028764469556, -2540.5500433622997, -2514.422813585647, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.9116185602196, "mean_raw_obs_processing_ms": 2.3024987951327693, "mean_inference_ms": 114.57018296568738, "mean_action_processing_ms": 0.36381339404708485}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 256000, "timers": {"sample_time_ms": 1396098.392, "sample_throughput": 2.865, "learn_time_ms": 114801.537, "learn_throughput": 34.843, "update_time_ms": 21.876}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.055407054955139756, "policy_loss": -0.013944777892902493, "vf_loss": 1114.5599145889282, "vf_explained_var": 0.7735064029693604, "kl": 0.012639964581467211, "entropy": 53.87187039852142, "entropy_coeff": 0.001}}, "num_steps_sampled": 256000, "num_steps_trained": 256000}, "done": false, "episodes_total": 256, "training_iteration": 64, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_20-32-15", "timestamp": 1618057935, "time_this_iter_s": 1532.9240815639496, "time_total_s": 93962.46585679054, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 93962.46585679054, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 22.98088909257562, "ram_util_percent": 19.50632447296059}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2249.7945648605446, "episode_reward_min": -2664.2319216435762, "episode_reward_mean": -2451.7762437146694, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2664.2319216435762, -2482.549525098566, -2552.856659624023, -2482.604626052019, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.0688810933925, "mean_raw_obs_processing_ms": 2.3033164980010468, "mean_inference_ms": 114.59550472989824, "mean_action_processing_ms": 0.3638823658729928}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 260000, "timers": {"sample_time_ms": 1404252.853, "sample_throughput": 2.848, "learn_time_ms": 117370.2, "learn_throughput": 34.08, "update_time_ms": 22.202}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05915071809431538, "policy_loss": -0.017201757582370192, "vf_loss": 1032.584722518921, "vf_explained_var": 0.7859765887260437, "kl": 0.012724921078188345, "entropy": 53.54729700088501, "entropy_coeff": 0.001}}, "num_steps_sampled": 260000, "num_steps_trained": 260000}, "done": false, "episodes_total": 260, "training_iteration": 65, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_20-58-01", "timestamp": 1618059481, "time_this_iter_s": 1545.8537917137146, "time_total_s": 95508.31964850426, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 95508.31964850426, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 22.969227272727274, "ram_util_percent": 19.501045454545455}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2249.7945648605446, "episode_reward_min": -2625.0252615078966, "episode_reward_mean": -2444.6638511911037, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2625.0252615078966, -2475.854972155544, -2542.2528186960294, -2535.8865266697944, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.2315791590739, "mean_raw_obs_processing_ms": 2.304073456565429, "mean_inference_ms": 114.62302737237069, "mean_action_processing_ms": 0.36397081150009497}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 264000, "timers": {"sample_time_ms": 1408296.606, "sample_throughput": 2.84, "learn_time_ms": 119449.182, "learn_throughput": 33.487, "update_time_ms": 22.708}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05725068543688394, "policy_loss": -0.010993617819622159, "vf_loss": 641.5312967300415, "vf_explained_var": 0.8509001135826111, "kl": 0.013055778865236789, "entropy": 53.97795391082764, "entropy_coeff": 0.001}}, "num_steps_sampled": 264000, "num_steps_trained": 264000}, "done": false, "episodes_total": 264, "training_iteration": 66, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_21-23-14", "timestamp": 1618060994, "time_this_iter_s": 1512.7889070510864, "time_total_s": 97021.10855555534, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 97021.10855555534, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 22.741058987459358, "ram_util_percent": 19.49698095680446}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2249.7945648605446, "episode_reward_min": -2617.2772835338083, "episode_reward_mean": -2434.744976154872, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2581.150310892942, -2523.467754750764, -2580.240441701861, -2443.804179345879, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.3968843689526, "mean_raw_obs_processing_ms": 2.3049467836528827, "mean_inference_ms": 114.65243395526072, "mean_action_processing_ms": 0.3640572040412233}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 268000, "timers": {"sample_time_ms": 1405061.423, "sample_throughput": 2.847, "learn_time_ms": 116290.21, "learn_throughput": 34.397, "update_time_ms": 20.562}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05616661155363545, "policy_loss": -0.011105684447102249, "vf_loss": 772.9734687805176, "vf_explained_var": 0.8290300965309143, "kl": 0.008954819553764537, "entropy": 53.68614172935486, "entropy_coeff": 0.001}}, "num_steps_sampled": 268000, "num_steps_trained": 268000}, "done": false, "episodes_total": 268, "training_iteration": 67, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_21-47-54", "timestamp": 1618062474, "time_this_iter_s": 1479.6183774471283, "time_total_s": 98500.72693300247, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 98500.72693300247, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 17.631528964862298, "ram_util_percent": 18.100759734093067}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2249.7945648605446, "episode_reward_min": -2617.2772835338083, "episode_reward_mean": -2426.6097415030304, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2515.703067993459, -2484.960523790443, -2617.2772835338083, -2502.6254861595166, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.567924586511, "mean_raw_obs_processing_ms": 2.305761024924032, "mean_inference_ms": 114.68322990654056, "mean_action_processing_ms": 0.36414452635517536}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 272000, "timers": {"sample_time_ms": 1402969.313, "sample_throughput": 2.851, "learn_time_ms": 116567.341, "learn_throughput": 34.315, "update_time_ms": 19.914}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.0568655890529044, "policy_loss": -0.011037928808946162, "vf_loss": 690.9695739746094, "vf_explained_var": 0.8411269783973694, "kl": 0.009648760111304, "entropy": 53.70222878456116, "entropy_coeff": 0.001}}, "num_steps_sampled": 272000, "num_steps_trained": 272000}, "done": false, "episodes_total": 272, "training_iteration": 68, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_22-13-03", "timestamp": 1618063983, "time_this_iter_s": 1509.3923118114471, "time_total_s": 100010.11924481392, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 100010.11924481392, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 19.509171322160146, "ram_util_percent": 18.654422718808192}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2249.7945648605446, "episode_reward_min": -2600.598304283412, "episode_reward_mean": -2417.7069674708614, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2553.452257729565, -2489.30560176448, -2500.4259081026757, -2600.598304283412, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.7550300447406, "mean_raw_obs_processing_ms": 2.3064454072629186, "mean_inference_ms": 114.71421495028216, "mean_action_processing_ms": 0.3642738382554191}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 276000, "timers": {"sample_time_ms": 1402192.295, "sample_throughput": 2.853, "learn_time_ms": 116109.236, "learn_throughput": 34.45, "update_time_ms": 19.507}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05629168526502326, "policy_loss": -0.011017990676918998, "vf_loss": 745.9523639678955, "vf_explained_var": 0.8368748426437378, "kl": 0.010158373595913872, "entropy": 53.74905300140381, "entropy_coeff": 0.001}}, "num_steps_sampled": 276000, "num_steps_trained": 276000}, "done": false, "episodes_total": 276, "training_iteration": 69, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_22-38-52", "timestamp": 1618065532, "time_this_iter_s": 1548.8544399738312, "time_total_s": 101558.97368478775, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 101558.97368478775, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 22.94861678004535, "ram_util_percent": 19.53600907029478}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2249.7945648605446, "episode_reward_min": -2580.0090463238143, "episode_reward_mean": -2410.6418949164645, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2412.289621052074, -2468.660077035849, -2509.250961037751, -2551.4494376298817, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.961029172019, "mean_raw_obs_processing_ms": 2.3071596981178937, "mean_inference_ms": 114.74884686291897, "mean_action_processing_ms": 0.36449171283515946}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 280000, "timers": {"sample_time_ms": 1404213.288, "sample_throughput": 2.849, "learn_time_ms": 115640.021, "learn_throughput": 34.59, "update_time_ms": 22.696}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.06372199510224164, "policy_loss": -0.0193659903598018, "vf_loss": 740.9632768630981, "vf_explained_var": 0.8233410716056824, "kl": 0.013993625994771719, "entropy": 53.16499853134155, "entropy_coeff": 0.001}}, "num_steps_sampled": 280000, "num_steps_trained": 280000}, "done": false, "episodes_total": 280, "training_iteration": 70, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_23-04-52", "timestamp": 1618067092, "time_this_iter_s": 1559.4142093658447, "time_total_s": 103118.3878941536, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 103118.3878941536, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 23.048219918882378, "ram_util_percent": 19.573050923839563}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2249.7945648605446, "episode_reward_min": -2580.0090463238143, "episode_reward_mean": -2403.4596613081408, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2415.9732284388037, -2401.482017540627, -2479.112863935054, -2515.6934357857563, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.1833874008744, "mean_raw_obs_processing_ms": 2.3078095361941333, "mean_inference_ms": 114.78579728836753, "mean_action_processing_ms": 0.3646715542679788}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 284000, "timers": {"sample_time_ms": 1409484.13, "sample_throughput": 2.838, "learn_time_ms": 118904.73, "learn_throughput": 33.64, "update_time_ms": 22.787}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05225084532867186, "policy_loss": -0.010349167860113084, "vf_loss": 1087.559931755066, "vf_explained_var": 0.7592645287513733, "kl": 0.0085706173122162, "entropy": 53.63433790206909, "entropy_coeff": 0.001}}, "num_steps_sampled": 284000, "num_steps_trained": 284000}, "done": false, "episodes_total": 284, "training_iteration": 71, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_23-30-47", "timestamp": 1618068647, "time_this_iter_s": 1555.113034248352, "time_total_s": 104673.50092840195, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 104673.50092840195, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 23.053297199638664, "ram_util_percent": 19.576964769647695}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2193.923266511244, "episode_reward_min": -2580.0090463238143, "episode_reward_mean": -2394.6765955639116, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2576.2868295148664, -2546.148008387484, -2430.471239274091, -2534.9761331677983, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.3990134225984, "mean_raw_obs_processing_ms": 2.308426844683923, "mean_inference_ms": 114.8217254740752, "mean_action_processing_ms": 0.3649256610705578}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 288000, "timers": {"sample_time_ms": 1412399.655, "sample_throughput": 2.832, "learn_time_ms": 116389.981, "learn_throughput": 34.367, "update_time_ms": 23.093}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.058492805081186816, "policy_loss": -0.016544132493436337, "vf_loss": 1035.3225212097168, "vf_explained_var": 0.7904932498931885, "kl": 0.012583780247950926, "entropy": 53.560271859169006, "entropy_coeff": 0.001}}, "num_steps_sampled": 288000, "num_steps_trained": 288000}, "done": false, "episodes_total": 288, "training_iteration": 72, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-10_23-55-58", "timestamp": 1618070158, "time_this_iter_s": 1511.475278377533, "time_total_s": 106184.97620677948, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 106184.97620677948, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 19.888057620817843, "ram_util_percent": 18.842611524163566}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2193.923266511244, "episode_reward_min": -2580.0090463238143, "episode_reward_mean": -2384.0802297131395, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2545.157739523402, -2561.509753510188, -2580.0090463238143, -2422.2518764278884, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.6037032361811, "mean_raw_obs_processing_ms": 2.3090556285259147, "mean_inference_ms": 114.8561094249889, "mean_action_processing_ms": 0.36515230050457215}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 292000, "timers": {"sample_time_ms": 1408578.982, "sample_throughput": 2.84, "learn_time_ms": 113642.754, "learn_throughput": 35.198, "update_time_ms": 20.465}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.057294240134069696, "policy_loss": -0.013606587424874306, "vf_loss": 847.156286239624, "vf_explained_var": 0.7957509160041809, "kl": 0.013441232353216037, "entropy": 53.503334522247314, "entropy_coeff": 0.001}}, "num_steps_sampled": 292000, "num_steps_trained": 292000}, "done": false, "episodes_total": 292, "training_iteration": 73, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_00-20-25", "timestamp": 1618071625, "time_this_iter_s": 1467.0724930763245, "time_total_s": 107652.0486998558, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 107652.0486998558, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 13.515093435553426, "ram_util_percent": 16.854575946334453}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2193.923266511244, "episode_reward_min": -2573.9053358973797, "episode_reward_mean": -2375.686730527174, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2492.480697177928, -2514.5148638709293, -2466.444376787764, -2509.1103059144853, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.7829072710265, "mean_raw_obs_processing_ms": 2.309601629484833, "mean_inference_ms": 114.88810208597454, "mean_action_processing_ms": 0.3653468356218578}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 296000, "timers": {"sample_time_ms": 1401265.866, "sample_throughput": 2.855, "learn_time_ms": 111156.001, "learn_throughput": 35.985, "update_time_ms": 21.503}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.056108411168679595, "policy_loss": -0.012156537704868242, "vf_loss": 826.079517364502, "vf_explained_var": 0.8013982772827148, "kl": 0.013060888304607943, "entropy": 53.51875698566437, "entropy_coeff": 0.001}}, "num_steps_sampled": 296000, "num_steps_trained": 296000}, "done": false, "episodes_total": 296, "training_iteration": 74, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_00-44-20", "timestamp": 1618073060, "time_this_iter_s": 1434.935940027237, "time_total_s": 109086.98463988304, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 109086.98463988304, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 11.873715124816446, "ram_util_percent": 15.893930494371029}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2167.9225109283075, "episode_reward_min": -2573.9053358973797, "episode_reward_mean": -2365.2243764483037, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2465.488314964433, -2539.4022810482716, -2530.0716984502656, -2394.9754767673257, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.9437799447064, "mean_raw_obs_processing_ms": 2.3100990081791153, "mean_inference_ms": 114.91650736545424, "mean_action_processing_ms": 0.3654932543690982}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 300000, "timers": {"sample_time_ms": 1393835.362, "sample_throughput": 2.87, "learn_time_ms": 108496.501, "learn_throughput": 36.868, "update_time_ms": 23.805}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05192227551015094, "policy_loss": -0.006553042971063405, "vf_loss": 660.6617741584778, "vf_explained_var": 0.8402911424636841, "kl": 0.017184394382638857, "entropy": 53.694286704063416, "entropy_coeff": 0.001}}, "num_steps_sampled": 300000, "num_steps_trained": 300000}, "done": false, "episodes_total": 300, "training_iteration": 75, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_01-08-25", "timestamp": 1618074505, "time_this_iter_s": 1444.9766719341278, "time_total_s": 110531.96131181717, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 110531.96131181717, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 11.600486144871171, "ram_util_percent": 15.811327175498302}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2167.9225109283075, "episode_reward_min": -2573.9053358973797, "episode_reward_mean": -2357.4378952345824, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2336.4098412973594, -2483.898228457948, -2412.647342574407, -2429.6331777903947, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.0990212018398, "mean_raw_obs_processing_ms": 2.3105382805580432, "mean_inference_ms": 114.94379640721166, "mean_action_processing_ms": 0.36555982432331036}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 304000, "timers": {"sample_time_ms": 1388433.174, "sample_throughput": 2.881, "learn_time_ms": 106591.322, "learn_throughput": 37.527, "update_time_ms": 26.562}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05771959765115753, "policy_loss": -0.012609258526936173, "vf_loss": 759.5668458938599, "vf_explained_var": 0.8095086216926575, "kl": 0.012714333104668185, "entropy": 53.97744011878967, "entropy_coeff": 0.001}}, "num_steps_sampled": 304000, "num_steps_trained": 304000}, "done": false, "episodes_total": 304, "training_iteration": 76, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_01-32-25", "timestamp": 1618075945, "time_this_iter_s": 1439.74281167984, "time_total_s": 111971.70412349701, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 111971.70412349701, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 11.592532942898975, "ram_util_percent": 15.81547096144461}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2167.9225109283075, "episode_reward_min": -2573.9053358973797, "episode_reward_mean": -2352.4797714387437, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2408.2155288431654, -2405.406875934747, -2476.758981704393, -2410.4853095312474, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.2501166169741, "mean_raw_obs_processing_ms": 2.310970325970669, "mean_inference_ms": 114.9689380969507, "mean_action_processing_ms": 0.3656487795665211}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 308000, "timers": {"sample_time_ms": 1385110.63, "sample_throughput": 2.888, "learn_time_ms": 106531.35, "learn_throughput": 37.548, "update_time_ms": 26.344}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05649331392487511, "policy_loss": -0.012578153284266591, "vf_loss": 902.093997001648, "vf_explained_var": 0.7826507091522217, "kl": 0.011791389377322048, "entropy": 54.115240693092346, "entropy_coeff": 0.001}}, "num_steps_sampled": 308000, "num_steps_trained": 308000}, "done": false, "episodes_total": 308, "training_iteration": 77, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_01-56-31", "timestamp": 1618077391, "time_this_iter_s": 1445.7929003238678, "time_total_s": 113417.49702382088, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 113417.49702382088, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 11.58824101068999, "ram_util_percent": 15.8187074829932}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2167.9225109283075, "episode_reward_min": -2573.9053358973797, "episode_reward_mean": -2346.790546164408, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2438.619753182829, -2425.4054593891597, -2422.9857780491047, -2461.3962883880968, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.3987987506307, "mean_raw_obs_processing_ms": 2.3113903960110638, "mean_inference_ms": 114.993276409061, "mean_action_processing_ms": 0.36577008058048194}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 312000, "timers": {"sample_time_ms": 1380756.98, "sample_throughput": 2.897, "learn_time_ms": 103953.161, "learn_throughput": 38.479, "update_time_ms": 25.938}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05496792332269251, "policy_loss": -0.009062408935278654, "vf_loss": 655.5193538665771, "vf_explained_var": 0.8462352752685547, "kl": 0.012962330889422446, "entropy": 53.756938338279724, "entropy_coeff": 0.001}}, "num_steps_sampled": 312000, "num_steps_trained": 312000}, "done": false, "episodes_total": 312, "training_iteration": 78, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_02-20-31", "timestamp": 1618078831, "time_this_iter_s": 1440.0699067115784, "time_total_s": 114857.56693053246, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 114857.56693053246, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 11.60390243902439, "ram_util_percent": 15.816292682926834}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2167.9225109283075, "episode_reward_min": -2573.9053358973797, "episode_reward_mean": -2339.8958308041274, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2451.5750095149783, -2393.232641435116, -2484.9367624319466, -2388.3740256569076, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.5457296414083, "mean_raw_obs_processing_ms": 2.311839286244296, "mean_inference_ms": 115.01747930596247, "mean_action_processing_ms": 0.3658341253352414}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 316000, "timers": {"sample_time_ms": 1372515.754, "sample_throughput": 2.914, "learn_time_ms": 101489.399, "learn_throughput": 39.413, "update_time_ms": 25.021}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05930597789119929, "policy_loss": -0.011345098377205431, "vf_loss": 508.2513647079468, "vf_explained_var": 0.8760987520217896, "kl": 0.010788655461510643, "entropy": 54.12225544452667, "entropy_coeff": 0.001}}, "num_steps_sampled": 316000, "num_steps_trained": 316000}, "done": false, "episodes_total": 316, "training_iteration": 79, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_02-44-33", "timestamp": 1618080273, "time_this_iter_s": 1441.7951221466064, "time_total_s": 116299.36205267906, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 116299.36205267906, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 11.577192982456141, "ram_util_percent": 15.810672514619888}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2167.9225109283075, "episode_reward_min": -2573.9053358973797, "episode_reward_mean": -2333.8634655934466, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2440.2802876078213, -2436.2416241106685, -2573.9053358973797, -2328.654505545801, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.6947855939568, "mean_raw_obs_processing_ms": 2.312171437939783, "mean_inference_ms": 115.04166634885598, "mean_action_processing_ms": 0.3658735460073349}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 320000, "timers": {"sample_time_ms": 1363220.152, "sample_throughput": 2.934, "learn_time_ms": 99220.417, "learn_throughput": 40.314, "update_time_ms": 23.296}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05746600223938003, "policy_loss": -0.011906280371476896, "vf_loss": 736.5318374633789, "vf_explained_var": 0.8197091817855835, "kl": 0.012285005068406463, "entropy": 54.153539419174194, "entropy_coeff": 0.001}}, "num_steps_sampled": 320000, "num_steps_trained": 320000}, "done": false, "episodes_total": 320, "training_iteration": 80, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_03-08-37", "timestamp": 1618081717, "time_this_iter_s": 1443.75119638443, "time_total_s": 117743.11324906349, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 117743.11324906349, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 11.579902676399024, "ram_util_percent": 15.819075425790759}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2167.9225109283075, "episode_reward_min": -2516.0899365077084, "episode_reward_mean": -2325.3691413190572, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2388.398256122289, -2449.058911797289, -2436.268901849033, -2430.6349247482112, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.8397250322874, "mean_raw_obs_processing_ms": 2.3125046985284454, "mean_inference_ms": 115.06518060525758, "mean_action_processing_ms": 0.365876613310937}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 324000, "timers": {"sample_time_ms": 1354371.958, "sample_throughput": 2.953, "learn_time_ms": 95856.672, "learn_throughput": 41.729, "update_time_ms": 21.805}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.0579768058960326, "policy_loss": -0.010714035597629845, "vf_loss": 591.0229787826538, "vf_explained_var": 0.8618155717849731, "kl": 0.011611116846324876, "entropy": 54.33410954475403, "entropy_coeff": 0.001}}, "num_steps_sampled": 324000, "num_steps_trained": 324000}, "done": false, "episodes_total": 324, "training_iteration": 81, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_03-32-30", "timestamp": 1618083150, "time_this_iter_s": 1432.9760174751282, "time_total_s": 119176.08926653862, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 119176.08926653862, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 11.593676470588235, "ram_util_percent": 15.823431372549024}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2167.9225109283075, "episode_reward_min": -2516.0899365077084, "episode_reward_mean": -2317.7933703500453, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2379.459851218375, -2361.5188238439487, -2437.157145587746, -2516.0899365077084, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.9638082669485, "mean_raw_obs_processing_ms": 2.312805646429879, "mean_inference_ms": 115.08541599810323, "mean_action_processing_ms": 0.3659314081263818}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 328000, "timers": {"sample_time_ms": 1347447.207, "sample_throughput": 2.969, "learn_time_ms": 95803.026, "learn_throughput": 41.752, "update_time_ms": 22.846}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.050338384753558785, "policy_loss": -0.008763145306147635, "vf_loss": 1203.369372367859, "vf_explained_var": 0.7410931587219238, "kl": 0.014224884187569842, "entropy": 55.03141927719116, "entropy_coeff": 0.001}}, "num_steps_sampled": 328000, "num_steps_trained": 328000}, "done": false, "episodes_total": 328, "training_iteration": 82, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_03-56-31", "timestamp": 1618084591, "time_this_iter_s": 1441.701423406601, "time_total_s": 120617.79068994522, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 120617.79068994522, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 11.598001949317737, "ram_util_percent": 15.811647173489282}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2147.2959800520007, "episode_reward_min": -2491.434250678043, "episode_reward_mean": -2308.6828926346357, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2387.7219045984853, -2424.740396068279, -2491.434250678043, -2458.687840213028, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 564.0687594087531, "mean_raw_obs_processing_ms": 2.313128348386737, "mean_inference_ms": 115.10371374005479, "mean_action_processing_ms": 0.36595106551430406}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 332000, "timers": {"sample_time_ms": 1345073.325, "sample_throughput": 2.974, "learn_time_ms": 95970.761, "learn_throughput": 41.679, "update_time_ms": 27.428}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05633081105770543, "policy_loss": -0.0080652009928599, "vf_loss": 478.1480178833008, "vf_explained_var": 0.873403012752533, "kl": 0.014420106279430911, "entropy": 54.489097237586975, "entropy_coeff": 0.001}}, "num_steps_sampled": 332000, "num_steps_trained": 332000}, "done": false, "episodes_total": 332, "training_iteration": 83, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_04-20-36", "timestamp": 1618086036, "time_this_iter_s": 1445.0570485591888, "time_total_s": 122062.84773850441, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 122062.84773850441, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 11.588721438988818, "ram_util_percent": 15.810549343704428}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2147.2959800520007, "episode_reward_min": -2459.496198063652, "episode_reward_mean": -2299.2187952394556, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2379.5708669595674, -2423.188311333433, -2402.577515270237, -2443.038869961739, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 564.1468127648494, "mean_raw_obs_processing_ms": 2.313431742819584, "mean_inference_ms": 115.11827307421008, "mean_action_processing_ms": 0.36598008472239946}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 336000, "timers": {"sample_time_ms": 1345241.795, "sample_throughput": 2.973, "learn_time_ms": 96424.533, "learn_throughput": 41.483, "update_time_ms": 27.733}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.052058233064599335, "policy_loss": -0.005910788429901004, "vf_loss": 695.0686941146851, "vf_explained_var": 0.8406683206558228, "kl": 0.014509006636217237, "entropy": 54.549031496047974, "entropy_coeff": 0.001}}, "num_steps_sampled": 336000, "num_steps_trained": 336000}, "done": false, "episodes_total": 336, "training_iteration": 84, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_04-44-38", "timestamp": 1618087478, "time_this_iter_s": 1441.161075592041, "time_total_s": 123504.00881409645, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 123504.00881409645, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 11.59961013645224, "ram_util_percent": 15.820565302144255}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2124.9929376211167, "episode_reward_min": -2459.496198063652, "episode_reward_mean": -2290.5983578073256, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2376.3977670273175, -2398.0781175183115, -2459.496198063652, -2326.187853485285, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 564.2018798875174, "mean_raw_obs_processing_ms": 2.3135664257764152, "mean_inference_ms": 115.12883789806492, "mean_action_processing_ms": 0.36598647581600063}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 340000, "timers": {"sample_time_ms": 1343559.367, "sample_throughput": 2.977, "learn_time_ms": 96510.342, "learn_throughput": 41.446, "update_time_ms": 26.058}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.05546947577386163, "policy_loss": -0.013258971564937383, "vf_loss": 1149.1735591888428, "vf_explained_var": 0.7672562599182129, "kl": 0.012053227139404044, "entropy": 54.90756058692932, "entropy_coeff": 0.001}}, "num_steps_sampled": 340000, "num_steps_trained": 340000}, "done": false, "episodes_total": 340, "training_iteration": 85, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_05-08-27", "timestamp": 1618088907, "time_this_iter_s": 1428.9936175346375, "time_total_s": 124933.00243163109, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 124933.00243163109, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 11.610471976401179, "ram_util_percent": 15.817502458210425}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2124.9929376211167, "episode_reward_min": -2444.219633526751, "episode_reward_mean": -2281.3869932614193, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2355.858743671798, -2396.9209304313204, -2400.7739482064585, -2444.219633526751, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 564.2482613737988, "mean_raw_obs_processing_ms": 2.3136509936392855, "mean_inference_ms": 115.13783192922342, "mean_action_processing_ms": 0.36602949210302926}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 344000, "timers": {"sample_time_ms": 1344097.751, "sample_throughput": 2.976, "learn_time_ms": 96396.68, "learn_throughput": 41.495, "update_time_ms": 22.837}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.07158715656260028, "policy_loss": -0.023229058540891856, "vf_loss": 515.700421333313, "vf_explained_var": 0.8654220700263977, "kl": 0.0153505782072898, "entropy": 55.05015480518341, "entropy_coeff": 0.001}}, "num_steps_sampled": 344000, "num_steps_trained": 344000}, "done": false, "episodes_total": 344, "training_iteration": 86, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_05-32-31", "timestamp": 1618090351, "time_this_iter_s": 1443.9577896595001, "time_total_s": 126376.96022129059, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 126376.96022129059, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 11.83542579075426, "ram_util_percent": 15.82924574209246}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2124.9929376211167, "episode_reward_min": -2431.4642738699276, "episode_reward_mean": -2272.564592895754, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2382.4617646278284, -2357.120776801847, -2308.7099866921794, -2285.208458109645, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 564.2834762022374, "mean_raw_obs_processing_ms": 2.3137174774242895, "mean_inference_ms": 115.14495195205353, "mean_action_processing_ms": 0.36613371483971663}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 348000, "timers": {"sample_time_ms": 1343303.943, "sample_throughput": 2.978, "learn_time_ms": 96476.979, "learn_throughput": 41.461, "update_time_ms": 24.465}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.059671034454368055, "policy_loss": -0.013929316482972354, "vf_loss": 806.7406659126282, "vf_explained_var": 0.8070334196090698, "kl": 0.01663893452496268, "entropy": 55.47301745414734, "entropy_coeff": 0.001}}, "num_steps_sampled": 348000, "num_steps_trained": 348000}, "done": false, "episodes_total": 348, "training_iteration": 87, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_05-56-29", "timestamp": 1618091789, "time_this_iter_s": 1438.6721107959747, "time_total_s": 127815.63233208656, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 127815.63233208656, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 11.600341796875, "ram_util_percent": 15.831201171875005}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2124.9929376211167, "episode_reward_min": -2431.4642738699276, "episode_reward_mean": -2267.284822681946, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2249.7945648605446, -2376.45967217607, -2430.4906712088514, -2284.887546598934, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 564.3017277153432, "mean_raw_obs_processing_ms": 2.3137055129982262, "mean_inference_ms": 115.15070978043961, "mean_action_processing_ms": 0.3662740413550769}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 352000, "timers": {"sample_time_ms": 1343810.529, "sample_throughput": 2.977, "learn_time_ms": 95256.459, "learn_throughput": 41.992, "update_time_ms": 25.015}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.06579893556772731, "policy_loss": -0.021073670126497746, "vf_loss": 859.116307258606, "vf_explained_var": 0.7744016647338867, "kl": 0.016956114035565406, "entropy": 55.01203942298889, "entropy_coeff": 0.001}}, "num_steps_sampled": 352000, "num_steps_trained": 352000}, "done": false, "episodes_total": 352, "training_iteration": 88, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_06-20-22", "timestamp": 1618093222, "time_this_iter_s": 1432.935881137848, "time_total_s": 129248.56821322441, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 129248.56821322441, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 11.836880823933301, "ram_util_percent": 15.842471799901917}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2124.9929376211167, "episode_reward_min": -2431.4642738699276, "episode_reward_mean": -2261.9934268093134, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2357.9807136742133, -2285.286196420925, -2303.3557746603897, -2361.8418745407334, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 564.3016273836873, "mean_raw_obs_processing_ms": 2.3136694565514433, "mean_inference_ms": 115.15346997920985, "mean_action_processing_ms": 0.36644011507395985}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 356000, "timers": {"sample_time_ms": 1342946.675, "sample_throughput": 2.979, "learn_time_ms": 95458.943, "learn_throughput": 41.903, "update_time_ms": 25.356}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.06944839819334447, "policy_loss": -0.020700007036793977, "vf_loss": 503.0452105998993, "vf_explained_var": 0.8787579536437988, "kl": 0.014711142517626286, "entropy": 55.249955892562866, "entropy_coeff": 0.001}}, "num_steps_sampled": 356000, "num_steps_trained": 356000}, "done": false, "episodes_total": 356, "training_iteration": 89, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_06-44-18", "timestamp": 1618094658, "time_this_iter_s": 1435.1848039627075, "time_total_s": 130683.75301718712, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 130683.75301718712, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 11.603181595692611, "ram_util_percent": 15.850758688203626}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2124.9929376211167, "episode_reward_min": -2431.4642738699276, "episode_reward_mean": -2257.4807938361196, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2386.1495138708565, -2431.4642738699276, -2268.1726961290333, -2385.2169961918316, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 564.2806313786365, "mean_raw_obs_processing_ms": 2.3135363253400896, "mean_inference_ms": 115.15402434107683, "mean_action_processing_ms": 0.3666202336589109}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 360000, "timers": {"sample_time_ms": 1342386.385, "sample_throughput": 2.98, "learn_time_ms": 95757.859, "learn_throughput": 41.772, "update_time_ms": 24.851}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.06138707126956433, "policy_loss": -0.01335821527754888, "vf_loss": 503.8075923919678, "vf_explained_var": 0.8753020763397217, "kl": 0.01645957722212188, "entropy": 54.712886571884155, "entropy_coeff": 0.001}}, "num_steps_sampled": 360000, "num_steps_trained": 360000}, "done": false, "episodes_total": 360, "training_iteration": 90, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_07-08-19", "timestamp": 1618096099, "time_this_iter_s": 1441.13240981102, "time_total_s": 132124.88542699814, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 132124.88542699814, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 11.60609458800585, "ram_util_percent": 15.852998537298884}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2121.385120597298, "episode_reward_min": -2400.3930255797122, "episode_reward_mean": -2249.0010220303916, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2310.2148220880104, -2306.2974974711383, -2289.678783005017, -2280.94097284192, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 564.2493208724559, "mean_raw_obs_processing_ms": 2.313437293972558, "mean_inference_ms": 115.15206454278032, "mean_action_processing_ms": 0.3667581342001183}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 364000, "timers": {"sample_time_ms": 1342126.107, "sample_throughput": 2.98, "learn_time_ms": 96578.453, "learn_throughput": 41.417, "update_time_ms": 24.989}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.06032406818121672, "policy_loss": -0.01268678205087781, "vf_loss": 564.9496097564697, "vf_explained_var": 0.8364918231964111, "kl": 0.01438818228780292, "entropy": 54.7255961894989, "entropy_coeff": 0.001}}, "num_steps_sampled": 364000, "num_steps_trained": 364000}, "done": false, "episodes_total": 364, "training_iteration": 91, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_07-32-17", "timestamp": 1618097537, "time_this_iter_s": 1438.5805084705353, "time_total_s": 133563.46593546867, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 133563.46593546867, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 11.603124999999999, "ram_util_percent": 15.856103515625005}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2085.7432545262373, "episode_reward_min": -2400.3930255797122, "episode_reward_mean": -2242.954214520441, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2317.7691082030165, -2323.1033684468175, -2320.483368588744, -2353.783376268716, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 564.2088838028416, "mean_raw_obs_processing_ms": 2.3133229803796307, "mean_inference_ms": 115.14733816455761, "mean_action_processing_ms": 0.36692208085396083}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 368000, "timers": {"sample_time_ms": 1340703.138, "sample_throughput": 2.984, "learn_time_ms": 96729.547, "learn_throughput": 41.352, "update_time_ms": 22.556}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.0612876649829559, "policy_loss": -0.016313245694618672, "vf_loss": 836.552116394043, "vf_explained_var": 0.7947840690612793, "kl": 0.014775759540498257, "entropy": 54.81751549243927, "entropy_coeff": 0.001}}, "num_steps_sampled": 368000, "num_steps_trained": 368000}, "done": false, "episodes_total": 368, "training_iteration": 92, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_07-56-06", "timestamp": 1618098966, "time_this_iter_s": 1428.958373785019, "time_total_s": 134992.4243092537, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 134992.4243092537, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 11.591297935103245, "ram_util_percent": 15.864355948869227}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2060.466751119968, "episode_reward_min": -2400.3930255797122, "episode_reward_mean": -2236.067498917226, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2343.6889797631643, -2323.8200481670187, -2254.8053000066843, -2307.9746303234538, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 564.1605123944, "mean_raw_obs_processing_ms": 2.313152174614861, "mean_inference_ms": 115.14089067043933, "mean_action_processing_ms": 0.3670566319001226}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 372000, "timers": {"sample_time_ms": 1340726.635, "sample_throughput": 2.983, "learn_time_ms": 96215.152, "learn_throughput": 41.573, "update_time_ms": 19.605}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.06423882121453062, "policy_loss": -0.018443677545292303, "vf_loss": 725.5765733718872, "vf_explained_var": 0.7977081537246704, "kl": 0.01553226719261147, "entropy": 54.60413360595703, "entropy_coeff": 0.001}}, "num_steps_sampled": 372000, "num_steps_trained": 372000}, "done": false, "episodes_total": 372, "training_iteration": 93, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_08-20-07", "timestamp": 1618100407, "time_this_iter_s": 1440.1183984279633, "time_total_s": 136432.54270768166, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 136432.54270768166, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 11.592780487804879, "ram_util_percent": 15.855317073170735}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2060.466751119968, "episode_reward_min": -2400.3930255797122, "episode_reward_mean": -2232.194169650551, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2400.3930255797122, -2382.7324514074307, -2304.8184492186606, -2349.3308902346753, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 564.0938160450262, "mean_raw_obs_processing_ms": 2.312999628748687, "mean_inference_ms": 115.13186599844929, "mean_action_processing_ms": 0.3671515583908322}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 376000, "timers": {"sample_time_ms": 1341024.533, "sample_throughput": 2.983, "learn_time_ms": 96337.432, "learn_throughput": 41.521, "update_time_ms": 19.787}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.06258591200457886, "policy_loss": -0.015115538670215756, "vf_loss": 554.0675077438354, "vf_explained_var": 0.8477100133895874, "kl": 0.015509070421103388, "entropy": 54.56195247173309, "entropy_coeff": 0.001}}, "num_steps_sampled": 376000, "num_steps_trained": 376000}, "done": false, "episodes_total": 376, "training_iteration": 94, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_08-44-12", "timestamp": 1618101852, "time_this_iter_s": 1445.3645112514496, "time_total_s": 137877.9072189331, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 137877.9072189331, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 11.587651920272242, "ram_util_percent": 15.854788526981043}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2060.466751119968, "episode_reward_min": -2348.525340380264, "episode_reward_mean": -2225.9857996740525, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2327.54415197502, -2293.901486849392, -2336.811748250245, -2265.169348848448, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 564.0072799563341, "mean_raw_obs_processing_ms": 2.312782404296537, "mean_inference_ms": 115.11886415796255, "mean_action_processing_ms": 0.3672254506878525}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 380000, "timers": {"sample_time_ms": 1342663.026, "sample_throughput": 2.979, "learn_time_ms": 95212.3, "learn_throughput": 42.011, "update_time_ms": 20.674}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.06616437993943691, "policy_loss": -0.018509818881284446, "vf_loss": 537.3797101974487, "vf_explained_var": 0.8568249940872192, "kl": 0.01402352494187653, "entropy": 54.4307062625885, "entropy_coeff": 0.001}}, "num_steps_sampled": 380000, "num_steps_trained": 380000}, "done": false, "episodes_total": 380, "training_iteration": 95, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_09-08-06", "timestamp": 1618103286, "time_this_iter_s": 1434.135994195938, "time_total_s": 139312.04321312904, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 139312.04321312904, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 11.58388834476004, "ram_util_percent": 15.85200783545544}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2060.466751119968, "episode_reward_min": -2348.525340380264, "episode_reward_mean": -2221.953923922278, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2278.5681254661094, -2193.923266511244, -2241.961062740584, -2219.5025165594366, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.9006587073912, "mean_raw_obs_processing_ms": 2.3125241682725686, "mean_inference_ms": 115.10430668647332, "mean_action_processing_ms": 0.3672993708176408}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 384000, "timers": {"sample_time_ms": 1342773.426, "sample_throughput": 2.979, "learn_time_ms": 95346.251, "learn_throughput": 41.952, "update_time_ms": 21.78}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.1, "cur_lr": 5e-05, "total_loss": -0.06228525680489838, "policy_loss": -0.015861984516959637, "vf_loss": 563.0943460464478, "vf_explained_var": 0.8623413443565369, "kl": 0.02305750860250555, "entropy": 54.359963178634644, "entropy_coeff": 0.001}}, "num_steps_sampled": 384000, "num_steps_trained": 384000}, "done": false, "episodes_total": 384, "training_iteration": 96, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_09-32-13", "timestamp": 1618104733, "time_this_iter_s": 1446.412441253662, "time_total_s": 140758.4556543827, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 140758.4556543827, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 11.59868804664723, "ram_util_percent": 15.849271137026244}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2060.466751119968, "episode_reward_min": -2348.525340380264, "episode_reward_mean": -2219.5950501459524, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2218.2632486948664, -2257.112929956242, -2277.9500316273366, -2274.919414988604, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.7798904031386, "mean_raw_obs_processing_ms": 2.31222944871332, "mean_inference_ms": 115.08653468904535, "mean_action_processing_ms": 0.3673531577922081}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 388000, "timers": {"sample_time_ms": 1342648.288, "sample_throughput": 2.979, "learn_time_ms": 95661.184, "learn_throughput": 41.814, "update_time_ms": 19.854}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15000000000000002, "cur_lr": 5e-05, "total_loss": -0.05835546203888953, "policy_loss": -0.012988160247914493, "vf_loss": 723.6982731819153, "vf_explained_var": 0.8092809319496155, "kl": 0.017104128724895418, "entropy": 55.16990113258362, "entropy_coeff": 0.001}}, "num_steps_sampled": 388000, "num_steps_trained": 388000}, "done": false, "episodes_total": 388, "training_iteration": 97, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_09-56-13", "timestamp": 1618106173, "time_this_iter_s": 1440.55068898201, "time_total_s": 142199.00634336472, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 142199.00634336472, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 11.604485616772306, "ram_util_percent": 15.850365675280356}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2060.466751119968, "episode_reward_min": -2348.525340380264, "episode_reward_mean": -2217.6466234106356, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2298.3628938178117, -2348.525340380264, -2296.9938708649015, -2325.696392125728, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.6547757489232, "mean_raw_obs_processing_ms": 2.312039077598709, "mean_inference_ms": 115.06920232524506, "mean_action_processing_ms": 0.36742045719962024}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 392000, "timers": {"sample_time_ms": 1342340.081, "sample_throughput": 2.98, "learn_time_ms": 96573.48, "learn_throughput": 41.419, "update_time_ms": 22.178}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15000000000000002, "cur_lr": 5e-05, "total_loss": -0.055099091317970306, "policy_loss": -0.009949791652616113, "vf_loss": 722.1315746307373, "vf_explained_var": 0.8211020231246948, "kl": 0.012503056932473555, "entropy": 54.24607229232788, "entropy_coeff": 0.001}}, "num_steps_sampled": 392000, "num_steps_trained": 392000}, "done": false, "episodes_total": 392, "training_iteration": 98, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_10-20-12", "timestamp": 1618107612, "time_this_iter_s": 1439.0000367164612, "time_total_s": 143638.00638008118, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 143638.00638008118, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 11.6015625, "ram_util_percent": 15.856103515625005}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2060.466751119968, "episode_reward_min": -2326.268143369884, "episode_reward_mean": -2210.4271245255095, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2303.947066416075, -2228.486828611294, -2235.958429908347, -2167.9225109283075, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.530986026876, "mean_raw_obs_processing_ms": 2.3118668997744196, "mean_inference_ms": 115.05168833282991, "mean_action_processing_ms": 0.3674594158258848}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 396000, "timers": {"sample_time_ms": 1341683.675, "sample_throughput": 2.981, "learn_time_ms": 96685.501, "learn_throughput": 41.371, "update_time_ms": 22.781}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15000000000000002, "cur_lr": 5e-05, "total_loss": -0.06016538105905056, "policy_loss": -0.018209199712146074, "vf_loss": 1101.3110837936401, "vf_explained_var": 0.7403231263160706, "kl": 0.012473071517888457, "entropy": 54.840252161026, "entropy_coeff": 0.001}}, "num_steps_sampled": 396000, "num_steps_trained": 396000}, "done": false, "episodes_total": 396, "training_iteration": 99, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_10-44-02", "timestamp": 1618109042, "time_this_iter_s": 1429.7469663619995, "time_total_s": 145067.75334644318, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 145067.75334644318, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 11.600785854616895, "ram_util_percent": 15.858889980353638}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2060.466751119968, "episode_reward_min": -2326.268143369884, "episode_reward_mean": -2207.144517101793, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2276.1442415849347, -2282.0568321508613, -2326.268143369884, -2266.8204327525123, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.4082802026738, "mean_raw_obs_processing_ms": 2.3116208025233114, "mean_inference_ms": 115.03530448796974, "mean_action_processing_ms": 0.36750211224079093}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 400000, "timers": {"sample_time_ms": 1341781.9, "sample_throughput": 2.981, "learn_time_ms": 96142.715, "learn_throughput": 41.605, "update_time_ms": 22.272}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15000000000000002, "cur_lr": 5e-05, "total_loss": -0.0626145742717199, "policy_loss": -0.01791050992324017, "vf_loss": 826.6873664855957, "vf_explained_var": 0.8106675148010254, "kl": 0.012905356619739905, "entropy": 54.90673756599426, "entropy_coeff": 0.001}}, "num_steps_sampled": 400000, "num_steps_trained": 400000}, "done": false, "episodes_total": 400, "training_iteration": 100, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_11-07-59", "timestamp": 1618110479, "time_this_iter_s": 1436.6816585063934, "time_total_s": 146504.43500494957, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 146504.43500494957, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 11.600146699266505, "ram_util_percent": 15.861320293398537}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2060.466751119968, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2205.771067428813, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2309.5482540190446, -2296.727305570842, -2295.2240037727643, -2265.2766471736063, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.2892439089724, "mean_raw_obs_processing_ms": 2.3113699957240423, "mean_inference_ms": 115.01951479297027, "mean_action_processing_ms": 0.3675537766903363}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 404000, "timers": {"sample_time_ms": 1342505.545, "sample_throughput": 2.98, "learn_time_ms": 96334.147, "learn_throughput": 41.522, "update_time_ms": 22.284}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15000000000000002, "cur_lr": 5e-05, "total_loss": -0.05731727520469576, "policy_loss": -0.010003278963267803, "vf_loss": 510.9117097854614, "vf_explained_var": 0.8693910837173462, "kl": 0.013101368822390214, "entropy": 54.38831627368927, "entropy_coeff": 0.001}}, "num_steps_sampled": 404000, "num_steps_trained": 404000}, "done": false, "episodes_total": 404, "training_iteration": 101, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_11-32-06", "timestamp": 1618111926, "time_this_iter_s": 1447.7314410209656, "time_total_s": 147952.16644597054, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 147952.16644597054, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 11.596166909267344, "ram_util_percent": 15.866035904900539}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2060.466751119968, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2201.6275797534727, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2271.1635314956793, -2256.6764544249, -2302.1753711064766, -2301.9288115529253, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.1707993895981, "mean_raw_obs_processing_ms": 2.311096917952035, "mean_inference_ms": 115.00475366742889, "mean_action_processing_ms": 0.3676007106391218}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 408000, "timers": {"sample_time_ms": 1343186.568, "sample_throughput": 2.978, "learn_time_ms": 95333.457, "learn_throughput": 41.958, "update_time_ms": 24.068}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15000000000000002, "cur_lr": 5e-05, "total_loss": -0.06711518199881539, "policy_loss": -0.020794609445147216, "vf_loss": 633.5292854309082, "vf_explained_var": 0.8505619764328003, "kl": 0.016271723492536694, "entropy": 55.096622824668884, "entropy_coeff": 0.001}}, "num_steps_sampled": 408000, "num_steps_trained": 408000}, "done": false, "episodes_total": 408, "training_iteration": 102, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_11-55-52", "timestamp": 1618113352, "time_this_iter_s": 1425.7794806957245, "time_total_s": 149377.94592666626, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 149377.94592666626, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 11.606456382454411, "ram_util_percent": 15.858551010349931}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2060.466751119968, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2197.3907815781668, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2244.3603366495313, -2255.1182898396614, -2291.0231497050386, -2268.4339667868917, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.0563589728363, "mean_raw_obs_processing_ms": 2.3108564836064973, "mean_inference_ms": 114.99038830842548, "mean_action_processing_ms": 0.3675991362989204}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 412000, "timers": {"sample_time_ms": 1343152.865, "sample_throughput": 2.978, "learn_time_ms": 95441.021, "learn_throughput": 41.911, "update_time_ms": 22.225}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15000000000000002, "cur_lr": 5e-05, "total_loss": -0.06893027242040262, "policy_loss": -0.02589537011226639, "vf_loss": 1006.7974109649658, "vf_explained_var": 0.7810443639755249, "kl": 0.014406966714886948, "entropy": 55.26391673088074, "entropy_coeff": 0.001}}, "num_steps_sampled": 412000, "num_steps_trained": 412000}, "done": false, "episodes_total": 412, "training_iteration": 103, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_12-19-53", "timestamp": 1618114793, "time_this_iter_s": 1440.8385572433472, "time_total_s": 150818.7844839096, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 150818.7844839096, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 11.625743539736714, "ram_util_percent": 15.850365675280356}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2053.1720945431534, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2191.902925906433, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2252.4385841567573, -2299.2057165394913, -2289.6878421380616, -2273.549775136572, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.9436076177577, "mean_raw_obs_processing_ms": 2.310611637625435, "mean_inference_ms": 114.97640398500138, "mean_action_processing_ms": 0.3675950867227705}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 416000, "timers": {"sample_time_ms": 1342855.649, "sample_throughput": 2.979, "learn_time_ms": 95617.384, "learn_throughput": 41.833, "update_time_ms": 22.621}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15000000000000002, "cur_lr": 5e-05, "total_loss": -0.05694689764641225, "policy_loss": -0.010040294553618878, "vf_loss": 483.3196153640747, "vf_explained_var": 0.8698962926864624, "kl": 0.023886265844339505, "entropy": 55.32273554801941, "entropy_coeff": 0.001}}, "num_steps_sampled": 416000, "num_steps_trained": 416000}, "done": false, "episodes_total": 416, "training_iteration": 104, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_12-43-57", "timestamp": 1618116237, "time_this_iter_s": 1444.1599526405334, "time_total_s": 152262.94443655014, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 152262.94443655014, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 11.600243190661478, "ram_util_percent": 15.851021400778214}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2053.1720945431534, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2187.592191854427, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2234.7961224459455, -2269.553764006891, -2211.2212935254515, -2214.078145744444, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.8312463091638, "mean_raw_obs_processing_ms": 2.3104321763690097, "mean_inference_ms": 114.96294595974807, "mean_action_processing_ms": 0.36760176501838543}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 420000, "timers": {"sample_time_ms": 1342010.041, "sample_throughput": 2.981, "learn_time_ms": 96500.612, "learn_throughput": 41.451, "update_time_ms": 20.93}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.05548612051643431, "policy_loss": -0.010107419861014932, "vf_loss": 750.5464639663696, "vf_explained_var": 0.8286547660827637, "kl": 0.014314988569822162, "entropy": 56.105035066604614, "entropy_coeff": 0.001}}, "num_steps_sampled": 420000, "num_steps_trained": 420000}, "done": false, "episodes_total": 420, "training_iteration": 105, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_13-07-52", "timestamp": 1618117672, "time_this_iter_s": 1434.4952964782715, "time_total_s": 153697.4397330284, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 153697.4397330284, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 11.59515181194907, "ram_util_percent": 15.856317335945155}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2053.1720945431534, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2186.188915936068, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2223.840604342372, -2245.595834225783, -2189.1076662056753, -2288.239792841812, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.7193725628392, "mean_raw_obs_processing_ms": 2.3102359150053773, "mean_inference_ms": 114.9492858371478, "mean_action_processing_ms": 0.3676499018799646}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 424000, "timers": {"sample_time_ms": 1340240.817, "sample_throughput": 2.985, "learn_time_ms": 96679.738, "learn_throughput": 41.374, "update_time_ms": 20.054}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06039847596548498, "policy_loss": -0.013423237454844639, "vf_loss": 530.0409731864929, "vf_explained_var": 0.8683817386627197, "kl": 0.015481706970604137, "entropy": 55.7590309381485, "entropy_coeff": 0.001}}, "num_steps_sampled": 424000, "num_steps_trained": 424000}, "done": false, "episodes_total": 424, "training_iteration": 106, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_13-31-42", "timestamp": 1618119102, "time_this_iter_s": 1430.5111496448517, "time_total_s": 155127.95088267326, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 155127.95088267326, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 11.602454590083456, "ram_util_percent": 15.86278841433481}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2053.1720945431534, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2181.614631101104, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2147.2959800520007, -2182.0701524113842, -2203.5388349977993, -2250.2730181555953, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.6085253978133, "mean_raw_obs_processing_ms": 2.310000816599773, "mean_inference_ms": 114.93626568460064, "mean_action_processing_ms": 0.36765390282224286}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 428000, "timers": {"sample_time_ms": 1340374.678, "sample_throughput": 2.984, "learn_time_ms": 96259.569, "learn_throughput": 41.554, "update_time_ms": 20.98}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06789241085061803, "policy_loss": -0.019393014896195382, "vf_loss": 556.0715937614441, "vf_explained_var": 0.8606683611869812, "kl": 0.009719351175590418, "entropy": 56.24696433544159, "entropy_coeff": 0.001}}, "num_steps_sampled": 428000, "num_steps_trained": 428000}, "done": false, "episodes_total": 428, "training_iteration": 107, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_13-55-40", "timestamp": 1618120540, "time_this_iter_s": 1437.6970119476318, "time_total_s": 156565.6478946209, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 156565.6478946209, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 11.612267839687194, "ram_util_percent": 15.865395894428156}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2053.1720945431534, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2178.2406613596804, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2245.865404124884, -2166.655219408012, -2224.758818015788, -2178.895210491182, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.4999475982091, "mean_raw_obs_processing_ms": 2.3098335578510567, "mean_inference_ms": 114.92309139522975, "mean_action_processing_ms": 0.3676917189614029}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 432000, "timers": {"sample_time_ms": 1340461.563, "sample_throughput": 2.984, "learn_time_ms": 96449.472, "learn_throughput": 41.472, "update_time_ms": 18.048}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.059290742268785834, "policy_loss": -0.010203178186202422, "vf_loss": 536.3190155029297, "vf_explained_var": 0.8584041595458984, "kl": 0.009927038248861209, "entropy": 56.68433475494385, "entropy_coeff": 0.001}}, "num_steps_sampled": 432000, "num_steps_trained": 432000}, "done": false, "episodes_total": 432, "training_iteration": 108, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_14-19-42", "timestamp": 1618121982, "time_this_iter_s": 1441.73872423172, "time_total_s": 158007.38661885262, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 158007.38661885262, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 11.601315789473684, "ram_util_percent": 15.869785575048738}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2044.2574753108356, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2173.2906449812585, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2186.3995664889153, -2192.1657771811515, -2282.7735390207795, -2124.9929376211167, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.3931527011702, "mean_raw_obs_processing_ms": 2.309634159501754, "mean_inference_ms": 114.9097731270907, "mean_action_processing_ms": 0.36772810544690643}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 436000, "timers": {"sample_time_ms": 1341279.37, "sample_throughput": 2.982, "learn_time_ms": 95440.737, "learn_throughput": 41.911, "update_time_ms": 18.586}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.05887821939541027, "policy_loss": -0.012701874307822436, "vf_loss": 763.6456832885742, "vf_explained_var": 0.8127585053443909, "kl": 0.015043568215332925, "entropy": 57.19760346412659, "entropy_coeff": 0.001}}, "num_steps_sampled": 436000, "num_steps_trained": 436000}, "done": false, "episodes_total": 436, "training_iteration": 109, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_14-43-30", "timestamp": 1618123410, "time_this_iter_s": 1427.8429563045502, "time_total_s": 159435.22957515717, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 159435.22957515717, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 11.614074803149608, "ram_util_percent": 15.862204724409452}, "trial_id": "d606b_00000"}
{"episode_reward_max": -2038.5468429085681, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2168.6178401580155, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2235.581261479858, -2128.4176730189874, -2132.1991876581465, -2142.8253593469217, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.2901546044209, "mean_raw_obs_processing_ms": 2.309446241169086, "mean_inference_ms": 114.89718511537562, "mean_action_processing_ms": 0.36773869878005244}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 440000, "timers": {"sample_time_ms": 1340835.591, "sample_throughput": 2.983, "learn_time_ms": 95580.65, "learn_throughput": 41.849, "update_time_ms": 18.438}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.069567987753544, "policy_loss": -0.02132771906326525, "vf_loss": 639.5253343582153, "vf_explained_var": 0.8293936252593994, "kl": 0.012823963654227555, "entropy": 57.52091038227081, "entropy_coeff": 0.001}}, "num_steps_sampled": 440000, "num_steps_trained": 440000}, "done": false, "episodes_total": 440, "training_iteration": 110, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_15-07-24", "timestamp": 1618124844, "time_this_iter_s": 1433.641666173935, "time_total_s": 160868.8712413311, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 160868.8712413311, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 11.616315531602156, "ram_util_percent": 15.855169034786874}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1954.4305997981567, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2164.0586706455124, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2206.742431190309, -2177.1910570309833, -2191.417811349728, -2140.181919698787, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.188388129655, "mean_raw_obs_processing_ms": 2.3093269585075316, "mean_inference_ms": 114.88355476178629, "mean_action_processing_ms": 0.36771425356837284}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 444000, "timers": {"sample_time_ms": 1339406.898, "sample_throughput": 2.986, "learn_time_ms": 95889.366, "learn_throughput": 41.715, "update_time_ms": 19.378}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0626800870813895, "policy_loss": -0.012531214335467666, "vf_loss": 414.8479702472687, "vf_explained_var": 0.8666098117828369, "kl": 0.013659888238180429, "entropy": 57.37082660198212, "entropy_coeff": 0.001}}, "num_steps_sampled": 444000, "num_steps_trained": 444000}, "done": false, "episodes_total": 444, "training_iteration": 111, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_15-31-20", "timestamp": 1618126280, "time_this_iter_s": 1436.541169166565, "time_total_s": 162305.41241049767, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 162305.41241049767, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 11.600293398533006, "ram_util_percent": 15.86826405867971}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1954.4305997981567, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2160.3509758813584, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2191.398391286301, -2208.853586859608, -2157.225034325017, -2248.0469523798224, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.0881641274898, "mean_raw_obs_processing_ms": 2.3091753688373213, "mean_inference_ms": 114.87024120355049, "mean_action_processing_ms": 0.3676885115499825}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 448000, "timers": {"sample_time_ms": 1339782.439, "sample_throughput": 2.986, "learn_time_ms": 96691.09, "learn_throughput": 41.369, "update_time_ms": 18.703}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.05523265461670235, "policy_loss": -0.005744059075368568, "vf_loss": 483.31081104278564, "vf_explained_var": 0.864236056804657, "kl": 0.016989962168736383, "entropy": 58.14444386959076, "entropy_coeff": 0.001}}, "num_steps_sampled": 448000, "num_steps_trained": 448000}, "done": false, "episodes_total": 448, "training_iteration": 112, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_15-55-18", "timestamp": 1618127718, "time_this_iter_s": 1437.5454790592194, "time_total_s": 163742.95788955688, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 163742.95788955688, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 11.597653958944283, "ram_util_percent": 15.863636363636367}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1954.4305997981567, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2155.1773868191613, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2182.8023507429025, -2234.474790367102, -2196.1848511856238, -2199.0308752855285, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.9887913270487, "mean_raw_obs_processing_ms": 2.3090135549083692, "mean_inference_ms": 114.85680994247559, "mean_action_processing_ms": 0.36760032469370046}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 452000, "timers": {"sample_time_ms": 1338804.027, "sample_throughput": 2.988, "learn_time_ms": 96859.976, "learn_throughput": 41.297, "update_time_ms": 19.062}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06327955587767065, "policy_loss": -0.01301833993056789, "vf_loss": 523.6565847396851, "vf_explained_var": 0.8391832709312439, "kl": 0.00983443581208121, "entropy": 57.71052825450897, "entropy_coeff": 0.001}}, "num_steps_sampled": 452000, "num_steps_trained": 452000}, "done": false, "episodes_total": 452, "training_iteration": 113, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_16-19-10", "timestamp": 1618129150, "time_this_iter_s": 1432.7470638751984, "time_total_s": 165175.70495343208, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 165175.70495343208, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 11.624607843137253, "ram_util_percent": 15.864901960784316}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1954.4305997981567, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2148.7980094803042, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2297.672065490899, -2203.8824742965085, -2150.5147168824647, -2205.1320053069503, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.8905510923444, "mean_raw_obs_processing_ms": 2.308833634174288, "mean_inference_ms": 114.8437431267463, "mean_action_processing_ms": 0.36751464833402225}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 456000, "timers": {"sample_time_ms": 1337436.18, "sample_throughput": 2.991, "learn_time_ms": 96545.629, "learn_throughput": 41.431, "update_time_ms": 17.642}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.058034210407640785, "policy_loss": -0.0102732514787931, "vf_loss": 745.3170986175537, "vf_explained_var": 0.8123806118965149, "kl": 0.01446262450190261, "entropy": 58.46821653842926, "entropy_coeff": 0.001}}, "num_steps_sampled": 456000, "num_steps_trained": 456000}, "done": false, "episodes_total": 456, "training_iteration": 114, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_16-42-58", "timestamp": 1618130578, "time_this_iter_s": 1427.3236000537872, "time_total_s": 166603.02855348587, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 166603.02855348587, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 11.598228346456692, "ram_util_percent": 15.863484251968506}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1954.4305997981567, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2141.3620983282003, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2121.385120597298, -2158.609535519681, -2207.171683340329, -2135.8599600315515, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.7949989285103, "mean_raw_obs_processing_ms": 2.3086725260919567, "mean_inference_ms": 114.8310562080973, "mean_action_processing_ms": 0.3674477440061141}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 460000, "timers": {"sample_time_ms": 1337866.399, "sample_throughput": 2.99, "learn_time_ms": 96722.406, "learn_throughput": 41.355, "update_time_ms": 17.272}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06532680947566405, "policy_loss": -0.015851716976612806, "vf_loss": 481.6830177307129, "vf_explained_var": 0.8429557085037231, "kl": 0.015402260352857411, "entropy": 57.757426381111145, "entropy_coeff": 0.001}}, "num_steps_sampled": 460000, "num_steps_trained": 460000}, "done": false, "episodes_total": 460, "training_iteration": 115, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_17-06-58", "timestamp": 1618132018, "time_this_iter_s": 1440.5616436004639, "time_total_s": 168043.59019708633, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 168043.59019708633, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 11.609800097513409, "ram_util_percent": 15.858605558264266}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1954.4305997981567, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2137.502039615871, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2085.7432545262373, -2155.728257869317, -2160.1122072881494, -2180.8676047273275, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.699254124226, "mean_raw_obs_processing_ms": 2.308495717026631, "mean_inference_ms": 114.81924391469755, "mean_action_processing_ms": 0.3673662277040614}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 464000, "timers": {"sample_time_ms": 1338341.09, "sample_throughput": 2.989, "learn_time_ms": 95618.518, "learn_throughput": 41.833, "update_time_ms": 18.439}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06524889200227335, "policy_loss": -0.013901644328143448, "vf_loss": 375.982008934021, "vf_explained_var": 0.8908673524856567, "kl": 0.009229613613570109, "entropy": 57.18372964859009, "entropy_coeff": 0.001}}, "num_steps_sampled": 464000, "num_steps_trained": 464000}, "done": false, "episodes_total": 464, "training_iteration": 116, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_17-30-43", "timestamp": 1618133443, "time_this_iter_s": 1424.2374892234802, "time_total_s": 169467.8276863098, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 169467.8276863098, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 11.605574740996547, "ram_util_percent": 15.867143561914165}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1954.4305997981567, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2135.2654328762746, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -2186.1187526278804, -2163.243050706483, -2060.466751119968, -2216.639106731505, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.6068912560036, "mean_raw_obs_processing_ms": 2.3082947415604873, "mean_inference_ms": 114.80889096206457, "mean_action_processing_ms": 0.3672513514904903}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 468000, "timers": {"sample_time_ms": 1338557.316, "sample_throughput": 2.988, "learn_time_ms": 95706.148, "learn_throughput": 41.795, "update_time_ms": 18.222}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0679829255095683, "policy_loss": -0.018847779894713312, "vf_loss": 468.88018321990967, "vf_explained_var": 0.8603414297103882, "kl": 0.013172902254154906, "entropy": 56.78785300254822, "entropy_coeff": 0.001}}, "num_steps_sampled": 468000, "num_steps_trained": 468000}, "done": false, "episodes_total": 468, "training_iteration": 117, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_17-54-43", "timestamp": 1618134883, "time_this_iter_s": 1440.7332971096039, "time_total_s": 170908.56098341942, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 170908.56098341942, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 11.602876645538762, "ram_util_percent": 15.854656265236475}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1954.4305997981567, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2131.373710602947, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2222.877726512565, -2217.6307797560535, -2210.701923559301, -2191.7456017648797, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.5145696982275, "mean_raw_obs_processing_ms": 2.3081033801302406, "mean_inference_ms": 114.79936989146816, "mean_action_processing_ms": 0.36716279671069996}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 472000, "timers": {"sample_time_ms": 1338190.255, "sample_throughput": 2.989, "learn_time_ms": 96073.641, "learn_throughput": 41.635, "update_time_ms": 19.039}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06633102806517854, "policy_loss": -0.017111835710238665, "vf_loss": 540.9643025398254, "vf_explained_var": 0.8488484621047974, "kl": 0.010901761925197206, "entropy": 57.081727147102356, "entropy_coeff": 0.001}}, "num_steps_sampled": 472000, "num_steps_trained": 472000}, "done": false, "episodes_total": 472, "training_iteration": 118, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_18-18-45", "timestamp": 1618136325, "time_this_iter_s": 1441.7511348724365, "time_total_s": 172350.31211829185, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 172350.31211829185, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 11.747222222222222, "ram_util_percent": 15.868323586744644}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1954.4305997981567, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2125.6087413329083, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2235.658306400384, -2235.649200706675, -2168.793073999396, -2176.3372376841576, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.4229683783476, "mean_raw_obs_processing_ms": 2.3079575908315495, "mean_inference_ms": 114.78991483199701, "mean_action_processing_ms": 0.36704163780186894}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 476000, "timers": {"sample_time_ms": 1338363.541, "sample_throughput": 2.989, "learn_time_ms": 96850.075, "learn_throughput": 41.301, "update_time_ms": 19.415}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06395285436883569, "policy_loss": -0.01314816891681403, "vf_loss": 450.9629843235016, "vf_explained_var": 0.8801184892654419, "kl": 0.010643662244547158, "entropy": 57.70913529396057, "entropy_coeff": 0.001}}, "num_steps_sampled": 476000, "num_steps_trained": 476000}, "done": false, "episodes_total": 476, "training_iteration": 119, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_18-42-43", "timestamp": 1618137763, "time_this_iter_s": 1437.3442168235779, "time_total_s": 173787.65633511543, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 173787.65633511543, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 11.915925744992673, "ram_util_percent": 15.915290669272109}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1915.1868332066877, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2119.1697004993107, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2166.005663218545, -2290.3638025278938, -2203.4421281091945, -2160.42756689008, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.3311175454274, "mean_raw_obs_processing_ms": 2.3078302561261355, "mean_inference_ms": 114.78013816713806, "mean_action_processing_ms": 0.366881509076827}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 480000, "timers": {"sample_time_ms": 1337845.878, "sample_throughput": 2.99, "learn_time_ms": 97047.786, "learn_throughput": 41.217, "update_time_ms": 19.312}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.05952668987447396, "policy_loss": -0.009111892926739529, "vf_loss": 489.90318536758423, "vf_explained_var": 0.8596221804618835, "kl": 0.011858195750392042, "entropy": 57.98192286491394, "entropy_coeff": 0.001}}, "num_steps_sampled": 480000, "num_steps_trained": 480000}, "done": false, "episodes_total": 480, "training_iteration": 120, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_19-06-33", "timestamp": 1618139193, "time_this_iter_s": 1430.4409673213959, "time_total_s": 175218.09730243683, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 175218.09730243683, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 11.894646365422396, "ram_util_percent": 15.912131630648332}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1915.1868332066877, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2110.529720337494, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -2157.903971594808, -2125.81547239318, -2186.6856180303066, -2227.6625316264144, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.2396621944395, "mean_raw_obs_processing_ms": 2.3077316340004974, "mean_inference_ms": 114.76984986708335, "mean_action_processing_ms": 0.36672964436635175}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 484000, "timers": {"sample_time_ms": 1338303.57, "sample_throughput": 2.989, "learn_time_ms": 96624.635, "learn_throughput": 41.397, "update_time_ms": 18.662}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06278291305352468, "policy_loss": -0.01582081420929171, "vf_loss": 734.7143096923828, "vf_explained_var": 0.803192675113678, "kl": 0.013679721509106457, "entropy": 57.387176513671875, "entropy_coeff": 0.001}}, "num_steps_sampled": 484000, "num_steps_trained": 484000}, "done": false, "episodes_total": 484, "training_iteration": 121, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_19-30-30", "timestamp": 1618140630, "time_this_iter_s": 1436.8802547454834, "time_total_s": 176654.9775571823, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 176654.9775571823, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 11.897066014669926, "ram_util_percent": 15.908459657701716}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1915.1868332066877, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2103.4115354911573, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2163.298056480328, -2135.9936830051665, -2271.991422140026, -2262.119790109861, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.1490033742572, "mean_raw_obs_processing_ms": 2.307611170234209, "mean_inference_ms": 114.76002923614597, "mean_action_processing_ms": 0.3665781527574309}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 488000, "timers": {"sample_time_ms": 1338360.812, "sample_throughput": 2.989, "learn_time_ms": 96731.292, "learn_throughput": 41.352, "update_time_ms": 19.019}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0637596741435118, "policy_loss": -0.017566316906595603, "vf_loss": 927.1856546401978, "vf_explained_var": 0.7662229537963867, "kl": 0.010516208945773542, "entropy": 57.83135664463043, "entropy_coeff": 0.001}}, "num_steps_sampled": 488000, "num_steps_trained": 488000}, "done": false, "episodes_total": 488, "training_iteration": 122, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_19-54-29", "timestamp": 1618142069, "time_this_iter_s": 1439.1880509853363, "time_total_s": 178094.16560816765, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 178094.16560816765, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 11.90214738897023, "ram_util_percent": 15.920351390922406}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1915.1868332066877, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2094.928401896189, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -2083.0287103978703, -2145.408539087773, -2159.6832872854825, -2159.5080719050034, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.0592157544369, "mean_raw_obs_processing_ms": 2.3074340670913305, "mean_inference_ms": 114.75019846548359, "mean_action_processing_ms": 0.36645564973018374}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 492000, "timers": {"sample_time_ms": 1338762.91, "sample_throughput": 2.988, "learn_time_ms": 95693.842, "learn_throughput": 41.8, "update_time_ms": 22.11}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07201452041044831, "policy_loss": -0.022624559642281383, "vf_loss": 394.1120491027832, "vf_explained_var": 0.8749649524688721, "kl": 0.01592903072014451, "entropy": 56.91511034965515, "entropy_coeff": 0.001}}, "num_steps_sampled": 492000, "num_steps_trained": 492000}, "done": false, "episodes_total": 492, "training_iteration": 123, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_20-18-16", "timestamp": 1618143496, "time_this_iter_s": 1426.4244229793549, "time_total_s": 179520.590031147, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 179520.590031147, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 11.921822660098522, "ram_util_percent": 15.915714285714289}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1915.1868332066877, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2088.6990053008803, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -2115.8784729367208, -2154.867568211532, -2174.960705798288, -2162.3473465458355, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.9726535338846, "mean_raw_obs_processing_ms": 2.307252541367658, "mean_inference_ms": 114.74132032679245, "mean_action_processing_ms": 0.3663451585106272}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 496000, "timers": {"sample_time_ms": 1340097.787, "sample_throughput": 2.985, "learn_time_ms": 95799.876, "learn_throughput": 41.754, "update_time_ms": 22.762}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07194423192413524, "policy_loss": -0.021241908485535532, "vf_loss": 437.46808338165283, "vf_explained_var": 0.8513864278793335, "kl": 0.012603322800714523, "entropy": 57.91275155544281, "entropy_coeff": 0.001}}, "num_steps_sampled": 496000, "num_steps_trained": 496000}, "done": false, "episodes_total": 496, "training_iteration": 124, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_20-42-17", "timestamp": 1618144937, "time_this_iter_s": 1441.7394194602966, "time_total_s": 180962.3294506073, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 180962.3294506073, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 11.894349732099366, "ram_util_percent": 15.907549926936195}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1915.1868332066877, "episode_reward_min": -2322.216625906544, "episode_reward_mean": -2082.983619187579, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -2218.390399012767, -2218.3102958402274, -2255.027361800638, -2322.216625906544, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.8873138861754, "mean_raw_obs_processing_ms": 2.3071138516845013, "mean_inference_ms": 114.73226331961712, "mean_action_processing_ms": 0.3662387921497613}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 500000, "timers": {"sample_time_ms": 1339689.265, "sample_throughput": 2.986, "learn_time_ms": 96102.646, "learn_throughput": 41.622, "update_time_ms": 23.888}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.057389679190237075, "policy_loss": -0.009768440155312419, "vf_loss": 719.4618282318115, "vf_explained_var": 0.7683371305465698, "kl": 0.013590194168500602, "entropy": 57.87364614009857, "entropy_coeff": 0.001}}, "num_steps_sampled": 500000, "num_steps_trained": 500000}, "done": false, "episodes_total": 500, "training_iteration": 125, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_21-06-17", "timestamp": 1618146377, "time_this_iter_s": 1439.5313584804535, "time_total_s": 182401.86080908775, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 182401.86080908775, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 11.916154221571498, "ram_util_percent": 15.913958028306494}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1915.1868332066877, "episode_reward_min": -2238.2680831463285, "episode_reward_mean": -2072.0277163623095, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2237.6747022716822, -2207.134696478475, -2134.658909617725, -2172.959134634301, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.8015036842045, "mean_raw_obs_processing_ms": 2.307005386131077, "mean_inference_ms": 114.72314036177602, "mean_action_processing_ms": 0.3661615377509531}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 504000, "timers": {"sample_time_ms": 1339855.687, "sample_throughput": 2.985, "learn_time_ms": 96952.554, "learn_throughput": 41.257, "update_time_ms": 23.677}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0684246244491078, "policy_loss": -0.01884978823363781, "vf_loss": 661.5538053512573, "vf_explained_var": 0.8176382184028625, "kl": 0.012697298167040572, "entropy": 59.0472617149353, "entropy_coeff": 0.001}}, "num_steps_sampled": 504000, "num_steps_trained": 504000}, "done": false, "episodes_total": 504, "training_iteration": 126, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_21-30-11", "timestamp": 1618147811, "time_this_iter_s": 1434.3835599422455, "time_total_s": 183836.24436903, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 183836.24436903, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 11.90073457394711, "ram_util_percent": 15.919833496571991}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1889.441624582864, "episode_reward_min": -2238.2680831463285, "episode_reward_mean": -2064.293729174318, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2158.0705377394693, -2184.7658878020425, -2127.1598423616156, -2238.2680831463285, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.7169043728237, "mean_raw_obs_processing_ms": 2.306918919929254, "mean_inference_ms": 114.71381186032332, "mean_action_processing_ms": 0.36608555583728125}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 508000, "timers": {"sample_time_ms": 1338526.253, "sample_throughput": 2.988, "learn_time_ms": 97114.317, "learn_throughput": 41.189, "update_time_ms": 23.76}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06132939556846395, "policy_loss": -0.010347292409278452, "vf_loss": 356.89443492889404, "vf_explained_var": 0.8900551199913025, "kl": 0.016486554348375648, "entropy": 58.26051878929138, "entropy_coeff": 0.001}}, "num_steps_sampled": 508000, "num_steps_trained": 508000}, "done": false, "episodes_total": 508, "training_iteration": 127, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_21-54-01", "timestamp": 1618149241, "time_this_iter_s": 1429.0575048923492, "time_total_s": 185265.30187392235, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 185265.30187392235, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 11.911996066863324, "ram_util_percent": 15.912291052114066}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1889.441624582864, "episode_reward_min": -2213.904665411548, "episode_reward_mean": -2057.5543248036506, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2172.7891502402967, -2182.079941322372, -2053.1720945431534, -2102.108989701961, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.6334303750768, "mean_raw_obs_processing_ms": 2.3068050303451466, "mean_inference_ms": 114.70475506637696, "mean_action_processing_ms": 0.3660291172062188}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 512000, "timers": {"sample_time_ms": 1338908.506, "sample_throughput": 2.988, "learn_time_ms": 96779.565, "learn_throughput": 41.331, "update_time_ms": 23.92}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06165249604964629, "policy_loss": -0.010494568559806794, "vf_loss": 368.8360433578491, "vf_explained_var": 0.8777785301208496, "kl": 0.015976840077200904, "entropy": 58.441075801849365, "entropy_coeff": 0.001}}, "num_steps_sampled": 512000, "num_steps_trained": 512000}, "done": false, "episodes_total": 512, "training_iteration": 128, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_22-18-03", "timestamp": 1618150683, "time_this_iter_s": 1442.2279033660889, "time_total_s": 186707.52977728844, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 186707.52977728844, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 12.347540185094983, "ram_util_percent": 15.94603019970775}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1889.441624582864, "episode_reward_min": -2213.904665411548, "episode_reward_mean": -2051.6165976728357, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -2149.7848189012466, -2202.742834576322, -2159.930296779443, -2171.350562513188, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.5556668110188, "mean_raw_obs_processing_ms": 2.306706135730889, "mean_inference_ms": 114.69682531918419, "mean_action_processing_ms": 0.3659708789152541}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 516000, "timers": {"sample_time_ms": 1342764.935, "sample_throughput": 2.979, "learn_time_ms": 99709.125, "learn_throughput": 40.117, "update_time_ms": 23.259}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.061527865123935044, "policy_loss": -0.010837929556146264, "vf_loss": 327.5851011276245, "vf_explained_var": 0.879912257194519, "kl": 0.014094731188379228, "entropy": 57.13709998130798, "entropy_coeff": 0.001}}, "num_steps_sampled": 516000, "num_steps_trained": 516000}, "done": false, "episodes_total": 516, "training_iteration": 129, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_22-43-08", "timestamp": 1618152188, "time_this_iter_s": 1505.19775223732, "time_total_s": 188212.72752952576, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 188212.72752952576, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 16.730999066293183, "ram_util_percent": 18.883426704014937}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1889.441624582864, "episode_reward_min": -2213.904665411548, "episode_reward_mean": -2044.1065168991522, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -2199.5298917153673, -2213.904665411548, -2173.233335402332, -2202.653841357627, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.4863112204442, "mean_raw_obs_processing_ms": 2.3065635805258893, "mean_inference_ms": 114.69038800064703, "mean_action_processing_ms": 0.3659341902116953}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 520000, "timers": {"sample_time_ms": 1348948.893, "sample_throughput": 2.965, "learn_time_ms": 101316.139, "learn_throughput": 39.48, "update_time_ms": 23.336}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06531930016353726, "policy_loss": -0.014623195631429553, "vf_loss": 356.51294779777527, "vf_explained_var": 0.8819569945335388, "kl": 0.011917130497749895, "entropy": 56.94258427619934, "entropy_coeff": 0.001}}, "num_steps_sampled": 520000, "num_steps_trained": 520000}, "done": false, "episodes_total": 520, "training_iteration": 130, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_23-08-16", "timestamp": 1618153696, "time_this_iter_s": 1508.3535554409027, "time_total_s": 189721.08108496666, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 189721.08108496666, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 23.107172799254773, "ram_util_percent": 22.49795062878435}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1889.441624582864, "episode_reward_min": -2152.141199278178, "episode_reward_mean": -2035.7573523044264, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -2149.372692407655, -2122.545794399929, -2093.2603525210425, -2124.176574790649, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.4263533592838, "mean_raw_obs_processing_ms": 2.306440892946014, "mean_inference_ms": 114.68509881578002, "mean_action_processing_ms": 0.36583988681821394}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 524000, "timers": {"sample_time_ms": 1353932.649, "sample_throughput": 2.954, "learn_time_ms": 103382.554, "learn_throughput": 38.691, "update_time_ms": 23.972}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07050304563017562, "policy_loss": -0.020177642407361418, "vf_loss": 353.82493686676025, "vf_explained_var": 0.8754032850265503, "kl": 0.015500223584240302, "entropy": 57.35119819641113, "entropy_coeff": 0.001}}, "num_steps_sampled": 524000, "num_steps_trained": 524000}, "done": false, "episodes_total": 524, "training_iteration": 131, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_23-33-24", "timestamp": 1618155204, "time_this_iter_s": 1507.3880021572113, "time_total_s": 191228.46908712387, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 191228.46908712387, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 22.368266542404474, "ram_util_percent": 20.491705498602048}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2152.141199278178, "episode_reward_mean": -2028.9828128733193, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -2119.76974071297, -2059.917940647736, -2119.869955604864, -2146.2233745088024, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.3751037683286, "mean_raw_obs_processing_ms": 2.306331018131047, "mean_inference_ms": 114.68055150431981, "mean_action_processing_ms": 0.365754096903103}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 528000, "timers": {"sample_time_ms": 1359342.107, "sample_throughput": 2.943, "learn_time_ms": 105738.366, "learn_throughput": 37.829, "update_time_ms": 24.365}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07136560464277864, "policy_loss": -0.019375436182599515, "vf_loss": 350.7518615722656, "vf_explained_var": 0.8891275525093079, "kl": 0.00923526511178352, "entropy": 57.5756196975708, "entropy_coeff": 0.001}}, "num_steps_sampled": 528000, "num_steps_trained": 528000}, "done": false, "episodes_total": 528, "training_iteration": 132, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-11_23-58-41", "timestamp": 1618156721, "time_this_iter_s": 1516.8496088981628, "time_total_s": 192745.31869602203, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 192745.31869602203, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 21.442241778601204, "ram_util_percent": 20.201111625752663}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2152.141199278178, "episode_reward_mean": -2021.522131545313, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -2082.1610084782533, -2044.2574753108356, -2107.295784192385, -2087.4587462161835, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.3281246544403, "mean_raw_obs_processing_ms": 2.3061850421794516, "mean_inference_ms": 114.67688960408778, "mean_action_processing_ms": 0.36562819934711216}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 532000, "timers": {"sample_time_ms": 1362693.217, "sample_throughput": 2.935, "learn_time_ms": 109434.709, "learn_throughput": 36.551, "update_time_ms": 22.237}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.059513102285563946, "policy_loss": -0.010056275757960975, "vf_loss": 687.9885370731354, "vf_explained_var": 0.7780693769454956, "kl": 0.0108706446189899, "entropy": 58.7826064825058, "entropy_coeff": 0.001}}, "num_steps_sampled": 532000, "num_steps_trained": 532000}, "done": false, "episodes_total": 532, "training_iteration": 133, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_00-23-38", "timestamp": 1618158218, "time_this_iter_s": 1496.877789735794, "time_total_s": 194242.19648575783, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 194242.19648575783, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 21.53774647887324, "ram_util_percent": 20.243615023474177}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2152.141199278178, "episode_reward_mean": -2016.4157874202951, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -2094.3285837235476, -2094.880358597627, -2038.5468429085681, -2091.2955527579425, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.2892334355465, "mean_raw_obs_processing_ms": 2.3061016919763917, "mean_inference_ms": 114.67395001858127, "mean_action_processing_ms": 0.3654923181824577}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 536000, "timers": {"sample_time_ms": 1367287.63, "sample_throughput": 2.926, "learn_time_ms": 111305.272, "learn_throughput": 35.937, "update_time_ms": 24.181}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06575360838905908, "policy_loss": -0.015800352033693343, "vf_loss": 516.7354054450989, "vf_explained_var": 0.8291273713111877, "kl": 0.014079566957661882, "entropy": 58.28851103782654, "entropy_coeff": 0.001}}, "num_steps_sampled": 536000, "num_steps_trained": 536000}, "done": false, "episodes_total": 536, "training_iteration": 134, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_00-48-44", "timestamp": 1618159724, "time_this_iter_s": 1506.4087536334991, "time_total_s": 195748.60523939133, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 195748.60523939133, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 21.524673507462687, "ram_util_percent": 20.285214552238806}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2152.141199278178, "episode_reward_mean": -2011.7274156271494, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -2099.5163817109965, -2075.4157774575824, -2053.7437712868636, -1954.4305997981567, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.2577280691997, "mean_raw_obs_processing_ms": 2.30605508238295, "mean_inference_ms": 114.67220025369728, "mean_action_processing_ms": 0.3653540239153416}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 540000, "timers": {"sample_time_ms": 1371946.21, "sample_throughput": 2.916, "learn_time_ms": 113978.101, "learn_throughput": 35.094, "update_time_ms": 23.414}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07525921046908479, "policy_loss": -0.024241662496933714, "vf_loss": 399.8733501434326, "vf_explained_var": 0.8713924884796143, "kl": 0.012523119570687413, "entropy": 57.83398246765137, "entropy_coeff": 0.001}}, "num_steps_sampled": 540000, "num_steps_trained": 540000}, "done": false, "episodes_total": 540, "training_iteration": 135, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_01-13-57", "timestamp": 1618161237, "time_this_iter_s": 1512.8353295326233, "time_total_s": 197261.44056892395, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 197261.44056892395, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 21.49740018570102, "ram_util_percent": 20.29586815227484}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2152.141199278178, "episode_reward_mean": -2008.7154803904964, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -2124.9846493172927, -2098.312047287343, -2083.2127046419537, -2038.2543416077958, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.233863827712, "mean_raw_obs_processing_ms": 2.3059876885070483, "mean_inference_ms": 114.67216932054153, "mean_action_processing_ms": 0.36526095457249386}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 544000, "timers": {"sample_time_ms": 1377595.867, "sample_throughput": 2.904, "learn_time_ms": 116692.801, "learn_throughput": 34.278, "update_time_ms": 21.969}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07389360183151439, "policy_loss": -0.025846905686194077, "vf_loss": 682.5661249160767, "vf_explained_var": 0.7803117036819458, "kl": 0.014486465806839988, "entropy": 58.131810665130615, "entropy_coeff": 0.001}}, "num_steps_sampled": 544000, "num_steps_trained": 544000}, "done": false, "episodes_total": 544, "training_iteration": 136, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_01-39-15", "timestamp": 1618162755, "time_this_iter_s": 1518.0126264095306, "time_total_s": 198779.45319533348, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 198779.45319533348, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 21.414074074074076, "ram_util_percent": 20.292870370370373}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2152.141199278178, "episode_reward_mean": -2004.082961570821, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -2089.711081012905, -2077.9067690445036, -2040.3809356160168, -2080.166272957669, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.2160426780638, "mean_raw_obs_processing_ms": 2.3059548513006667, "mean_inference_ms": 114.67287654271666, "mean_action_processing_ms": 0.3651743594837839}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 548000, "timers": {"sample_time_ms": 1382673.169, "sample_throughput": 2.893, "learn_time_ms": 119106.761, "learn_throughput": 33.583, "update_time_ms": 21.421}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.05973567263572477, "policy_loss": -0.013231726305093616, "vf_loss": 805.3955297470093, "vf_explained_var": 0.7260317206382751, "kl": 0.013939686090452597, "entropy": 57.69432854652405, "entropy_coeff": 0.001}}, "num_steps_sampled": 548000, "num_steps_trained": 548000}, "done": false, "episodes_total": 548, "training_iteration": 137, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_02-04-19", "timestamp": 1618164259, "time_this_iter_s": 1503.96458029747, "time_total_s": 200283.41777563095, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 200283.41777563095, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 21.551517982251287, "ram_util_percent": 20.29397477814106}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2152.141199278178, "episode_reward_mean": -1998.8616957450236, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2039.5130324053703, -2040.9127089719716, -2086.9930067405185, -2007.1363855775182, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.2077103878612, "mean_raw_obs_processing_ms": 2.3059682373002954, "mean_inference_ms": 114.67465335615093, "mean_action_processing_ms": 0.36509061515152363}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 552000, "timers": {"sample_time_ms": 1388331.509, "sample_throughput": 2.881, "learn_time_ms": 120743.331, "learn_throughput": 33.128, "update_time_ms": 21.139}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.05796403659041971, "policy_loss": -0.007811622665030882, "vf_loss": 581.3219404220581, "vf_explained_var": 0.8001112937927246, "kl": 0.01108156464761123, "entropy": 58.45898509025574, "entropy_coeff": 0.001}}, "num_steps_sampled": 552000, "num_steps_trained": 552000}, "done": false, "episodes_total": 552, "training_iteration": 138, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_02-29-34", "timestamp": 1618165774, "time_this_iter_s": 1515.1740791797638, "time_total_s": 201798.59185481071, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 201798.59185481071, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 21.486509040333793, "ram_util_percent": 20.296615669911915}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2152.141199278178, "episode_reward_mean": -1995.5503462376735, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -2051.8455179819903, -2033.2202809168627, -2028.3928978393035, -2000.1514500282653, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.2048327259628, "mean_raw_obs_processing_ms": 2.306001529834315, "mean_inference_ms": 114.67727503491328, "mean_action_processing_ms": 0.36502466721492227}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 556000, "timers": {"sample_time_ms": 1387180.084, "sample_throughput": 2.884, "learn_time_ms": 120296.621, "learn_throughput": 33.251, "update_time_ms": 20.553}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06168505677487701, "policy_loss": -0.011453168233856559, "vf_loss": 595.2742974758148, "vf_explained_var": 0.8246861100196838, "kl": 0.012213232141220942, "entropy": 58.93260943889618, "entropy_coeff": 0.001}}, "num_steps_sampled": 556000, "num_steps_trained": 556000}, "done": false, "episodes_total": 556, "training_iteration": 139, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_02-54-23", "timestamp": 1618167263, "time_this_iter_s": 1489.2103877067566, "time_total_s": 203287.80224251747, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 203287.80224251747, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 21.49834827748938, "ram_util_percent": 20.291080698442663}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2152.141199278178, "episode_reward_mean": -1992.5391044820615, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -2044.0635676672873, -1998.8962351563193, -2095.1679263922065, -2098.892699040129, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.2036829726577, "mean_raw_obs_processing_ms": 2.306017143653698, "mean_inference_ms": 114.67999527460623, "mean_action_processing_ms": 0.3649641638146335}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 560000, "timers": {"sample_time_ms": 1383024.786, "sample_throughput": 2.892, "learn_time_ms": 119917.719, "learn_throughput": 33.356, "update_time_ms": 21.236}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06628321943571791, "policy_loss": -0.01580185604689177, "vf_loss": 461.4537239074707, "vf_explained_var": 0.8490928411483765, "kl": 0.01326087539200671, "entropy": 58.079594135284424, "entropy_coeff": 0.001}}, "num_steps_sampled": 560000, "num_steps_trained": 560000}, "done": false, "episodes_total": 560, "training_iteration": 140, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_03-18-46", "timestamp": 1618168726, "time_this_iter_s": 1463.0164685249329, "time_total_s": 204750.8187110424, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 204750.8187110424, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 21.35040806529045, "ram_util_percent": 20.297503600576096}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2152.141199278178, "episode_reward_mean": -1988.5855336446432, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -2152.141199278178, -2065.8535428184296, -2039.0664876991527, -2101.729420655669, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.2084338880372, "mean_raw_obs_processing_ms": 2.3060580074402925, "mean_inference_ms": 114.68362820810542, "mean_action_processing_ms": 0.36495508510615515}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 564000, "timers": {"sample_time_ms": 1381975.829, "sample_throughput": 2.894, "learn_time_ms": 117822.179, "learn_throughput": 33.949, "update_time_ms": 21.89}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0655327559215948, "policy_loss": -0.015778875560499728, "vf_loss": 560.8925452232361, "vf_explained_var": 0.8135284185409546, "kl": 0.013596660981420428, "entropy": 58.42205345630646, "entropy_coeff": 0.001}}, "num_steps_sampled": 564000, "num_steps_trained": 564000}, "done": false, "episodes_total": 564, "training_iteration": 141, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_03-43-22", "timestamp": 1618170202, "time_this_iter_s": 1475.9497401714325, "time_total_s": 206226.76845121384, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 206226.76845121384, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 20.14673964778677, "ram_util_percent": 20.042265587815326}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2108.976444650517, "episode_reward_mean": -1981.668663911239, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1987.7404814451165, -2088.271834429862, -2085.815408714126, -2075.4677092639604, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.2141180570944, "mean_raw_obs_processing_ms": 2.306082090227693, "mean_inference_ms": 114.68657108820818, "mean_action_processing_ms": 0.3649755465849666}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 568000, "timers": {"sample_time_ms": 1376724.183, "sample_throughput": 2.905, "learn_time_ms": 115525.128, "learn_throughput": 34.625, "update_time_ms": 20.156}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0689510777592659, "policy_loss": -0.016151151998201385, "vf_loss": 265.7328853607178, "vf_explained_var": 0.8974952697753906, "kl": 0.013290226459503174, "entropy": 58.44755470752716, "entropy_coeff": 0.001}}, "num_steps_sampled": 568000, "num_steps_trained": 568000}, "done": false, "episodes_total": 568, "training_iteration": 142, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_04-07-24", "timestamp": 1618171644, "time_this_iter_s": 1441.3403460979462, "time_total_s": 207668.10879731178, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 207668.10879731178, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 11.74985380116959, "ram_util_percent": 17.42982456140351}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2108.976444650517, "episode_reward_mean": -1977.2965976487692, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -2086.529479863759, -2086.707946581356, -1984.245233493269, -2108.976444650517, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.2202666565389, "mean_raw_obs_processing_ms": 2.3060761189027685, "mean_inference_ms": 114.689300249681, "mean_action_processing_ms": 0.3649934697594378}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 572000, "timers": {"sample_time_ms": 1373416.099, "sample_throughput": 2.912, "learn_time_ms": 112578.021, "learn_throughput": 35.531, "update_time_ms": 20.319}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06616555945947766, "policy_loss": -0.01347780117066577, "vf_loss": 319.90837955474854, "vf_explained_var": 0.8935474753379822, "kl": 0.012302724935580045, "entropy": 58.65495252609253, "entropy_coeff": 0.001}}, "num_steps_sampled": 572000, "num_steps_trained": 572000}, "done": false, "episodes_total": 572, "training_iteration": 143, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_04-31-18", "timestamp": 1618173078, "time_this_iter_s": 1434.3272457122803, "time_total_s": 209102.43604302406, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 209102.43604302406, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 11.580852105778648, "ram_util_percent": 17.429578844270324}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2096.0789654254, "episode_reward_mean": -1972.2820552678493, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -2085.377410191481, -1915.1868332066877, -2096.0789654254, -2075.8905266072716, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.2257296409284, "mean_raw_obs_processing_ms": 2.3060406525539787, "mean_inference_ms": 114.69139137601113, "mean_action_processing_ms": 0.3650005254183605}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 576000, "timers": {"sample_time_ms": 1367031.268, "sample_throughput": 2.926, "learn_time_ms": 110719.079, "learn_throughput": 36.127, "update_time_ms": 19.515}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0706915975897573, "policy_loss": -0.022631285421084613, "vf_loss": 805.6087846755981, "vf_explained_var": 0.7810816764831543, "kl": 0.011786195711465552, "entropy": 58.76829123497009, "entropy_coeff": 0.001}}, "num_steps_sampled": 576000, "num_steps_trained": 576000}, "done": false, "episodes_total": 576, "training_iteration": 144, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_04-55-02", "timestamp": 1618174502, "time_this_iter_s": 1423.977340221405, "time_total_s": 210526.41338324547, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 210526.41338324547, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 11.576999012833168, "ram_util_percent": 17.41999012833169}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2092.717853657037, "episode_reward_mean": -1967.808505405455, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -2062.2716696408975, -1987.9897163226794, -1962.4973284295586, -1943.4824301709218, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.2324064457343, "mean_raw_obs_processing_ms": 2.3060236938970426, "mean_inference_ms": 114.69383146079703, "mean_action_processing_ms": 0.36501934105465067}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 580000, "timers": {"sample_time_ms": 1362199.046, "sample_throughput": 2.936, "learn_time_ms": 107532.295, "learn_throughput": 37.198, "update_time_ms": 20.091}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.060285534942522645, "policy_loss": -0.009021075995406136, "vf_loss": 480.0957570075989, "vf_explained_var": 0.8340615034103394, "kl": 0.011149789410410449, "entropy": 58.57411706447601, "entropy_coeff": 0.001}}, "num_steps_sampled": 580000, "num_steps_trained": 580000}, "done": false, "episodes_total": 580, "training_iteration": 145, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_05-18-55", "timestamp": 1618175935, "time_this_iter_s": 1432.6375966072083, "time_total_s": 211959.05097985268, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 211959.05097985268, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 11.57514705882353, "ram_util_percent": 17.424803921568632}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2092.717853657037, "episode_reward_mean": -1965.786511398621, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1977.6879140860062, -2019.6599945943724, -1992.9039359917153, -1995.9972643389588, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.2399882420618, "mean_raw_obs_processing_ms": 2.306000046186756, "mean_inference_ms": 114.69611807522732, "mean_action_processing_ms": 0.3650425479085797}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 584000, "timers": {"sample_time_ms": 1356665.729, "sample_throughput": 2.948, "learn_time_ms": 104850.079, "learn_throughput": 38.15, "update_time_ms": 21.096}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06649016065057367, "policy_loss": -0.01405065186554566, "vf_loss": 312.65756464004517, "vf_explained_var": 0.897005558013916, "kl": 0.01410976133774966, "entropy": 58.74078094959259, "entropy_coeff": 0.001}}, "num_steps_sampled": 584000, "num_steps_trained": 584000}, "done": false, "episodes_total": 584, "training_iteration": 146, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_05-42-51", "timestamp": 1618177371, "time_this_iter_s": 1435.8802516460419, "time_total_s": 213394.93123149872, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 213394.93123149872, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 11.57725048923679, "ram_util_percent": 17.43175146771037}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2092.717853657037, "episode_reward_mean": -1964.049843144997, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -2037.8350556168855, -1946.8836176017928, -1929.6991823825647, -2070.6717366372745, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.2471462476028, "mean_raw_obs_processing_ms": 2.3059457891578985, "mean_inference_ms": 114.69816894137738, "mean_action_processing_ms": 0.3650821495081918}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 588000, "timers": {"sample_time_ms": 1351634.944, "sample_throughput": 2.959, "learn_time_ms": 102631.727, "learn_throughput": 38.974, "update_time_ms": 20.626}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.060582788224564865, "policy_loss": -0.008901725173927844, "vf_loss": 376.68730068206787, "vf_explained_var": 0.8726162314414978, "kl": 0.012867497134720907, "entropy": 58.34312343597412, "entropy_coeff": 0.001}}, "num_steps_sampled": 588000, "num_steps_trained": 588000}, "done": false, "episodes_total": 588, "training_iteration": 147, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_06-06-42", "timestamp": 1618178802, "time_this_iter_s": 1431.468695640564, "time_total_s": 214826.39992713928, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 214826.39992713928, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 11.57717231222386, "ram_util_percent": 17.4319587628866}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2092.717853657037, "episode_reward_mean": -1961.3040250966817, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1986.4903720344096, -1998.3035167306316, -1994.8595994172351, -1945.0354609630422, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.2566479533763, "mean_raw_obs_processing_ms": 2.3059289266506675, "mean_inference_ms": 114.70021741537606, "mean_action_processing_ms": 0.36511903347758917}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 592000, "timers": {"sample_time_ms": 1346677.065, "sample_throughput": 2.97, "learn_time_ms": 100758.701, "learn_throughput": 39.699, "update_time_ms": 20.149}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06400729168672115, "policy_loss": -0.0143991251825355, "vf_loss": 589.3605623245239, "vf_explained_var": 0.8006588220596313, "kl": 0.01247599208727479, "entropy": 58.308865427970886, "entropy_coeff": 0.001}}, "num_steps_sampled": 592000, "num_steps_trained": 592000}, "done": false, "episodes_total": 592, "training_iteration": 148, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_06-30-49", "timestamp": 1618180249, "time_this_iter_s": 1446.8603608608246, "time_total_s": 216273.2602880001, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 216273.2602880001, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 11.852815533980584, "ram_util_percent": 17.434126213592233}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2092.717853657037, "episode_reward_mean": -1958.5120869891657, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1985.8496703790481, -2015.1790408546215, -2042.4864938733738, -1993.000277055175, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.2658717527761, "mean_raw_obs_processing_ms": 2.3059145832714547, "mean_inference_ms": 114.70223867439347, "mean_action_processing_ms": 0.3651354935780462}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 596000, "timers": {"sample_time_ms": 1344001.343, "sample_throughput": 2.976, "learn_time_ms": 98452.971, "learn_throughput": 40.629, "update_time_ms": 20.565}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.05956803445587866, "policy_loss": -0.008711847534868866, "vf_loss": 423.707923412323, "vf_explained_var": 0.8440704345703125, "kl": 0.013033577968599275, "entropy": 58.02582144737244, "entropy_coeff": 0.001}}, "num_steps_sampled": 596000, "num_steps_trained": 596000}, "done": false, "episodes_total": 596, "training_iteration": 149, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_06-54-49", "timestamp": 1618181689, "time_this_iter_s": 1439.4134676456451, "time_total_s": 217712.67375564575, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 217712.67375564575, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 11.593701171875, "ram_util_percent": 17.431250000000002}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2092.717853657037, "episode_reward_mean": -1954.7412431528785, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1933.7824904899956, -1974.0709746616135, -1999.6727190546026, -2010.828215827048, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.2750063950887, "mean_raw_obs_processing_ms": 2.305908840470277, "mean_inference_ms": 114.70419467785548, "mean_action_processing_ms": 0.36513001947654883}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 600000, "timers": {"sample_time_ms": 1342415.559, "sample_throughput": 2.98, "learn_time_ms": 96945.556, "learn_throughput": 41.26, "update_time_ms": 18.776}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06987266804208048, "policy_loss": -0.019906551897292957, "vf_loss": 535.858247756958, "vf_explained_var": 0.8035153746604919, "kl": 0.013136745721567422, "entropy": 58.28046667575836, "entropy_coeff": 0.001}}, "num_steps_sampled": 600000, "num_steps_trained": 600000}, "done": false, "episodes_total": 600, "training_iteration": 150, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_07-18-41", "timestamp": 1618183121, "time_this_iter_s": 1432.0665800571442, "time_total_s": 219144.7403357029, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 219144.7403357029, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 11.568498527968597, "ram_util_percent": 17.440873405299318}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2092.717853657037, "episode_reward_mean": -1952.9771961822726, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -2058.590484231238, -2092.717853657037, -1938.2787617318213, -1889.441624582864, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.2845147262303, "mean_raw_obs_processing_ms": 2.3058696378666492, "mean_inference_ms": 114.70554089345646, "mean_action_processing_ms": 0.36507989917222006}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 604000, "timers": {"sample_time_ms": 1337820.431, "sample_throughput": 2.99, "learn_time_ms": 97096.048, "learn_throughput": 41.196, "update_time_ms": 18.303}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07009221820044331, "policy_loss": -0.01812531508039683, "vf_loss": 422.25557231903076, "vf_explained_var": 0.8525554537773132, "kl": 0.011413412299589254, "entropy": 58.75747537612915, "entropy_coeff": 0.001}}, "num_steps_sampled": 604000, "num_steps_trained": 604000}, "done": false, "episodes_total": 604, "training_iteration": 151, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_07-42-32", "timestamp": 1618184552, "time_this_iter_s": 1431.4988496303558, "time_total_s": 220576.23918533325, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 220576.23918533325, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 11.580176643768402, "ram_util_percent": 17.42944062806673}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2056.2053303980792, "episode_reward_mean": -1950.284965645948, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -2056.2053303980792, -1983.9628559507796, -1993.3315913901527, -2000.8241362437834, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.2947198107994, "mean_raw_obs_processing_ms": 2.3058236710318436, "mean_inference_ms": 114.70727952471577, "mean_action_processing_ms": 0.3650502611012177}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 608000, "timers": {"sample_time_ms": 1337284.077, "sample_throughput": 2.991, "learn_time_ms": 97032.053, "learn_throughput": 41.223, "update_time_ms": 20.115}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07742602180223912, "policy_loss": -0.02700152510078624, "vf_loss": 546.8388013839722, "vf_explained_var": 0.8239248991012573, "kl": 0.01226713421056047, "entropy": 58.65298891067505, "entropy_coeff": 0.001}}, "num_steps_sampled": 608000, "num_steps_trained": 608000}, "done": false, "episodes_total": 608, "training_iteration": 152, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_08-06-28", "timestamp": 1618185988, "time_this_iter_s": 1435.354986190796, "time_total_s": 222011.59417152405, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 222011.59417152405, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 11.581253059226627, "ram_util_percent": 17.432452276064613}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2050.767691366458, "episode_reward_mean": -1948.4708462004596, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -2015.1690050850918, -1940.1252458938761, -2011.856283793992, -1949.2269279532945, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.3054339893375, "mean_raw_obs_processing_ms": 2.3057958773049707, "mean_inference_ms": 114.7091686606248, "mean_action_processing_ms": 0.3650259456671898}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 612000, "timers": {"sample_time_ms": 1338063.435, "sample_throughput": 2.989, "learn_time_ms": 97179.453, "learn_throughput": 41.161, "update_time_ms": 18.277}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07255182898370549, "policy_loss": -0.021341349405702204, "vf_loss": 417.06083822250366, "vf_explained_var": 0.8496796488761902, "kl": 0.013813216122798622, "entropy": 58.48905909061432, "entropy_coeff": 0.001}}, "num_steps_sampled": 612000, "num_steps_trained": 612000}, "done": false, "episodes_total": 612, "training_iteration": 153, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_08-30-31", "timestamp": 1618187431, "time_this_iter_s": 1443.5765085220337, "time_total_s": 223455.17068004608, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 223455.17068004608, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 11.591577409931839, "ram_util_percent": 17.438023369036028}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2050.767691366458, "episode_reward_mean": -1944.7909844581536, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1937.9849956275425, -2004.3329958633765, -2014.3371420902456, -1976.1453018206983, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.3114472166794, "mean_raw_obs_processing_ms": 2.3057524066464685, "mean_inference_ms": 114.70987371603046, "mean_action_processing_ms": 0.36504196414177303}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 616000, "timers": {"sample_time_ms": 1339288.037, "sample_throughput": 2.987, "learn_time_ms": 97663.106, "learn_throughput": 40.957, "update_time_ms": 18.914}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06907730322564021, "policy_loss": -0.019112683075945824, "vf_loss": 495.6959447860718, "vf_explained_var": 0.8295798897743225, "kl": 0.01677909810678102, "entropy": 58.69687259197235, "entropy_coeff": 0.001}}, "num_steps_sampled": 616000, "num_steps_trained": 616000}, "done": false, "episodes_total": 616, "training_iteration": 154, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_08-54-32", "timestamp": 1618188872, "time_this_iter_s": 1441.0519325733185, "time_total_s": 224896.2226126194, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 224896.2226126194, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 12.827352510970258, "ram_util_percent": 17.7366650414432}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1850.9254278054902, "episode_reward_min": -2050.767691366458, "episode_reward_mean": -1943.0465032890272, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1961.5590065895638, -1997.1839126663347, -2050.767691366458, -1944.8946637918946, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.3351958307053, "mean_raw_obs_processing_ms": 2.305796563386179, "mean_inference_ms": 114.71292432743252, "mean_action_processing_ms": 0.3650449403152461}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 620000, "timers": {"sample_time_ms": 1361215.668, "sample_throughput": 2.939, "learn_time_ms": 100813.563, "learn_throughput": 39.677, "update_time_ms": 18.602}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07261846197070554, "policy_loss": -0.023430221539456397, "vf_loss": 514.1493582725525, "vf_explained_var": 0.8221710920333862, "kl": 0.015206329146167263, "entropy": 57.751155614852905, "entropy_coeff": 0.001}}, "num_steps_sampled": 620000, "num_steps_trained": 620000}, "done": false, "episodes_total": 620, "training_iteration": 155, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_09-22-36", "timestamp": 1618190556, "time_this_iter_s": 1683.4156608581543, "time_total_s": 226579.63827347755, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 226579.63827347755, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 32.88961201501877, "ram_util_percent": 23.510554860241967}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1805.7233393798526, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1940.1277756786224, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1942.7333356289541, -1999.8834346460728, -1850.9254278054902, -2018.359272928059, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.3746583560445, "mean_raw_obs_processing_ms": 2.305854923540335, "mean_inference_ms": 114.71834346427326, "mean_action_processing_ms": 0.365087146610373}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 624000, "timers": {"sample_time_ms": 1381408.23, "sample_throughput": 2.896, "learn_time_ms": 105161.221, "learn_throughput": 38.037, "update_time_ms": 18.823}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06081085017649457, "policy_loss": -0.010353825287893414, "vf_loss": 323.74445390701294, "vf_explained_var": 0.880225658416748, "kl": 0.016156447731191292, "entropy": 57.32966983318329, "entropy_coeff": 0.001}}, "num_steps_sampled": 624000, "num_steps_trained": 624000}, "done": false, "episodes_total": 624, "training_iteration": 156, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_09-50-37", "timestamp": 1618192237, "time_this_iter_s": 1681.2751903533936, "time_total_s": 228260.91346383095, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 228260.91346383095, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 34.037918060200674, "ram_util_percent": 24.0}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1805.7233393798526, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1938.3857958714536, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1921.1638016072577, -1967.0906967625922, -1918.7215986030233, -1892.7367817008767, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.4197136538467, "mean_raw_obs_processing_ms": 2.305939845846824, "mean_inference_ms": 114.72490552090694, "mean_action_processing_ms": 0.3651320707823508}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 628000, "timers": {"sample_time_ms": 1394239.353, "sample_throughput": 2.869, "learn_time_ms": 106349.234, "learn_throughput": 37.612, "update_time_ms": 19.826}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07932117488235235, "policy_loss": -0.0289488043054007, "vf_loss": 460.31124663352966, "vf_explained_var": 0.8455928564071655, "kl": 0.01423633229569532, "entropy": 58.178651452064514, "entropy_coeff": 0.001}}, "num_steps_sampled": 628000, "num_steps_trained": 628000}, "done": false, "episodes_total": 628, "training_iteration": 157, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_10-16-49", "timestamp": 1618193809, "time_this_iter_s": 1571.67041349411, "time_total_s": 229832.58387732506, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 229832.58387732506, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 26.2441018766756, "ram_util_percent": 22.471894548704203}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1805.7233393798526, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1937.0882484670133, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1947.210909728006, -1935.7099117869966, -1940.1772856649507, -1987.4404945159572, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.473755380861, "mean_raw_obs_processing_ms": 2.3060206486835755, "mean_inference_ms": 114.73219599853861, "mean_action_processing_ms": 0.36520410950174514}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 632000, "timers": {"sample_time_ms": 1404687.366, "sample_throughput": 2.848, "learn_time_ms": 108113.456, "learn_throughput": 36.998, "update_time_ms": 20.263}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0693004984932486, "policy_loss": -0.021274670405546203, "vf_loss": 665.8997964859009, "vf_explained_var": 0.743127703666687, "kl": 0.013578861835412681, "entropy": 57.74006640911102, "entropy_coeff": 0.001}}, "num_steps_sampled": 632000, "num_steps_trained": 632000}, "done": false, "episodes_total": 632, "training_iteration": 158, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_10-42-58", "timestamp": 1618195378, "time_this_iter_s": 1568.9870977401733, "time_total_s": 231401.57097506523, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 231401.57097506523, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 21.55566502463054, "ram_util_percent": 21.404388714733546}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1805.7233393798526, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1935.7790221039204, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1938.4332505825848, -2011.1096220780153, -1928.9871645350984, -1971.6841214773713, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.525159915828, "mean_raw_obs_processing_ms": 2.3060667604932252, "mean_inference_ms": 114.73907624144451, "mean_action_processing_ms": 0.36529267088645967}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 636000, "timers": {"sample_time_ms": 1408032.89, "sample_throughput": 2.841, "learn_time_ms": 110334.093, "learn_throughput": 36.254, "update_time_ms": 19.269}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06364779593423009, "policy_loss": -0.013012539828196168, "vf_loss": 430.09381914138794, "vf_explained_var": 0.8501508235931396, "kl": 0.013809605850838125, "entropy": 58.04335105419159, "entropy_coeff": 0.001}}, "num_steps_sampled": 636000, "num_steps_trained": 636000}, "done": false, "episodes_total": 636, "training_iteration": 159, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_11-07-53", "timestamp": 1618196873, "time_this_iter_s": 1495.0512611865997, "time_total_s": 232896.62223625183, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 232896.62223625183, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 21.57377819548872, "ram_util_percent": 21.412077067669173}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1805.7233393798526, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1932.7197767561638, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1968.3092475179324, -1998.352183255253, -1914.8050026052126, -2000.4465732099318, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.5726252791465, "mean_raw_obs_processing_ms": 2.306121254709528, "mean_inference_ms": 114.74557383852846, "mean_action_processing_ms": 0.3654028821352964}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 640000, "timers": {"sample_time_ms": 1410464.858, "sample_throughput": 2.836, "learn_time_ms": 112519.824, "learn_throughput": 35.549, "update_time_ms": 19.263}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07166409026831388, "policy_loss": -0.020239949983078986, "vf_loss": 431.241596698761, "vf_explained_var": 0.8532321453094482, "kl": 0.012868598394561559, "entropy": 58.6319864988327, "entropy_coeff": 0.001}}, "num_steps_sampled": 640000, "num_steps_trained": 640000}, "done": false, "episodes_total": 640, "training_iteration": 160, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_11-32-31", "timestamp": 1618198351, "time_this_iter_s": 1478.2433049678802, "time_total_s": 234374.8655412197, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 234374.8655412197, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 21.630403800475058, "ram_util_percent": 21.40793349168646}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1805.7233393798526, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1929.4027419182958, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1953.7335766563408, -2028.2495051840274, -1943.577698055425, -1955.9510809910469, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.6198052610649, "mean_raw_obs_processing_ms": 2.306224624974894, "mean_inference_ms": 114.75216864256554, "mean_action_processing_ms": 0.36550653113767156}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 644000, "timers": {"sample_time_ms": 1417176.275, "sample_throughput": 2.823, "learn_time_ms": 114987.507, "learn_throughput": 34.786, "update_time_ms": 20.71}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06840151851065457, "policy_loss": -0.015725531411590055, "vf_loss": 367.1505298614502, "vf_explained_var": 0.8672645092010498, "kl": 0.012748794339131564, "entropy": 59.21596872806549, "entropy_coeff": 0.001}}, "num_steps_sampled": 644000, "num_steps_trained": 644000}, "done": false, "episodes_total": 644, "training_iteration": 161, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_11-57-55", "timestamp": 1618199875, "time_this_iter_s": 1523.3042619228363, "time_total_s": 235898.16980314255, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 235898.16980314255, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 21.376834333179506, "ram_util_percent": 21.317443470235354}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1805.7233393798526, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1925.3764265136767, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1890.1929435778866, -1930.3113233876143, -1947.3119219150994, -1998.2222871707374, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.6672163495251, "mean_raw_obs_processing_ms": 2.306305488018351, "mean_inference_ms": 114.75903019731888, "mean_action_processing_ms": 0.36560915798376387}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 648000, "timers": {"sample_time_ms": 1422616.373, "sample_throughput": 2.812, "learn_time_ms": 115922.161, "learn_throughput": 34.506, "update_time_ms": 22.143}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07262837240705267, "policy_loss": -0.020626407873351127, "vf_loss": 370.85980463027954, "vf_explained_var": 0.8551719784736633, "kl": 0.014350265031680465, "entropy": 58.93936824798584, "entropy_coeff": 0.001}}, "num_steps_sampled": 648000, "num_steps_trained": 648000}, "done": false, "episodes_total": 648, "training_iteration": 162, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_12-22-54", "timestamp": 1618201374, "time_this_iter_s": 1499.1185426712036, "time_total_s": 237397.28834581375, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 237397.28834581375, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 21.00112464854733, "ram_util_percent": 21.248500468603563}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1805.7233393798526, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1924.8625624183087, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -2030.8929886679796, -1936.7330418705383, -1961.5726226631466, -1914.2215297587263, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.7066521717792, "mean_raw_obs_processing_ms": 2.3063799344558986, "mean_inference_ms": 114.76501781941722, "mean_action_processing_ms": 0.3657416993012024}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 652000, "timers": {"sample_time_ms": 1421855.675, "sample_throughput": 2.813, "learn_time_ms": 115855.816, "learn_throughput": 34.526, "update_time_ms": 23.342}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06815108365844935, "policy_loss": -0.015346050771768205, "vf_loss": 292.59686851501465, "vf_explained_var": 0.8983925580978394, "kl": 0.01362830339348875, "entropy": 58.797367215156555, "entropy_coeff": 0.001}}, "num_steps_sampled": 652000, "num_steps_trained": 652000}, "done": false, "episodes_total": 652, "training_iteration": 163, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_12-46-49", "timestamp": 1618202809, "time_this_iter_s": 1435.3303544521332, "time_total_s": 238832.61870026588, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 238832.61870026588, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 11.745401174168297, "ram_util_percent": 18.546771037181998}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1762.301079374112, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1920.9419037965592, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1966.9123623077658, -1964.1898825577018, -1933.4198542887655, -1947.963872050993, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.7414305597256, "mean_raw_obs_processing_ms": 2.3064480979407445, "mean_inference_ms": 114.77059830211095, "mean_action_processing_ms": 0.36585721154768136}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 656000, "timers": {"sample_time_ms": 1421425.08, "sample_throughput": 2.814, "learn_time_ms": 115502.064, "learn_throughput": 34.631, "update_time_ms": 22.159}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06954943551681936, "policy_loss": -0.01726119968225248, "vf_loss": 420.23227548599243, "vf_explained_var": 0.847922682762146, "kl": 0.012926519993925467, "entropy": 59.39902138710022, "entropy_coeff": 0.001}}, "num_steps_sampled": 656000, "num_steps_trained": 656000}, "done": false, "episodes_total": 656, "training_iteration": 164, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_13-10-42", "timestamp": 1618204242, "time_this_iter_s": 1433.1967284679413, "time_total_s": 240265.81542873383, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 240265.81542873383, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 11.773823529411764, "ram_util_percent": 18.55254901960784}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1762.301079374112, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1918.1533960060735, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1932.40823359826, -2004.2202776428371, -1960.5475235327206, -1944.4873097402794, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.7742760025479, "mean_raw_obs_processing_ms": 2.3065685765233703, "mean_inference_ms": 114.77625662667666, "mean_action_processing_ms": 0.3659749635737175}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 660000, "timers": {"sample_time_ms": 1399793.231, "sample_throughput": 2.858, "learn_time_ms": 112348.335, "learn_throughput": 35.604, "update_time_ms": 22.039}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.05942707206122577, "policy_loss": -0.007931945903692394, "vf_loss": 500.2755160331726, "vf_explained_var": 0.8388600945472717, "kl": 0.014064907416468486, "entropy": 59.66248381137848, "entropy_coeff": 0.001}}, "num_steps_sampled": 660000, "num_steps_trained": 660000}, "done": false, "episodes_total": 660, "training_iteration": 165, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_13-34-38", "timestamp": 1618205678, "time_this_iter_s": 1435.5583386421204, "time_total_s": 241701.37376737595, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 241701.37376737595, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 11.76456191874694, "ram_util_percent": 18.541654429760158}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1762.301079374112, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1914.375061834331, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1932.366160634668, -1895.2966211039509, -1906.554255312593, -1932.8866400598436, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.8020500214147, "mean_raw_obs_processing_ms": 2.30667447807815, "mean_inference_ms": 114.78132948786998, "mean_action_processing_ms": 0.3660384362148176}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 664000, "timers": {"sample_time_ms": 1379629.348, "sample_throughput": 2.899, "learn_time_ms": 108206.066, "learn_throughput": 36.967, "update_time_ms": 21.184}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0720525614451617, "policy_loss": -0.01957182856858708, "vf_loss": 435.8127727508545, "vf_explained_var": 0.8501825332641602, "kl": 0.014966763119446114, "entropy": 60.20637881755829, "entropy_coeff": 0.001}}, "num_steps_sampled": 664000, "num_steps_trained": 664000}, "done": false, "episodes_total": 664, "training_iteration": 166, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_13-58-36", "timestamp": 1618207116, "time_this_iter_s": 1438.2015235424042, "time_total_s": 243139.57529091835, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 243139.57529091835, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 11.766438690766977, "ram_util_percent": 18.549291646311676}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1762.301079374112, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1911.4956117156894, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1934.1137076662587, -1904.0302737648374, -1990.39503931288, -1971.5497868620507, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.8291709706465, "mean_raw_obs_processing_ms": 2.306828960124039, "mean_inference_ms": 114.78671587782594, "mean_action_processing_ms": 0.3661160603139794}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 668000, "timers": {"sample_time_ms": 1367611.968, "sample_throughput": 2.925, "learn_time_ms": 105642.713, "learn_throughput": 37.863, "update_time_ms": 20.853}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07272859202930704, "policy_loss": -0.019044672342715785, "vf_loss": 400.414439201355, "vf_explained_var": 0.8649120330810547, "kl": 0.011271253431914374, "entropy": 60.224093556404114, "entropy_coeff": 0.001}}, "num_steps_sampled": 668000, "num_steps_trained": 668000}, "done": false, "episodes_total": 668, "training_iteration": 167, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_14-22-22", "timestamp": 1618208542, "time_this_iter_s": 1425.8592553138733, "time_total_s": 244565.43454623222, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 244565.43454623222, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 11.786453201970444, "ram_util_percent": 18.56118226600985}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1762.301079374112, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1908.3953547866067, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1921.9547732200538, -1975.6323447861662, -1950.0247238265656, -1917.3930246641798, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.8570097163048, "mean_raw_obs_processing_ms": 2.3070323531771866, "mean_inference_ms": 114.79243558025208, "mean_action_processing_ms": 0.3662075892550857}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 672000, "timers": {"sample_time_ms": 1356310.204, "sample_throughput": 2.949, "learn_time_ms": 104008.44, "learn_throughput": 38.458, "update_time_ms": 22.016}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06910400162450969, "policy_loss": -0.017467168858274817, "vf_loss": 577.0672607421875, "vf_explained_var": 0.8057743906974792, "kl": 0.011927005252800882, "entropy": 60.09107983112335, "entropy_coeff": 0.001}}, "num_steps_sampled": 672000, "num_steps_trained": 672000}, "done": false, "episodes_total": 672, "training_iteration": 168, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_14-46-22", "timestamp": 1618209982, "time_this_iter_s": 1439.6382539272308, "time_total_s": 246005.07280015945, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 246005.07280015945, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 11.7763299170327, "ram_util_percent": 18.544948755490488}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1762.301079374112, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1904.6889698643604, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1911.9655066833818, -1931.4776150077917, -1907.34592284776, -1974.3897046524733, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.8859484737943, "mean_raw_obs_processing_ms": 2.3072354518897886, "mean_inference_ms": 114.79832502162452, "mean_action_processing_ms": 0.36633602519027214}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 676000, "timers": {"sample_time_ms": 1352200.633, "sample_throughput": 2.958, "learn_time_ms": 101844.638, "learn_throughput": 39.276, "update_time_ms": 22.395}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06833607144653797, "policy_loss": -0.016777741722762585, "vf_loss": 574.6646776199341, "vf_explained_var": 0.8052136898040771, "kl": 0.015046423039166257, "entropy": 60.690420508384705, "entropy_coeff": 0.001}}, "num_steps_sampled": 676000, "num_steps_trained": 676000}, "done": false, "episodes_total": 676, "training_iteration": 169, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_15-10-14", "timestamp": 1618211414, "time_this_iter_s": 1432.3350956439972, "time_total_s": 247437.40789580345, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 247437.40789580345, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 11.765473271211379, "ram_util_percent": 18.54830799411476}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1762.301079374112, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1900.6061885924296, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1897.1756983152654, -1954.299250863738, -1951.918702466298, -1950.6480922353194, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.9151501427924, "mean_raw_obs_processing_ms": 2.3074315949722095, "mean_inference_ms": 114.80433669994876, "mean_action_processing_ms": 0.36644014475888814}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 680000, "timers": {"sample_time_ms": 1349840.998, "sample_throughput": 2.963, "learn_time_ms": 99746.238, "learn_throughput": 40.102, "update_time_ms": 26.512}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07250720271258615, "policy_loss": -0.01671606267336756, "vf_loss": 234.30579948425293, "vf_explained_var": 0.9022569060325623, "kl": 0.010345277143642306, "entropy": 60.46188008785248, "entropy_coeff": 0.001}}, "num_steps_sampled": 680000, "num_steps_trained": 680000}, "done": false, "episodes_total": 680, "training_iteration": 170, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_15-34-08", "timestamp": 1618212848, "time_this_iter_s": 1433.7041611671448, "time_total_s": 248871.1120569706, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 248871.1120569706, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 11.763823529411763, "ram_util_percent": 18.550784313725494}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1762.301079374112, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1896.830707920526, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1913.4133509598166, -1970.135993308134, -1971.975303893228, -1957.057635487509, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.943219134467, "mean_raw_obs_processing_ms": 2.3076452735166604, "mean_inference_ms": 114.81055121402696, "mean_action_processing_ms": 0.36652757869928726}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 684000, "timers": {"sample_time_ms": 1342671.556, "sample_throughput": 2.979, "learn_time_ms": 97408.839, "learn_throughput": 41.064, "update_time_ms": 26.758}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.08192414487712085, "policy_loss": -0.031001522787846625, "vf_loss": 687.5535793304443, "vf_explained_var": 0.73460453748703, "kl": 0.010554432432400063, "entropy": 60.17289888858795, "entropy_coeff": 0.001}}, "num_steps_sampled": 684000, "num_steps_trained": 684000}, "done": false, "episodes_total": 684, "training_iteration": 171, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_15-57-56", "timestamp": 1618214276, "time_this_iter_s": 1428.2382831573486, "time_total_s": 250299.35034012794, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 250299.35034012794, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 11.76709296606001, "ram_util_percent": 18.551500245941956}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1762.301079374112, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1893.004166576972, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1994.6736188873133, -1928.0472738348121, -1884.6120240316031, -1903.1748706532414, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.973427668559, "mean_raw_obs_processing_ms": 2.307913109035027, "mean_inference_ms": 114.81712720910616, "mean_action_processing_ms": 0.36662783031963286}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 688000, "timers": {"sample_time_ms": 1338267.717, "sample_throughput": 2.989, "learn_time_ms": 98365.676, "learn_throughput": 40.665, "update_time_ms": 24.218}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07171348572592251, "policy_loss": -0.01794133911607787, "vf_loss": 378.7805051803589, "vf_explained_var": 0.8620983362197876, "kl": 0.010440060461405665, "entropy": 59.90896141529083, "entropy_coeff": 0.001}}, "num_steps_sampled": 688000, "num_steps_trained": 688000}, "done": false, "episodes_total": 688, "training_iteration": 172, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_16-22-21", "timestamp": 1618215741, "time_this_iter_s": 1464.6214258670807, "time_total_s": 251763.97176599503, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 251763.97176599503, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 14.601966426858512, "ram_util_percent": 19.412278177458035}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1762.301079374112, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1889.4735414529675, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1933.7568022701878, -1922.3994529348197, -1905.2575969341071, -1884.0812862545638, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.005837487048, "mean_raw_obs_processing_ms": 2.3081700013725315, "mean_inference_ms": 114.8245571454858, "mean_action_processing_ms": 0.3667167264347613}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 692000, "timers": {"sample_time_ms": 1342032.853, "sample_throughput": 2.981, "learn_time_ms": 100656.076, "learn_throughput": 39.739, "update_time_ms": 23.24}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07095540914451703, "policy_loss": -0.01770809033769183, "vf_loss": 401.4698600769043, "vf_explained_var": 0.8501962423324585, "kl": 0.011927698069484904, "entropy": 59.9457483291626, "entropy_coeff": 0.001}}, "num_steps_sampled": 692000, "num_steps_trained": 692000}, "done": false, "episodes_total": 692, "training_iteration": 173, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_16-47-17", "timestamp": 1618217237, "time_this_iter_s": 1495.8637521266937, "time_total_s": 253259.83551812172, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 253259.83551812172, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 22.661625176139037, "ram_util_percent": 22.371019257867548}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1762.301079374112, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1888.4869858631268, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1934.0419023130069, -1933.7235156691872, -1861.486414678244, -1930.17926587309, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.0486915627172, "mean_raw_obs_processing_ms": 2.3084756763910024, "mean_inference_ms": 114.83355812061967, "mean_action_processing_ms": 0.3668265612135666}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 696000, "timers": {"sample_time_ms": 1353080.302, "sample_throughput": 2.956, "learn_time_ms": 101695.25, "learn_throughput": 39.333, "update_time_ms": 22.973}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07378315617097542, "policy_loss": -0.020682604343164712, "vf_loss": 441.95494747161865, "vf_explained_var": 0.8282351493835449, "kl": 0.012237475661095232, "entropy": 60.27353525161743, "entropy_coeff": 0.001}}, "num_steps_sampled": 696000, "num_steps_trained": 696000}, "done": false, "episodes_total": 696, "training_iteration": 174, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_17-13-11", "timestamp": 1618218791, "time_this_iter_s": 1554.0601665973663, "time_total_s": 254813.8956847191, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 254813.8956847191, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 26.571428571428573, "ram_util_percent": 23.47133815551537}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1762.301079374112, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1886.0665761869307, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1901.6549418456923, -1965.1863632375548, -1934.5606908419095, -1940.5477070474697, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.1028997583389, "mean_raw_obs_processing_ms": 2.3087945473816083, "mean_inference_ms": 114.84435941962376, "mean_action_processing_ms": 0.3669451104980633}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 700000, "timers": {"sample_time_ms": 1364097.904, "sample_throughput": 2.932, "learn_time_ms": 105130.939, "learn_throughput": 38.048, "update_time_ms": 23.628}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06967452901881188, "policy_loss": -0.01588538003852591, "vf_loss": 311.65832138061523, "vf_explained_var": 0.8838212490081787, "kl": 0.014322364295367151, "entropy": 60.12826144695282, "entropy_coeff": 0.001}}, "num_steps_sampled": 700000, "num_steps_trained": 700000}, "done": false, "episodes_total": 700, "training_iteration": 175, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_17-39-31", "timestamp": 1618220371, "time_this_iter_s": 1580.0978713035583, "time_total_s": 256393.99355602264, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 256393.99355602264, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 25.093285904846596, "ram_util_percent": 24.079368608270343}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1762.301079374112, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1881.9082580363984, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1925.6127529841278, -1924.0008158343837, -1914.3911050053016, -1945.8009967467556, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.1632558595613, "mean_raw_obs_processing_ms": 2.309088864101855, "mean_inference_ms": 114.85643913680569, "mean_action_processing_ms": 0.367072795707909}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 704000, "timers": {"sample_time_ms": 1369825.874, "sample_throughput": 2.92, "learn_time_ms": 108252.022, "learn_throughput": 36.951, "update_time_ms": 23.608}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07602473642327823, "policy_loss": -0.02191727567696944, "vf_loss": 401.06986141204834, "vf_explained_var": 0.8461453318595886, "kl": 0.011704584379913285, "entropy": 60.751688957214355, "entropy_coeff": 0.001}}, "num_steps_sampled": 704000, "num_steps_trained": 704000}, "done": false, "episodes_total": 704, "training_iteration": 176, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_18-04-58", "timestamp": 1618221898, "time_this_iter_s": 1526.6923871040344, "time_total_s": 257920.68594312668, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 257920.68594312668, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 23.111504832029453, "ram_util_percent": 24.077956741831567}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1762.301079374112, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1876.6969795809307, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1950.2632850088985, -1932.6060091350482, -1979.6423797867992, -1990.4002955031444, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.2303921502665, "mean_raw_obs_processing_ms": 2.3093810100831855, "mean_inference_ms": 114.86927093413301, "mean_action_processing_ms": 0.36719061444282636}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 708000, "timers": {"sample_time_ms": 1375979.377, "sample_throughput": 2.907, "learn_time_ms": 112093.517, "learn_throughput": 35.684, "update_time_ms": 24.698}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06285134996869601, "policy_loss": -0.010280776186846197, "vf_loss": 571.1927704811096, "vf_explained_var": 0.810577392578125, "kl": 0.01258848435827531, "entropy": 61.11490786075592, "entropy_coeff": 0.001}}, "num_steps_sampled": 708000, "num_steps_trained": 708000}, "done": false, "episodes_total": 708, "training_iteration": 177, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_18-30-23", "timestamp": 1618223423, "time_this_iter_s": 1525.820363521576, "time_total_s": 259446.50630664825, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 259446.50630664825, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 24.5234914785813, "ram_util_percent": 26.033302625518193}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1762.301079374112, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1871.947408187175, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1882.0017027420238, -1910.8532679301652, -1879.3681913891987, -1876.1681264342901, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.304306507694, "mean_raw_obs_processing_ms": 2.309680013021462, "mean_inference_ms": 114.88293447383953, "mean_action_processing_ms": 0.3673228579052254}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 712000, "timers": {"sample_time_ms": 1383586.747, "sample_throughput": 2.891, "learn_time_ms": 113807.183, "learn_throughput": 35.147, "update_time_ms": 21.973}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06971940031507984, "policy_loss": -0.013603442464955151, "vf_loss": 258.69766759872437, "vf_explained_var": 0.8954075574874878, "kl": 0.01140528597170487, "entropy": 61.269121408462524, "entropy_coeff": 0.001}}, "num_steps_sampled": 712000, "num_steps_trained": 712000}, "done": false, "episodes_total": 712, "training_iteration": 178, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_18-55-56", "timestamp": 1618224956, "time_this_iter_s": 1532.831869840622, "time_total_s": 260979.33817648888, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 260979.33817648888, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 23.991109074243816, "ram_util_percent": 28.663198900091654}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1762.301079374112, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1869.627836759166, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1955.6048938068568, -1924.711183394444, -1991.3835066815782, -1886.652734606413, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.3826269373275, "mean_raw_obs_processing_ms": 2.310001259765197, "mean_inference_ms": 114.89745217075311, "mean_action_processing_ms": 0.3674563041846053}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 716000, "timers": {"sample_time_ms": 1388678.873, "sample_throughput": 2.88, "learn_time_ms": 113721.97, "learn_throughput": 35.174, "update_time_ms": 22.241}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0717325396835804, "policy_loss": -0.017386482970323414, "vf_loss": 287.17204332351685, "vf_explained_var": 0.8966348171234131, "kl": 0.01389817480230704, "entropy": 60.34486377239227, "entropy_coeff": 0.001}}, "num_steps_sampled": 716000, "num_steps_trained": 716000}, "done": false, "episodes_total": 716, "training_iteration": 179, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_19-20-39", "timestamp": 1618226439, "time_this_iter_s": 1482.3975946903229, "time_total_s": 262461.7357711792, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 262461.7357711792, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 17.334343912837518, "ram_util_percent": 26.751350071056375}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1755.9676858028852, "episode_reward_min": -2035.7848146414615, "episode_reward_mean": -1864.469839015717, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1884.3329159914197, -1936.69144336097, -2035.7848146414615, -1805.7233393798526, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.4380975934688, "mean_raw_obs_processing_ms": 2.310267168281514, "mean_inference_ms": 114.90907815823643, "mean_action_processing_ms": 0.3675677686974872}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 720000, "timers": {"sample_time_ms": 1391236.894, "sample_throughput": 2.875, "learn_time_ms": 114049.864, "learn_throughput": 35.072, "update_time_ms": 18.938}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07884729979559779, "policy_loss": -0.026386244338937104, "vf_loss": 424.2795658111572, "vf_explained_var": 0.8294519186019897, "kl": 0.014793728769291192, "entropy": 60.032437324523926, "entropy_coeff": 0.001}}, "num_steps_sampled": 720000, "num_steps_trained": 720000}, "done": false, "episodes_total": 720, "training_iteration": 180, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_19-45-01", "timestamp": 1618227901, "time_this_iter_s": 1462.530389547348, "time_total_s": 263924.26616072655, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 263924.26616072655, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 14.099807877041306, "ram_util_percent": 26.25403458213256}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1755.9676858028852, "episode_reward_min": -1997.7410228554966, "episode_reward_mean": -1860.3165506801458, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1912.5090585540565, -1913.56884677517, -1868.8059691693554, -1942.819615793114, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.4724623680028, "mean_raw_obs_processing_ms": 2.3105402702824778, "mean_inference_ms": 114.91805641916434, "mean_action_processing_ms": 0.3676462954184152}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 724000, "timers": {"sample_time_ms": 1394201.766, "sample_throughput": 2.869, "learn_time_ms": 114525.81, "learn_throughput": 34.927, "update_time_ms": 19.032}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.05985662166494876, "policy_loss": -0.005995811312459409, "vf_loss": 316.3963894844055, "vf_explained_var": 0.8745201826095581, "kl": 0.014197950367815793, "entropy": 60.219308853149414, "entropy_coeff": 0.001}}, "num_steps_sampled": 724000, "num_steps_trained": 724000}, "done": false, "episodes_total": 724, "training_iteration": 181, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_20-09-24", "timestamp": 1618229364, "time_this_iter_s": 1462.6472957134247, "time_total_s": 265386.91345644, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 265386.91345644, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 14.859462055715658, "ram_util_percent": 26.311575408261287}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1750.6433200317797, "episode_reward_min": -1997.7410228554966, "episode_reward_mean": -1856.3299794572793, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1877.7058411148776, -1953.1764267121982, -1874.5197560262109, -1864.556114376413, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.498184438882, "mean_raw_obs_processing_ms": 2.3108032075173783, "mean_inference_ms": 114.92609827979945, "mean_action_processing_ms": 0.3677205667648269}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 728000, "timers": {"sample_time_ms": 1398139.674, "sample_throughput": 2.861, "learn_time_ms": 115899.001, "learn_throughput": 34.513, "update_time_ms": 18.457}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07892538234591484, "policy_loss": -0.02413248980883509, "vf_loss": 301.54323649406433, "vf_explained_var": 0.8871104717254639, "kl": 0.011765079543692991, "entropy": 60.45546579360962, "entropy_coeff": 0.001}}, "num_steps_sampled": 728000, "num_steps_trained": 728000}, "done": false, "episodes_total": 728, "training_iteration": 182, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_20-34-42", "timestamp": 1618230882, "time_this_iter_s": 1517.7267763614655, "time_total_s": 266904.64023280144, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 266904.64023280144, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 17.841342592592593, "ram_util_percent": 27.041157407407404}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1750.6433200317797, "episode_reward_min": -1997.7410228554966, "episode_reward_mean": -1852.9510455666666, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1981.2884880836534, -1869.8296356456315, -1907.320877296871, -1921.17696436049, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.5232906705133, "mean_raw_obs_processing_ms": 2.3110671233309996, "mean_inference_ms": 114.93472683313568, "mean_action_processing_ms": 0.3677975760883443}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 732000, "timers": {"sample_time_ms": 1407215.576, "sample_throughput": 2.842, "learn_time_ms": 116540.775, "learn_throughput": 34.323, "update_time_ms": 20.848}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07542264283983968, "policy_loss": -0.021681589307263494, "vf_loss": 413.8340826034546, "vf_explained_var": 0.8511887788772583, "kl": 0.013000712468056008, "entropy": 60.80455219745636, "entropy_coeff": 0.001}}, "num_steps_sampled": 732000, "num_steps_trained": 732000}, "done": false, "episodes_total": 732, "training_iteration": 183, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_21-01-15", "timestamp": 1618232475, "time_this_iter_s": 1593.066484451294, "time_total_s": 268497.70671725273, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 268497.70671725273, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 27.654717813051143, "ram_util_percent": 29.56093474426808}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1718.984180762571, "episode_reward_min": -1997.7410228554966, "episode_reward_mean": -1847.1909807742238, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1926.0336415800891, -1860.652154138949, -1865.4866633446109, -1892.1171648337474, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.5548405649558, "mean_raw_obs_processing_ms": 2.3113415415505254, "mean_inference_ms": 114.94498024937289, "mean_action_processing_ms": 0.3678641472044258}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 736000, "timers": {"sample_time_ms": 1408162.777, "sample_throughput": 2.841, "learn_time_ms": 116958.916, "learn_throughput": 34.2, "update_time_ms": 21.034}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.056678057968383655, "policy_loss": -0.0014633820683229715, "vf_loss": 306.69001626968384, "vf_explained_var": 0.8832399845123291, "kl": 0.013443043746519834, "entropy": 61.30626046657562, "entropy_coeff": 0.001}}, "num_steps_sampled": 736000, "num_steps_trained": 736000}, "done": false, "episodes_total": 736, "training_iteration": 184, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_21-27-23", "timestamp": 1618234043, "time_this_iter_s": 1567.7154529094696, "time_total_s": 270065.4221701622, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 270065.4221701622, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 27.709054235768715, "ram_util_percent": 34.53930972658001}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1718.984180762571, "episode_reward_min": -1997.7410228554966, "episode_reward_mean": -1843.1370977684157, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1883.6894676279717, -1908.9382749127785, -1829.3994360298718, -1928.1823442309365, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.5939421486505, "mean_raw_obs_processing_ms": 2.3115778497971893, "mean_inference_ms": 114.9560637595101, "mean_action_processing_ms": 0.3679265595183125}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 740000, "timers": {"sample_time_ms": 1407070.391, "sample_throughput": 2.843, "learn_time_ms": 117130.073, "learn_throughput": 34.15, "update_time_ms": 21.467}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07814193039666861, "policy_loss": -0.02479999855859205, "vf_loss": 439.7435293197632, "vf_explained_var": 0.8423144817352295, "kl": 0.01386087920400314, "entropy": 60.858060240745544, "entropy_coeff": 0.001}}, "num_steps_sampled": 740000, "num_steps_trained": 740000}, "done": false, "episodes_total": 740, "training_iteration": 185, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_21-53-34", "timestamp": 1618235614, "time_this_iter_s": 1570.8900871276855, "time_total_s": 271636.3122572899, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 271636.3122572899, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 26.51936493738819, "ram_util_percent": 36.50688729874776}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1718.984180762571, "episode_reward_min": -1997.7410228554966, "episode_reward_mean": -1839.3288612437996, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1909.0920485836643, -1817.7816417352392, -1852.9734155177307, -1899.0332145882946, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.635053249105, "mean_raw_obs_processing_ms": 2.311821265803375, "mean_inference_ms": 114.96760148810867, "mean_action_processing_ms": 0.3680012072072492}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 744000, "timers": {"sample_time_ms": 1410876.829, "sample_throughput": 2.835, "learn_time_ms": 116910.397, "learn_throughput": 34.214, "update_time_ms": 22.33}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07420109189115465, "policy_loss": -0.019645042542833835, "vf_loss": 290.1810896396637, "vf_explained_var": 0.8887968063354492, "kl": 0.015786250674864277, "entropy": 61.00976228713989, "entropy_coeff": 0.001}}, "num_steps_sampled": 744000, "num_steps_trained": 744000}, "done": false, "episodes_total": 744, "training_iteration": 186, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_22-19-36", "timestamp": 1618237176, "time_this_iter_s": 1562.5701355934143, "time_total_s": 273198.8823928833, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 273198.8823928833, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 26.290557553956834, "ram_util_percent": 39.03961330935251}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1718.984180762571, "episode_reward_min": -1997.7410228554966, "episode_reward_mean": -1835.2451187603767, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1955.6924632885523, -1848.6051266736797, -1912.613453696778, -1997.7410228554966, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.6818205403658, "mean_raw_obs_processing_ms": 2.312082829299035, "mean_inference_ms": 114.98001502205861, "mean_action_processing_ms": 0.3680711818753305}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 748000, "timers": {"sample_time_ms": 1416491.306, "sample_throughput": 2.824, "learn_time_ms": 115725.182, "learn_throughput": 34.565, "update_time_ms": 21.446}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07031684188405052, "policy_loss": -0.0155194730614312, "vf_loss": 261.3514688014984, "vf_explained_var": 0.8929798603057861, "kl": 0.015005646244389936, "entropy": 60.78714919090271, "entropy_coeff": 0.001}}, "num_steps_sampled": 748000, "num_steps_trained": 748000}, "done": false, "episodes_total": 748, "training_iteration": 187, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_22-45-46", "timestamp": 1618238746, "time_this_iter_s": 1570.1063590049744, "time_total_s": 274768.9887518883, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 274768.9887518883, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 27.101969561324978, "ram_util_percent": 36.84449418084154}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1718.984180762571, "episode_reward_min": -1984.5045518326792, "episode_reward_mean": -1828.4184729352544, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1948.6278649489489, -1889.2008044915658, -1762.301079374112, -1851.224571970841, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.7336777177271, "mean_raw_obs_processing_ms": 2.312334044698637, "mean_inference_ms": 114.99339033129098, "mean_action_processing_ms": 0.3681296652540918}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 752000, "timers": {"sample_time_ms": 1414168.442, "sample_throughput": 2.829, "learn_time_ms": 116723.793, "learn_throughput": 34.269, "update_time_ms": 24.013}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07510933006415144, "policy_loss": -0.01973596098832786, "vf_loss": 205.2953085899353, "vf_explained_var": 0.9104324579238892, "kl": 0.013441942806821316, "entropy": 60.45075511932373, "entropy_coeff": 0.001}}, "num_steps_sampled": 752000, "num_steps_trained": 752000}, "done": false, "episodes_total": 752, "training_iteration": 188, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_23-11-06", "timestamp": 1618240266, "time_this_iter_s": 1519.6044480800629, "time_total_s": 276288.59319996834, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 276288.59319996834, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 22.00656495607952, "ram_util_percent": 35.47175219602404}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1706.6640006982452, "episode_reward_min": -1984.5045518326792, "episode_reward_mean": -1825.4932518234014, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1885.517757513815, -1959.9742162295324, -1859.1113165257973, -1829.0319018875507, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.7911926839312, "mean_raw_obs_processing_ms": 2.312592340140935, "mean_inference_ms": 115.0074831608227, "mean_action_processing_ms": 0.368186811583528}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 756000, "timers": {"sample_time_ms": 1414821.724, "sample_throughput": 2.827, "learn_time_ms": 119133.403, "learn_throughput": 33.576, "update_time_ms": 24.578}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07736361870774999, "policy_loss": -0.0239776850794442, "vf_loss": 351.9534854888916, "vf_explained_var": 0.86561119556427, "kl": 0.016719470324460417, "entropy": 60.667348742485046, "entropy_coeff": 0.001}}, "num_steps_sampled": 756000, "num_steps_trained": 756000}, "done": false, "episodes_total": 756, "training_iteration": 189, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-12_23-36-19", "timestamp": 1618241779, "time_this_iter_s": 1513.02796626091, "time_total_s": 277801.62116622925, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 277801.62116622925, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 22.29781801299907, "ram_util_percent": 35.57794800371402}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1706.6640006982452, "episode_reward_min": -1984.5045518326792, "episode_reward_mean": -1821.7290097895734, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1867.226604797775, -1901.9795470565987, -1850.8182002574251, -1843.8055752280152, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.8522267932021, "mean_raw_obs_processing_ms": 2.312867868957081, "mean_inference_ms": 115.02199393465129, "mean_action_processing_ms": 0.3682120914004341}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 760000, "timers": {"sample_time_ms": 1416001.339, "sample_throughput": 2.825, "learn_time_ms": 121224.294, "learn_throughput": 32.997, "update_time_ms": 26.769}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0825163232802879, "policy_loss": -0.0271966676809825, "vf_loss": 261.2864582538605, "vf_explained_var": 0.9060655832290649, "kl": 0.015106435574125499, "entropy": 61.331463098526, "entropy_coeff": 0.001}}, "num_steps_sampled": 760000, "num_steps_trained": 760000}, "done": false, "episodes_total": 760, "training_iteration": 190, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_00-01-14", "timestamp": 1618243274, "time_this_iter_s": 1495.2574031352997, "time_total_s": 279296.87856936455, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 279296.87856936455, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 22.25827067669173, "ram_util_percent": 35.66588345864662}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1706.6640006982452, "episode_reward_min": -1984.5045518326792, "episode_reward_mean": -1817.6837224891867, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1845.327936029325, -1825.2651698888212, -1878.9265839533173, -1829.6389753754374, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.916135322607, "mean_raw_obs_processing_ms": 2.3131714539906194, "mean_inference_ms": 115.03650412754702, "mean_action_processing_ms": 0.36824974180716863}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 764000, "timers": {"sample_time_ms": 1417002.758, "sample_throughput": 2.823, "learn_time_ms": 123363.394, "learn_throughput": 32.425, "update_time_ms": 24.088}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07206468045478687, "policy_loss": -0.018141700536943972, "vf_loss": 302.0896773338318, "vf_explained_var": 0.8717019557952881, "kl": 0.01328987639863044, "entropy": 59.934094071388245, "entropy_coeff": 0.001}}, "num_steps_sampled": 764000, "num_steps_trained": 764000}, "done": false, "episodes_total": 764, "training_iteration": 191, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_00-26-08", "timestamp": 1618244768, "time_this_iter_s": 1494.0256536006927, "time_total_s": 280790.90422296524, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 280790.90422296524, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 22.350587682181477, "ram_util_percent": 35.666666666666664}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1706.6640006982452, "episode_reward_min": -1984.5045518326792, "episode_reward_mean": -1815.5743079700492, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1873.9602944057372, -1844.796638015743, -1890.1176657486078, -1881.1885165276244, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.9857305530466, "mean_raw_obs_processing_ms": 2.3134477073217905, "mean_inference_ms": 115.05156784024369, "mean_action_processing_ms": 0.3682654472308933}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 768000, "timers": {"sample_time_ms": 1418391.099, "sample_throughput": 2.82, "learn_time_ms": 122598.245, "learn_throughput": 32.627, "update_time_ms": 24.377}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06428380234865472, "policy_loss": -0.012343697715550661, "vf_loss": 444.87848472595215, "vf_explained_var": 0.8292437195777893, "kl": 0.015253937570378184, "entropy": 59.821019887924194, "entropy_coeff": 0.001}}, "num_steps_sampled": 768000, "num_steps_trained": 768000}, "done": false, "episodes_total": 768, "training_iteration": 192, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_00-51-32", "timestamp": 1618246292, "time_this_iter_s": 1523.967975616455, "time_total_s": 282314.8721985817, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 282314.8721985817, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 22.339557399723375, "ram_util_percent": 35.63084370677731}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1706.6640006982452, "episode_reward_min": -1984.5045518326792, "episode_reward_mean": -1812.1391111659718, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1826.4273524303817, -1845.726872743915, -1879.4307232562326, -1842.7814258418234, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.0581246134374, "mean_raw_obs_processing_ms": 2.3136993341138066, "mean_inference_ms": 115.06708625410603, "mean_action_processing_ms": 0.3682510757434195}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 772000, "timers": {"sample_time_ms": 1409480.407, "sample_throughput": 2.838, "learn_time_ms": 122135.856, "learn_throughput": 32.75, "update_time_ms": 21.929}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07857396709732711, "policy_loss": -0.025254564796341583, "vf_loss": 315.7822947502136, "vf_explained_var": 0.8760361075401306, "kl": 0.014625394571339712, "entropy": 59.76793670654297, "entropy_coeff": 0.001}}, "num_steps_sampled": 772000, "num_steps_trained": 772000}, "done": false, "episodes_total": 772, "training_iteration": 193, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_01-16-32", "timestamp": 1618247792, "time_this_iter_s": 1499.3125865459442, "time_total_s": 283814.18478512764, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 283814.18478512764, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 22.266213683223995, "ram_util_percent": 35.621462043111535}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1706.6640006982452, "episode_reward_min": -1984.5045518326792, "episode_reward_mean": -1809.3726737842214, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1818.1806539756897, -1798.5062644142622, -1881.1529595227694, -1819.0607440856327, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.1324015306458, "mean_raw_obs_processing_ms": 2.313932152243702, "mean_inference_ms": 115.08338286338422, "mean_action_processing_ms": 0.3682292855663731}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 776000, "timers": {"sample_time_ms": 1399738.865, "sample_throughput": 2.858, "learn_time_ms": 123386.546, "learn_throughput": 32.418, "update_time_ms": 21.697}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06859035039087757, "policy_loss": -0.014249385392758995, "vf_loss": 235.0064697265625, "vf_explained_var": 0.9044753313064575, "kl": 0.015372160283732228, "entropy": 60.149762868881226, "entropy_coeff": 0.001}}, "num_steps_sampled": 776000, "num_steps_trained": 776000}, "done": false, "episodes_total": 776, "training_iteration": 194, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_01-41-15", "timestamp": 1618249275, "time_this_iter_s": 1482.8046917915344, "time_total_s": 285296.9894769192, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 285296.9894769192, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 22.264756039791568, "ram_util_percent": 35.63363334912364}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1706.6640006982452, "episode_reward_min": -1984.5045518326792, "episode_reward_mean": -1809.2338075512848, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1816.795881759758, -1814.6489505843087, -1892.0738789006834, -1852.9749654454968, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.2092807510709, "mean_raw_obs_processing_ms": 2.314219850043941, "mean_inference_ms": 115.10000132696165, "mean_action_processing_ms": 0.3682234873162329}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 780000, "timers": {"sample_time_ms": 1392939.756, "sample_throughput": 2.872, "learn_time_ms": 122337.535, "learn_throughput": 32.696, "update_time_ms": 21.601}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0678927380067762, "policy_loss": -0.015762957744300365, "vf_loss": 501.16142416000366, "vf_explained_var": 0.8135380744934082, "kl": 0.01380997381056659, "entropy": 60.24863314628601, "entropy_coeff": 0.001}}, "num_steps_sampled": 780000, "num_steps_trained": 780000}, "done": false, "episodes_total": 780, "training_iteration": 195, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_02-06-07", "timestamp": 1618250767, "time_this_iter_s": 1492.4274444580078, "time_total_s": 286789.4169213772, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 286789.4169213772, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 22.281920903954802, "ram_util_percent": 35.61591337099812}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1706.6640006982452, "episode_reward_min": -1984.5045518326792, "episode_reward_mean": -1805.995835696861, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1797.5156509196652, -1841.6726209442043, -1905.6946303000632, -1885.0452471293827, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.2889645509459, "mean_raw_obs_processing_ms": 2.3145245213438064, "mean_inference_ms": 115.11702273151477, "mean_action_processing_ms": 0.3682623958690571}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 784000, "timers": {"sample_time_ms": 1385729.873, "sample_throughput": 2.887, "learn_time_ms": 121759.284, "learn_throughput": 32.852, "update_time_ms": 20.792}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07143396697938442, "policy_loss": -0.017685521859675646, "vf_loss": 345.5860695838928, "vf_explained_var": 0.8780175447463989, "kl": 0.015875976881943643, "entropy": 60.77639961242676, "entropy_coeff": 0.001}}, "num_steps_sampled": 784000, "num_steps_trained": 784000}, "done": false, "episodes_total": 784, "training_iteration": 196, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_02-30-52", "timestamp": 1618252252, "time_this_iter_s": 1484.6789588928223, "time_total_s": 288274.09588027, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 288274.09588027, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 22.2540937056318, "ram_util_percent": 35.63478466635116}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1706.6640006982452, "episode_reward_min": -1984.5045518326792, "episode_reward_mean": -1804.0291447352654, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1827.6543282541352, -1830.621054879222, -1833.2991788813158, -1865.8707129918464, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.3729312418001, "mean_raw_obs_processing_ms": 2.3148455041021982, "mean_inference_ms": 115.1346002727891, "mean_action_processing_ms": 0.36828222893902607}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 788000, "timers": {"sample_time_ms": 1380137.3, "sample_throughput": 2.898, "learn_time_ms": 121767.605, "learn_throughput": 32.849, "update_time_ms": 21.426}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0708600472426042, "policy_loss": -0.016146732697961852, "vf_loss": 277.32105469703674, "vf_explained_var": 0.8885746002197266, "kl": 0.016575747955357656, "entropy": 61.21606385707855, "entropy_coeff": 0.001}}, "num_steps_sampled": 788000, "num_steps_trained": 788000}, "done": false, "episodes_total": 788, "training_iteration": 197, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_02-56-06", "timestamp": 1618253766, "time_this_iter_s": 1514.2681584358215, "time_total_s": 289788.3640387058, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 289788.3640387058, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 22.238914656771797, "ram_util_percent": 35.74870129870129}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1706.6640006982452, "episode_reward_min": -1984.5045518326792, "episode_reward_mean": -1800.7077555249284, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1873.7781734967377, -1984.5045518326792, -1884.9628012781561, -1803.5940528020435, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.457167551146, "mean_raw_obs_processing_ms": 2.315151374972323, "mean_inference_ms": 115.151829170741, "mean_action_processing_ms": 0.36829615448928993}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 792000, "timers": {"sample_time_ms": 1379031.834, "sample_throughput": 2.901, "learn_time_ms": 121471.425, "learn_throughput": 32.93, "update_time_ms": 20.521}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0704021799901966, "policy_loss": -0.01438776624854654, "vf_loss": 209.57729196548462, "vf_explained_var": 0.9135071039199829, "kl": 0.01216735492926091, "entropy": 60.84784007072449, "entropy_coeff": 0.001}}, "num_steps_sampled": 792000, "num_steps_trained": 792000}, "done": false, "episodes_total": 792, "training_iteration": 198, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_03-21-12", "timestamp": 1618255272, "time_this_iter_s": 1505.5791418552399, "time_total_s": 291293.94318056107, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 291293.94318056107, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 22.187301587301587, "ram_util_percent": 35.86465919701213}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1706.6640006982452, "episode_reward_min": -1915.8341522457292, "episode_reward_mean": -1796.8682826172035, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1915.8341522457292, -1894.1426461473748, -1843.0307691118533, -1764.3825634089344, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.5342938840139, "mean_raw_obs_processing_ms": 2.3154172316150867, "mean_inference_ms": 115.16764154087191, "mean_action_processing_ms": 0.36830673323607976}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 796000, "timers": {"sample_time_ms": 1377566.396, "sample_throughput": 2.904, "learn_time_ms": 120670.635, "learn_throughput": 33.148, "update_time_ms": 19.629}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06960061332210898, "policy_loss": -0.015058126009535044, "vf_loss": 353.8797583580017, "vf_explained_var": 0.86814284324646, "kl": 0.012073165009496734, "entropy": 60.7977432012558, "entropy_coeff": 0.001}}, "num_steps_sampled": 796000, "num_steps_trained": 796000}, "done": false, "episodes_total": 796, "training_iteration": 199, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_03-46-02", "timestamp": 1618256762, "time_this_iter_s": 1490.3568148612976, "time_total_s": 292784.29999542236, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 292784.29999542236, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 21.957728557964185, "ram_util_percent": 35.87714420358152}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1706.6640006982452, "episode_reward_min": -1899.2955004013832, "episode_reward_mean": -1795.1124238118305, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1814.656099079423, -1800.6049618305565, -1897.908170604237, -1812.9486564051858, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.6075469080907, "mean_raw_obs_processing_ms": 2.315674743337397, "mean_inference_ms": 115.18257727433588, "mean_action_processing_ms": 0.3683281096366823}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 800000, "timers": {"sample_time_ms": 1382011.168, "sample_throughput": 2.894, "learn_time_ms": 120409.192, "learn_throughput": 33.22, "update_time_ms": 16.64}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07426387837040238, "policy_loss": -0.020523770130239427, "vf_loss": 383.4946279525757, "vf_explained_var": 0.8459300994873047, "kl": 0.011866898552398197, "entropy": 60.24510073661804, "entropy_coeff": 0.001}}, "num_steps_sampled": 800000, "num_steps_trained": 800000}, "done": false, "episodes_total": 800, "training_iteration": 200, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_04-11-39", "timestamp": 1618258299, "time_this_iter_s": 1537.0608851909637, "time_total_s": 294321.3608806133, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 294321.3608806133, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 22.06483767718336, "ram_util_percent": 35.88267032464564}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1706.6640006982452, "episode_reward_min": -1899.2955004013832, "episode_reward_mean": -1794.1151631233347, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1804.9066668243595, -1767.4495256808557, -1765.4725412962714, -1850.8490912222903, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.6816015456818, "mean_raw_obs_processing_ms": 2.315939303559727, "mean_inference_ms": 115.1973092157942, "mean_action_processing_ms": 0.36836849722399523}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 804000, "timers": {"sample_time_ms": 1386417.502, "sample_throughput": 2.885, "learn_time_ms": 119102.231, "learn_throughput": 33.585, "update_time_ms": 17.582}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07385167019674554, "policy_loss": -0.020486915833316743, "vf_loss": 435.35385608673096, "vf_explained_var": 0.822982907295227, "kl": 0.012839437433285639, "entropy": 60.60716187953949, "entropy_coeff": 0.001}}, "num_steps_sampled": 804000, "num_steps_trained": 804000}, "done": false, "episodes_total": 804, "training_iteration": 201, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_04-37-04", "timestamp": 1618259824, "time_this_iter_s": 1525.028962135315, "time_total_s": 295846.38984274864, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 295846.38984274864, "timesteps_since_restore": 0, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 21.812574850299402, "ram_util_percent": 35.876877015200364}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1680.9513767796175, "episode_reward_min": -1899.2955004013832, "episode_reward_mean": -1794.2110711152907, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1860.1271459250531, -1805.1003445755725, -1833.9448441020122, -1878.7824954556795, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.7564817362654, "mean_raw_obs_processing_ms": 2.316220209581204, "mean_inference_ms": 115.21219493767232, "mean_action_processing_ms": 0.3684018002405909}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 808000, "timers": {"sample_time_ms": 1388156.695, "sample_throughput": 2.882, "learn_time_ms": 117938.921, "learn_throughput": 33.916, "update_time_ms": 18.249}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0717397902335506, "policy_loss": -0.016579585382714868, "vf_loss": 283.14936923980713, "vf_explained_var": 0.8845949172973633, "kl": 0.01289872350753285, "entropy": 60.89390468597412, "entropy_coeff": 0.001}}, "num_steps_sampled": 808000, "num_steps_trained": 808000}, "done": false, "episodes_total": 808, "training_iteration": 202, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_05-02-34", "timestamp": 1618261354, "time_this_iter_s": 1529.7271618843079, "time_total_s": 297376.11700463295, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 297376.11700463295, "timesteps_since_restore": 0, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 21.33665594855305, "ram_util_percent": 35.87432246210381}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1680.9513767796175, "episode_reward_min": -1899.2955004013832, "episode_reward_mean": -1790.926237954594, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1766.9230128275713, -1899.2955004013832, -1801.0268253758225, -1849.188807090027, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.8286983187958, "mean_raw_obs_processing_ms": 2.3164990428729597, "mean_inference_ms": 115.22706614113933, "mean_action_processing_ms": 0.36845072719194105}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 812000, "timers": {"sample_time_ms": 1390445.444, "sample_throughput": 2.877, "learn_time_ms": 118036.104, "learn_throughput": 33.888, "update_time_ms": 19.59}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0746289347007405, "policy_loss": -0.021471379732247442, "vf_loss": 362.374653339386, "vf_explained_var": 0.8633226156234741, "kl": 0.01617315923795104, "entropy": 60.42025673389435, "entropy_coeff": 0.001}}, "num_steps_sampled": 812000, "num_steps_trained": 812000}, "done": false, "episodes_total": 812, "training_iteration": 203, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_05-27-57", "timestamp": 1618262877, "time_this_iter_s": 1523.18182015419, "time_total_s": 298899.29882478714, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 298899.29882478714, "timesteps_since_restore": 0, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 22.107472324723247, "ram_util_percent": 35.865221402214026}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1680.9513767796175, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1787.840207559521, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1816.8745124636898, -1841.5140267039928, -1755.9676858028852, -1828.1963191738146, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.9010765101254, "mean_raw_obs_processing_ms": 2.3167796391439355, "mean_inference_ms": 115.24181091201226, "mean_action_processing_ms": 0.36849472553404794}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 816000, "timers": {"sample_time_ms": 1394028.205, "sample_throughput": 2.869, "learn_time_ms": 117826.565, "learn_throughput": 33.948, "update_time_ms": 20.089}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06145987153286114, "policy_loss": -0.008752424328122288, "vf_loss": 607.4562759399414, "vf_explained_var": 0.7699457406997681, "kl": 0.011769515345804393, "entropy": 61.43014848232269, "entropy_coeff": 0.001}}, "num_steps_sampled": 816000, "num_steps_trained": 816000}, "done": false, "episodes_total": 816, "training_iteration": 204, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_05-53-14", "timestamp": 1618264394, "time_this_iter_s": 1516.5419781208038, "time_total_s": 300415.84080290794, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 300415.84080290794, "timesteps_since_restore": 0, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 22.245947197776747, "ram_util_percent": 35.86118573413617}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1680.9513767796175, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1786.2065258659238, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1854.4137549248508, -1781.0532081498316, -1840.5537311390317, -1771.1829856028605, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.9762722244815, "mean_raw_obs_processing_ms": 2.317068219888684, "mean_inference_ms": 115.25645722519772, "mean_action_processing_ms": 0.36855827681876624}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 820000, "timers": {"sample_time_ms": 1396159.197, "sample_throughput": 2.865, "learn_time_ms": 117673.452, "learn_throughput": 33.992, "update_time_ms": 21.461}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06714440629002638, "policy_loss": -0.01213120124884881, "vf_loss": 283.921151638031, "vf_explained_var": 0.8783283233642578, "kl": 0.012527649843832478, "entropy": 60.67113757133484, "entropy_coeff": 0.001}}, "num_steps_sampled": 820000, "num_steps_trained": 820000}, "done": false, "episodes_total": 820, "training_iteration": 205, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_06-18-26", "timestamp": 1618265906, "time_this_iter_s": 1512.2001521587372, "time_total_s": 301928.0409550667, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 301928.0409550667, "timesteps_since_restore": 0, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 22.093866171003718, "ram_util_percent": 35.865799256505575}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1680.9513767796175, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1786.4156063151343, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1847.49236836149, -1868.9826888529944, -1750.6433200317797, -1771.9279907588148, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.0547171286954, "mean_raw_obs_processing_ms": 2.3173472308358694, "mean_inference_ms": 115.27146698357046, "mean_action_processing_ms": 0.36863410310054495}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 824000, "timers": {"sample_time_ms": 1399682.081, "sample_throughput": 2.858, "learn_time_ms": 117816.694, "learn_throughput": 33.951, "update_time_ms": 21.42}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.058827987289987504, "policy_loss": -0.005689069454092532, "vf_loss": 391.08287358283997, "vf_explained_var": 0.8613853454589844, "kl": 0.018543657613918185, "entropy": 61.22206723690033, "entropy_coeff": 0.001}}, "num_steps_sampled": 824000, "num_steps_trained": 824000}, "done": false, "episodes_total": 824, "training_iteration": 206, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_06-43-47", "timestamp": 1618267427, "time_this_iter_s": 1521.3397331237793, "time_total_s": 303449.38068819046, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 303449.38068819046, "timesteps_since_restore": 0, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 22.358818097876267, "ram_util_percent": 35.96662049861496}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1680.9513767796175, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1784.45564969349, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1812.5330806113113, -1770.8219757472841, -1816.3569129763928, -1832.3527798333926, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.13347580944, "mean_raw_obs_processing_ms": 2.3176075235027986, "mean_inference_ms": 115.28648500327192, "mean_action_processing_ms": 0.3687086861983445}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 828000, "timers": {"sample_time_ms": 1399655.665, "sample_throughput": 2.858, "learn_time_ms": 117913.444, "learn_throughput": 33.923, "update_time_ms": 23.355}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07555299482191913, "policy_loss": -0.022283134137978777, "vf_loss": 500.65288257598877, "vf_explained_var": 0.7914367914199829, "kl": 0.011565621010959148, "entropy": 60.8786518573761, "entropy_coeff": 0.001}}, "num_steps_sampled": 828000, "num_steps_trained": 828000}, "done": false, "episodes_total": 828, "training_iteration": 207, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_07-09-02", "timestamp": 1618268942, "time_this_iter_s": 1514.990564584732, "time_total_s": 304964.3712527752, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 304964.3712527752, "timesteps_since_restore": 0, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 21.642207792207795, "ram_util_percent": 35.98603896103896}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1680.9513767796175, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1783.1407223383376, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1803.2290951246357, -1789.656273631554, -1718.984180762571, -1791.7399366236248, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.2049997976757, "mean_raw_obs_processing_ms": 2.3178655659947136, "mean_inference_ms": 115.30073489873133, "mean_action_processing_ms": 0.3687844127691633}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 832000, "timers": {"sample_time_ms": 1401796.473, "sample_throughput": 2.853, "learn_time_ms": 117979.114, "learn_throughput": 33.904, "update_time_ms": 22.629}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07389561017043889, "policy_loss": -0.01846347568789497, "vf_loss": 199.16651058197021, "vf_explained_var": 0.9224374294281006, "kl": 0.013449373916955665, "entropy": 60.44990611076355, "entropy_coeff": 0.001}}, "num_steps_sampled": 832000, "num_steps_trained": 832000}, "done": false, "episodes_total": 832, "training_iteration": 208, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_07-34-30", "timestamp": 1618270470, "time_this_iter_s": 1527.6367313861847, "time_total_s": 306492.0079841614, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 306492.0079841614, "timesteps_since_restore": 0, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 22.085747126436782, "ram_util_percent": 35.97921839080459}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1680.9513767796175, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1782.196533286225, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1808.3799710612723, -1781.7895572179077, -1817.428424251425, -1731.3033707859538, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.2722335508581, "mean_raw_obs_processing_ms": 2.3181461326932284, "mean_inference_ms": 115.3140809755158, "mean_action_processing_ms": 0.36887196942134887}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 836000, "timers": {"sample_time_ms": 1405948.734, "sample_throughput": 2.845, "learn_time_ms": 117891.531, "learn_throughput": 33.929, "update_time_ms": 24.943}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06755093322135508, "policy_loss": -0.014590688340831548, "vf_loss": 568.3740935325623, "vf_explained_var": 0.8097314834594727, "kl": 0.015072564536239952, "entropy": 62.035308957099915, "entropy_coeff": 0.001}}, "num_steps_sampled": 836000, "num_steps_trained": 836000}, "done": false, "episodes_total": 836, "training_iteration": 209, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_08-00-01", "timestamp": 1618272001, "time_this_iter_s": 1531.0283198356628, "time_total_s": 308023.03630399704, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 308023.03630399704, "timesteps_since_restore": 0, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 22.037815511702618, "ram_util_percent": 35.98090867370354}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1680.9513767796175, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1780.8880716616436, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1794.45138892023, -1812.1465985603013, -1840.6424093090375, -1722.1454735504067, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.3378582600787, "mean_raw_obs_processing_ms": 2.3184471029231815, "mean_inference_ms": 115.32730528993844, "mean_action_processing_ms": 0.36894235089031807}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 840000, "timers": {"sample_time_ms": 1407716.284, "sample_throughput": 2.841, "learn_time_ms": 119681.833, "learn_throughput": 33.422, "update_time_ms": 27.111}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0743142002611421, "policy_loss": -0.019809935300145298, "vf_loss": 358.5494508743286, "vf_explained_var": 0.851075291633606, "kl": 0.012399374070810154, "entropy": 60.879613399505615, "entropy_coeff": 0.001}}, "num_steps_sampled": 840000, "num_steps_trained": 840000}, "done": false, "episodes_total": 840, "training_iteration": 210, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_08-26-14", "timestamp": 1618273574, "time_this_iter_s": 1572.6639363765717, "time_total_s": 309595.7002403736, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 309595.7002403736, "timesteps_since_restore": 0, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 24.31081322609473, "ram_util_percent": 36.30612153708668}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1680.9513767796175, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1779.8013627790383, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1757.9569321986994, -1781.045687918411, -1736.3250106829698, -1795.1784412825575, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.4014344177407, "mean_raw_obs_processing_ms": 2.3187053114152567, "mean_inference_ms": 115.34013320850117, "mean_action_processing_ms": 0.36899246611699604}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 844000, "timers": {"sample_time_ms": 1408609.153, "sample_throughput": 2.84, "learn_time_ms": 121561.823, "learn_throughput": 32.905, "update_time_ms": 26.426}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07016444249893539, "policy_loss": -0.01448054116917774, "vf_loss": 318.53311467170715, "vf_explained_var": 0.8738816380500793, "kl": 0.013269216811750084, "entropy": 61.85480356216431, "entropy_coeff": 0.001}}, "num_steps_sampled": 844000, "num_steps_trained": 844000}, "done": false, "episodes_total": 844, "training_iteration": 211, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_08-52-07", "timestamp": 1618275127, "time_this_iter_s": 1552.7507627010345, "time_total_s": 311148.45100307465, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 311148.45100307465, "timesteps_since_restore": 0, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 22.727737556561088, "ram_util_percent": 29.289547511312215}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1680.9513767796175, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1778.3538440250488, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1741.8918574890615, -1725.2240501212302, -1759.0659400411228, -1805.8056363508622, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.4599909056593, "mean_raw_obs_processing_ms": 2.3189741521476366, "mean_inference_ms": 115.35198666990259, "mean_action_processing_ms": 0.36903112002218774}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 848000, "timers": {"sample_time_ms": 1408171.876, "sample_throughput": 2.841, "learn_time_ms": 123860.719, "learn_throughput": 32.294, "update_time_ms": 25.715}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06764553976245224, "policy_loss": -0.015115947229787707, "vf_loss": 449.17952013015747, "vf_explained_var": 0.828945517539978, "kl": 0.01619375345762819, "entropy": 60.66498005390167, "entropy_coeff": 0.001}}, "num_steps_sampled": 848000, "num_steps_trained": 848000}, "done": false, "episodes_total": 848, "training_iteration": 212, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_09-17-55", "timestamp": 1618276675, "time_this_iter_s": 1548.3361909389496, "time_total_s": 312696.7871940136, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 312696.7871940136, "timesteps_since_restore": 0, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 25.809714026327736, "ram_util_percent": 24.84557421697685}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1675.1809697835943, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1777.4947551188898, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1819.5222274235803, -1706.6640006982452, -1834.1390688697054, -1798.506912608627, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.5170887713867, "mean_raw_obs_processing_ms": 2.3192220232948753, "mean_inference_ms": 115.36357106358652, "mean_action_processing_ms": 0.3690692954650586}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 852000, "timers": {"sample_time_ms": 1406797.603, "sample_throughput": 2.843, "learn_time_ms": 115945.644, "learn_throughput": 34.499, "update_time_ms": 23.705}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06829835593816824, "policy_loss": -0.012526085803983733, "vf_loss": 315.78230917453766, "vf_explained_var": 0.8710834383964539, "kl": 0.01300219853874296, "entropy": 61.85558748245239, "entropy_coeff": 0.001}}, "num_steps_sampled": 852000, "num_steps_trained": 852000}, "done": false, "episodes_total": 852, "training_iteration": 213, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_09-41-45", "timestamp": 1618278105, "time_this_iter_s": 1430.2682476043701, "time_total_s": 314127.05544161797, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 314127.05544161797, "timesteps_since_restore": 0, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 28.00014734774067, "ram_util_percent": 24.912180746561884}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1675.1809697835943, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1775.0513258858339, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1749.0678980177313, -1819.229774879742, -1790.238701428808, -1798.6746144475972, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.520828483286, "mean_raw_obs_processing_ms": 2.3193267641724993, "mean_inference_ms": 115.36254406630758, "mean_action_processing_ms": 0.3690884651972435}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 856000, "timers": {"sample_time_ms": 1336301.16, "sample_throughput": 2.993, "learn_time_ms": 107471.821, "learn_throughput": 37.219, "update_time_ms": 21.753}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07036790298298001, "policy_loss": -0.013570090930443257, "vf_loss": 211.12479996681213, "vf_explained_var": 0.9044352769851685, "kl": 0.014356868457980454, "entropy": 62.139352202415466, "entropy_coeff": 0.001}}, "num_steps_sampled": 856000, "num_steps_trained": 856000}, "done": false, "episodes_total": 856, "training_iteration": 214, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_09-53-52", "timestamp": 1618278832, "time_this_iter_s": 726.8195950984955, "time_total_s": 314853.87503671646, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 314853.87503671646, "timesteps_since_restore": 0, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 26.059420289855073, "ram_util_percent": 22.410338164251208}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1675.1809697835943, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1774.2652706889598, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1717.7224823140084, -1794.533596355815, -1780.3348795584325, -1766.7102390729024, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.4707450710798, "mean_raw_obs_processing_ms": 2.3192452824111127, "mean_inference_ms": 115.3487210400695, "mean_action_processing_ms": 0.36907900192802573}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 860000, "timers": {"sample_time_ms": 1262682.924, "sample_throughput": 3.168, "learn_time_ms": 99065.707, "learn_throughput": 40.377, "update_time_ms": 17.885}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06984455283964053, "policy_loss": -0.013758721324848011, "vf_loss": 250.03731107711792, "vf_explained_var": 0.9006044268608093, "kl": 0.012897866894491017, "entropy": 61.48822271823883, "entropy_coeff": 0.001}}, "num_steps_sampled": 860000, "num_steps_trained": 860000}, "done": false, "episodes_total": 860, "training_iteration": 215, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_10-05-24", "timestamp": 1618279524, "time_this_iter_s": 691.9179031848907, "time_total_s": 315545.79293990135, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 315545.79293990135, "timesteps_since_restore": 0, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 21.6351269035533, "ram_util_percent": 22.122030456852787}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1675.1809697835943, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1773.1334999950639, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1795.8412670102293, -1797.3277662253881, -1807.682649808739, -1767.3655302887796, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.3683353144886, "mean_raw_obs_processing_ms": 2.318989287457985, "mean_inference_ms": 115.32234353100408, "mean_action_processing_ms": 0.369025513840031}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 864000, "timers": {"sample_time_ms": 1188670.21, "sample_throughput": 3.365, "learn_time_ms": 90386.785, "learn_throughput": 44.254, "update_time_ms": 16.567}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0665997804608196, "policy_loss": -0.01080672862008214, "vf_loss": 270.3160808086395, "vf_explained_var": 0.89065021276474, "kl": 0.01067372557008639, "entropy": 60.89779758453369, "entropy_coeff": 0.001}}, "num_steps_sampled": 864000, "num_steps_trained": 864000}, "done": false, "episodes_total": 864, "training_iteration": 216, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_10-16-59", "timestamp": 1618280219, "time_this_iter_s": 694.4101366996765, "time_total_s": 316240.203076601, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 316240.203076601, "timesteps_since_restore": 0, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 20.88432760364004, "ram_util_percent": 22.01011122345804}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1675.1809697835943, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1772.0691482725047, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1818.0879910089984, -1782.2384358406387, -1766.2483999314886, -1779.9686075088769, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.2105807933129, "mean_raw_obs_processing_ms": 2.318586106171371, "mean_inference_ms": 115.28307452292121, "mean_action_processing_ms": 0.36892999008267147}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 868000, "timers": {"sample_time_ms": 1113937.351, "sample_throughput": 3.591, "learn_time_ms": 82278.505, "learn_throughput": 48.615, "update_time_ms": 12.118}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07196382700931281, "policy_loss": -0.018418431136524305, "vf_loss": 378.1461515426636, "vf_explained_var": 0.8506343960762024, "kl": 0.019132353394525126, "entropy": 61.631632685661316, "entropy_coeff": 0.001}}, "num_steps_sampled": 868000, "num_steps_trained": 868000}, "done": false, "episodes_total": 868, "training_iteration": 217, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_10-28-25", "timestamp": 1618280905, "time_this_iter_s": 686.5347039699554, "time_total_s": 316926.737780571, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 316926.737780571, "timesteps_since_restore": 0, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 20.746980552712387, "ram_util_percent": 22.004912998976458}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1675.1809697835943, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1769.9166192130185, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1814.575845073295, -1790.7204346681228, -1709.6056867042275, -1802.8206696516531, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 563.0004027961098, "mean_raw_obs_processing_ms": 2.318052613991446, "mean_inference_ms": 115.23102084838028, "mean_action_processing_ms": 0.36880010709208205}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 872000, "timers": {"sample_time_ms": 1038632.777, "sample_throughput": 3.851, "learn_time_ms": 73937.67, "learn_throughput": 54.1, "update_time_ms": 10.709}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.08446518471464515, "policy_loss": -0.029611670703161508, "vf_loss": 381.27305459976196, "vf_explained_var": 0.8498855233192444, "kl": 0.01444631940103136, "entropy": 61.91666090488434, "entropy_coeff": 0.001}}, "num_steps_sampled": 872000, "num_steps_trained": 872000}, "done": false, "episodes_total": 872, "training_iteration": 218, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_10-39-56", "timestamp": 1618281596, "time_this_iter_s": 691.1683683395386, "time_total_s": 317617.9061489105, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 317617.9061489105, "timesteps_since_restore": 0, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 21.53536585365854, "ram_util_percent": 22.016260162601625}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1675.1809697835943, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1768.8400930123028, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1856.6960634454451, -1796.2546378516254, -1813.0101434945152, -1837.053153913137, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.7400392023591, "mean_raw_obs_processing_ms": 2.317408038718171, "mean_inference_ms": 115.16659335299555, "mean_action_processing_ms": 0.36862407289145854}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 876000, "timers": {"sample_time_ms": 962346.98, "sample_throughput": 4.157, "learn_time_ms": 66460.123, "learn_throughput": 60.186, "update_time_ms": 7.487}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07516615497297607, "policy_loss": -0.019257044477853924, "vf_loss": 312.50307273864746, "vf_explained_var": 0.8760175704956055, "kl": 0.01302635922911577, "entropy": 61.965067744255066, "entropy_coeff": 0.001}}, "num_steps_sampled": 876000, "num_steps_trained": 876000}, "done": false, "episodes_total": 876, "training_iteration": 219, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_10-51-30", "timestamp": 1618282290, "time_this_iter_s": 693.3606522083282, "time_total_s": 318311.26680111885, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 318311.26680111885, "timesteps_since_restore": 0, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 21.00385005065856, "ram_util_percent": 22.012765957446806}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1668.097468948037, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1765.0925227212074, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1737.7720131316073, -1724.6506767047074, -1822.361486813149, -1767.9123145983733, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.4287826169088, "mean_raw_obs_processing_ms": 2.3165729104873107, "mean_inference_ms": 115.08987488495302, "mean_action_processing_ms": 0.3683988724920609}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 880000, "timers": {"sample_time_ms": 883953.726, "sample_throughput": 4.525, "learn_time_ms": 56718.013, "learn_throughput": 70.524, "update_time_ms": 5.3}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06906793738016859, "policy_loss": -0.012633882637601346, "vf_loss": 185.49367904663086, "vf_explained_var": 0.9255700707435608, "kl": 0.01525527288322337, "entropy": 61.72142148017883, "entropy_coeff": 0.001}}, "num_steps_sampled": 880000, "num_steps_trained": 880000}, "done": false, "episodes_total": 880, "training_iteration": 220, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_11-03-01", "timestamp": 1618282981, "time_this_iter_s": 691.2853209972382, "time_total_s": 319002.5521221161, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 319002.5521221161, "timesteps_since_restore": 0, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 20.869441624365482, "ram_util_percent": 22.01766497461929}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1632.1978477325786, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1762.3505029831622, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1811.5442114094692, -1833.650640175238, -1786.8414411965314, -1801.2227603525291, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 562.0676419435649, "mean_raw_obs_processing_ms": 2.315596302752379, "mean_inference_ms": 115.00098474798429, "mean_action_processing_ms": 0.3681014954907681}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 884000, "timers": {"sample_time_ms": 807105.951, "sample_throughput": 4.956, "learn_time_ms": 47199.015, "learn_throughput": 84.748, "update_time_ms": 3.991}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06978021090617403, "policy_loss": -0.014291761734057218, "vf_loss": 354.175172328949, "vf_explained_var": 0.8577185273170471, "kl": 0.012705234665190801, "entropy": 61.88887369632721, "entropy_coeff": 0.001}}, "num_steps_sampled": 884000, "num_steps_trained": 884000}, "done": false, "episodes_total": 884, "training_iteration": 221, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_11-14-30", "timestamp": 1618283670, "time_this_iter_s": 689.0698266029358, "time_total_s": 319691.621948719, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 319691.621948719, "timesteps_since_restore": 0, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 20.567278287461775, "ram_util_percent": 21.99388379204893}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1632.1978477325786, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1758.0736065269389, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1763.2340036864946, -1765.368195110761, -1765.6435644559972, -1731.060590719592, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.6541117046178, "mean_raw_obs_processing_ms": 2.3144667997878123, "mean_inference_ms": 114.89968362502147, "mean_action_processing_ms": 0.3677626992222161}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 888000, "timers": {"sample_time_ms": 731243.78, "sample_throughput": 5.47, "learn_time_ms": 37400.648, "learn_throughput": 106.95, "update_time_ms": 2.984}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07760571385733783, "policy_loss": -0.021947484754491597, "vf_loss": 290.7562837600708, "vf_explained_var": 0.8821945190429688, "kl": 0.012696297228103504, "entropy": 61.42245817184448, "entropy_coeff": 0.001}}, "num_steps_sampled": 888000, "num_steps_trained": 888000}, "done": false, "episodes_total": 888, "training_iteration": 222, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_11-26-02", "timestamp": 1618284362, "time_this_iter_s": 691.7206757068634, "time_total_s": 320383.3426244259, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 320383.3426244259, "timesteps_since_restore": 0, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 20.892994923857866, "ram_util_percent": 21.98182741116751}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1632.1978477325786, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1756.7868798735942, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1785.942951526075, -1795.5788779153881, -1788.395564069642, -1792.9748951259983, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 561.189966069618, "mean_raw_obs_processing_ms": 2.3132138746758786, "mean_inference_ms": 114.78637596146422, "mean_action_processing_ms": 0.36738127115111013}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 892000, "timers": {"sample_time_ms": 658350.497, "sample_throughput": 6.076, "learn_time_ms": 36214.679, "learn_throughput": 110.452, "update_time_ms": 2.813}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07610338824451901, "policy_loss": -0.020995461440179497, "vf_loss": 332.66847229003906, "vf_explained_var": 0.8572609424591064, "kl": 0.013528130948543549, "entropy": 61.478437304496765, "entropy_coeff": 0.001}}, "num_steps_sampled": 892000, "num_steps_trained": 892000}, "done": false, "episodes_total": 892, "training_iteration": 223, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_11-37-31", "timestamp": 1618285051, "time_this_iter_s": 689.4739947319031, "time_total_s": 321072.8166191578, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 321072.8166191578, "timesteps_since_restore": 0, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 15.14877800407332, "ram_util_percent": 20.369042769857437}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1632.1978477325786, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1754.7712470257597, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1770.3792796316554, -1853.2739986380877, -1823.8041644076127, -1794.3468076991992, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.6753706364991, "mean_raw_obs_processing_ms": 2.3118134020875676, "mean_inference_ms": 114.66125906719618, "mean_action_processing_ms": 0.3669575019393511}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 896000, "timers": {"sample_time_ms": 654345.913, "sample_throughput": 6.113, "learn_time_ms": 35442.862, "learn_throughput": 112.858, "update_time_ms": 2.822}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0737439455697313, "policy_loss": -0.021908440859988332, "vf_loss": 422.65586709976196, "vf_explained_var": 0.8172391057014465, "kl": 0.019481460709357634, "entropy": 60.44538712501526, "entropy_coeff": 0.001}}, "num_steps_sampled": 896000, "num_steps_trained": 896000}, "done": false, "episodes_total": 896, "training_iteration": 224, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_11-48-50", "timestamp": 1618285730, "time_this_iter_s": 679.0556273460388, "time_total_s": 321751.87224650383, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 321751.87224650383, "timesteps_since_restore": 0, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 11.070423991726988, "ram_util_percent": 19.234643226473633}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1632.1978477325786, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1751.4321013982474, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1864.9854120543464, -1731.7842133350875, -1868.7443878662543, -1760.877805814189, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 560.1070087705718, "mean_raw_obs_processing_ms": 2.310269331278316, "mean_inference_ms": 114.52391588348688, "mean_action_processing_ms": 0.36648251132499404}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 900000, "timers": {"sample_time_ms": 653398.435, "sample_throughput": 6.122, "learn_time_ms": 34994.692, "learn_throughput": 114.303, "update_time_ms": 2.795}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06687069064355455, "policy_loss": -0.011285625339951366, "vf_loss": 243.24461936950684, "vf_explained_var": 0.8992255926132202, "kl": 0.013751685299212113, "entropy": 61.11164045333862, "entropy_coeff": 0.001}}, "num_steps_sampled": 900000, "num_steps_trained": 900000}, "done": false, "episodes_total": 900, "training_iteration": 225, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_12-00-08", "timestamp": 1618286408, "time_this_iter_s": 677.9612600803375, "time_total_s": 322429.83350658417, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 322429.83350658417, "timesteps_since_restore": 0, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 11.080725388601035, "ram_util_percent": 19.224974093264247}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1632.1978477325786, "episode_reward_min": -1885.8426387333177, "episode_reward_mean": -1747.0222637706527, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1680.9513767796175, -1858.1778561657643, -1773.2967525406664, -1885.8426387333177, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 559.4862131503309, "mean_raw_obs_processing_ms": 2.3085930020476035, "mean_inference_ms": 114.3745274142603, "mean_action_processing_ms": 0.3659466868410459}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 904000, "timers": {"sample_time_ms": 652543.732, "sample_throughput": 6.13, "learn_time_ms": 34473.395, "learn_throughput": 116.032, "update_time_ms": 2.804}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07352393987821415, "policy_loss": -0.018973114667460322, "vf_loss": 223.87417554855347, "vf_explained_var": 0.9034703969955444, "kl": 0.014237882860470563, "entropy": 59.99308454990387, "entropy_coeff": 0.001}}, "num_steps_sampled": 904000, "num_steps_trained": 904000}, "done": false, "episodes_total": 904, "training_iteration": 226, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_12-11-29", "timestamp": 1618287089, "time_this_iter_s": 680.6501314640045, "time_total_s": 323110.4836380482, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 323110.4836380482, "timesteps_since_restore": 0, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 11.076676986584106, "ram_util_percent": 19.22569659442724}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1632.1978477325786, "episode_reward_min": -1855.9572958028061, "episode_reward_mean": -1743.0779719732757, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1718.763391148874, -1771.659203407474, -1785.518811772549, -1773.5301076597325, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 558.8128449285429, "mean_raw_obs_processing_ms": 2.3067789074628666, "mean_inference_ms": 114.21271284643375, "mean_action_processing_ms": 0.3653641916097166}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 908000, "timers": {"sample_time_ms": 651875.122, "sample_throughput": 6.136, "learn_time_ms": 34241.455, "learn_throughput": 116.817, "update_time_ms": 2.795}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07739388279151171, "policy_loss": -0.023590677155880257, "vf_loss": 319.4926176071167, "vf_explained_var": 0.865392804145813, "kl": 0.013720039278268814, "entropy": 60.085137248039246, "entropy_coeff": 0.001}}, "num_steps_sampled": 908000, "num_steps_trained": 908000}, "done": false, "episodes_total": 908, "training_iteration": 227, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_12-22-47", "timestamp": 1618287767, "time_this_iter_s": 677.5288441181183, "time_total_s": 323788.0124821663, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 323788.0124821663, "timesteps_since_restore": 0, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 11.087253886010364, "ram_util_percent": 19.226735751295337}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1632.1978477325786, "episode_reward_min": -1855.9572958028061, "episode_reward_mean": -1740.5314772218467, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1802.0583421601216, -1736.077677722337, -1712.069200090695, -1757.625886214396, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 558.088913632124, "mean_raw_obs_processing_ms": 2.304839075434347, "mean_inference_ms": 114.03867506054613, "mean_action_processing_ms": 0.36471914623069923}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 912000, "timers": {"sample_time_ms": 651022.138, "sample_throughput": 6.144, "learn_time_ms": 33481.561, "learn_throughput": 119.469, "update_time_ms": 2.799}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07112754107220098, "policy_loss": -0.016982892237138003, "vf_loss": 341.1738224029541, "vf_explained_var": 0.8497581481933594, "kl": 0.013931495166616514, "entropy": 60.69096922874451, "entropy_coeff": 0.001}}, "num_steps_sampled": 912000, "num_steps_trained": 912000}, "done": false, "episodes_total": 912, "training_iteration": 228, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_12-34-02", "timestamp": 1618288442, "time_this_iter_s": 675.0397803783417, "time_total_s": 324463.05226254463, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 324463.05226254463, "timesteps_since_restore": 0, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 11.082414151925077, "ram_util_percent": 19.22341311134235}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1622.1850957302086, "episode_reward_min": -1855.9572958028061, "episode_reward_mean": -1737.1107416818268, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1782.4221295276002, -1736.8009817030697, -1775.3906800881134, -1784.5705834658463, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 557.315329140363, "mean_raw_obs_processing_ms": 2.3027494193747717, "mean_inference_ms": 113.8530627325551, "mean_action_processing_ms": 0.3640226309189207}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 916000, "timers": {"sample_time_ms": 650195.092, "sample_throughput": 6.152, "learn_time_ms": 32795.3, "learn_throughput": 121.969, "update_time_ms": 2.627}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06884955274290405, "policy_loss": -0.01482421375112608, "vf_loss": 207.12633323669434, "vf_explained_var": 0.8997972011566162, "kl": 0.01603526930557564, "entropy": 59.70453715324402, "entropy_coeff": 0.001}}, "num_steps_sampled": 916000, "num_steps_trained": 916000}, "done": false, "episodes_total": 916, "training_iteration": 229, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_12-45-20", "timestamp": 1618289120, "time_this_iter_s": 678.2261807918549, "time_total_s": 325141.2784433365, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 325141.2784433365, "timesteps_since_restore": 0, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 11.09823834196891, "ram_util_percent": 19.23160621761658}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1619.8621534680422, "episode_reward_min": -1855.9572958028061, "episode_reward_mean": -1733.8940222257786, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1795.2102446171994, -1855.9572958028061, -1775.1660243734773, -1841.7781599441241, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 556.4923341992667, "mean_raw_obs_processing_ms": 2.300514876972107, "mean_inference_ms": 113.65606443191686, "mean_action_processing_ms": 0.36327264953577065}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 920000, "timers": {"sample_time_ms": 649411.817, "sample_throughput": 6.159, "learn_time_ms": 32044.548, "learn_throughput": 124.826, "update_time_ms": 2.626}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07387307146564126, "policy_loss": -0.020059392059920356, "vf_loss": 263.6056399345398, "vf_explained_var": 0.882840633392334, "kl": 0.01392395599395968, "entropy": 59.58262264728546, "entropy_coeff": 0.001}}, "num_steps_sampled": 920000, "num_steps_trained": 920000}, "done": false, "episodes_total": 920, "training_iteration": 230, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_12-56-36", "timestamp": 1618289796, "time_this_iter_s": 675.9449775218964, "time_total_s": 325817.2234208584, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 325817.2234208584, "timesteps_since_restore": 0, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 11.105815160955348, "ram_util_percent": 19.2269989615784}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1567.9425042074474, "episode_reward_min": -1830.5680776062447, "episode_reward_mean": -1727.3669820691691, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1806.4660042156017, -1745.9115535387812, -1737.650042089685, -1753.0231059965924, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 555.6203251746326, "mean_raw_obs_processing_ms": 2.2981510847434294, "mean_inference_ms": 113.44750230483707, "mean_action_processing_ms": 0.36248935931886783}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 924000, "timers": {"sample_time_ms": 648812.903, "sample_throughput": 6.165, "learn_time_ms": 31609.824, "learn_throughput": 126.543, "update_time_ms": 2.612}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06922877924807835, "policy_loss": -0.016163838910870254, "vf_loss": 252.17884612083435, "vf_explained_var": 0.8756701350212097, "kl": 0.01618995558237657, "entropy": 59.229464054107666, "entropy_coeff": 0.001}}, "num_steps_sampled": 924000, "num_steps_trained": 924000}, "done": false, "episodes_total": 924, "training_iteration": 231, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_13-07-55", "timestamp": 1618290475, "time_this_iter_s": 678.7332096099854, "time_total_s": 326495.95663046837, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 326495.95663046837, "timesteps_since_restore": 0, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 11.074534161490684, "ram_util_percent": 19.226915113871634}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1567.9425042074474, "episode_reward_min": -1830.5680776062447, "episode_reward_mean": -1723.6957225421131, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1797.763596216468, -1762.7238187514565, -1809.7038772190303, -1730.380721466171, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 554.6993490786292, "mean_raw_obs_processing_ms": 2.2956573778347478, "mean_inference_ms": 113.22732771978438, "mean_action_processing_ms": 0.361667577381}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 928000, "timers": {"sample_time_ms": 647528.507, "sample_throughput": 6.177, "learn_time_ms": 31160.03, "learn_throughput": 128.37, "update_time_ms": 2.595}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06546927208546549, "policy_loss": -0.01186551310820505, "vf_loss": 312.44636607170105, "vf_explained_var": 0.8705119490623474, "kl": 0.015109397034393623, "entropy": 60.12782967090607, "entropy_coeff": 0.001}}, "num_steps_sampled": 928000, "num_steps_trained": 928000}, "done": false, "episodes_total": 928, "training_iteration": 232, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_13-19-09", "timestamp": 1618291149, "time_this_iter_s": 674.3785312175751, "time_total_s": 327170.33516168594, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 327170.33516168594, "timesteps_since_restore": 0, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 11.082291666666666, "ram_util_percent": 19.22239583333333}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1567.9425042074474, "episode_reward_min": -1830.5680776062447, "episode_reward_mean": -1720.8684438564524, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.4209423205034, -1783.8273909535476, -1712.2293834585385, -1814.7128641985644, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 553.7299013929162, "mean_raw_obs_processing_ms": 2.2930380763890246, "mean_inference_ms": 112.99544521836042, "mean_action_processing_ms": 0.360797225969703}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 932000, "timers": {"sample_time_ms": 646249.992, "sample_throughput": 6.19, "learn_time_ms": 31157.242, "learn_throughput": 128.381, "update_time_ms": 2.588}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.08047391066793352, "policy_loss": -0.02683601644821465, "vf_loss": 415.30210876464844, "vf_explained_var": 0.8230331540107727, "kl": 0.011851028626551852, "entropy": 60.45739269256592, "entropy_coeff": 0.001}}, "num_steps_sampled": 932000, "num_steps_trained": 932000}, "done": false, "episodes_total": 932, "training_iteration": 233, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_13-30-26", "timestamp": 1618291826, "time_this_iter_s": 676.6609542369843, "time_total_s": 327846.9961159229, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 327846.9961159229, "timesteps_since_restore": 0, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 11.091381100726895, "ram_util_percent": 19.222637590861886}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1567.9425042074474, "episode_reward_min": -1830.5680776062447, "episode_reward_mean": -1720.1022010992542, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1710.4789871622795, -1767.947921442796, -1749.2336035987992, -1780.394648654508, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 552.7113639743187, "mean_raw_obs_processing_ms": 2.29025632623667, "mean_inference_ms": 112.75212509111822, "mean_action_processing_ms": 0.3598811324232358}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 936000, "timers": {"sample_time_ms": 646184.447, "sample_throughput": 6.19, "learn_time_ms": 31160.426, "learn_throughput": 128.368, "update_time_ms": 2.591}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07270544819766656, "policy_loss": -0.01726808736566454, "vf_loss": 232.2786145210266, "vf_explained_var": 0.895321786403656, "kl": 0.011075071844970807, "entropy": 60.25203859806061, "entropy_coeff": 0.001}}, "num_steps_sampled": 936000, "num_steps_trained": 936000}, "done": false, "episodes_total": 936, "training_iteration": 234, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_13-41-44", "timestamp": 1618292504, "time_this_iter_s": 678.43213057518, "time_total_s": 328525.4282464981, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 328525.4282464981, "timesteps_since_restore": 0, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 11.118840579710144, "ram_util_percent": 19.219151138716352}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1567.9425042074474, "episode_reward_min": -1830.5680776062447, "episode_reward_mean": -1715.63280841484, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1816.2909882449042, -1775.4030446757174, -1698.767914219409, -1770.2530349393905, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 551.642617769495, "mean_raw_obs_processing_ms": 2.287334656597904, "mean_inference_ms": 112.49692472883173, "mean_action_processing_ms": 0.3589275465384392}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 940000, "timers": {"sample_time_ms": 646147.477, "sample_throughput": 6.191, "learn_time_ms": 31160.814, "learn_throughput": 128.366, "update_time_ms": 2.592}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0739247354795225, "policy_loss": -0.018737583828624338, "vf_loss": 181.47551774978638, "vf_explained_var": 0.9169317483901978, "kl": 0.01394744060235098, "entropy": 60.14007747173309, "entropy_coeff": 0.001}}, "num_steps_sampled": 940000, "num_steps_trained": 940000}, "done": false, "episodes_total": 940, "training_iteration": 235, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_13-53-02", "timestamp": 1618293182, "time_this_iter_s": 677.5954887866974, "time_total_s": 329203.0237352848, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 329203.0237352848, "timesteps_since_restore": 0, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 11.090767634854771, "ram_util_percent": 19.214004149377594}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1567.9425042074474, "episode_reward_min": -1830.5680776062447, "episode_reward_mean": -1711.040227465321, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1730.6058897441833, -1793.154888156005, -1704.2494321179738, -1697.7439866656, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 550.5250173031191, "mean_raw_obs_processing_ms": 2.2842899332348825, "mean_inference_ms": 112.23045105651629, "mean_action_processing_ms": 0.3579341030318916}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 944000, "timers": {"sample_time_ms": 645849.763, "sample_throughput": 6.193, "learn_time_ms": 31163.663, "learn_throughput": 128.355, "update_time_ms": 2.576}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.08021373878000304, "policy_loss": -0.025725601182784885, "vf_loss": 211.5451374053955, "vf_explained_var": 0.8989524841308594, "kl": 0.016219866200117394, "entropy": 60.25305891036987, "entropy_coeff": 0.001}}, "num_steps_sampled": 944000, "num_steps_trained": 944000}, "done": false, "episodes_total": 944, "training_iteration": 236, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_14-04-20", "timestamp": 1618293860, "time_this_iter_s": 677.7012903690338, "time_total_s": 329880.72502565384, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 329880.72502565384, "timesteps_since_restore": 0, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 11.080829015544042, "ram_util_percent": 19.221243523316062}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1567.9425042074474, "episode_reward_min": -1830.5680776062447, "episode_reward_mean": -1707.869694448811, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1706.5540963206147, -1764.5750823118058, -1675.1809697835943, -1799.7684449703152, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 549.3597911868876, "mean_raw_obs_processing_ms": 2.28108993544126, "mean_inference_ms": 111.95287098233145, "mean_action_processing_ms": 0.3569030545913423}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 948000, "timers": {"sample_time_ms": 645838.071, "sample_throughput": 6.194, "learn_time_ms": 31161.083, "learn_throughput": 128.365, "update_time_ms": 2.576}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07910347415599972, "policy_loss": -0.025835025473497808, "vf_loss": 206.14707946777344, "vf_explained_var": 0.9028139114379883, "kl": 0.01770236945594661, "entropy": 59.31295108795166, "entropy_coeff": 0.001}}, "num_steps_sampled": 948000, "num_steps_trained": 948000}, "done": false, "episodes_total": 948, "training_iteration": 237, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_14-15-37", "timestamp": 1618294537, "time_this_iter_s": 677.3865523338318, "time_total_s": 330558.1115779877, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 330558.1115779877, "timesteps_since_restore": 0, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 11.075726141078839, "ram_util_percent": 19.226867219917015}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1567.9425042074474, "episode_reward_min": -1830.5680776062447, "episode_reward_mean": -1705.9562230614279, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1734.1344661834912, -1715.6407603662888, -1708.186944423395, -1756.527115321395, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 548.1497616713806, "mean_raw_obs_processing_ms": 2.277776412605842, "mean_inference_ms": 111.66445528066548, "mean_action_processing_ms": 0.3558305520532612}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 952000, "timers": {"sample_time_ms": 646103.66, "sample_throughput": 6.191, "learn_time_ms": 31160.982, "learn_throughput": 128.366, "update_time_ms": 2.578}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07751058001304045, "policy_loss": -0.02441914554219693, "vf_loss": 257.11937856674194, "vf_explained_var": 0.8770411610603333, "kl": 0.015905355277936906, "entropy": 59.24133110046387, "entropy_coeff": 0.001}}, "num_steps_sampled": 952000, "num_steps_trained": 952000}, "done": false, "episodes_total": 952, "training_iteration": 238, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_14-26-55", "timestamp": 1618295215, "time_this_iter_s": 677.6945400238037, "time_total_s": 331235.8061180115, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 331235.8061180115, "timesteps_since_restore": 0, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 11.077927461139897, "ram_util_percent": 19.225284974093267}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1567.9425042074474, "episode_reward_min": -1830.5680776062447, "episode_reward_mean": -1703.0249552364085, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1778.1375177079924, -1744.9518693564412, -1760.4593426275787, -1795.0567393945266, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.9473184491293, "mean_raw_obs_processing_ms": 2.2744844666534543, "mean_inference_ms": 111.37789308589954, "mean_action_processing_ms": 0.3547581429457206}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 956000, "timers": {"sample_time_ms": 646152.357, "sample_throughput": 6.19, "learn_time_ms": 31156.675, "learn_throughput": 128.383, "update_time_ms": 2.63}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06705600232817233, "policy_loss": -0.010108341870363802, "vf_loss": 154.4426531791687, "vf_explained_var": 0.9285072684288025, "kl": 0.011151626124046743, "entropy": 61.001200556755066, "entropy_coeff": 0.001}}, "num_steps_sampled": 956000, "num_steps_trained": 956000}, "done": false, "episodes_total": 956, "training_iteration": 239, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_14-38-14", "timestamp": 1618295894, "time_this_iter_s": 678.6706991195679, "time_total_s": 331914.47681713104, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 331914.47681713104, "timesteps_since_restore": 0, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 11.09358841778697, "ram_util_percent": 19.224922440537746}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1567.9425042074474, "episode_reward_min": -1830.5680776062447, "episode_reward_mean": -1697.9765889486025, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1760.1332406359106, -1763.9767981873842, -1740.208830024135, -1681.8052590640586, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.7547998769693, "mean_raw_obs_processing_ms": 2.2712358071910113, "mean_inference_ms": 111.09386505794274, "mean_action_processing_ms": 0.35369307480654144}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 960000, "timers": {"sample_time_ms": 646559.286, "sample_throughput": 6.187, "learn_time_ms": 31224.205, "learn_throughput": 128.106, "update_time_ms": 2.636}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06793773279059678, "policy_loss": -0.013329906039871275, "vf_loss": 245.8607383966446, "vf_explained_var": 0.870911180973053, "kl": 0.014608118712203577, "entropy": 60.3532600402832, "entropy_coeff": 0.001}}, "num_steps_sampled": 960000, "num_steps_trained": 960000}, "done": false, "episodes_total": 960, "training_iteration": 240, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_14-49-34", "timestamp": 1618296574, "time_this_iter_s": 680.690815448761, "time_total_s": 332595.1676325798, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 332595.1676325798, "timesteps_since_restore": 0, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 12.188544891640866, "ram_util_percent": 19.254695562435504}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1567.9425042074474, "episode_reward_min": -1830.5680776062447, "episode_reward_mean": -1694.4887036805908, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1753.6121800568856, -1746.4317460456966, -1731.170037368383, -1830.5680776062447, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.5723626605402, "mean_raw_obs_processing_ms": 2.268020532371104, "mean_inference_ms": 110.81230473491864, "mean_action_processing_ms": 0.3526381454824366}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 964000, "timers": {"sample_time_ms": 647215.958, "sample_throughput": 6.18, "learn_time_ms": 31531.18, "learn_throughput": 126.859, "update_time_ms": 2.635}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06599501409800723, "policy_loss": -0.012518080591689795, "vf_loss": 411.9862880706787, "vf_explained_var": 0.8135795593261719, "kl": 0.013647490995936096, "entropy": 60.66747856140137, "entropy_coeff": 0.001}}, "num_steps_sampled": 964000, "num_steps_trained": 964000}, "done": false, "episodes_total": 964, "training_iteration": 241, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_15-01-03", "timestamp": 1618297263, "time_this_iter_s": 688.369710445404, "time_total_s": 333283.5373430252, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 333283.5373430252, "timesteps_since_restore": 0, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 21.463877551020406, "ram_util_percent": 22.333367346938772}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1567.9425042074474, "episode_reward_min": -1816.981793945992, "episode_reward_mean": -1689.8170173112294, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1755.6504093888207, -1752.7576687580856, -1704.8334724304802, -1718.0489777640576, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.4005870449238, "mean_raw_obs_processing_ms": 2.2648395797155643, "mean_inference_ms": 110.53336785262944, "mean_action_processing_ms": 0.3515915003283399}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 968000, "timers": {"sample_time_ms": 648806.55, "sample_throughput": 6.165, "learn_time_ms": 32190.128, "learn_throughput": 124.262, "update_time_ms": 2.771}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07256160496035591, "policy_loss": -0.017678768519544974, "vf_loss": 202.19504928588867, "vf_explained_var": 0.9107015132904053, "kl": 0.015927268337691203, "entropy": 60.48841726779938, "entropy_coeff": 0.001}}, "num_steps_sampled": 968000, "num_steps_trained": 968000}, "done": false, "episodes_total": 968, "training_iteration": 242, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_15-12-40", "timestamp": 1618297960, "time_this_iter_s": 696.8752255439758, "time_total_s": 333980.4125685692, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 333980.4125685692, "timesteps_since_restore": 0, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 21.26787512588117, "ram_util_percent": 22.199999999999996}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1567.9425042074474, "episode_reward_min": -1816.981793945992, "episode_reward_mean": -1686.888874162341, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1734.2337447609666, -1741.5771607372483, -1779.1908290043139, -1755.0682815232003, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 542.2391431810902, "mean_raw_obs_processing_ms": 2.261684680376764, "mean_inference_ms": 110.25679518257537, "mean_action_processing_ms": 0.3505555866450027}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 972000, "timers": {"sample_time_ms": 649659.926, "sample_throughput": 6.157, "learn_time_ms": 32821.329, "learn_throughput": 121.872, "update_time_ms": 2.886}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06403403752483428, "policy_loss": -0.008031782577745616, "vf_loss": 164.64777898788452, "vf_explained_var": 0.9194738268852234, "kl": 0.012172190443379804, "entropy": 60.38747429847717, "entropy_coeff": 0.001}}, "num_steps_sampled": 972000, "num_steps_trained": 972000}, "done": false, "episodes_total": 972, "training_iteration": 243, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_15-24-11", "timestamp": 1618298651, "time_this_iter_s": 691.5076916217804, "time_total_s": 334671.92026019096, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 334671.92026019096, "timesteps_since_restore": 0, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 21.58517766497462, "ram_util_percent": 22.200406091370553}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1567.9425042074474, "episode_reward_min": -1816.981793945992, "episode_reward_mean": -1681.4677080998156, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1781.2061009633983, -1725.0930157959083, -1668.097468948037, -1753.8603838878198, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.0877645141904, "mean_raw_obs_processing_ms": 2.2585523722470042, "mean_inference_ms": 109.98270670313869, "mean_action_processing_ms": 0.34952466227415}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 976000, "timers": {"sample_time_ms": 650631.385, "sample_throughput": 6.148, "learn_time_ms": 33448.788, "learn_throughput": 119.586, "update_time_ms": 2.888}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06852463682298549, "policy_loss": -0.014467811561189592, "vf_loss": 254.82577753067017, "vf_explained_var": 0.870822548866272, "kl": 0.014475650095846504, "entropy": 59.86210322380066, "entropy_coeff": 0.001}}, "num_steps_sampled": 976000, "num_steps_trained": 976000}, "done": false, "episodes_total": 976, "training_iteration": 244, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_15-35-46", "timestamp": 1618299346, "time_this_iter_s": 694.4211084842682, "time_total_s": 335366.34136867523, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 335366.34136867523, "timesteps_since_restore": 0, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 21.429858299595143, "ram_util_percent": 22.199999999999992}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1567.9425042074474, "episode_reward_min": -1816.981793945992, "episode_reward_mean": -1677.386630143365, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1752.8759454686324, -1709.7848076512648, -1683.6359165907918, -1632.1978477325786, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 539.946454939244, "mean_raw_obs_processing_ms": 2.2554473469875513, "mean_inference_ms": 109.71106084221601, "mean_action_processing_ms": 0.3485055536793988}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 980000, "timers": {"sample_time_ms": 651606.145, "sample_throughput": 6.139, "learn_time_ms": 34220.676, "learn_throughput": 116.888, "update_time_ms": 2.887}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.08062079950468615, "policy_loss": -0.025840883725322783, "vf_loss": 171.312842130661, "vf_explained_var": 0.9144684076309204, "kl": 0.017536295199533924, "entropy": 60.438708901405334, "entropy_coeff": 0.001}}, "num_steps_sampled": 980000, "num_steps_trained": 980000}, "done": false, "episodes_total": 980, "training_iteration": 245, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_15-47-21", "timestamp": 1618300041, "time_this_iter_s": 695.0617537498474, "time_total_s": 336061.4031224251, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 336061.4031224251, "timesteps_since_restore": 0, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 21.44919191919192, "ram_util_percent": 22.200101010101}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1567.9425042074474, "episode_reward_min": -1816.981793945992, "episode_reward_mean": -1676.996139334941, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1722.451200886498, -1769.3254051725262, -1661.5132968141281, -1652.2795046383335, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 538.8151356364497, "mean_raw_obs_processing_ms": 2.2523666481501556, "mean_inference_ms": 109.4416902131879, "mean_action_processing_ms": 0.3474969238132324}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 984000, "timers": {"sample_time_ms": 652473.181, "sample_throughput": 6.131, "learn_time_ms": 34992.437, "learn_throughput": 114.31, "update_time_ms": 2.892}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07058466243324801, "policy_loss": -0.01577048032777384, "vf_loss": 249.9012942314148, "vf_explained_var": 0.8860034942626953, "kl": 0.013567106070695445, "entropy": 60.36579144001007, "entropy_coeff": 0.001}}, "num_steps_sampled": 984000, "num_steps_trained": 984000}, "done": false, "episodes_total": 984, "training_iteration": 246, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_15-58-55", "timestamp": 1618300735, "time_this_iter_s": 694.0892686843872, "time_total_s": 336755.49239110947, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 336755.49239110947, "timesteps_since_restore": 0, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 21.660121457489875, "ram_util_percent": 22.205870445344125}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1567.9425042074474, "episode_reward_min": -1816.981793945992, "episode_reward_mean": -1674.5224204262115, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1716.9545917468581, -1736.1508606850075, -1714.1260347734283, -1729.4022014330508, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 537.6934951890987, "mean_raw_obs_processing_ms": 2.2493142947626956, "mean_inference_ms": 109.1745979908365, "mean_action_processing_ms": 0.3464966642361604}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 988000, "timers": {"sample_time_ms": 653437.833, "sample_throughput": 6.121, "learn_time_ms": 35723.614, "learn_throughput": 111.971, "update_time_ms": 2.905}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0824005534814205, "policy_loss": -0.027365251211449504, "vf_loss": 267.9497492313385, "vf_explained_var": 0.8823517560958862, "kl": 0.010983753309119493, "entropy": 60.18613851070404, "entropy_coeff": 0.001}}, "num_steps_sampled": 988000, "num_steps_trained": 988000}, "done": false, "episodes_total": 988, "training_iteration": 247, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_16-10-29", "timestamp": 1618301429, "time_this_iter_s": 694.3448648452759, "time_total_s": 337449.83725595474, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 337449.83725595474, "timesteps_since_restore": 0, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 21.626188068756313, "ram_util_percent": 22.205561172901916}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1567.9425042074474, "episode_reward_min": -1816.981793945992, "episode_reward_mean": -1672.0864875963475, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1776.7105400595374, -1712.266214320602, -1769.952260195398, -1702.399989278173, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 536.5811380388907, "mean_raw_obs_processing_ms": 2.246287863064889, "mean_inference_ms": 108.90983491728086, "mean_action_processing_ms": 0.34550411592935526}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 992000, "timers": {"sample_time_ms": 654416.739, "sample_throughput": 6.112, "learn_time_ms": 36410.611, "learn_throughput": 109.858, "update_time_ms": 2.907}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07588555192342028, "policy_loss": -0.020832398091442883, "vf_loss": 201.6489441394806, "vf_explained_var": 0.9087368845939636, "kl": 0.018716123973717913, "entropy": 61.28077006340027, "entropy_coeff": 0.001}}, "num_steps_sampled": 992000, "num_steps_trained": 992000}, "done": false, "episodes_total": 992, "training_iteration": 248, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_16-22-04", "timestamp": 1618302124, "time_this_iter_s": 694.3534882068634, "time_total_s": 338144.1907441616, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 338144.1907441616, "timesteps_since_restore": 0, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 21.479777553083924, "ram_util_percent": 22.205561172901916}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1567.9425042074474, "episode_reward_min": -1816.981793945992, "episode_reward_mean": -1668.5042568929068, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1816.981793945992, -1741.0779978071405, -1679.0896241190792, -1670.7402717530704, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 535.4787707920484, "mean_raw_obs_processing_ms": 2.2432885611458313, "mean_inference_ms": 108.6474194739302, "mean_action_processing_ms": 0.3445189787426753}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 996000, "timers": {"sample_time_ms": 655208.724, "sample_throughput": 6.105, "learn_time_ms": 37050.24, "learn_throughput": 107.962, "update_time_ms": 2.855}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07871172472368926, "policy_loss": -0.02463653782615438, "vf_loss": 235.43464589118958, "vf_explained_var": 0.8952970504760742, "kl": 0.01725440376321785, "entropy": 60.31177079677582, "entropy_coeff": 0.001}}, "num_steps_sampled": 996000, "num_steps_trained": 996000}, "done": false, "episodes_total": 996, "training_iteration": 249, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_16-33-37", "timestamp": 1618302817, "time_this_iter_s": 692.9865872859955, "time_total_s": 338837.1773314476, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 338837.1773314476, "timesteps_since_restore": 0, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 21.35689655172414, "ram_util_percent": 22.205476673427984}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1567.9425042074474, "episode_reward_min": -1785.9663688039207, "episode_reward_mean": -1665.6225904593914, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1716.3505049381738, -1680.4500161602864, -1685.1605476026343, -1703.4469876092999, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 534.3863825222346, "mean_raw_obs_processing_ms": 2.240320698665289, "mean_inference_ms": 108.38731235737752, "mean_action_processing_ms": 0.3435402922379055}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1000000, "timers": {"sample_time_ms": 655940.222, "sample_throughput": 6.098, "learn_time_ms": 37725.995, "learn_throughput": 106.028, "update_time_ms": 2.869}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07139990464202128, "policy_loss": -0.01610129466280341, "vf_loss": 198.3311676979065, "vf_explained_var": 0.9077696800231934, "kl": 0.013350564142456278, "entropy": 60.28579664230347, "entropy_coeff": 0.001}}, "num_steps_sampled": 1000000, "num_steps_trained": 1000000}, "done": false, "episodes_total": 1000, "training_iteration": 250, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_16-45-11", "timestamp": 1618303511, "time_this_iter_s": 694.7623598575592, "time_total_s": 339531.93969130516, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 339531.93969130516, "timesteps_since_restore": 0, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 21.50333670374115, "ram_util_percent": 22.205662285136494}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1567.9425042074474, "episode_reward_min": -1785.9663688039207, "episode_reward_mean": -1665.2749382459108, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1656.4890390003409, -1646.61095095236, -1714.773085725069, -1785.9663688039207, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 533.3039004068784, "mean_raw_obs_processing_ms": 2.237380339860227, "mean_inference_ms": 108.12951111992717, "mean_action_processing_ms": 0.34256650054406534}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1004000, "timers": {"sample_time_ms": 656446.737, "sample_throughput": 6.093, "learn_time_ms": 38133.672, "learn_throughput": 104.894, "update_time_ms": 2.867}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07572805572999641, "policy_loss": -0.019808597397059202, "vf_loss": 128.55354642868042, "vf_explained_var": 0.9371768236160278, "kl": 0.01619917302741669, "entropy": 60.84980273246765, "entropy_coeff": 0.001}}, "num_steps_sampled": 1004000, "num_steps_trained": 1004000}, "done": false, "episodes_total": 1004, "training_iteration": 251, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_16-56-49", "timestamp": 1618304209, "time_this_iter_s": 697.5116245746613, "time_total_s": 340229.4513158798, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 340229.4513158798, "timesteps_since_restore": 0, "iterations_since_restore": 251, "perf": {"cpu_util_percent": 21.41780684104628, "ram_util_percent": 22.205533199195166}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1562.9415149537672, "episode_reward_min": -1783.1668801078329, "episode_reward_mean": -1663.2877677871988, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1721.3762486185535, -1689.262699757242, -1687.9349059843469, -1696.2481844855772, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 532.231087639859, "mean_raw_obs_processing_ms": 2.234471414884237, "mean_inference_ms": 107.87399416159717, "mean_action_processing_ms": 0.3416058447386003}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1008000, "timers": {"sample_time_ms": 656145.683, "sample_throughput": 6.096, "learn_time_ms": 37960.473, "learn_throughput": 105.373, "update_time_ms": 2.736}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07827953022206202, "policy_loss": -0.022841617261292413, "vf_loss": 181.6102294921875, "vf_explained_var": 0.9194050431251526, "kl": 0.012038387823849916, "entropy": 59.962650775909424, "entropy_coeff": 0.001}}, "num_steps_sampled": 1008000, "num_steps_trained": 1008000}, "done": false, "episodes_total": 1008, "training_iteration": 252, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_17-08-21", "timestamp": 1618304901, "time_this_iter_s": 692.1315038204193, "time_total_s": 340921.58281970024, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 340921.58281970024, "timesteps_since_restore": 0, "iterations_since_restore": 252, "perf": {"cpu_util_percent": 21.413401015228423, "ram_util_percent": 22.205279187817254}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1562.9415149537672, "episode_reward_min": -1783.1668801078329, "episode_reward_mean": -1662.304479341799, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1674.0876374020822, -1699.8772448882744, -1669.6075741650159, -1622.1850957302086, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 531.1685740760119, "mean_raw_obs_processing_ms": 2.231576883965129, "mean_inference_ms": 107.62091422273593, "mean_action_processing_ms": 0.34065484969074816}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1012000, "timers": {"sample_time_ms": 657274.101, "sample_throughput": 6.086, "learn_time_ms": 37531.238, "learn_throughput": 106.578, "update_time_ms": 2.634}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0593279343447648, "policy_loss": -0.0035959089873358607, "vf_loss": 224.76167702674866, "vf_explained_var": 0.9016296863555908, "kl": 0.012018441717373207, "entropy": 60.68379104137421, "entropy_coeff": 0.001}}, "num_steps_sampled": 1012000, "num_steps_trained": 1012000}, "done": false, "episodes_total": 1012, "training_iteration": 253, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_17-20-00", "timestamp": 1618305600, "time_this_iter_s": 698.4990479946136, "time_total_s": 341620.08186769485, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 341620.08186769485, "timesteps_since_restore": 0, "iterations_since_restore": 253, "perf": {"cpu_util_percent": 20.788128772635815, "ram_util_percent": 22.281488933601604}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1562.9415149537672, "episode_reward_min": -1783.1668801078329, "episode_reward_mean": -1660.9755530649115, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1726.5170163939654, -1619.8621534680422, -1698.3448925083296, -1712.7883668094673, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 530.1160234464237, "mean_raw_obs_processing_ms": 2.2287049507523387, "mean_inference_ms": 107.37019433162808, "mean_action_processing_ms": 0.3397139847907398}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1016000, "timers": {"sample_time_ms": 658016.342, "sample_throughput": 6.079, "learn_time_ms": 36983.92, "learn_throughput": 108.155, "update_time_ms": 2.636}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06455213512526825, "policy_loss": -0.010877788008656353, "vf_loss": 296.8538269996643, "vf_explained_var": 0.8671241998672485, "kl": 0.014608577563194558, "entropy": 59.92980873584747, "entropy_coeff": 0.001}}, "num_steps_sampled": 1016000, "num_steps_trained": 1016000}, "done": false, "episodes_total": 1016, "training_iteration": 254, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_17-31-36", "timestamp": 1618306296, "time_this_iter_s": 696.370628118515, "time_total_s": 342316.45249581337, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 342316.45249581337, "timesteps_since_restore": 0, "iterations_since_restore": 254, "perf": {"cpu_util_percent": 20.23407258064516, "ram_util_percent": 22.42419354838709}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1562.9415149537672, "episode_reward_min": -1783.1668801078329, "episode_reward_mean": -1660.1268143764166, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1567.9425042074474, -1707.0482138719733, -1664.8738119106356, -1675.543179086601, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 529.0722553300934, "mean_raw_obs_processing_ms": 2.2258611017755188, "mean_inference_ms": 107.1216547690624, "mean_action_processing_ms": 0.3387795669484738}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1020000, "timers": {"sample_time_ms": 657068.126, "sample_throughput": 6.088, "learn_time_ms": 36214.816, "learn_throughput": 110.452, "update_time_ms": 2.632}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06954156474967021, "policy_loss": -0.014559758885297924, "vf_loss": 228.56298732757568, "vf_explained_var": 0.8885136842727661, "kl": 0.013703014992643148, "entropy": 60.35061204433441, "entropy_coeff": 0.001}}, "num_steps_sampled": 1020000, "num_steps_trained": 1020000}, "done": false, "episodes_total": 1020, "training_iteration": 255, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_17-42-54", "timestamp": 1618306974, "time_this_iter_s": 677.8885600566864, "time_total_s": 342994.34105587006, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 342994.34105587006, "timesteps_since_restore": 0, "iterations_since_restore": 255, "perf": {"cpu_util_percent": 12.57336787564767, "ram_util_percent": 19.81098445595855}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1562.9415149537672, "episode_reward_min": -1783.1668801078329, "episode_reward_mean": -1659.5104374807606, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1664.2230478720353, -1640.5905808235336, -1700.438936758499, -1670.6721876809943, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 528.0372538808602, "mean_raw_obs_processing_ms": 2.2230369239928303, "mean_inference_ms": 106.8751154031236, "mean_action_processing_ms": 0.3378519184609901}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1024000, "timers": {"sample_time_ms": 656420.847, "sample_throughput": 6.094, "learn_time_ms": 35468.211, "learn_throughput": 112.777, "update_time_ms": 2.643}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06766539328964427, "policy_loss": -0.012617681932169944, "vf_loss": 187.91826963424683, "vf_explained_var": 0.9042973518371582, "kl": 0.01301389344735071, "entropy": 59.85501825809479, "entropy_coeff": 0.001}}, "num_steps_sampled": 1024000, "num_steps_trained": 1024000}, "done": false, "episodes_total": 1024, "training_iteration": 256, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_17-54-14", "timestamp": 1618307654, "time_this_iter_s": 680.1509318351746, "time_total_s": 343674.49198770523, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 343674.49198770523, "timesteps_since_restore": 0, "iterations_since_restore": 256, "perf": {"cpu_util_percent": 11.790702479338842, "ram_util_percent": 19.40123966942149}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1562.9415149537672, "episode_reward_min": -1783.1668801078329, "episode_reward_mean": -1659.4916691106191, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1632.5628971951921, -1720.7881521154688, -1695.6219286728926, -1768.8711671035053, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 527.0113068253332, "mean_raw_obs_processing_ms": 2.2202392423115147, "mean_inference_ms": 106.63068775731034, "mean_action_processing_ms": 0.3369317164243929}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1028000, "timers": {"sample_time_ms": 655837.074, "sample_throughput": 6.099, "learn_time_ms": 34751.162, "learn_throughput": 115.104, "update_time_ms": 2.636}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07355949963675812, "policy_loss": -0.01728932317928411, "vf_loss": 162.57473039627075, "vf_explained_var": 0.9191817045211792, "kl": 0.013056653551757336, "entropy": 60.83366668224335, "entropy_coeff": 0.001}}, "num_steps_sampled": 1028000, "num_steps_trained": 1028000}, "done": false, "episodes_total": 1028, "training_iteration": 257, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_18-05-35", "timestamp": 1618308335, "time_this_iter_s": 681.3363690376282, "time_total_s": 344355.82835674286, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 344355.82835674286, "timesteps_since_restore": 0, "iterations_since_restore": 257, "perf": {"cpu_util_percent": 11.837628865979381, "ram_util_percent": 19.399587628865977}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1562.9415149537672, "episode_reward_min": -1783.1668801078329, "episode_reward_mean": -1657.0209085853107, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1698.9916627659711, -1783.1668801078329, -1704.3352153223648, -1746.0725470151588, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 525.9940553782437, "mean_raw_obs_processing_ms": 2.217475983430585, "mean_inference_ms": 106.3882167581574, "mean_action_processing_ms": 0.33601938573746565}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1032000, "timers": {"sample_time_ms": 655039.566, "sample_throughput": 6.107, "learn_time_ms": 34074.634, "learn_throughput": 117.389, "update_time_ms": 2.636}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07573666330426931, "policy_loss": -0.020276374940294772, "vf_loss": 206.73745226860046, "vf_explained_var": 0.914042055606842, "kl": 0.01310870045563206, "entropy": 60.47711539268494, "entropy_coeff": 0.001}}, "num_steps_sampled": 1032000, "num_steps_trained": 1032000}, "done": false, "episodes_total": 1032, "training_iteration": 258, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_18-16-55", "timestamp": 1618309015, "time_this_iter_s": 679.6131339073181, "time_total_s": 345035.4414906502, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 345035.4414906502, "timesteps_since_restore": 0, "iterations_since_restore": 258, "perf": {"cpu_util_percent": 11.784798345398139, "ram_util_percent": 19.39968976215098}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1562.9415149537672, "episode_reward_min": -1767.29454167096, "episode_reward_mean": -1652.7675883725472, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1625.4096934031415, -1659.8004805998648, -1693.166585741108, -1582.7391326728705, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 524.9850414834816, "mean_raw_obs_processing_ms": 2.2147360891158687, "mean_inference_ms": 106.14778842185945, "mean_action_processing_ms": 0.3351112376371136}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1036000, "timers": {"sample_time_ms": 654234.044, "sample_throughput": 6.114, "learn_time_ms": 33449.031, "learn_throughput": 119.585, "update_time_ms": 2.645}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07566456444328651, "policy_loss": -0.02209305122960359, "vf_loss": 344.727413892746, "vf_explained_var": 0.8336385488510132, "kl": 0.014404810703126714, "entropy": 60.25987088680267, "entropy_coeff": 0.001}}, "num_steps_sampled": 1036000, "num_steps_trained": 1036000}, "done": false, "episodes_total": 1036, "training_iteration": 259, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_18-28-14", "timestamp": 1618309694, "time_this_iter_s": 678.6750922203064, "time_total_s": 345714.1165828705, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 345714.1165828705, "timesteps_since_restore": 0, "iterations_since_restore": 259, "perf": {"cpu_util_percent": 11.792546583850932, "ram_util_percent": 19.399689440993786}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1562.9415149537672, "episode_reward_min": -1767.29454167096, "episode_reward_mean": -1654.7756476410061, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1747.617650441118, -1597.8198272111692, -1639.2818247354037, -1616.7375847398393, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 523.9845719903855, "mean_raw_obs_processing_ms": 2.2120170849872878, "mean_inference_ms": 105.90942970216132, "mean_action_processing_ms": 0.334209612023986}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1040000, "timers": {"sample_time_ms": 653833.24, "sample_throughput": 6.118, "learn_time_ms": 32710.994, "learn_throughput": 122.283, "update_time_ms": 2.618}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07701078880927525, "policy_loss": -0.02343249338446185, "vf_loss": 325.43184328079224, "vf_explained_var": 0.8406853675842285, "kl": 0.015090497035998851, "entropy": 60.227973103523254, "entropy_coeff": 0.001}}, "num_steps_sampled": 1040000, "num_steps_trained": 1040000}, "done": false, "episodes_total": 1040, "training_iteration": 260, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_18-39-37", "timestamp": 1618310377, "time_this_iter_s": 683.3736128807068, "time_total_s": 346397.4901957512, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 346397.4901957512, "timesteps_since_restore": 0, "iterations_since_restore": 260, "perf": {"cpu_util_percent": 11.795071868583161, "ram_util_percent": 19.399794661190967}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1767.29454167096, "episode_reward_mean": -1653.0745127613286, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1663.5647190133632, -1636.9353305179634, -1635.5818612460184, -1672.61898425538, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 522.992751252083, "mean_raw_obs_processing_ms": 2.2093162499854513, "mean_inference_ms": 105.67319714914493, "mean_action_processing_ms": 0.33331289918340296}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1044000, "timers": {"sample_time_ms": 653570.378, "sample_throughput": 6.12, "learn_time_ms": 32022.103, "learn_throughput": 124.914, "update_time_ms": 2.642}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07484321924857795, "policy_loss": -0.020019325776956975, "vf_loss": 122.694406747818, "vf_explained_var": 0.9359964728355408, "kl": 0.016401681379647925, "entropy": 59.741209268569946, "entropy_coeff": 0.001}}, "num_steps_sampled": 1044000, "num_steps_trained": 1044000}, "done": false, "episodes_total": 1044, "training_iteration": 261, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_18-51-05", "timestamp": 1618311065, "time_this_iter_s": 687.9950475692749, "time_total_s": 347085.48524332047, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 347085.48524332047, "timesteps_since_restore": 0, "iterations_since_restore": 261, "perf": {"cpu_util_percent": 13.718079673135852, "ram_util_percent": 19.411848825331973}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1767.29454167096, "episode_reward_mean": -1652.977717995148, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1718.2682593671573, -1682.975619208308, -1699.6868239598643, -1653.800752112662, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 522.01008541224, "mean_raw_obs_processing_ms": 2.206636294451723, "mean_inference_ms": 105.43902826465434, "mean_action_processing_ms": 0.33242426572334666}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1048000, "timers": {"sample_time_ms": 654236.188, "sample_throughput": 6.114, "learn_time_ms": 31538.857, "learn_throughput": 126.828, "update_time_ms": 2.64}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06076873675920069, "policy_loss": -0.005893648194614798, "vf_loss": 232.18457078933716, "vf_explained_var": 0.8932604789733887, "kl": 0.012279073474928737, "entropy": 59.95972192287445, "entropy_coeff": 0.001}}, "num_steps_sampled": 1048000, "num_steps_trained": 1048000}, "done": false, "episodes_total": 1048, "training_iteration": 262, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_19-02-39", "timestamp": 1618311759, "time_this_iter_s": 693.9572820663452, "time_total_s": 347779.4425253868, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 347779.4425253868, "timesteps_since_restore": 0, "iterations_since_restore": 262, "perf": {"cpu_util_percent": 14.467408906882593, "ram_util_percent": 19.574595141700406}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1767.29454167096, "episode_reward_mean": -1649.3799179300777, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1649.1257380475038, -1679.0943881918668, -1623.1644579435122, -1669.9779196097807, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 521.035949310496, "mean_raw_obs_processing_ms": 2.2039798893421367, "mean_inference_ms": 105.20675651097372, "mean_action_processing_ms": 0.33154663849593036}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1052000, "timers": {"sample_time_ms": 653190.623, "sample_throughput": 6.124, "learn_time_ms": 31410.485, "learn_throughput": 127.346, "update_time_ms": 2.647}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06751991831697524, "policy_loss": -0.01581449132936541, "vf_loss": 435.59784030914307, "vf_explained_var": 0.8071661591529846, "kl": 0.017135282047092915, "entropy": 59.916841983795166, "entropy_coeff": 0.001}}, "num_steps_sampled": 1052000, "num_steps_trained": 1052000}, "done": false, "episodes_total": 1052, "training_iteration": 263, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_19-14-06", "timestamp": 1618312446, "time_this_iter_s": 686.7594199180603, "time_total_s": 348466.20194530487, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 348466.20194530487, "timesteps_since_restore": 0, "iterations_since_restore": 263, "perf": {"cpu_util_percent": 13.110747185261005, "ram_util_percent": 19.537461617195493}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1650.9178419877435, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1654.9017766811808, -1630.5979647285258, -1657.502897821413, -1630.7662010747874, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 520.0701334080698, "mean_raw_obs_processing_ms": 2.2013425011715166, "mean_inference_ms": 104.97643133778429, "mean_action_processing_ms": 0.33067466540442636}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1056000, "timers": {"sample_time_ms": 652240.38, "sample_throughput": 6.133, "learn_time_ms": 31925.88, "learn_throughput": 125.29, "update_time_ms": 2.642}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.0680952662951313, "policy_loss": -0.014995281002484262, "vf_loss": 297.6364583969116, "vf_explained_var": 0.8627346754074097, "kl": 0.01732674808590673, "entropy": 59.97486710548401, "entropy_coeff": 0.001}}, "num_steps_sampled": 1056000, "num_steps_trained": 1056000}, "done": false, "episodes_total": 1056, "training_iteration": 264, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_19-25-38", "timestamp": 1618313138, "time_this_iter_s": 692.0224294662476, "time_total_s": 349158.2243747711, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 349158.2243747711, "timesteps_since_restore": 0, "iterations_since_restore": 264, "perf": {"cpu_util_percent": 22.252535496957403, "ram_util_percent": 22.73975659229209}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1653.5174602734633, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1611.9467222823826, -1662.2801419602747, -1659.6340461246127, -1663.4746907430767, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 519.113018064218, "mean_raw_obs_processing_ms": 2.198725698028032, "mean_inference_ms": 104.7479003538175, "mean_action_processing_ms": 0.3298110092821249}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1060000, "timers": {"sample_time_ms": 653680.939, "sample_throughput": 6.119, "learn_time_ms": 32664.605, "learn_throughput": 122.457, "update_time_ms": 2.671}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.07014416245510802, "policy_loss": -0.01778472203295678, "vf_loss": 392.56009912490845, "vf_explained_var": 0.8373537063598633, "kl": 0.015331592585425824, "entropy": 59.7346476316452, "entropy_coeff": 0.001}}, "num_steps_sampled": 1060000, "num_steps_trained": 1060000}, "done": false, "episodes_total": 1060, "training_iteration": 265, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_19-37-18", "timestamp": 1618313838, "time_this_iter_s": 699.6816811561584, "time_total_s": 349857.9060559273, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 349857.9060559273, "timesteps_since_restore": 0, "iterations_since_restore": 265, "perf": {"cpu_util_percent": 21.463654618473896, "ram_util_percent": 22.21275100401606}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1653.5103870781281, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1688.5050735614366, -1666.7004637026644, -1621.7551143946414, -1617.6527524823157, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 518.1638674511852, "mean_raw_obs_processing_ms": 2.1961317975416534, "mean_inference_ms": 104.52119155316119, "mean_action_processing_ms": 0.3289525025495007}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1064000, "timers": {"sample_time_ms": 654849.435, "sample_throughput": 6.108, "learn_time_ms": 33118.782, "learn_throughput": 120.777, "update_time_ms": 2.668}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.22500000000000003, "cur_lr": 5e-05, "total_loss": -0.06770695402519777, "policy_loss": -0.013211998011684045, "vf_loss": 174.14443469047546, "vf_explained_var": 0.9264159202575684, "kl": 0.020663671661168337, "entropy": 60.885724663734436, "entropy_coeff": 0.001}}, "num_steps_sampled": 1064000, "num_steps_trained": 1064000}, "done": false, "episodes_total": 1064, "training_iteration": 266, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_19-48-54", "timestamp": 1618314534, "time_this_iter_s": 696.3777096271515, "time_total_s": 350554.2837655544, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 350554.2837655544, "timesteps_since_restore": 0, "iterations_since_restore": 266, "perf": {"cpu_util_percent": 21.75383064516129, "ram_util_percent": 22.260584677419356}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1655.522927816771, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1718.2146596796836, -1635.6533957471554, -1656.8815913665587, -1627.7265666591675, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 517.2220140178185, "mean_raw_obs_processing_ms": 2.1935534945806374, "mean_inference_ms": 104.29625013411285, "mean_action_processing_ms": 0.32810247338021603}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1068000, "timers": {"sample_time_ms": 655563.668, "sample_throughput": 6.102, "learn_time_ms": 33807.525, "learn_throughput": 118.317, "update_time_ms": 2.677}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3375, "cur_lr": 5e-05, "total_loss": -0.07312190945958719, "policy_loss": -0.020618095441022888, "vf_loss": 130.21541571617126, "vf_explained_var": 0.9389538764953613, "kl": 0.017195168271427974, "entropy": 59.609333992004395, "entropy_coeff": 0.001}}, "num_steps_sampled": 1068000, "num_steps_trained": 1068000}, "done": false, "episodes_total": 1068, "training_iteration": 267, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_20-00-30", "timestamp": 1618315230, "time_this_iter_s": 695.3662843704224, "time_total_s": 351249.65004992485, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 351249.65004992485, "timesteps_since_restore": 0, "iterations_since_restore": 267, "perf": {"cpu_util_percent": 21.5850353892821, "ram_util_percent": 22.28786653185036}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1655.783979021199, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1584.3492616675721, -1677.6029809857114, -1620.2301984834307, -1585.7709686365138, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 516.2880389260667, "mean_raw_obs_processing_ms": 2.190992499881469, "mean_inference_ms": 104.07311371531563, "mean_action_processing_ms": 0.32725858917532974}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1072000, "timers": {"sample_time_ms": 656873.151, "sample_throughput": 6.089, "learn_time_ms": 34389.472, "learn_throughput": 116.315, "update_time_ms": 2.676}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.3375, "cur_lr": 5e-05, "total_loss": -0.06750911126437131, "policy_loss": -0.019127681327518076, "vf_loss": 424.0145378112793, "vf_explained_var": 0.8173130750656128, "kl": 0.020237400953192264, "entropy": 59.45169472694397, "entropy_coeff": 0.001}}, "num_steps_sampled": 1072000, "num_steps_trained": 1072000}, "done": false, "episodes_total": 1072, "training_iteration": 268, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_20-12-08", "timestamp": 1618315928, "time_this_iter_s": 698.5275449752808, "time_total_s": 351948.17759490013, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 351948.17759490013, "timesteps_since_restore": 0, "iterations_since_restore": 268, "perf": {"cpu_util_percent": 21.69748743718593, "ram_util_percent": 22.232864321608037}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1658.230550583529, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1594.2718071262384, -1639.988029274939, -1661.9368967786434, -1623.9524407702706, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 515.3614771726296, "mean_raw_obs_processing_ms": 2.188452729939427, "mean_inference_ms": 103.85166161409481, "mean_action_processing_ms": 0.32642116873985055}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1076000, "timers": {"sample_time_ms": 657970.425, "sample_throughput": 6.079, "learn_time_ms": 34844.499, "learn_throughput": 114.796, "update_time_ms": 2.709}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07318812957964838, "policy_loss": -0.02019106555962935, "vf_loss": 256.0304334163666, "vf_explained_var": 0.8865385055541992, "kl": 0.009927372389938682, "entropy": 60.583096623420715, "entropy_coeff": 0.001}}, "num_steps_sampled": 1076000, "num_steps_trained": 1076000}, "done": false, "episodes_total": 1076, "training_iteration": 269, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_20-23-42", "timestamp": 1618316622, "time_this_iter_s": 694.1983594894409, "time_total_s": 352642.3759543896, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 352642.3759543896, "timesteps_since_restore": 0, "iterations_since_restore": 269, "perf": {"cpu_util_percent": 21.683704453441294, "ram_util_percent": 22.28552631578948}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1658.7338737655148, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1711.8945920062592, -1673.7539446992826, -1736.3867082244005, -1617.4101916709392, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 514.4425965136295, "mean_raw_obs_processing_ms": 2.1859325568339356, "mean_inference_ms": 103.63186722731785, "mean_action_processing_ms": 0.3255871050206882}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1080000, "timers": {"sample_time_ms": 658892.739, "sample_throughput": 6.071, "learn_time_ms": 35676.848, "learn_throughput": 112.118, "update_time_ms": 2.766}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.06900460537872277, "policy_loss": -0.019392595073441043, "vf_loss": 364.403781414032, "vf_explained_var": 0.8159451484680176, "kl": 0.01268813363276422, "entropy": 59.679412603378296, "entropy_coeff": 0.001}}, "num_steps_sampled": 1080000, "num_steps_trained": 1080000}, "done": false, "episodes_total": 1080, "training_iteration": 270, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_20-35-23", "timestamp": 1618317323, "time_this_iter_s": 700.9219355583191, "time_total_s": 353343.2978899479, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 353343.2978899479, "timesteps_since_restore": 0, "iterations_since_restore": 270, "perf": {"cpu_util_percent": 22.36002004008016, "ram_util_percent": 22.233967935871743}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1657.677041525797, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1641.0621120643477, -1632.4809683590136, -1693.8940516554403, -1590.760384559768, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 513.5310093533043, "mean_raw_obs_processing_ms": 2.1834297873339064, "mean_inference_ms": 103.41381216912123, "mean_action_processing_ms": 0.32475955037414317}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1084000, "timers": {"sample_time_ms": 659020.918, "sample_throughput": 6.07, "learn_time_ms": 36137.613, "learn_throughput": 110.688, "update_time_ms": 2.753}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.0761969555169344, "policy_loss": -0.022044972254661843, "vf_loss": 189.1227104663849, "vf_explained_var": 0.9168176651000977, "kl": 0.008543020041543059, "entropy": 60.36811327934265, "entropy_coeff": 0.001}}, "num_steps_sampled": 1084000, "num_steps_trained": 1084000}, "done": false, "episodes_total": 1084, "training_iteration": 271, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_20-46-57", "timestamp": 1618318017, "time_this_iter_s": 693.8836905956268, "time_total_s": 354037.1815805435, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 354037.1815805435, "timesteps_since_restore": 0, "iterations_since_restore": 271, "perf": {"cpu_util_percent": 21.461740890688258, "ram_util_percent": 22.303340080971665}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1659.2319522476855, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1628.15280145658, -1653.2692797046784, -1707.8894007935405, -1663.7289236971421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 512.6267545275533, "mean_raw_obs_processing_ms": 2.180933161880298, "mean_inference_ms": 103.19740076236796, "mean_action_processing_ms": 0.3239402792733628}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1088000, "timers": {"sample_time_ms": 658775.629, "sample_throughput": 6.072, "learn_time_ms": 36855.84, "learn_throughput": 108.531, "update_time_ms": 2.843}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07388501218520105, "policy_loss": -0.022403980372473598, "vf_loss": 252.703754901886, "vf_explained_var": 0.8904041051864624, "kl": 0.012412208438036032, "entropy": 60.291749119758606, "entropy_coeff": 0.001}}, "num_steps_sampled": 1088000, "num_steps_trained": 1088000}, "done": false, "episodes_total": 1088, "training_iteration": 272, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_20-58-36", "timestamp": 1618318716, "time_this_iter_s": 698.6874051094055, "time_total_s": 354735.8689856529, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 354735.8689856529, "timesteps_since_restore": 0, "iterations_since_restore": 272, "perf": {"cpu_util_percent": 21.22894472361809, "ram_util_percent": 22.305527638190963}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1660.4904494036603, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1681.1765726448398, -1646.4725934729404, -1606.5800253352477, -1668.876742056611, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 511.72930966480374, "mean_raw_obs_processing_ms": 2.1784559020765992, "mean_inference_ms": 102.98254061786622, "mean_action_processing_ms": 0.3231327018019738}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1092000, "timers": {"sample_time_ms": 658590.591, "sample_throughput": 6.074, "learn_time_ms": 37502.72, "learn_throughput": 106.659, "update_time_ms": 2.83}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07624118402600288, "policy_loss": -0.023492898617405444, "vf_loss": 357.376503944397, "vf_explained_var": 0.8615990877151489, "kl": 0.009136902008322068, "entropy": 60.94760608673096, "entropy_coeff": 0.001}}, "num_steps_sampled": 1092000, "num_steps_trained": 1092000}, "done": false, "episodes_total": 1092, "training_iteration": 273, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_21-10-07", "timestamp": 1618319407, "time_this_iter_s": 691.3776240348816, "time_total_s": 355427.2466096878, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 355427.2466096878, "timesteps_since_restore": 0, "iterations_since_restore": 273, "perf": {"cpu_util_percent": 21.249593495934956, "ram_util_percent": 22.30558943089431}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1661.7658415313695, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1626.9138804939605, -1630.3608759395456, -1695.3412602492203, -1667.1070275909624, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 510.8390629887288, "mean_raw_obs_processing_ms": 2.1759980702225117, "mean_inference_ms": 102.76930472223474, "mean_action_processing_ms": 0.3223340080843584}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1096000, "timers": {"sample_time_ms": 659061.348, "sample_throughput": 6.069, "learn_time_ms": 37653.006, "learn_throughput": 106.233, "update_time_ms": 2.827}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.06152746034786105, "policy_loss": -0.01122589921578765, "vf_loss": 374.68196535110474, "vf_explained_var": 0.8382366299629211, "kl": 0.014066809351788834, "entropy": 61.16969871520996, "entropy_coeff": 0.001}}, "num_steps_sampled": 1096000, "num_steps_trained": 1096000}, "done": false, "episodes_total": 1096, "training_iteration": 274, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_21-21-46", "timestamp": 1618320106, "time_this_iter_s": 698.2323813438416, "time_total_s": 356125.47899103165, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 356125.47899103165, "timesteps_since_restore": 0, "iterations_since_restore": 274, "perf": {"cpu_util_percent": 21.241105527638194, "ram_util_percent": 22.25125628140704}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1663.5049065668647, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1711.7569123620644, -1749.3223889669264, -1616.3648710462958, -1673.1986625870452, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 509.9557102186115, "mean_raw_obs_processing_ms": 2.1735534334017688, "mean_inference_ms": 102.5576405182408, "mean_action_processing_ms": 0.32154435305886714}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1100000, "timers": {"sample_time_ms": 658549.506, "sample_throughput": 6.074, "learn_time_ms": 37211.603, "learn_throughput": 107.493, "update_time_ms": 2.803}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.06416750507196411, "policy_loss": -0.01215980653068982, "vf_loss": 209.1568431854248, "vf_explained_var": 0.9041663408279419, "kl": 0.01296499342424795, "entropy": 60.6627916097641, "entropy_coeff": 0.001}}, "num_steps_sampled": 1100000, "num_steps_trained": 1100000}, "done": false, "episodes_total": 1100, "training_iteration": 275, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_21-33-16", "timestamp": 1618320796, "time_this_iter_s": 690.1491432189941, "time_total_s": 356815.62813425064, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 356815.62813425064, "timesteps_since_restore": 0, "iterations_since_restore": 275, "perf": {"cpu_util_percent": 21.24195519348269, "ram_util_percent": 22.104887983706725}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1663.3023356232, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1686.3987885610768, -1562.9415149537672, -1676.3514637969545, -1679.4306312987524, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 509.0787405578404, "mean_raw_obs_processing_ms": 2.1711250071608985, "mean_inference_ms": 102.34757869483222, "mean_action_processing_ms": 0.3207594125952252}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1104000, "timers": {"sample_time_ms": 658003.121, "sample_throughput": 6.079, "learn_time_ms": 37436.393, "learn_throughput": 106.848, "update_time_ms": 2.787}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.06811859394656494, "policy_loss": -0.014418974344152957, "vf_loss": 253.0535831451416, "vf_explained_var": 0.8894781470298767, "kl": 0.00913434814719949, "entropy": 60.854418992996216, "entropy_coeff": 0.001}}, "num_steps_sampled": 1104000, "num_steps_trained": 1104000}, "done": false, "episodes_total": 1104, "training_iteration": 276, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_21-44-49", "timestamp": 1618321489, "time_this_iter_s": 693.161276102066, "time_total_s": 357508.7894103527, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 357508.7894103527, "timesteps_since_restore": 0, "iterations_since_restore": 276, "perf": {"cpu_util_percent": 21.336474164133737, "ram_util_percent": 22.10557244174266}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1663.4097048101858, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1634.5323214170733, -1649.648934932322, -1645.0173962853728, -1767.29454167096, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 508.2081425108405, "mean_raw_obs_processing_ms": 2.168715342650155, "mean_inference_ms": 102.13908135481047, "mean_action_processing_ms": 0.31997502010553525}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1108000, "timers": {"sample_time_ms": 657455.66, "sample_throughput": 6.084, "learn_time_ms": 37464.344, "learn_throughput": 106.768, "update_time_ms": 2.844}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.06991316052153707, "policy_loss": -0.018417199491523206, "vf_loss": 393.8199636936188, "vf_explained_var": 0.84501713514328, "kl": 0.010635194470523857, "entropy": 60.81822371482849, "entropy_coeff": 0.001}}, "num_steps_sampled": 1108000, "num_steps_trained": 1108000}, "done": false, "episodes_total": 1108, "training_iteration": 277, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_21-56-19", "timestamp": 1618322179, "time_this_iter_s": 690.1725249290466, "time_total_s": 358198.96193528175, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 358198.96193528175, "timesteps_since_restore": 0, "iterations_since_restore": 277, "perf": {"cpu_util_percent": 21.343743641912514, "ram_util_percent": 22.1059003051882}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1666.1153744684648, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1629.3030719850672, -1605.315346642352, -1582.184093300783, -1716.0624125686372, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 507.3441328074875, "mean_raw_obs_processing_ms": 2.166329953459959, "mean_inference_ms": 101.93194843942194, "mean_action_processing_ms": 0.31919783152618086}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1112000, "timers": {"sample_time_ms": 657546.857, "sample_throughput": 6.083, "learn_time_ms": 37226.348, "learn_throughput": 107.451, "update_time_ms": 3.026}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.06178364442894235, "policy_loss": -0.010235744615783915, "vf_loss": 330.28986167907715, "vf_explained_var": 0.8477030396461487, "kl": 0.01223718817345798, "entropy": 61.04587435722351, "entropy_coeff": 0.001}}, "num_steps_sampled": 1112000, "num_steps_trained": 1112000}, "done": false, "episodes_total": 1112, "training_iteration": 278, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_22-07-56", "timestamp": 1618322876, "time_this_iter_s": 697.0615994930267, "time_total_s": 358896.0235347748, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 358896.0235347748, "timesteps_since_restore": 0, "iterations_since_restore": 278, "perf": {"cpu_util_percent": 21.053326612903227, "ram_util_percent": 22.104939516129033}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1668.440702801323, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1673.5544786915398, -1716.512375878114, -1622.252143810178, -1660.3195619504784, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 506.48588890947707, "mean_raw_obs_processing_ms": 2.1639624905717336, "mean_inference_ms": 101.72617566519897, "mean_action_processing_ms": 0.31842609558420565}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1116000, "timers": {"sample_time_ms": 657033.099, "sample_throughput": 6.088, "learn_time_ms": 37386.798, "learn_throughput": 106.99, "update_time_ms": 3.01}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.06864428473636508, "policy_loss": -0.01779931108467281, "vf_loss": 478.3485460281372, "vf_explained_var": 0.8007058501243591, "kl": 0.010589585406705737, "entropy": 60.98943066596985, "entropy_coeff": 0.001}}, "num_steps_sampled": 1116000, "num_steps_trained": 1116000}, "done": false, "episodes_total": 1116, "training_iteration": 279, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_22-19-27", "timestamp": 1618323567, "time_this_iter_s": 690.6650729179382, "time_total_s": 359586.6886076927, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 359586.6886076927, "timesteps_since_restore": 0, "iterations_since_restore": 279, "perf": {"cpu_util_percent": 21.213821138211383, "ram_util_percent": 22.10569105691057}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1670.205243844095, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1645.6420794273356, -1633.31068107167, -1656.581747175938, -1618.2355118360995, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 505.6345342569091, "mean_raw_obs_processing_ms": 2.1616032183657565, "mean_inference_ms": 101.52208821398698, "mean_action_processing_ms": 0.3176637981799973}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1120000, "timers": {"sample_time_ms": 656343.733, "sample_throughput": 6.094, "learn_time_ms": 37271.9, "learn_throughput": 107.319, "update_time_ms": 2.961}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07691090324078687, "policy_loss": -0.021646389650413767, "vf_loss": 154.08787035942078, "vf_explained_var": 0.9284867644309998, "kl": 0.008761919409153052, "entropy": 61.241111516952515, "entropy_coeff": 0.001}}, "num_steps_sampled": 1120000, "num_steps_trained": 1120000}, "done": false, "episodes_total": 1120, "training_iteration": 280, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_22-31-00", "timestamp": 1618324260, "time_this_iter_s": 692.8777463436127, "time_total_s": 360279.56635403633, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 360279.56635403633, "timesteps_since_restore": 0, "iterations_since_restore": 280, "perf": {"cpu_util_percent": 21.33367139959432, "ram_util_percent": 22.117545638945234}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1671.7764572796443, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1713.9930145133296, -1726.5661082114138, -1595.9211666587803, -1637.5676267373751, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 504.7898707464789, "mean_raw_obs_processing_ms": 2.159258923985883, "mean_inference_ms": 101.31964128283045, "mean_action_processing_ms": 0.3169071996482997}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1124000, "timers": {"sample_time_ms": 656139.406, "sample_throughput": 6.096, "learn_time_ms": 37287.07, "learn_throughput": 107.276, "update_time_ms": 3.051}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.06213259551441297, "policy_loss": -0.01256591678247787, "vf_loss": 452.73274421691895, "vf_explained_var": 0.7939152717590332, "kl": 0.012647040857700631, "entropy": 60.49656939506531, "entropy_coeff": 0.001}}, "num_steps_sampled": 1124000, "num_steps_trained": 1124000}, "done": false, "episodes_total": 1124, "training_iteration": 281, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_22-42-32", "timestamp": 1618324952, "time_this_iter_s": 691.9931080341339, "time_total_s": 360971.55946207047, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 360971.55946207047, "timesteps_since_restore": 0, "iterations_since_restore": 281, "perf": {"cpu_util_percent": 21.231269035532993, "ram_util_percent": 22.117969543147208}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1673.2824994035261, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1599.499209099871, -1640.5668459001317, -1643.2495587831836, -1687.4524787730195, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 503.9517716237434, "mean_raw_obs_processing_ms": 2.156934925962743, "mean_inference_ms": 101.11873697928178, "mean_action_processing_ms": 0.31615521288598253}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1128000, "timers": {"sample_time_ms": 655566.076, "sample_throughput": 6.102, "learn_time_ms": 37185.386, "learn_throughput": 107.569, "update_time_ms": 2.965}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.06810681236675009, "policy_loss": -0.01728826272301376, "vf_loss": 418.70666456222534, "vf_explained_var": 0.8119145631790161, "kl": 0.011527153808856383, "entropy": 60.84123361110687, "entropy_coeff": 0.001}}, "num_steps_sampled": 1128000, "num_steps_trained": 1128000}, "done": false, "episodes_total": 1128, "training_iteration": 282, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_22-54-04", "timestamp": 1618325644, "time_this_iter_s": 691.9361391067505, "time_total_s": 361663.4956011772, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 361663.4956011772, "timesteps_since_restore": 0, "iterations_since_restore": 282, "perf": {"cpu_util_percent": 21.15482233502538, "ram_util_percent": 22.10781725888325}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1675.8161059673182, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1609.15633893814, -1665.9317159836748, -1581.8873571151153, -1650.2588718980667, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 503.12022264419187, "mean_raw_obs_processing_ms": 2.154616366861451, "mean_inference_ms": 100.91938287005455, "mean_action_processing_ms": 0.31540956530586134}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1132000, "timers": {"sample_time_ms": 655600.268, "sample_throughput": 6.101, "learn_time_ms": 37166.463, "learn_throughput": 107.624, "update_time_ms": 2.977}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.08880747715011239, "policy_loss": -0.035183247935492545, "vf_loss": 145.3440763950348, "vf_explained_var": 0.93537437915802, "kl": 0.011250176117755473, "entropy": 60.7730770111084, "entropy_coeff": 0.001}}, "num_steps_sampled": 1132000, "num_steps_trained": 1132000}, "done": false, "episodes_total": 1132, "training_iteration": 283, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_23-05-35", "timestamp": 1618326335, "time_this_iter_s": 691.5302324295044, "time_total_s": 362355.0258336067, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 362355.0258336067, "timesteps_since_restore": 0, "iterations_since_restore": 283, "perf": {"cpu_util_percent": 21.382436548223346, "ram_util_percent": 22.120507614213203}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1676.6890365736833, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1700.1565113391803, -1671.3156961268674, -1682.1275975286987, -1708.3220142681841, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 502.2955685409288, "mean_raw_obs_processing_ms": 2.1523125110389567, "mean_inference_ms": 100.72161080651195, "mean_action_processing_ms": 0.3146726420174011}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1136000, "timers": {"sample_time_ms": 655559.848, "sample_throughput": 6.102, "learn_time_ms": 37173.53, "learn_throughput": 107.603, "update_time_ms": 3.017}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.08042549667879939, "policy_loss": -0.028507045237347484, "vf_loss": 292.6295485496521, "vf_explained_var": 0.8530399799346924, "kl": 0.010782236378872767, "entropy": 60.30325186252594, "entropy_coeff": 0.001}}, "num_steps_sampled": 1136000, "num_steps_trained": 1136000}, "done": false, "episodes_total": 1136, "training_iteration": 284, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_23-17-13", "timestamp": 1618327033, "time_this_iter_s": 697.9001817703247, "time_total_s": 363052.92601537704, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 363052.92601537704, "timesteps_since_restore": 0, "iterations_since_restore": 284, "perf": {"cpu_util_percent": 21.43843058350101, "ram_util_percent": 22.117605633802818}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1559.3125353584253, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1675.679877652395, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1574.1125958131254, -1672.273144138081, -1559.3125353584253, -1625.645123850094, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 501.47724604381926, "mean_raw_obs_processing_ms": 2.1500279513742813, "mean_inference_ms": 100.52528898839279, "mean_action_processing_ms": 0.3139451773704274}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1140000, "timers": {"sample_time_ms": 655593.925, "sample_throughput": 6.101, "learn_time_ms": 37143.997, "learn_throughput": 107.689, "update_time_ms": 3.008}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.06965371692785993, "policy_loss": -0.020547329040709883, "vf_loss": 502.7865881919861, "vf_explained_var": 0.7726492285728455, "kl": 0.011964190023718402, "entropy": 60.19112241268158, "entropy_coeff": 0.001}}, "num_steps_sampled": 1140000, "num_steps_trained": 1140000}, "done": false, "episodes_total": 1140, "training_iteration": 285, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_23-28-44", "timestamp": 1618327724, "time_this_iter_s": 690.1944575309753, "time_total_s": 363743.120472908, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 363743.120472908, "timesteps_since_restore": 0, "iterations_since_restore": 285, "perf": {"cpu_util_percent": 20.963136456211814, "ram_util_percent": 22.120162932790222}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1579.3704693314917, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1679.7214357292326, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1676.626831196785, -1610.7489676747803, -1617.4563781891702, -1694.1892413539763, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 500.6648631450922, "mean_raw_obs_processing_ms": 2.1477535925227302, "mean_inference_ms": 100.33021592851149, "mean_action_processing_ms": 0.31322616387402163}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1144000, "timers": {"sample_time_ms": 655386.674, "sample_throughput": 6.103, "learn_time_ms": 37085.579, "learn_throughput": 107.859, "update_time_ms": 3.016}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.06619114353816258, "policy_loss": -0.012148380337748677, "vf_loss": 195.42772126197815, "vf_explained_var": 0.916504442691803, "kl": 0.010258775437250733, "entropy": 61.19054675102234, "entropy_coeff": 0.001}}, "num_steps_sampled": 1144000, "num_steps_trained": 1144000}, "done": false, "episodes_total": 1144, "training_iteration": 286, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_23-40-14", "timestamp": 1618328414, "time_this_iter_s": 690.5046653747559, "time_total_s": 364433.6251382828, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 364433.6251382828, "timesteps_since_restore": 0, "iterations_since_restore": 286, "perf": {"cpu_util_percent": 21.446286876907426, "ram_util_percent": 22.158392675483213}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1579.3704693314917, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1680.3350080769278, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1579.3704693314917, -1581.9601365840238, -1641.6497829968434, -1591.9710592285335, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 499.85775762678213, "mean_raw_obs_processing_ms": 2.1454994511073293, "mean_inference_ms": 100.13648374508341, "mean_action_processing_ms": 0.31251016521307284}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1148000, "timers": {"sample_time_ms": 655600.636, "sample_throughput": 6.101, "learn_time_ms": 36893.251, "learn_throughput": 108.421, "update_time_ms": 2.961}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07480586570454761, "policy_loss": -0.02381588105345145, "vf_loss": 432.77567291259766, "vf_explained_var": 0.807680606842041, "kl": 0.01078737765783444, "entropy": 60.778847098350525, "entropy_coeff": 0.001}}, "num_steps_sampled": 1148000, "num_steps_trained": 1148000}, "done": false, "episodes_total": 1148, "training_iteration": 287, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-13_23-51-45", "timestamp": 1618329105, "time_this_iter_s": 690.3876345157623, "time_total_s": 365124.01277279854, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 365124.01277279854, "timesteps_since_restore": 0, "iterations_since_restore": 287, "perf": {"cpu_util_percent": 21.193191056910567, "ram_util_percent": 22.122357723577238}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1583.8261372488532, "episode_reward_min": -1818.9376918573773, "episode_reward_mean": -1684.5718112290251, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1611.1250988333782, -1647.5258704756086, -1697.5662483928784, -1818.9376918573773, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 499.0564754689702, "mean_raw_obs_processing_ms": 2.143263688374258, "mean_inference_ms": 99.9441632066846, "mean_action_processing_ms": 0.3117966035333188}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1152000, "timers": {"sample_time_ms": 654777.968, "sample_throughput": 6.109, "learn_time_ms": 37291.825, "learn_throughput": 107.262, "update_time_ms": 2.773}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.0714745843433775, "policy_loss": -0.018348861805861816, "vf_loss": 240.72077083587646, "vf_explained_var": 0.8883857727050781, "kl": 0.011028288703528233, "entropy": 61.116000056266785, "entropy_coeff": 0.001}}, "num_steps_sampled": 1152000, "num_steps_trained": 1152000}, "done": false, "episodes_total": 1152, "training_iteration": 288, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_00-03-17", "timestamp": 1618329797, "time_this_iter_s": 692.8185081481934, "time_total_s": 365816.83128094673, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 365816.83128094673, "timesteps_since_restore": 0, "iterations_since_restore": 288, "perf": {"cpu_util_percent": 21.44939148073022, "ram_util_percent": 22.139959432048677}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1583.8261372488532, "episode_reward_min": -1803.268063136544, "episode_reward_mean": -1685.627881586615, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1685.071059890262, -1685.5917258970308, -1685.7696357698906, -1777.298247320738, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 498.26099975851656, "mean_raw_obs_processing_ms": 2.141044540419643, "mean_inference_ms": 99.75312776283783, "mean_action_processing_ms": 0.31108835540704166}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1156000, "timers": {"sample_time_ms": 654787.012, "sample_throughput": 6.109, "learn_time_ms": 37393.958, "learn_throughput": 106.969, "update_time_ms": 2.761}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07067796000046656, "policy_loss": -0.022964996751397848, "vf_loss": 472.050950050354, "vf_explained_var": 0.8063036203384399, "kl": 0.01789148841635324, "entropy": 61.491037130355835, "entropy_coeff": 0.001}}, "num_steps_sampled": 1156000, "num_steps_trained": 1156000}, "done": false, "episodes_total": 1156, "training_iteration": 289, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_00-14-49", "timestamp": 1618330489, "time_this_iter_s": 691.7766766548157, "time_total_s": 366508.60795760155, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 366508.60795760155, "timesteps_since_restore": 0, "iterations_since_restore": 289, "perf": {"cpu_util_percent": 21.313807106598983, "ram_util_percent": 22.197360406091363}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1583.8261372488532, "episode_reward_min": -1803.268063136544, "episode_reward_mean": -1684.6116131710794, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1620.9496833348412, -1661.4595619647016, -1667.080400182231, -1647.1386360950041, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 497.47054244367973, "mean_raw_obs_processing_ms": 2.13883185639539, "mean_inference_ms": 99.56348488049365, "mean_action_processing_ms": 0.3103845938260338}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1160000, "timers": {"sample_time_ms": 654566.139, "sample_throughput": 6.111, "learn_time_ms": 37024.86, "learn_throughput": 108.036, "update_time_ms": 2.756}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07157238852232695, "policy_loss": -0.02072431574924849, "vf_loss": 499.07951402664185, "vf_explained_var": 0.8210179805755615, "kl": 0.011367255967343226, "entropy": 61.593541264534, "entropy_coeff": 0.001}}, "num_steps_sampled": 1160000, "num_steps_trained": 1160000}, "done": false, "episodes_total": 1160, "training_iteration": 290, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_00-26-16", "timestamp": 1618331176, "time_this_iter_s": 686.9780659675598, "time_total_s": 367195.5860235691, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 367195.5860235691, "timesteps_since_restore": 0, "iterations_since_restore": 290, "perf": {"cpu_util_percent": 21.11104294478528, "ram_util_percent": 22.19754601226993}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1583.8261372488532, "episode_reward_min": -1803.268063136544, "episode_reward_mean": -1686.9202237056086, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1737.1459613758116, -1710.8994841173596, -1677.9560705818187, -1669.8659619303949, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 496.6854669715933, "mean_raw_obs_processing_ms": 2.1366390343987787, "mean_inference_ms": 99.37520440058387, "mean_action_processing_ms": 0.30968594987707504}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1164000, "timers": {"sample_time_ms": 654566.254, "sample_throughput": 6.111, "learn_time_ms": 37133.275, "learn_throughput": 107.72, "update_time_ms": 2.656}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07606847083661705, "policy_loss": -0.021794898028019816, "vf_loss": 220.91700553894043, "vf_explained_var": 0.898811936378479, "kl": 0.009111180566833355, "entropy": 61.09527373313904, "entropy_coeff": 0.001}}, "num_steps_sampled": 1164000, "num_steps_trained": 1164000}, "done": false, "episodes_total": 1164, "training_iteration": 291, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_00-37-49", "timestamp": 1618331869, "time_this_iter_s": 693.0772655010223, "time_total_s": 367888.66328907013, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 367888.66328907013, "timesteps_since_restore": 0, "iterations_since_restore": 291, "perf": {"cpu_util_percent": 21.40820668693009, "ram_util_percent": 22.099290780141846}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1583.8261372488532, "episode_reward_min": -1818.8598582147358, "episode_reward_mean": -1687.921275345055, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1741.8810596433748, -1622.8756388300467, -1655.1078654284795, -1644.7167699934391, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 495.90574371992415, "mean_raw_obs_processing_ms": 2.1344628488320447, "mean_inference_ms": 99.18820156128187, "mean_action_processing_ms": 0.30899230204155215}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1168000, "timers": {"sample_time_ms": 654359.245, "sample_throughput": 6.113, "learn_time_ms": 37250.961, "learn_throughput": 107.38, "update_time_ms": 2.657}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07671624282374978, "policy_loss": -0.024568866763729602, "vf_loss": 268.4188566207886, "vf_explained_var": 0.8820393085479736, "kl": 0.012770516652381048, "entropy": 61.29663145542145, "entropy_coeff": 0.001}}, "num_steps_sampled": 1168000, "num_steps_trained": 1168000}, "done": false, "episodes_total": 1168, "training_iteration": 292, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_00-49-20", "timestamp": 1618332560, "time_this_iter_s": 691.043018579483, "time_total_s": 368579.7063076496, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 368579.7063076496, "timesteps_since_restore": 0, "iterations_since_restore": 292, "perf": {"cpu_util_percent": 21.286483739837397, "ram_util_percent": 22.10376016260163}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1583.8261372488532, "episode_reward_min": -1818.8598582147358, "episode_reward_mean": -1688.3773142079317, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1733.7506870475179, -1618.4434136300038, -1652.9001551455406, -1707.5163101831824, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 495.13110788640654, "mean_raw_obs_processing_ms": 2.13230199959878, "mean_inference_ms": 99.00247175547169, "mean_action_processing_ms": 0.30830645419672165}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1172000, "timers": {"sample_time_ms": 654436.769, "sample_throughput": 6.112, "learn_time_ms": 37164.747, "learn_throughput": 107.629, "update_time_ms": 2.656}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07137102811248042, "policy_loss": -0.01839009375544265, "vf_loss": 240.83647775650024, "vf_explained_var": 0.8847436904907227, "kl": 0.009786580252693966, "entropy": 60.343754172325134, "entropy_coeff": 0.001}}, "num_steps_sampled": 1172000, "num_steps_trained": 1172000}, "done": false, "episodes_total": 1172, "training_iteration": 293, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_01-00-52", "timestamp": 1618333252, "time_this_iter_s": 691.4435513019562, "time_total_s": 369271.14985895157, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 369271.14985895157, "timesteps_since_restore": 0, "iterations_since_restore": 293, "perf": {"cpu_util_percent": 21.269410569105695, "ram_util_percent": 22.100304878048785}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1583.8261372488532, "episode_reward_min": -1818.8598582147358, "episode_reward_mean": -1690.5709563599914, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1626.549424983566, -1583.8261372488532, -1662.6908765676797, -1697.4150533486159, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 494.3616827622824, "mean_raw_obs_processing_ms": 2.1301584647273106, "mean_inference_ms": 98.81798349752763, "mean_action_processing_ms": 0.30762638416364224}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1176000, "timers": {"sample_time_ms": 653874.208, "sample_throughput": 6.117, "learn_time_ms": 37084.098, "learn_throughput": 107.863, "update_time_ms": 2.619}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07535377598833293, "policy_loss": -0.02370175119722262, "vf_loss": 288.8533627986908, "vf_explained_var": 0.8766365051269531, "kl": 0.012394273217068985, "entropy": 60.815155148506165, "entropy_coeff": 0.001}}, "num_steps_sampled": 1176000, "num_steps_trained": 1176000}, "done": false, "episodes_total": 1176, "training_iteration": 294, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_01-12-23", "timestamp": 1618333943, "time_this_iter_s": 691.4668428897858, "time_total_s": 369962.61670184135, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 369962.61670184135, "timesteps_since_restore": 0, "iterations_since_restore": 294, "perf": {"cpu_util_percent": 21.18607723577236, "ram_util_percent": 22.1135162601626}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1589.1934405474742, "episode_reward_min": -1818.8598582147358, "episode_reward_mean": -1692.909000960205, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1645.2065563419405, -1689.1348692548215, -1710.2273464848452, -1589.1934405474742, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 493.59696621875366, "mean_raw_obs_processing_ms": 2.1280272073070825, "mean_inference_ms": 98.63482477422069, "mean_action_processing_ms": 0.3069527869806252}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1180000, "timers": {"sample_time_ms": 653401.45, "sample_throughput": 6.122, "learn_time_ms": 37561.554, "learn_throughput": 106.492, "update_time_ms": 2.629}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07319201825885102, "policy_loss": -0.021022150584030896, "vf_loss": 204.7904155254364, "vf_explained_var": 0.9090203046798706, "kl": 0.010650609561707824, "entropy": 59.60963809490204, "entropy_coeff": 0.001}}, "num_steps_sampled": 1180000, "num_steps_trained": 1180000}, "done": false, "episodes_total": 1180, "training_iteration": 295, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_01-23-54", "timestamp": 1618334634, "time_this_iter_s": 690.241370677948, "time_total_s": 370652.8580725193, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 370652.8580725193, "timesteps_since_restore": 0, "iterations_since_restore": 295, "perf": {"cpu_util_percent": 21.199491353001015, "ram_util_percent": 22.17995930824008}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1594.274504107994, "episode_reward_min": -1818.8598582147358, "episode_reward_mean": -1694.415289360565, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1702.322187920301, -1627.16396167518, -1729.0727258601444, -1655.1297133717924, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 492.8373008221644, "mean_raw_obs_processing_ms": 2.1259130930436454, "mean_inference_ms": 98.45294479485113, "mean_action_processing_ms": 0.30628229165145143}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1184000, "timers": {"sample_time_ms": 653477.849, "sample_throughput": 6.121, "learn_time_ms": 37621.076, "learn_throughput": 106.323, "update_time_ms": 2.634}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07595138117903844, "policy_loss": -0.022763582412153482, "vf_loss": 135.98920106887817, "vf_explained_var": 0.9389885663986206, "kl": 0.011900672427145764, "entropy": 60.57240056991577, "entropy_coeff": 0.001}}, "num_steps_sampled": 1184000, "num_steps_trained": 1184000}, "done": false, "episodes_total": 1184, "training_iteration": 296, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_01-35-25", "timestamp": 1618335325, "time_this_iter_s": 691.8639430999756, "time_total_s": 371344.7220156193, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 371344.7220156193, "timesteps_since_restore": 0, "iterations_since_restore": 296, "perf": {"cpu_util_percent": 21.137868020304573, "ram_util_percent": 22.199999999999992}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1594.274504107994, "episode_reward_min": -1818.8598582147358, "episode_reward_mean": -1695.1298162943508, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1644.8452724489644, -1707.9288503578068, -1745.0946725955723, -1681.0213258470421, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 492.0824071154755, "mean_raw_obs_processing_ms": 2.1238237336788286, "mean_inference_ms": 98.27231717140803, "mean_action_processing_ms": 0.30561880201887365}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1188000, "timers": {"sample_time_ms": 653189.186, "sample_throughput": 6.124, "learn_time_ms": 37671.168, "learn_throughput": 106.182, "update_time_ms": 2.621}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.0709947662835475, "policy_loss": -0.021007736155297607, "vf_loss": 444.7024178504944, "vf_explained_var": 0.819166898727417, "kl": 0.011761328234570101, "entropy": 60.38822901248932, "entropy_coeff": 0.001}}, "num_steps_sampled": 1188000, "num_steps_trained": 1188000}, "done": false, "episodes_total": 1188, "training_iteration": 297, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_01-46-54", "timestamp": 1618336014, "time_this_iter_s": 688.0017297267914, "time_total_s": 372032.72374534607, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 372032.72374534607, "timesteps_since_restore": 0, "iterations_since_restore": 297, "perf": {"cpu_util_percent": 21.17622448979592, "ram_util_percent": 22.15397959183673}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1594.274504107994, "episode_reward_min": -1818.8598582147358, "episode_reward_mean": -1696.5279424390826, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1652.534304641248, -1713.2926179793237, -1726.3774650057, -1638.4407586543157, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 491.33271509662126, "mean_raw_obs_processing_ms": 2.1217514416535352, "mean_inference_ms": 98.09290778776892, "mean_action_processing_ms": 0.3049547759258299}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1192000, "timers": {"sample_time_ms": 652895.578, "sample_throughput": 6.127, "learn_time_ms": 37680.075, "learn_throughput": 106.157, "update_time_ms": 2.632}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07052376202773303, "policy_loss": -0.01998197298962623, "vf_loss": 431.7837829589844, "vf_explained_var": 0.8192276954650879, "kl": 0.012547139354865067, "entropy": 61.21161246299744, "entropy_coeff": 0.001}}, "num_steps_sampled": 1192000, "num_steps_trained": 1192000}, "done": false, "episodes_total": 1192, "training_iteration": 298, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_01-58-24", "timestamp": 1618336704, "time_this_iter_s": 689.971319437027, "time_total_s": 372722.6950647831, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 372722.6950647831, "timesteps_since_restore": 0, "iterations_since_restore": 298, "perf": {"cpu_util_percent": 21.209164969450104, "ram_util_percent": 22.100101832993893}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1594.274504107994, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1698.896333412571, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1709.2932219888023, -1713.8273255272634, -1694.231477321005, -1676.2775229861347, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 490.58782546007666, "mean_raw_obs_processing_ms": 2.119694423317034, "mean_inference_ms": 97.91471177241759, "mean_action_processing_ms": 0.3042957171363061}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1196000, "timers": {"sample_time_ms": 652901.887, "sample_throughput": 6.126, "learn_time_ms": 37647.794, "learn_throughput": 106.248, "update_time_ms": 2.635}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.06678580734296702, "policy_loss": -0.02153625915525481, "vf_loss": 967.0114097595215, "vf_explained_var": 0.6016318798065186, "kl": 0.010812939624884166, "entropy": 60.39370536804199, "entropy_coeff": 0.001}}, "num_steps_sampled": 1196000, "num_steps_trained": 1196000}, "done": false, "episodes_total": 1196, "training_iteration": 299, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_02-09-55", "timestamp": 1618337395, "time_this_iter_s": 691.5169699192047, "time_total_s": 373414.2120347023, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 373414.2120347023, "timesteps_since_restore": 0, "iterations_since_restore": 299, "perf": {"cpu_util_percent": 21.39451776649746, "ram_util_percent": 22.100000000000005}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1594.274504107994, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1700.4736594340338, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1667.7049625855252, -1634.8560662031607, -1706.7899699370398, -1721.0347418701235, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 489.8476975673574, "mean_raw_obs_processing_ms": 2.1176564302103973, "mean_inference_ms": 97.73783746091732, "mean_action_processing_ms": 0.3036412969578787}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1200000, "timers": {"sample_time_ms": 652838.84, "sample_throughput": 6.127, "learn_time_ms": 38005.395, "learn_throughput": 105.248, "update_time_ms": 2.65}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.06875276158098131, "policy_loss": -0.015633325529051945, "vf_loss": 257.802885055542, "vf_explained_var": 0.9005844593048096, "kl": 0.010713506053434685, "entropy": 61.12117564678192, "entropy_coeff": 0.001}}, "num_steps_sampled": 1200000, "num_steps_trained": 1200000}, "done": false, "episodes_total": 1200, "training_iteration": 300, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_02-21-25", "timestamp": 1618338085, "time_this_iter_s": 689.9236607551575, "time_total_s": 374104.13569545746, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 374104.13569545746, "timesteps_since_restore": 0, "iterations_since_restore": 300, "perf": {"cpu_util_percent": 21.22207527975585, "ram_util_percent": 22.18138351983723}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1594.274504107994, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1700.2106163368514, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1660.3038033428288, -1673.5857057608805, -1630.9822203795811, -1650.9875878258456, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 489.1130314346911, "mean_raw_obs_processing_ms": 2.1156327335164344, "mean_inference_ms": 97.56216485542178, "mean_action_processing_ms": 0.3029934966975646}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1204000, "timers": {"sample_time_ms": 653238.171, "sample_throughput": 6.123, "learn_time_ms": 37796.3, "learn_throughput": 105.83, "update_time_ms": 2.656}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.0747812271292787, "policy_loss": -0.022964010713621974, "vf_loss": 324.2087836265564, "vf_explained_var": 0.8441733717918396, "kl": 0.010648725554347038, "entropy": 60.45021975040436, "entropy_coeff": 0.001}}, "num_steps_sampled": 1204000, "num_steps_trained": 1204000}, "done": false, "episodes_total": 1204, "training_iteration": 301, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_02-33-00", "timestamp": 1618338780, "time_this_iter_s": 694.9798240661621, "time_total_s": 374799.1155195236, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 374799.1155195236, "timesteps_since_restore": 0, "iterations_since_restore": 301, "perf": {"cpu_util_percent": 21.046006066734076, "ram_util_percent": 22.193023255813948}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1594.274504107994, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1702.6785156163287, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1699.7376324503682, -1678.7310209921695, -1785.3234435545876, -1803.268063136544, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 488.3838386600314, "mean_raw_obs_processing_ms": 2.1136149441582326, "mean_inference_ms": 97.38767747394364, "mean_action_processing_ms": 0.3023496319418936}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1208000, "timers": {"sample_time_ms": 653670.683, "sample_throughput": 6.119, "learn_time_ms": 37801.739, "learn_throughput": 105.815, "update_time_ms": 2.651}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07147006230661646, "policy_loss": -0.01859855992370285, "vf_loss": 184.4688276052475, "vf_explained_var": 0.9174795150756836, "kl": 0.012623816961422563, "entropy": 61.1069952249527, "entropy_coeff": 0.001}}, "num_steps_sampled": 1208000, "num_steps_trained": 1208000}, "done": false, "episodes_total": 1208, "training_iteration": 302, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_02-44-36", "timestamp": 1618339476, "time_this_iter_s": 695.4225344657898, "time_total_s": 375494.5380539894, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 375494.5380539894, "timesteps_since_restore": 0, "iterations_since_restore": 302, "perf": {"cpu_util_percent": 21.262626262626263, "ram_util_percent": 22.19585858585858}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1594.274504107994, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1701.6865260477355, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1742.134988503104, -1747.5070694368196, -1665.270815272959, -1610.4848845697718, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 487.65886009685414, "mean_raw_obs_processing_ms": 2.1116048993781886, "mean_inference_ms": 97.2143373100741, "mean_action_processing_ms": 0.3017096553876769}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1212000, "timers": {"sample_time_ms": 653344.855, "sample_throughput": 6.122, "learn_time_ms": 37815.997, "learn_throughput": 105.775, "update_time_ms": 2.637}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07306735683232546, "policy_loss": -0.021243994939140975, "vf_loss": 520.6040806770325, "vf_explained_var": 0.7859245538711548, "kl": 0.008804733472061343, "entropy": 61.486793518066406, "entropy_coeff": 0.001}}, "num_steps_sampled": 1212000, "num_steps_trained": 1212000}, "done": false, "episodes_total": 1212, "training_iteration": 303, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_02-56-04", "timestamp": 1618340164, "time_this_iter_s": 688.3276929855347, "time_total_s": 376182.86574697495, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 376182.86574697495, "timesteps_since_restore": 0, "iterations_since_restore": 303, "perf": {"cpu_util_percent": 21.206829765545365, "ram_util_percent": 22.185932721712533}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1594.274504107994, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1702.4126438344895, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1711.4197711410436, -1693.0506565034252, -1756.727934111922, -1687.8943028510942, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 486.9389245471827, "mean_raw_obs_processing_ms": 2.109612637020571, "mean_inference_ms": 97.0422035527826, "mean_action_processing_ms": 0.3010738735091283}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1216000, "timers": {"sample_time_ms": 653390.687, "sample_throughput": 6.122, "learn_time_ms": 37854.225, "learn_throughput": 105.669, "update_time_ms": 2.794}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.068553397199139, "policy_loss": -0.017179173039039597, "vf_loss": 338.67567706108093, "vf_explained_var": 0.8369880318641663, "kl": 0.01214159355731681, "entropy": 60.9076589345932, "entropy_coeff": 0.001}}, "num_steps_sampled": 1216000, "num_steps_trained": 1216000}, "done": false, "episodes_total": 1216, "training_iteration": 304, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_03-07-36", "timestamp": 1618340856, "time_this_iter_s": 692.309769153595, "time_total_s": 376875.17551612854, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 376875.17551612854, "timesteps_since_restore": 0, "iterations_since_restore": 304, "perf": {"cpu_util_percent": 21.365888324873094, "ram_util_percent": 22.105482233502542}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1594.274504107994, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1701.702996102388, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1682.5295968151042, -1634.7748880994777, -1717.137301261295, -1676.449576890105, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 486.22413006204994, "mean_raw_obs_processing_ms": 2.107640361788084, "mean_inference_ms": 96.87117420323288, "mean_action_processing_ms": 0.30043798164692725}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1220000, "timers": {"sample_time_ms": 653889.743, "sample_throughput": 6.117, "learn_time_ms": 37786.501, "learn_throughput": 105.858, "update_time_ms": 2.83}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07865354232490063, "policy_loss": -0.028822839201893657, "vf_loss": 421.1895236968994, "vf_explained_var": 0.8136813640594482, "kl": 0.01227354136062786, "entropy": 60.25607454776764, "entropy_coeff": 0.001}}, "num_steps_sampled": 1220000, "num_steps_trained": 1220000}, "done": false, "episodes_total": 1220, "training_iteration": 305, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_03-19-11", "timestamp": 1618341551, "time_this_iter_s": 694.5552299022675, "time_total_s": 377569.7307460308, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 377569.7307460308, "timesteps_since_restore": 0, "iterations_since_restore": 305, "perf": {"cpu_util_percent": 21.067745197168858, "ram_util_percent": 22.124772497472197}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1594.274504107994, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1704.2086540179505, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1638.5997249434017, -1781.020822895788, -1665.29370203552, -1739.7378786343295, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 485.5140686716605, "mean_raw_obs_processing_ms": 2.1056881117876856, "mean_inference_ms": 96.70129665874244, "mean_action_processing_ms": 0.2998048932993735}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1224000, "timers": {"sample_time_ms": 653795.064, "sample_throughput": 6.118, "learn_time_ms": 37719.064, "learn_throughput": 106.047, "update_time_ms": 2.977}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.08503759966697544, "policy_loss": -0.03388365701539442, "vf_loss": 301.4105110168457, "vf_explained_var": 0.8724744915962219, "kl": 0.013971995271276683, "entropy": 61.241366147994995, "entropy_coeff": 0.001}}, "num_steps_sampled": 1224000, "num_steps_trained": 1224000}, "done": false, "episodes_total": 1224, "training_iteration": 306, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_03-30-41", "timestamp": 1618342241, "time_this_iter_s": 690.2443096637726, "time_total_s": 378259.9750556946, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 378259.9750556946, "timesteps_since_restore": 0, "iterations_since_restore": 306, "perf": {"cpu_util_percent": 21.41556459816887, "ram_util_percent": 22.193692777212608}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1594.274504107994, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1706.1243042131405, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1707.2364864163467, -1668.0771137055192, -1746.8448869542055, -1701.9702618593835, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 484.80882480725194, "mean_raw_obs_processing_ms": 2.103744674760735, "mean_inference_ms": 96.53255385882558, "mean_action_processing_ms": 0.2991747389192739}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1228000, "timers": {"sample_time_ms": 654164.751, "sample_throughput": 6.115, "learn_time_ms": 37866.229, "learn_throughput": 105.635, "update_time_ms": 2.98}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.06592061591800302, "policy_loss": -0.015045897627715021, "vf_loss": 470.1338210105896, "vf_explained_var": 0.7949357032775879, "kl": 0.010665800888091326, "entropy": 60.97561740875244, "entropy_coeff": 0.001}}, "num_steps_sampled": 1228000, "num_steps_trained": 1228000}, "done": false, "episodes_total": 1228, "training_iteration": 307, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_03-42-14", "timestamp": 1618342934, "time_this_iter_s": 693.1703655719757, "time_total_s": 378953.14542126656, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 378953.14542126656, "timesteps_since_restore": 0, "iterations_since_restore": 307, "perf": {"cpu_util_percent": 21.259067882472134, "ram_util_percent": 22.199999999999996}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1594.274504107994, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1706.2052790142404, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1602.9439308099427, -1594.274504107994, -1700.1768920591126, -1697.132017594441, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 484.1083725982522, "mean_raw_obs_processing_ms": 2.1018156938847112, "mean_inference_ms": 96.36508789086132, "mean_action_processing_ms": 0.29854782772575084}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1232000, "timers": {"sample_time_ms": 654647.606, "sample_throughput": 6.11, "learn_time_ms": 37273.002, "learn_throughput": 107.316, "update_time_ms": 2.972}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07341290137264878, "policy_loss": -0.02039800680358894, "vf_loss": 321.75703144073486, "vf_explained_var": 0.8619102239608765, "kl": 0.009372327083838172, "entropy": 60.977203726768494, "entropy_coeff": 0.001}}, "num_steps_sampled": 1232000, "num_steps_trained": 1232000}, "done": false, "episodes_total": 1232, "training_iteration": 308, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_03-53-43", "timestamp": 1618343623, "time_this_iter_s": 688.8679776191711, "time_total_s": 379642.0133988857, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 379642.0133988857, "timesteps_since_restore": 0, "iterations_since_restore": 308, "perf": {"cpu_util_percent": 21.273775510204086, "ram_util_percent": 22.199999999999992}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1617.671228262754, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1708.1004355997004, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1682.2079403098746, -1705.4173050754587, -1653.926122113745, -1619.4545596350167, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 483.41234435455425, "mean_raw_obs_processing_ms": 2.0999015951932853, "mean_inference_ms": 96.19866460777563, "mean_action_processing_ms": 0.2979239859431949}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1236000, "timers": {"sample_time_ms": 654667.114, "sample_throughput": 6.11, "learn_time_ms": 37197.774, "learn_throughput": 107.533, "update_time_ms": 2.962}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.08743523963494226, "policy_loss": -0.03412203449988738, "vf_loss": 278.933718919754, "vf_explained_var": 0.8827676773071289, "kl": 0.008671680901898071, "entropy": 60.49257946014404, "entropy_coeff": 0.001}}, "num_steps_sampled": 1236000, "num_steps_trained": 1236000}, "done": false, "episodes_total": 1236, "training_iteration": 309, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_04-05-14", "timestamp": 1618344314, "time_this_iter_s": 690.9597337245941, "time_total_s": 380332.9731326103, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 380332.9731326103, "timesteps_since_restore": 0, "iterations_since_restore": 309, "perf": {"cpu_util_percent": 21.252642276422765, "ram_util_percent": 22.199999999999996}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1617.671228262754, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1709.7095724628543, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1674.101724793519, -1709.1816049157298, -1753.6008344148652, -1698.6150427194248, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 482.72097533416223, "mean_raw_obs_processing_ms": 2.09801269804187, "mean_inference_ms": 96.03339068391055, "mean_action_processing_ms": 0.2973021357295432}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1240000, "timers": {"sample_time_ms": 655160.682, "sample_throughput": 6.105, "learn_time_ms": 36977.793, "learn_throughput": 108.173, "update_time_ms": 3.1}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07037242379738018, "policy_loss": -0.01764679327607155, "vf_loss": 380.2249457836151, "vf_explained_var": 0.8477786779403687, "kl": 0.010424175154184923, "entropy": 61.80511164665222, "entropy_coeff": 0.001}}, "num_steps_sampled": 1240000, "num_steps_trained": 1240000}, "done": false, "episodes_total": 1240, "training_iteration": 310, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_04-16-47", "timestamp": 1618345007, "time_this_iter_s": 692.6610460281372, "time_total_s": 381025.63417863846, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 381025.63417863846, "timesteps_since_restore": 0, "iterations_since_restore": 310, "perf": {"cpu_util_percent": 21.113083164300203, "ram_util_percent": 22.20010141987829}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1617.671228262754, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1708.7773680923347, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1682.712252053781, -1685.4005916245692, -1642.3418126340828, -1649.923996871746, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 482.03404534263507, "mean_raw_obs_processing_ms": 2.0961388595974166, "mean_inference_ms": 95.86928424906343, "mean_action_processing_ms": 0.2966825555300179}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1244000, "timers": {"sample_time_ms": 654224.971, "sample_throughput": 6.114, "learn_time_ms": 37316.528, "learn_throughput": 107.191, "update_time_ms": 3.103}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07286905957153067, "policy_loss": -0.018535750219598413, "vf_loss": 226.6030979156494, "vf_explained_var": 0.8986105918884277, "kl": 0.009370850486448035, "entropy": 61.343332171440125, "entropy_coeff": 0.001}}, "num_steps_sampled": 1244000, "num_steps_trained": 1244000}, "done": false, "episodes_total": 1244, "training_iteration": 311, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_04-28-16", "timestamp": 1618345696, "time_this_iter_s": 689.0098600387573, "time_total_s": 381714.6440386772, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 381714.6440386772, "timesteps_since_restore": 0, "iterations_since_restore": 311, "perf": {"cpu_util_percent": 21.383384301732928, "ram_util_percent": 22.199999999999992}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1617.671228262754, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1710.5706891648929, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1715.636194090904, -1637.8419799387966, -1723.560345312717, -1741.593244008185, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 481.3515983357784, "mean_raw_obs_processing_ms": 2.0942777051792936, "mean_inference_ms": 95.7062658726302, "mean_action_processing_ms": 0.2960683570623743}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1248000, "timers": {"sample_time_ms": 653772.577, "sample_throughput": 6.118, "learn_time_ms": 37223.297, "learn_throughput": 107.46, "update_time_ms": 3.124}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07017469152924605, "policy_loss": -0.01620191178517416, "vf_loss": 302.0327205657959, "vf_explained_var": 0.8724215030670166, "kl": 0.009512057149549946, "entropy": 61.80858397483826, "entropy_coeff": 0.001}}, "num_steps_sampled": 1248000, "num_steps_trained": 1248000}, "done": false, "episodes_total": 1248, "training_iteration": 312, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_04-39-46", "timestamp": 1618346386, "time_this_iter_s": 689.9666073322296, "time_total_s": 382404.61064600945, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 382404.61064600945, "timesteps_since_restore": 0, "iterations_since_restore": 312, "perf": {"cpu_util_percent": 21.223421588594707, "ram_util_percent": 22.200203665987775}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1617.671228262754, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1708.9227024998406, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1696.3134934779218, -1754.2536133875567, -1732.0134841634217, -1698.1813542893296, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 480.67359652913177, "mean_raw_obs_processing_ms": 2.0924374709083877, "mean_inference_ms": 95.5442880549907, "mean_action_processing_ms": 0.29546198248432737}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1252000, "timers": {"sample_time_ms": 653862.651, "sample_throughput": 6.117, "learn_time_ms": 37314.239, "learn_throughput": 107.198, "update_time_ms": 3.12}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.0734282074845396, "policy_loss": -0.021801743598189205, "vf_loss": 308.3689441680908, "vf_explained_var": 0.8760184645652771, "kl": 0.01297073031309992, "entropy": 61.27658259868622, "entropy_coeff": 0.001}}, "num_steps_sampled": 1252000, "num_steps_trained": 1252000}, "done": false, "episodes_total": 1252, "training_iteration": 313, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_04-51-16", "timestamp": 1618347076, "time_this_iter_s": 690.1377747058868, "time_total_s": 383094.74842071533, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 383094.74842071533, "timesteps_since_restore": 0, "iterations_since_restore": 313, "perf": {"cpu_util_percent": 21.32706002034588, "ram_util_percent": 22.16266531027467}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1617.671228262754, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1707.8298730340941, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987, -1651.6808351280604, -1676.8139360764612, -1730.709987644321, -1672.8990684755972, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 480.00014460869784, "mean_raw_obs_processing_ms": 2.0906080957058477, "mean_inference_ms": 95.38345057090541, "mean_action_processing_ms": 0.294860211559531}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1256000, "timers": {"sample_time_ms": 653987.639, "sample_throughput": 6.116, "learn_time_ms": 37339.523, "learn_throughput": 107.125, "update_time_ms": 3.119}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.08653985161799937, "policy_loss": -0.032573550881352276, "vf_loss": 247.4575970172882, "vf_explained_var": 0.8907530307769775, "kl": 0.009903752215905115, "entropy": 61.45465052127838, "entropy_coeff": 0.001}}, "num_steps_sampled": 1256000, "num_steps_trained": 1256000}, "done": false, "episodes_total": 1256, "training_iteration": 314, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_05-02-50", "timestamp": 1618347770, "time_this_iter_s": 693.8120641708374, "time_total_s": 383788.56048488617, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 383788.56048488617, "timesteps_since_restore": 0, "iterations_since_restore": 314, "perf": {"cpu_util_percent": 21.200202634245187, "ram_util_percent": 22.200101317122588}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1617.671228262754, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1709.11760458456, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1676.0744849002067, -1651.0733465014623, -1796.8057881744014, -1736.9233627949616, -1681.1723510092202, -1681.4377406418796, -1693.6182098020404, -1771.2610335765253, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 479.3314150978185, "mean_raw_obs_processing_ms": 2.08879191905161, "mean_inference_ms": 95.22373222040181, "mean_action_processing_ms": 0.29426212380566363}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1260000, "timers": {"sample_time_ms": 653995.902, "sample_throughput": 6.116, "learn_time_ms": 37375.627, "learn_throughput": 107.022, "update_time_ms": 3.082}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07421373971737921, "policy_loss": -0.024707199016120285, "vf_loss": 547.8186302185059, "vf_explained_var": 0.7478345632553101, "kl": 0.012267660291399807, "entropy": 61.195226073265076, "entropy_coeff": 0.001}}, "num_steps_sampled": 1260000, "num_steps_trained": 1260000}, "done": false, "episodes_total": 1260, "training_iteration": 315, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_05-14-25", "timestamp": 1618348465, "time_this_iter_s": 694.9985337257385, "time_total_s": 384483.5590186119, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 384483.5590186119, "timesteps_since_restore": 0, "iterations_since_restore": 315, "perf": {"cpu_util_percent": 21.740303030303032, "ram_util_percent": 22.166868686868686}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1596.7560360396812, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1707.6279113582495, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1637.9556474873714, -1596.7560360396812, -1750.7394904478747, -1693.0688384237278, -1707.4519439348162, -1818.8598582147358, -1682.2124987099, -1687.4483410905523, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987, -1676.0744849002067, -1651.0733465014623, -1796.8057881744014, -1736.9233627949616], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 478.66693801496723, "mean_raw_obs_processing_ms": 2.0869815757610417, "mean_inference_ms": 95.06499136820497, "mean_action_processing_ms": 0.29367238129033413}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1264000, "timers": {"sample_time_ms": 654004.175, "sample_throughput": 6.116, "learn_time_ms": 37391.087, "learn_throughput": 106.977, "update_time_ms": 2.931}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07197698624804616, "policy_loss": -0.02426424401346594, "vf_loss": 620.6637010574341, "vf_explained_var": 0.7092680931091309, "kl": 0.012557251640828326, "entropy": 60.27648568153381, "entropy_coeff": 0.001}}, "num_steps_sampled": 1264000, "num_steps_trained": 1264000}, "done": false, "episodes_total": 1264, "training_iteration": 316, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_05-25-55", "timestamp": 1618349155, "time_this_iter_s": 690.4801092147827, "time_total_s": 385174.0391278267, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 385174.0391278267, "timesteps_since_restore": 0, "iterations_since_restore": 316, "perf": {"cpu_util_percent": 21.39938962360122, "ram_util_percent": 22.15859613428281}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1596.7560360396812, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1705.0711578901087, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1641.9391551136214, -1640.854628798243, -1716.0895784679735, -1641.4139327560506, -1664.5809271720184, -1671.1950906233164, -1666.4255781296629, -1707.9836242580102, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987, -1676.0744849002067, -1651.0733465014623, -1796.8057881744014, -1736.9233627949616, -1637.9556474873714, -1596.7560360396812, -1750.7394904478747, -1693.0688384237278], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 478.00709361747363, "mean_raw_obs_processing_ms": 2.085182395078498, "mean_inference_ms": 94.90731365271061, "mean_action_processing_ms": 0.2930869369047504}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1268000, "timers": {"sample_time_ms": 654174.361, "sample_throughput": 6.115, "learn_time_ms": 37394.2, "learn_throughput": 106.968, "update_time_ms": 2.93}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.06907148839673027, "policy_loss": -0.015104292484465986, "vf_loss": 105.25856649875641, "vf_explained_var": 0.9462779760360718, "kl": 0.012229684361955151, "entropy": 61.211055397987366, "entropy_coeff": 0.001}}, "num_steps_sampled": 1268000, "num_steps_trained": 1268000}, "done": false, "episodes_total": 1268, "training_iteration": 317, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_05-37-30", "timestamp": 1618349850, "time_this_iter_s": 694.9030981063843, "time_total_s": 385868.9422259331, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 385868.9422259331, "timesteps_since_restore": 0, "iterations_since_restore": 317, "perf": {"cpu_util_percent": 21.2360970677452, "ram_util_percent": 22.127401415571285}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1596.7560360396812, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1705.9993572916123, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1694.9732363758733, -1686.4323362008247, -1708.7038474165652, -1712.8957403400864, -1723.9952320508305, -1722.3495019683821, -1681.6559047399812, -1803.9741424530412, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987, -1676.0744849002067, -1651.0733465014623, -1796.8057881744014, -1736.9233627949616, -1637.9556474873714, -1596.7560360396812, -1750.7394904478747, -1693.0688384237278, -1641.9391551136214, -1640.854628798243, -1716.0895784679735, -1641.4139327560506], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 477.3516588271933, "mean_raw_obs_processing_ms": 2.0833920182165766, "mean_inference_ms": 94.75072643018294, "mean_action_processing_ms": 0.2925032252728093}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1272000, "timers": {"sample_time_ms": 654219.791, "sample_throughput": 6.114, "learn_time_ms": 37952.804, "learn_throughput": 105.394, "update_time_ms": 2.936}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07212918566074222, "policy_loss": -0.021075930795632303, "vf_loss": 403.0933485031128, "vf_explained_var": 0.8286612033843994, "kl": 0.011758297710912302, "entropy": 61.036821484565735, "entropy_coeff": 0.001}}, "num_steps_sampled": 1272000, "num_steps_trained": 1272000}, "done": false, "episodes_total": 1272, "training_iteration": 318, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_05-49-05", "timestamp": 1618350545, "time_this_iter_s": 694.9081418514252, "time_total_s": 386563.8503677845, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 386563.8503677845, "timesteps_since_restore": 0, "iterations_since_restore": 318, "perf": {"cpu_util_percent": 21.327272727272728, "ram_util_percent": 22.211010101010096}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1596.7560360396812, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1703.7535435794607, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1691.7311909170926, -1711.9945367373477, -1685.5841290589483, -1618.083553283736, -1674.933689113468, -1782.6411501685755, -1653.1026989647203, -1693.6084139233, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987, -1676.0744849002067, -1651.0733465014623, -1796.8057881744014, -1736.9233627949616, -1637.9556474873714, -1596.7560360396812, -1750.7394904478747, -1693.0688384237278, -1641.9391551136214, -1640.854628798243, -1716.0895784679735, -1641.4139327560506, -1694.9732363758733, -1686.4323362008247, -1708.7038474165652, -1712.8957403400864], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 476.7002847809997, "mean_raw_obs_processing_ms": 2.0816100918293765, "mean_inference_ms": 94.5951998905719, "mean_action_processing_ms": 0.2919214574671915}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1276000, "timers": {"sample_time_ms": 653917.312, "sample_throughput": 6.117, "learn_time_ms": 38012.616, "learn_throughput": 105.228, "update_time_ms": 2.936}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.0692150458926335, "policy_loss": -0.01554982049856335, "vf_loss": 250.85499596595764, "vf_explained_var": 0.8900607228279114, "kl": 0.00990205789275933, "entropy": 61.18668603897095, "entropy_coeff": 0.001}}, "num_steps_sampled": 1276000, "num_steps_trained": 1276000}, "done": false, "episodes_total": 1276, "training_iteration": 319, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_06-00-34", "timestamp": 1618351234, "time_this_iter_s": 688.5330946445465, "time_total_s": 387252.38346242905, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 387252.38346242905, "timesteps_since_restore": 0, "iterations_since_restore": 319, "perf": {"cpu_util_percent": 21.446326530612247, "ram_util_percent": 22.2238775510204}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1596.7560360396812, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1703.4395845264087, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1726.8285708665849, -1689.4633487298422, -1625.834458586243, -1730.7636686821506, -1767.0986942772677, -1671.0265080815657, -1644.3587398561763, -1701.9071104500802, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987, -1676.0744849002067, -1651.0733465014623, -1796.8057881744014, -1736.9233627949616, -1637.9556474873714, -1596.7560360396812, -1750.7394904478747, -1693.0688384237278, -1641.9391551136214, -1640.854628798243, -1716.0895784679735, -1641.4139327560506, -1694.9732363758733, -1686.4323362008247, -1708.7038474165652, -1712.8957403400864, -1691.7311909170926, -1711.9945367373477, -1685.5841290589483, -1618.083553283736], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 476.0532972761372, "mean_raw_obs_processing_ms": 2.079848872985653, "mean_inference_ms": 94.44066389490031, "mean_action_processing_ms": 0.29134188517392046}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1280000, "timers": {"sample_time_ms": 653735.384, "sample_throughput": 6.119, "learn_time_ms": 37783.994, "learn_throughput": 105.865, "update_time_ms": 2.81}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07424456076114438, "policy_loss": -0.026199871237622574, "vf_loss": 657.0325193405151, "vf_explained_var": 0.728949248790741, "kl": 0.01350571564398706, "entropy": 61.452279448509216, "entropy_coeff": 0.001}}, "num_steps_sampled": 1280000, "num_steps_trained": 1280000}, "done": false, "episodes_total": 1280, "training_iteration": 320, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_06-12-02", "timestamp": 1618351922, "time_this_iter_s": 688.5543608665466, "time_total_s": 387940.9378232956, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 387940.9378232956, "timesteps_since_restore": 0, "iterations_since_restore": 320, "perf": {"cpu_util_percent": 21.095, "ram_util_percent": 22.19959183673469}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1596.7560360396812, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1703.920925643826, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1664.1126603231328, -1741.636013896844, -1659.6123797287196, -1767.1641104581101, -1691.0647400174362, -1667.6232362909598, -1739.1895792474922, -1687.2637266501094, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987, -1676.0744849002067, -1651.0733465014623, -1796.8057881744014, -1736.9233627949616, -1637.9556474873714, -1596.7560360396812, -1750.7394904478747, -1693.0688384237278, -1641.9391551136214, -1640.854628798243, -1716.0895784679735, -1641.4139327560506, -1694.9732363758733, -1686.4323362008247, -1708.7038474165652, -1712.8957403400864, -1691.7311909170926, -1711.9945367373477, -1685.5841290589483, -1618.083553283736, -1726.8285708665849, -1689.4633487298422, -1625.834458586243, -1730.7636686821506], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 475.41048732333854, "mean_raw_obs_processing_ms": 2.078096823067652, "mean_inference_ms": 94.28714043756023, "mean_action_processing_ms": 0.2907688996400543}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1284000, "timers": {"sample_time_ms": 653964.434, "sample_throughput": 6.117, "learn_time_ms": 37774.4, "learn_throughput": 105.892, "update_time_ms": 2.968}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.0632175273494795, "policy_loss": -0.01573283298057504, "vf_loss": 836.6447443962097, "vf_explained_var": 0.6618794202804565, "kl": 0.012158069977886043, "entropy": 62.00616228580475, "entropy_coeff": 0.001}}, "num_steps_sampled": 1284000, "num_steps_trained": 1284000}, "done": false, "episodes_total": 1284, "training_iteration": 321, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_06-23-34", "timestamp": 1618352614, "time_this_iter_s": 691.2061548233032, "time_total_s": 388632.1439781189, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 388632.1439781189, "timesteps_since_restore": 0, "iterations_since_restore": 321, "perf": {"cpu_util_percent": 21.25487804878049, "ram_util_percent": 22.131402439024388}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1596.7560360396812, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1702.6692933862766, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1686.1527499981291, -1662.0987550721716, -1681.5159244412969, -1630.2106269395097, -1639.0992714139393, -1764.4893602584455, -1735.2190619000505, -1779.895042150138, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987, -1676.0744849002067, -1651.0733465014623, -1796.8057881744014, -1736.9233627949616, -1637.9556474873714, -1596.7560360396812, -1750.7394904478747, -1693.0688384237278, -1641.9391551136214, -1640.854628798243, -1716.0895784679735, -1641.4139327560506, -1694.9732363758733, -1686.4323362008247, -1708.7038474165652, -1712.8957403400864, -1691.7311909170926, -1711.9945367373477, -1685.5841290589483, -1618.083553283736, -1726.8285708665849, -1689.4633487298422, -1625.834458586243, -1730.7636686821506, -1664.1126603231328, -1741.636013896844, -1659.6123797287196, -1767.1641104581101], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 474.77218110737783, "mean_raw_obs_processing_ms": 2.076348326104526, "mean_inference_ms": 94.13470560761921, "mean_action_processing_ms": 0.29019820799496915}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1288000, "timers": {"sample_time_ms": 654578.194, "sample_throughput": 6.111, "learn_time_ms": 37832.782, "learn_throughput": 105.728, "update_time_ms": 2.941}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.0771160118165426, "policy_loss": -0.022365750308381394, "vf_loss": 161.38442277908325, "vf_explained_var": 0.9201866984367371, "kl": 0.009896344927255996, "entropy": 61.37412965297699, "entropy_coeff": 0.001}}, "num_steps_sampled": 1288000, "num_steps_trained": 1288000}, "done": false, "episodes_total": 1288, "training_iteration": 322, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_06-35-10", "timestamp": 1618353310, "time_this_iter_s": 696.6876494884491, "time_total_s": 389328.83162760735, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 389328.83162760735, "timesteps_since_restore": 0, "iterations_since_restore": 322, "perf": {"cpu_util_percent": 21.585699899295065, "ram_util_percent": 22.205135951661628}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1596.7560360396812, "episode_reward_min": -1850.7049900217382, "episode_reward_mean": -1701.8239232390217, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1645.0773007096452, -1711.803651505361, -1782.7265303924396, -1694.5582383896206, -1710.6154887250802, -1676.3724478763008, -1850.7049900217382, -1729.791317006323, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987, -1676.0744849002067, -1651.0733465014623, -1796.8057881744014, -1736.9233627949616, -1637.9556474873714, -1596.7560360396812, -1750.7394904478747, -1693.0688384237278, -1641.9391551136214, -1640.854628798243, -1716.0895784679735, -1641.4139327560506, -1694.9732363758733, -1686.4323362008247, -1708.7038474165652, -1712.8957403400864, -1691.7311909170926, -1711.9945367373477, -1685.5841290589483, -1618.083553283736, -1726.8285708665849, -1689.4633487298422, -1625.834458586243, -1730.7636686821506, -1664.1126603231328, -1741.636013896844, -1659.6123797287196, -1767.1641104581101, -1686.1527499981291, -1662.0987550721716, -1681.5159244412969, -1630.2106269395097], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 474.13795480597474, "mean_raw_obs_processing_ms": 2.0746051450827734, "mean_inference_ms": 93.98333269589544, "mean_action_processing_ms": 0.28963178127117745}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1292000, "timers": {"sample_time_ms": 654572.806, "sample_throughput": 6.111, "learn_time_ms": 37816.059, "learn_throughput": 105.775, "update_time_ms": 2.949}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.0787648294644896, "policy_loss": -0.02760213872534223, "vf_loss": 494.0332770347595, "vf_explained_var": 0.7942447662353516, "kl": 0.01255057955859229, "entropy": 62.4567494392395, "entropy_coeff": 0.001}}, "num_steps_sampled": 1292000, "num_steps_trained": 1292000}, "done": false, "episodes_total": 1292, "training_iteration": 323, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_06-46-40", "timestamp": 1618354000, "time_this_iter_s": 689.916784286499, "time_total_s": 390018.74841189384, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 390018.74841189384, "timesteps_since_restore": 0, "iterations_since_restore": 323, "perf": {"cpu_util_percent": 21.375865580448064, "ram_util_percent": 22.199999999999996}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1596.7560360396812, "episode_reward_min": -1831.1758441413565, "episode_reward_mean": -1698.2450995529819, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1674.7541189837868, -1709.7989965111294, -1626.5226783319313, -1598.5260811986095, -1831.1758441413565, -1651.2185799721062, -1765.210242046527, -1703.7574838094963, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987, -1676.0744849002067, -1651.0733465014623, -1796.8057881744014, -1736.9233627949616, -1637.9556474873714, -1596.7560360396812, -1750.7394904478747, -1693.0688384237278, -1641.9391551136214, -1640.854628798243, -1716.0895784679735, -1641.4139327560506, -1694.9732363758733, -1686.4323362008247, -1708.7038474165652, -1712.8957403400864, -1691.7311909170926, -1711.9945367373477, -1685.5841290589483, -1618.083553283736, -1726.8285708665849, -1689.4633487298422, -1625.834458586243, -1730.7636686821506, -1664.1126603231328, -1741.636013896844, -1659.6123797287196, -1767.1641104581101, -1686.1527499981291, -1662.0987550721716, -1681.5159244412969, -1630.2106269395097, -1645.0773007096452, -1711.803651505361, -1782.7265303924396, -1694.5582383896206], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 473.5077170902721, "mean_raw_obs_processing_ms": 2.0728710501229677, "mean_inference_ms": 93.83293503244802, "mean_action_processing_ms": 0.28906884491596474}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1296000, "timers": {"sample_time_ms": 654191.037, "sample_throughput": 6.114, "learn_time_ms": 37802.888, "learn_throughput": 105.812, "update_time_ms": 2.791}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.08372843079268932, "policy_loss": -0.03387012635357678, "vf_loss": 438.66588592529297, "vf_explained_var": 0.7969139218330383, "kl": 0.012566217628773302, "entropy": 60.60661029815674, "entropy_coeff": 0.001}}, "num_steps_sampled": 1296000, "num_steps_trained": 1296000}, "done": false, "episodes_total": 1296, "training_iteration": 324, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_06-58-10", "timestamp": 1618354690, "time_this_iter_s": 689.8605630397797, "time_total_s": 390708.6089749336, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 390708.6089749336, "timesteps_since_restore": 0, "iterations_since_restore": 324, "perf": {"cpu_util_percent": 21.521894093686356, "ram_util_percent": 22.199999999999996}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1596.7560360396812, "episode_reward_min": -1819.5534624206957, "episode_reward_mean": -1696.62197572868, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1696.8284792079635, -1652.5841680519077, -1778.8126958704484, -1660.8244244089788, -1665.0175500231, -1692.6877722071263, -1687.4376088158858, -1658.9384998314497, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987, -1676.0744849002067, -1651.0733465014623, -1796.8057881744014, -1736.9233627949616, -1637.9556474873714, -1596.7560360396812, -1750.7394904478747, -1693.0688384237278, -1641.9391551136214, -1640.854628798243, -1716.0895784679735, -1641.4139327560506, -1694.9732363758733, -1686.4323362008247, -1708.7038474165652, -1712.8957403400864, -1691.7311909170926, -1711.9945367373477, -1685.5841290589483, -1618.083553283736, -1726.8285708665849, -1689.4633487298422, -1625.834458586243, -1730.7636686821506, -1664.1126603231328, -1741.636013896844, -1659.6123797287196, -1767.1641104581101, -1686.1527499981291, -1662.0987550721716, -1681.5159244412969, -1630.2106269395097, -1645.0773007096452, -1711.803651505361, -1782.7265303924396, -1694.5582383896206, -1674.7541189837868, -1709.7989965111294, -1626.5226783319313, -1598.5260811986095], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 472.8817870891381, "mean_raw_obs_processing_ms": 2.0711435358656214, "mean_inference_ms": 93.6834643601481, "mean_action_processing_ms": 0.2885116817315208}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1300000, "timers": {"sample_time_ms": 654031.346, "sample_throughput": 6.116, "learn_time_ms": 37825.266, "learn_throughput": 105.749, "update_time_ms": 2.785}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07134736530133523, "policy_loss": -0.01778452208964154, "vf_loss": 241.95562171936035, "vf_explained_var": 0.8931452035903931, "kl": 0.011895760573679581, "entropy": 62.00462579727173, "entropy_coeff": 0.001}}, "num_steps_sampled": 1300000, "num_steps_trained": 1300000}, "done": false, "episodes_total": 1300, "training_iteration": 325, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_07-09-44", "timestamp": 1618355384, "time_this_iter_s": 693.6252624988556, "time_total_s": 391402.2342374325, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 391402.2342374325, "timesteps_since_restore": 0, "iterations_since_restore": 325, "perf": {"cpu_util_percent": 21.077530364372468, "ram_util_percent": 22.199999999999992}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1596.7560360396812, "episode_reward_min": -1819.5534624206957, "episode_reward_mean": -1696.3386703026026, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1619.0096367917213, -1695.5925290488206, -1633.66415074855, -1727.4845716807763, -1760.0398528781573, -1698.9302185999643, -1681.8710404655276, -1721.8081333132573, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987, -1676.0744849002067, -1651.0733465014623, -1796.8057881744014, -1736.9233627949616, -1637.9556474873714, -1596.7560360396812, -1750.7394904478747, -1693.0688384237278, -1641.9391551136214, -1640.854628798243, -1716.0895784679735, -1641.4139327560506, -1694.9732363758733, -1686.4323362008247, -1708.7038474165652, -1712.8957403400864, -1691.7311909170926, -1711.9945367373477, -1685.5841290589483, -1618.083553283736, -1726.8285708665849, -1689.4633487298422, -1625.834458586243, -1730.7636686821506, -1664.1126603231328, -1741.636013896844, -1659.6123797287196, -1767.1641104581101, -1686.1527499981291, -1662.0987550721716, -1681.5159244412969, -1630.2106269395097, -1645.0773007096452, -1711.803651505361, -1782.7265303924396, -1694.5582383896206, -1674.7541189837868, -1709.7989965111294, -1626.5226783319313, -1598.5260811986095, -1696.8284792079635, -1652.5841680519077, -1778.8126958704484, -1660.8244244089788], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 472.2594511973179, "mean_raw_obs_processing_ms": 2.0694219771296267, "mean_inference_ms": 93.53500180407144, "mean_action_processing_ms": 0.2879547700200874}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1304000, "timers": {"sample_time_ms": 654222.253, "sample_throughput": 6.114, "learn_time_ms": 37916.174, "learn_throughput": 105.496, "update_time_ms": 2.819}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07389205554500222, "policy_loss": -0.02016350216581486, "vf_loss": 256.6307098865509, "vf_explained_var": 0.8863726854324341, "kl": 0.011679103336064145, "entropy": 62.20740532875061, "entropy_coeff": 0.001}}, "num_steps_sampled": 1304000, "num_steps_trained": 1304000}, "done": false, "episodes_total": 1304, "training_iteration": 326, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_07-21-17", "timestamp": 1618356077, "time_this_iter_s": 693.2988934516907, "time_total_s": 392095.53313088417, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 392095.53313088417, "timesteps_since_restore": 0, "iterations_since_restore": 326, "perf": {"cpu_util_percent": 21.40010131712259, "ram_util_percent": 22.187639311043565}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1596.7560360396812, "episode_reward_min": -1819.5534624206957, "episode_reward_mean": -1696.1660701494536, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1706.437824141134, -1660.1831034453928, -1773.5050079640218, -1705.2632943914114, -1770.369208761741, -1715.0451151379611, -1697.8177621047178, -1684.629117269935, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987, -1676.0744849002067, -1651.0733465014623, -1796.8057881744014, -1736.9233627949616, -1637.9556474873714, -1596.7560360396812, -1750.7394904478747, -1693.0688384237278, -1641.9391551136214, -1640.854628798243, -1716.0895784679735, -1641.4139327560506, -1694.9732363758733, -1686.4323362008247, -1708.7038474165652, -1712.8957403400864, -1691.7311909170926, -1711.9945367373477, -1685.5841290589483, -1618.083553283736, -1726.8285708665849, -1689.4633487298422, -1625.834458586243, -1730.7636686821506, -1664.1126603231328, -1741.636013896844, -1659.6123797287196, -1767.1641104581101, -1686.1527499981291, -1662.0987550721716, -1681.5159244412969, -1630.2106269395097, -1645.0773007096452, -1711.803651505361, -1782.7265303924396, -1694.5582383896206, -1674.7541189837868, -1709.7989965111294, -1626.5226783319313, -1598.5260811986095, -1696.8284792079635, -1652.5841680519077, -1778.8126958704484, -1660.8244244089788, -1619.0096367917213, -1695.5925290488206, -1633.66415074855, -1727.4845716807763], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 471.6406746034663, "mean_raw_obs_processing_ms": 2.067711471781277, "mean_inference_ms": 93.38751523047014, "mean_action_processing_ms": 0.2874038323186717}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1308000, "timers": {"sample_time_ms": 653719.248, "sample_throughput": 6.119, "learn_time_ms": 37888.495, "learn_throughput": 105.573, "update_time_ms": 2.82}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07163619913626462, "policy_loss": -0.01861458388157189, "vf_loss": 182.82670211791992, "vf_explained_var": 0.9085721969604492, "kl": 0.01287195083568804, "entropy": 61.36630439758301, "entropy_coeff": 0.001}}, "num_steps_sampled": 1308000, "num_steps_trained": 1308000}, "done": false, "episodes_total": 1308, "training_iteration": 327, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_07-32-47", "timestamp": 1618356767, "time_this_iter_s": 689.5970828533173, "time_total_s": 392785.1302137375, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 392785.1302137375, "timesteps_since_restore": 0, "iterations_since_restore": 327, "perf": {"cpu_util_percent": 21.360794297352342, "ram_util_percent": 22.131364562118126}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1596.7560360396812, "episode_reward_min": -1819.5534624206957, "episode_reward_mean": -1693.6257801011066, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1630.190470125778, -1656.702495867786, -1676.5168939733671, -1650.422338472691, -1705.4824632654208, -1666.2379337760897, -1710.3140426461946, -1755.9750967703185, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987, -1676.0744849002067, -1651.0733465014623, -1796.8057881744014, -1736.9233627949616, -1637.9556474873714, -1596.7560360396812, -1750.7394904478747, -1693.0688384237278, -1641.9391551136214, -1640.854628798243, -1716.0895784679735, -1641.4139327560506, -1694.9732363758733, -1686.4323362008247, -1708.7038474165652, -1712.8957403400864, -1691.7311909170926, -1711.9945367373477, -1685.5841290589483, -1618.083553283736, -1726.8285708665849, -1689.4633487298422, -1625.834458586243, -1730.7636686821506, -1664.1126603231328, -1741.636013896844, -1659.6123797287196, -1767.1641104581101, -1686.1527499981291, -1662.0987550721716, -1681.5159244412969, -1630.2106269395097, -1645.0773007096452, -1711.803651505361, -1782.7265303924396, -1694.5582383896206, -1674.7541189837868, -1709.7989965111294, -1626.5226783319313, -1598.5260811986095, -1696.8284792079635, -1652.5841680519077, -1778.8126958704484, -1660.8244244089788, -1619.0096367917213, -1695.5925290488206, -1633.66415074855, -1727.4845716807763, -1706.437824141134, -1660.1831034453928, -1773.5050079640218, -1705.2632943914114], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 471.0261300500094, "mean_raw_obs_processing_ms": 2.066010636035877, "mean_inference_ms": 93.24102179026053, "mean_action_processing_ms": 0.2868571491110378}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1312000, "timers": {"sample_time_ms": 653798.795, "sample_throughput": 6.118, "learn_time_ms": 37882.194, "learn_throughput": 105.591, "update_time_ms": 2.812}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.06993878347566351, "policy_loss": -0.01540070999180898, "vf_loss": 439.8430685997009, "vf_explained_var": 0.8402607440948486, "kl": 0.007841400481993333, "entropy": 62.90620946884155, "entropy_coeff": 0.001}}, "num_steps_sampled": 1312000, "num_steps_trained": 1312000}, "done": false, "episodes_total": 1312, "training_iteration": 328, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_07-44-23", "timestamp": 1618357463, "time_this_iter_s": 695.6403081417084, "time_total_s": 393480.7705218792, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 393480.7705218792, "timesteps_since_restore": 0, "iterations_since_restore": 328, "perf": {"cpu_util_percent": 21.33572149344097, "ram_util_percent": 22.199899091826428}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1596.7560360396812, "episode_reward_min": -1819.5534624206957, "episode_reward_mean": -1692.2824221023732, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1704.307405933423, -1669.4801882861536, -1667.757414315935, -1662.1287280492293, -1675.8256919601442, -1618.705668175522, -1711.9901000400514, -1771.6064312215835, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987, -1676.0744849002067, -1651.0733465014623, -1796.8057881744014, -1736.9233627949616, -1637.9556474873714, -1596.7560360396812, -1750.7394904478747, -1693.0688384237278, -1641.9391551136214, -1640.854628798243, -1716.0895784679735, -1641.4139327560506, -1694.9732363758733, -1686.4323362008247, -1708.7038474165652, -1712.8957403400864, -1691.7311909170926, -1711.9945367373477, -1685.5841290589483, -1618.083553283736, -1726.8285708665849, -1689.4633487298422, -1625.834458586243, -1730.7636686821506, -1664.1126603231328, -1741.636013896844, -1659.6123797287196, -1767.1641104581101, -1686.1527499981291, -1662.0987550721716, -1681.5159244412969, -1630.2106269395097, -1645.0773007096452, -1711.803651505361, -1782.7265303924396, -1694.5582383896206, -1674.7541189837868, -1709.7989965111294, -1626.5226783319313, -1598.5260811986095, -1696.8284792079635, -1652.5841680519077, -1778.8126958704484, -1660.8244244089788, -1619.0096367917213, -1695.5925290488206, -1633.66415074855, -1727.4845716807763, -1706.437824141134, -1660.1831034453928, -1773.5050079640218, -1705.2632943914114, -1630.190470125778, -1656.702495867786, -1676.5168939733671, -1650.422338472691], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 470.4153343826992, "mean_raw_obs_processing_ms": 2.0643200293187327, "mean_inference_ms": 93.09548359022841, "mean_action_processing_ms": 0.28631624751108353}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1316000, "timers": {"sample_time_ms": 653961.644, "sample_throughput": 6.117, "learn_time_ms": 37383.374, "learn_throughput": 106.999, "update_time_ms": 2.828}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07086343190167099, "policy_loss": -0.015795996645465493, "vf_loss": 138.24886047840118, "vf_explained_var": 0.9319894313812256, "kl": 0.010776764218462631, "entropy": 61.9056590795517, "entropy_coeff": 0.001}}, "num_steps_sampled": 1316000, "num_steps_trained": 1316000}, "done": false, "episodes_total": 1316, "training_iteration": 329, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_07-55-48", "timestamp": 1618358148, "time_this_iter_s": 685.1737170219421, "time_total_s": 394165.94423890114, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 394165.94423890114, "timesteps_since_restore": 0, "iterations_since_restore": 329, "perf": {"cpu_util_percent": 20.853846153846153, "ram_util_percent": 22.200102564102554}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1596.1378507384431, "episode_reward_min": -1819.5534624206957, "episode_reward_mean": -1691.3308813508404, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1596.1378507384431, -1751.840991088665, -1662.6403605191726, -1672.3546138977104, -1794.3383931545316, -1680.550528068198, -1766.260775880593, -1720.307457518943, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987, -1676.0744849002067, -1651.0733465014623, -1796.8057881744014, -1736.9233627949616, -1637.9556474873714, -1596.7560360396812, -1750.7394904478747, -1693.0688384237278, -1641.9391551136214, -1640.854628798243, -1716.0895784679735, -1641.4139327560506, -1694.9732363758733, -1686.4323362008247, -1708.7038474165652, -1712.8957403400864, -1691.7311909170926, -1711.9945367373477, -1685.5841290589483, -1618.083553283736, -1726.8285708665849, -1689.4633487298422, -1625.834458586243, -1730.7636686821506, -1664.1126603231328, -1741.636013896844, -1659.6123797287196, -1767.1641104581101, -1686.1527499981291, -1662.0987550721716, -1681.5159244412969, -1630.2106269395097, -1645.0773007096452, -1711.803651505361, -1782.7265303924396, -1694.5582383896206, -1674.7541189837868, -1709.7989965111294, -1626.5226783319313, -1598.5260811986095, -1696.8284792079635, -1652.5841680519077, -1778.8126958704484, -1660.8244244089788, -1619.0096367917213, -1695.5925290488206, -1633.66415074855, -1727.4845716807763, -1706.437824141134, -1660.1831034453928, -1773.5050079640218, -1705.2632943914114, -1630.190470125778, -1656.702495867786, -1676.5168939733671, -1650.422338472691, -1704.307405933423, -1669.4801882861536, -1667.757414315935, -1662.1287280492293], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 469.8085657905697, "mean_raw_obs_processing_ms": 2.0626413868890965, "mean_inference_ms": 92.95085750382495, "mean_action_processing_ms": 0.28578144641031095}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1320000, "timers": {"sample_time_ms": 654441.344, "sample_throughput": 6.112, "learn_time_ms": 37342.143, "learn_throughput": 107.118, "update_time_ms": 2.811}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07349669962422922, "policy_loss": -0.017784905270673335, "vf_loss": 200.17680883407593, "vf_explained_var": 0.9016295671463013, "kl": 0.009261975210392848, "entropy": 62.40243363380432, "entropy_coeff": 0.001}}, "num_steps_sampled": 1320000, "num_steps_trained": 1320000}, "done": false, "episodes_total": 1320, "training_iteration": 330, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_08-07-21", "timestamp": 1618358841, "time_this_iter_s": 692.9387731552124, "time_total_s": 394858.88301205635, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 394858.88301205635, "timesteps_since_restore": 0, "iterations_since_restore": 330, "perf": {"cpu_util_percent": 20.496048632218844, "ram_util_percent": 22.349949341438702}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1596.1378507384431, "episode_reward_min": -1819.5534624206957, "episode_reward_mean": -1689.6357869402698, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1656.7246426981258, -1739.5718304499546, -1725.0558841085408, -1670.5953563085875, -1702.305126568865, -1743.90637471978, -1750.452184318684, -1819.5534624206957, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987, -1676.0744849002067, -1651.0733465014623, -1796.8057881744014, -1736.9233627949616, -1637.9556474873714, -1596.7560360396812, -1750.7394904478747, -1693.0688384237278, -1641.9391551136214, -1640.854628798243, -1716.0895784679735, -1641.4139327560506, -1694.9732363758733, -1686.4323362008247, -1708.7038474165652, -1712.8957403400864, -1691.7311909170926, -1711.9945367373477, -1685.5841290589483, -1618.083553283736, -1726.8285708665849, -1689.4633487298422, -1625.834458586243, -1730.7636686821506, -1664.1126603231328, -1741.636013896844, -1659.6123797287196, -1767.1641104581101, -1686.1527499981291, -1662.0987550721716, -1681.5159244412969, -1630.2106269395097, -1645.0773007096452, -1711.803651505361, -1782.7265303924396, -1694.5582383896206, -1674.7541189837868, -1709.7989965111294, -1626.5226783319313, -1598.5260811986095, -1696.8284792079635, -1652.5841680519077, -1778.8126958704484, -1660.8244244089788, -1619.0096367917213, -1695.5925290488206, -1633.66415074855, -1727.4845716807763, -1706.437824141134, -1660.1831034453928, -1773.5050079640218, -1705.2632943914114, -1630.190470125778, -1656.702495867786, -1676.5168939733671, -1650.422338472691, -1704.307405933423, -1669.4801882861536, -1667.757414315935, -1662.1287280492293, -1596.1378507384431, -1751.840991088665, -1662.6403605191726, -1672.3546138977104], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 469.2062625282345, "mean_raw_obs_processing_ms": 2.060967448050263, "mean_inference_ms": 92.80725171873394, "mean_action_processing_ms": 0.2852515858977616}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1324000, "timers": {"sample_time_ms": 655630.661, "sample_throughput": 6.101, "learn_time_ms": 36604.593, "learn_throughput": 109.276, "update_time_ms": 2.646}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.0683562143240124, "policy_loss": -0.01513339311350137, "vf_loss": 238.67393589019775, "vf_explained_var": 0.8908187747001648, "kl": 0.014185220294166356, "entropy": 62.790823101997375, "entropy_coeff": 0.001}}, "num_steps_sampled": 1324000, "num_steps_trained": 1324000}, "done": false, "episodes_total": 1324, "training_iteration": 331, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_08-18-56", "timestamp": 1618359536, "time_this_iter_s": 695.7222385406494, "time_total_s": 395554.605250597, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 395554.605250597, "timesteps_since_restore": 0, "iterations_since_restore": 331, "perf": {"cpu_util_percent": 20.612613521695256, "ram_util_percent": 22.198990918264375}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1596.1378507384431, "episode_reward_min": -1802.4404464334093, "episode_reward_mean": -1686.7133298313886, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1640.809043857104, -1657.0755397411795, -1696.4402137206673, -1729.6466398209566, -1769.8099612962346, -1645.64597497749, -1727.49935278534, -1689.2709399863995, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987, -1676.0744849002067, -1651.0733465014623, -1796.8057881744014, -1736.9233627949616, -1637.9556474873714, -1596.7560360396812, -1750.7394904478747, -1693.0688384237278, -1641.9391551136214, -1640.854628798243, -1716.0895784679735, -1641.4139327560506, -1694.9732363758733, -1686.4323362008247, -1708.7038474165652, -1712.8957403400864, -1691.7311909170926, -1711.9945367373477, -1685.5841290589483, -1618.083553283736, -1726.8285708665849, -1689.4633487298422, -1625.834458586243, -1730.7636686821506, -1664.1126603231328, -1741.636013896844, -1659.6123797287196, -1767.1641104581101, -1686.1527499981291, -1662.0987550721716, -1681.5159244412969, -1630.2106269395097, -1645.0773007096452, -1711.803651505361, -1782.7265303924396, -1694.5582383896206, -1674.7541189837868, -1709.7989965111294, -1626.5226783319313, -1598.5260811986095, -1696.8284792079635, -1652.5841680519077, -1778.8126958704484, -1660.8244244089788, -1619.0096367917213, -1695.5925290488206, -1633.66415074855, -1727.4845716807763, -1706.437824141134, -1660.1831034453928, -1773.5050079640218, -1705.2632943914114, -1630.190470125778, -1656.702495867786, -1676.5168939733671, -1650.422338472691, -1704.307405933423, -1669.4801882861536, -1667.757414315935, -1662.1287280492293, -1596.1378507384431, -1751.840991088665, -1662.6403605191726, -1672.3546138977104, -1656.7246426981258, -1739.5718304499546, -1725.0558841085408, -1670.5953563085875], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 468.60745114331536, "mean_raw_obs_processing_ms": 2.0593022130538863, "mean_inference_ms": 92.6646043229229, "mean_action_processing_ms": 0.28472518454312734}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1328000, "timers": {"sample_time_ms": 654839.749, "sample_throughput": 6.108, "learn_time_ms": 36634.615, "learn_throughput": 109.186, "update_time_ms": 2.653}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07693922528414987, "policy_loss": -0.020848618674790487, "vf_loss": 125.61083590984344, "vf_explained_var": 0.9412533044815063, "kl": 0.009665219229646027, "entropy": 62.239728569984436, "entropy_coeff": 0.001}}, "num_steps_sampled": 1328000, "num_steps_trained": 1328000}, "done": false, "episodes_total": 1328, "training_iteration": 332, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_08-30-26", "timestamp": 1618360226, "time_this_iter_s": 689.0789642333984, "time_total_s": 396243.6842148304, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 396243.6842148304, "timesteps_since_restore": 0, "iterations_since_restore": 332, "perf": {"cpu_util_percent": 18.07737003058104, "ram_util_percent": 22.662895005096843}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1596.1378507384431, "episode_reward_min": -1802.4404464334093, "episode_reward_mean": -1685.7392775824437, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1689.2785992762504, -1725.4218369272373, -1621.187488447878, -1698.933079499631, -1660.928225233617, -1617.671228262754, -1703.003103187685, -1802.4404464334093, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987, -1676.0744849002067, -1651.0733465014623, -1796.8057881744014, -1736.9233627949616, -1637.9556474873714, -1596.7560360396812, -1750.7394904478747, -1693.0688384237278, -1641.9391551136214, -1640.854628798243, -1716.0895784679735, -1641.4139327560506, -1694.9732363758733, -1686.4323362008247, -1708.7038474165652, -1712.8957403400864, -1691.7311909170926, -1711.9945367373477, -1685.5841290589483, -1618.083553283736, -1726.8285708665849, -1689.4633487298422, -1625.834458586243, -1730.7636686821506, -1664.1126603231328, -1741.636013896844, -1659.6123797287196, -1767.1641104581101, -1686.1527499981291, -1662.0987550721716, -1681.5159244412969, -1630.2106269395097, -1645.0773007096452, -1711.803651505361, -1782.7265303924396, -1694.5582383896206, -1674.7541189837868, -1709.7989965111294, -1626.5226783319313, -1598.5260811986095, -1696.8284792079635, -1652.5841680519077, -1778.8126958704484, -1660.8244244089788, -1619.0096367917213, -1695.5925290488206, -1633.66415074855, -1727.4845716807763, -1706.437824141134, -1660.1831034453928, -1773.5050079640218, -1705.2632943914114, -1630.190470125778, -1656.702495867786, -1676.5168939733671, -1650.422338472691, -1704.307405933423, -1669.4801882861536, -1667.757414315935, -1662.1287280492293, -1596.1378507384431, -1751.840991088665, -1662.6403605191726, -1672.3546138977104, -1656.7246426981258, -1739.5718304499546, -1725.0558841085408, -1670.5953563085875, -1640.809043857104, -1657.0755397411795, -1696.4402137206673, -1729.6466398209566], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 468.0119768294024, "mean_raw_obs_processing_ms": 2.0576463981150495, "mean_inference_ms": 92.52273067877864, "mean_action_processing_ms": 0.2842030622075525}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1332000, "timers": {"sample_time_ms": 654423.176, "sample_throughput": 6.112, "learn_time_ms": 36648.28, "learn_throughput": 109.146, "update_time_ms": 2.653}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07505193780525587, "policy_loss": -0.020165742142125964, "vf_loss": 151.42819261550903, "vf_explained_var": 0.9280408620834351, "kl": 0.011204221518710256, "entropy": 62.07261085510254, "entropy_coeff": 0.001}}, "num_steps_sampled": 1332000, "num_steps_trained": 1332000}, "done": false, "episodes_total": 1332, "training_iteration": 333, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_08-41-51", "timestamp": 1618360911, "time_this_iter_s": 685.8875563144684, "time_total_s": 396929.57177114487, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 396929.57177114487, "timesteps_since_restore": 0, "iterations_since_restore": 333, "perf": {"cpu_util_percent": 21.70891393442623, "ram_util_percent": 22.63104508196721}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1596.1378507384431, "episode_reward_min": -1796.8057881744014, "episode_reward_mean": -1686.9181395702842, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1690.3625043618865, -1692.2274550160032, -1781.2970487182056, -1738.0421938053819, -1620.7769000413923, -1759.5958591206038, -1707.884952196025, -1733.6619020914725, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987, -1676.0744849002067, -1651.0733465014623, -1796.8057881744014, -1736.9233627949616, -1637.9556474873714, -1596.7560360396812, -1750.7394904478747, -1693.0688384237278, -1641.9391551136214, -1640.854628798243, -1716.0895784679735, -1641.4139327560506, -1694.9732363758733, -1686.4323362008247, -1708.7038474165652, -1712.8957403400864, -1691.7311909170926, -1711.9945367373477, -1685.5841290589483, -1618.083553283736, -1726.8285708665849, -1689.4633487298422, -1625.834458586243, -1730.7636686821506, -1664.1126603231328, -1741.636013896844, -1659.6123797287196, -1767.1641104581101, -1686.1527499981291, -1662.0987550721716, -1681.5159244412969, -1630.2106269395097, -1645.0773007096452, -1711.803651505361, -1782.7265303924396, -1694.5582383896206, -1674.7541189837868, -1709.7989965111294, -1626.5226783319313, -1598.5260811986095, -1696.8284792079635, -1652.5841680519077, -1778.8126958704484, -1660.8244244089788, -1619.0096367917213, -1695.5925290488206, -1633.66415074855, -1727.4845716807763, -1706.437824141134, -1660.1831034453928, -1773.5050079640218, -1705.2632943914114, -1630.190470125778, -1656.702495867786, -1676.5168939733671, -1650.422338472691, -1704.307405933423, -1669.4801882861536, -1667.757414315935, -1662.1287280492293, -1596.1378507384431, -1751.840991088665, -1662.6403605191726, -1672.3546138977104, -1656.7246426981258, -1739.5718304499546, -1725.0558841085408, -1670.5953563085875, -1640.809043857104, -1657.0755397411795, -1696.4402137206673, -1729.6466398209566, -1689.2785992762504, -1725.4218369272373, -1621.187488447878, -1698.933079499631], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 467.42008339957, "mean_raw_obs_processing_ms": 2.0560024370915455, "mean_inference_ms": 92.38170788369003, "mean_action_processing_ms": 0.28368384328357155}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1336000, "timers": {"sample_time_ms": 654413.923, "sample_throughput": 6.112, "learn_time_ms": 36706.643, "learn_throughput": 108.972, "update_time_ms": 2.692}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.08368087856797501, "policy_loss": -0.030760473338887095, "vf_loss": 310.6237177848816, "vf_explained_var": 0.8721498847007751, "kl": 0.011452794657088816, "entropy": 61.82461369037628, "entropy_coeff": 0.001}}, "num_steps_sampled": 1336000, "num_steps_trained": 1336000}, "done": false, "episodes_total": 1336, "training_iteration": 334, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_08-53-22", "timestamp": 1618361602, "time_this_iter_s": 690.3521461486816, "time_total_s": 397619.92391729355, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 397619.92391729355, "timesteps_since_restore": 0, "iterations_since_restore": 334, "perf": {"cpu_util_percent": 21.477517802644964, "ram_util_percent": 22.188301119023393}, "trial_id": "d606b_00000"}
{"episode_reward_max": -1596.1378507384431, "episode_reward_min": -1796.8057881744014, "episode_reward_mean": -1685.2356642104278, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1660.6805326142012, -1687.1533571591813, -1671.3310177868216, -1634.5071699036514, -1702.9244262150482, -1686.2728845732843, -1634.955181498279, -1718.126277504977, -1752.7129819514014, -1689.0458643692361, -1720.9786515585545, -1676.973262560772, -1620.1729089530459, -1688.1880095474994, -1666.0208096371373, -1679.4513687077597, -1729.1991923011922, -1695.263277749647, -1709.9405764676956, -1637.0759522249987, -1676.0744849002067, -1651.0733465014623, -1796.8057881744014, -1736.9233627949616, -1637.9556474873714, -1596.7560360396812, -1750.7394904478747, -1693.0688384237278, -1641.9391551136214, -1640.854628798243, -1716.0895784679735, -1641.4139327560506, -1694.9732363758733, -1686.4323362008247, -1708.7038474165652, -1712.8957403400864, -1691.7311909170926, -1711.9945367373477, -1685.5841290589483, -1618.083553283736, -1726.8285708665849, -1689.4633487298422, -1625.834458586243, -1730.7636686821506, -1664.1126603231328, -1741.636013896844, -1659.6123797287196, -1767.1641104581101, -1686.1527499981291, -1662.0987550721716, -1681.5159244412969, -1630.2106269395097, -1645.0773007096452, -1711.803651505361, -1782.7265303924396, -1694.5582383896206, -1674.7541189837868, -1709.7989965111294, -1626.5226783319313, -1598.5260811986095, -1696.8284792079635, -1652.5841680519077, -1778.8126958704484, -1660.8244244089788, -1619.0096367917213, -1695.5925290488206, -1633.66415074855, -1727.4845716807763, -1706.437824141134, -1660.1831034453928, -1773.5050079640218, -1705.2632943914114, -1630.190470125778, -1656.702495867786, -1676.5168939733671, -1650.422338472691, -1704.307405933423, -1669.4801882861536, -1667.757414315935, -1662.1287280492293, -1596.1378507384431, -1751.840991088665, -1662.6403605191726, -1672.3546138977104, -1656.7246426981258, -1739.5718304499546, -1725.0558841085408, -1670.5953563085875, -1640.809043857104, -1657.0755397411795, -1696.4402137206673, -1729.6466398209566, -1689.2785992762504, -1725.4218369272373, -1621.187488447878, -1698.933079499631, -1690.3625043618865, -1692.2274550160032, -1781.2970487182056, -1738.0421938053819], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 466.8314231053916, "mean_raw_obs_processing_ms": 2.0543568574898314, "mean_inference_ms": 92.24151973576936, "mean_action_processing_ms": 0.28316940759071124}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1340000, "timers": {"sample_time_ms": 653767.093, "sample_throughput": 6.118, "learn_time_ms": 36510.089, "learn_throughput": 109.559, "update_time_ms": 2.747}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.5062500000000001, "cur_lr": 5e-05, "total_loss": -0.07396929658716545, "policy_loss": -0.01868560368893668, "vf_loss": 223.1158902645111, "vf_explained_var": 0.8940713405609131, "kl": 0.010401699153590016, "entropy": 62.78070878982544, "entropy_coeff": 0.001}}, "num_steps_sampled": 1340000, "num_steps_trained": 1340000}, "done": false, "episodes_total": 1340, "training_iteration": 335, "experiment_id": "03a578316dc74c93b0f2b8beff5f7128", "date": "2021-04-14_09-04-47", "timestamp": 1618362287, "time_this_iter_s": 685.1918532848358, "time_total_s": 398305.1157705784, "pid": 20118, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 1, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "attentionModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 398305.1157705784, "timesteps_since_restore": 0, "iterations_since_restore": 335, "perf": {"cpu_util_percent": 21.527971311475408, "ram_util_percent": 22.199999999999992}, "trial_id": "d606b_00000"}
