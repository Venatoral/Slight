{"episode_reward_max": -2754.6227606832485, "episode_reward_min": -2886.871261001328, "episode_reward_mean": -2836.18554501357, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485], "episode_lengths": [1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 779.2811553994159, "mean_raw_obs_processing_ms": 2.378663797488158, "mean_inference_ms": 11.78470037985539, "mean_action_processing_ms": 0.302963349772715}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 4000, "timers": {"sample_time_ms": 1598646.165, "sample_throughput": 2.502, "learn_time_ms": 27230.532, "learn_throughput": 146.894, "update_time_ms": 44.741}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": 0.20051675266586244, "policy_loss": -0.08623680571326986, "vf_loss": 33222.964782714844, "vf_explained_var": -3.366917371749878e-05, "kl": 0.028836956771556288, "entropy": 51.243468165397644, "entropy_coeff": 0.001}}, "num_steps_sampled": 4000, "num_steps_trained": 4000}, "done": false, "episodes_total": 4, "training_iteration": 1, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-07_18-38-56", "timestamp": 1617791936, "time_this_iter_s": 1625.9303221702576, "time_total_s": 1625.9303221702576, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 1625.9303221702576, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 13.776587473002161, "ram_util_percent": 16.82038876889849}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2712.1679343322085, "episode_reward_min": -2886.871261001328, "episode_reward_mean": -2806.192484197998, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 791.8921492729859, "mean_raw_obs_processing_ms": 2.400471003373172, "mean_inference_ms": 11.86626247941533, "mean_action_processing_ms": 0.32621001695550333}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 8000, "timers": {"sample_time_ms": 1647226.716, "sample_throughput": 2.428, "learn_time_ms": 23758.039, "learn_throughput": 168.364, "update_time_ms": 53.996}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": 0.16655205673305318, "policy_loss": -0.10595243674470112, "vf_loss": 31571.275512695312, "vf_explained_var": -9.406358003616333e-06, "kl": 0.026546521054115146, "entropy": 51.172210812568665, "entropy_coeff": 0.001}}, "num_steps_sampled": 8000, "num_steps_trained": 8000}, "done": false, "episodes_total": 8, "training_iteration": 2, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-07_19-07-32", "timestamp": 1617793652, "time_this_iter_s": 1716.1637263298035, "time_total_s": 3342.094048500061, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 3342.094048500061, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 15.651289398280802, "ram_util_percent": 17.513262382316825}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2712.1679343322085, "episode_reward_min": -2886.871261001328, "episode_reward_mean": -2813.1067615544075, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 802.29084374381, "mean_raw_obs_processing_ms": 2.426433623969339, "mean_inference_ms": 11.869201838859661, "mean_action_processing_ms": 0.33955069593469106}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 12000, "timers": {"sample_time_ms": 1683192.133, "sample_throughput": 2.376, "learn_time_ms": 26165.724, "learn_throughput": 152.872, "update_time_ms": 54.756}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": 0.1727039446705021, "policy_loss": -0.11159051739377901, "vf_loss": 32456.469970703125, "vf_explained_var": -4.563480615615845e-06, "kl": 0.02433554024901241, "entropy": 51.22122347354889, "entropy_coeff": 0.001}}, "num_steps_sampled": 12000, "num_steps_trained": 12000}, "done": false, "episodes_total": 12, "training_iteration": 3, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-07_19-37-18", "timestamp": 1617795438, "time_this_iter_s": 1786.1679458618164, "time_total_s": 5128.261994361877, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 5128.261994361877, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 21.8810853322847, "ram_util_percent": 22.074360990955565}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2712.1679343322085, "episode_reward_min": -2886.871261001328, "episode_reward_mean": -2800.421326907017, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 808.1908999507161, "mean_raw_obs_processing_ms": 2.4320198013873284, "mean_inference_ms": 11.874901241272834, "mean_action_processing_ms": 0.34228823784519513}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 16000, "timers": {"sample_time_ms": 1688195.863, "sample_throughput": 2.369, "learn_time_ms": 26493.311, "learn_throughput": 150.982, "update_time_ms": 64.097}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": 0.14489798789145425, "policy_loss": -0.12741479778196663, "vf_loss": 30761.259765625, "vf_explained_var": -2.738088369369507e-06, "kl": 0.023677057411987334, "entropy": 51.28181767463684, "entropy_coeff": 0.001}}, "num_steps_sampled": 16000, "num_steps_trained": 16000}, "done": false, "episodes_total": 16, "training_iteration": 4, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-07_20-06-09", "timestamp": 1617797169, "time_this_iter_s": 1730.7828829288483, "time_total_s": 6859.044877290726, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 6859.044877290726, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.401987829614605, "ram_util_percent": 29.77496957403651}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2712.1679343322085, "episode_reward_min": -2886.871261001328, "episode_reward_mean": -2805.8251527393354, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 811.9332414444049, "mean_raw_obs_processing_ms": 2.4350056099614994, "mean_inference_ms": 11.877681523716445, "mean_action_processing_ms": 0.3501217582899394}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 20000, "timers": {"sample_time_ms": 1691394.354, "sample_throughput": 2.365, "learn_time_ms": 26112.051, "learn_throughput": 153.186, "update_time_ms": 56.166}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 5e-05, "total_loss": 0.17223744466900826, "policy_loss": -0.11196610145270824, "vf_loss": 31341.395874023438, "vf_explained_var": -1.5497207641601562e-06, "kl": 0.02179878094466403, "entropy": 51.28166747093201, "entropy_coeff": 0.001}}, "num_steps_sampled": 20000, "num_steps_trained": 20000}, "done": false, "episodes_total": 20, "training_iteration": 5, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-07_20-34-58", "timestamp": 1617798898, "time_this_iter_s": 1728.8444290161133, "time_total_s": 8587.889306306839, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 8587.889306306839, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 21.164079642421783, "ram_util_percent": 24.321048354327512}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2712.1679343322085, "episode_reward_min": -2886.871261001328, "episode_reward_mean": -2803.490046921725, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 815.267835304967, "mean_raw_obs_processing_ms": 2.4363323272974373, "mean_inference_ms": 11.908383027723191, "mean_action_processing_ms": 0.3558200218888172}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 24000, "timers": {"sample_time_ms": 1702642.063, "sample_throughput": 2.349, "learn_time_ms": 26426.614, "learn_throughput": 151.363, "update_time_ms": 55.657}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5e-05, "total_loss": 0.16411391482688487, "policy_loss": -0.115800280647818, "vf_loss": 30105.82342529297, "vf_explained_var": -1.0281801223754883e-06, "kl": 0.01986243179999292, "entropy": 51.31009781360626, "entropy_coeff": 0.001}}, "num_steps_sampled": 24000, "num_steps_trained": 24000}, "done": false, "episodes_total": 24, "training_iteration": 6, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-07_21-04-45", "timestamp": 1617800685, "time_this_iter_s": 1786.9552216529846, "time_total_s": 10374.844527959824, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 10374.844527959824, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.452103814392448, "ram_util_percent": 28.725206449075895}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2712.1679343322085, "episode_reward_min": -2886.871261001328, "episode_reward_mean": -2802.9002787145937, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 817.4005108762046, "mean_raw_obs_processing_ms": 2.4358629823253852, "mean_inference_ms": 11.924922768233504, "mean_action_processing_ms": 0.36034763906114176}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 28000, "timers": {"sample_time_ms": 1698721.335, "sample_throughput": 2.355, "learn_time_ms": 26533.768, "learn_throughput": 150.751, "update_time_ms": 55.68}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5e-05, "total_loss": 0.17122395290061831, "policy_loss": -0.11001145903719589, "vf_loss": 30271.171020507812, "vf_explained_var": -6.631016731262207e-07, "kl": 0.019581745844334364, "entropy": 51.216065883636475, "entropy_coeff": 0.001}}, "num_steps_sampled": 28000, "num_steps_trained": 28000}, "done": false, "episodes_total": 28, "training_iteration": 7, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-07_21-33-07", "timestamp": 1617802387, "time_this_iter_s": 1702.4371557235718, "time_total_s": 12077.281683683395, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 12077.281683683395, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.307797029702968, "ram_util_percent": 29.10272277227723}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2649.450398444852, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2807.9655531670123, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 818.5961370918176, "mean_raw_obs_processing_ms": 2.4341040225617703, "mean_inference_ms": 11.936965364056586, "mean_action_processing_ms": 0.36441711142835953}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 32000, "timers": {"sample_time_ms": 1692353.326, "sample_throughput": 2.364, "learn_time_ms": 26729.045, "learn_throughput": 149.65, "update_time_ms": 54.888}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5e-05, "total_loss": 0.17624315770808607, "policy_loss": -0.10727867580135353, "vf_loss": 30406.2744140625, "vf_explained_var": -6.146728992462158e-07, "kl": 0.02026678348192945, "entropy": 51.32107973098755, "entropy_coeff": 0.001}}, "num_steps_sampled": 32000, "num_steps_trained": 32000}, "done": false, "episodes_total": 32, "training_iteration": 8, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-07_22-01-03", "timestamp": 1617804063, "time_this_iter_s": 1675.9302022457123, "time_total_s": 13753.211885929108, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 13753.211885929108, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.132606873428333, "ram_util_percent": 29.36508801341157}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2649.450398444852, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2801.728142790634, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 819.7058120985093, "mean_raw_obs_processing_ms": 2.4328313064851024, "mean_inference_ms": 11.947357882889158, "mean_action_processing_ms": 0.3672078928924589}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 36000, "timers": {"sample_time_ms": 1695885.438, "sample_throughput": 2.359, "learn_time_ms": 26627.687, "learn_throughput": 150.22, "update_time_ms": 55.305}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.278125, "cur_lr": 5e-05, "total_loss": 0.15484762331470847, "policy_loss": -0.10955325301620178, "vf_loss": 27371.096557617188, "vf_explained_var": -3.7997961044311523e-07, "kl": 0.01844682276714593, "entropy": 51.334237456321716, "entropy_coeff": 0.001}}, "num_steps_sampled": 36000, "num_steps_trained": 36000}, "done": false, "episodes_total": 36, "training_iteration": 9, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-07_22-30-13", "timestamp": 1617805813, "time_this_iter_s": 1750.0255208015442, "time_total_s": 15503.237406730652, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 15503.237406730652, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.240008025682183, "ram_util_percent": 31.224719101123597}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2632.8398619786367, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2790.4635778613383, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 820.2420968355727, "mean_raw_obs_processing_ms": 2.4327533837021145, "mean_inference_ms": 11.951647275224833, "mean_action_processing_ms": 0.3687966678126933}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 40000, "timers": {"sample_time_ms": 1688540.93, "sample_throughput": 2.369, "learn_time_ms": 26839.971, "learn_throughput": 149.031, "update_time_ms": 54.977}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.278125, "cur_lr": 5e-05, "total_loss": 0.13799546542577446, "policy_loss": -0.10865463517257012, "vf_loss": 26009.636840820312, "vf_explained_var": -3.166496753692627e-07, "kl": 0.016656260879244655, "entropy": 51.3913037776947, "entropy_coeff": 0.001}}, "num_steps_sampled": 40000, "num_steps_trained": 40000}, "done": false, "episodes_total": 40, "training_iteration": 10, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-07_22-57-45", "timestamp": 1617807465, "time_this_iter_s": 1651.2506005764008, "time_total_s": 17154.488007307053, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 17154.488007307053, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.178562313908973, "ram_util_percent": 30.724372607401104}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2632.8398619786367, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2788.069025286038, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 820.6777736544645, "mean_raw_obs_processing_ms": 2.430766633795002, "mean_inference_ms": 11.957388654070717, "mean_action_processing_ms": 0.3698511484066182}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 44000, "timers": {"sample_time_ms": 1697608.882, "sample_throughput": 2.356, "learn_time_ms": 26845.807, "learn_throughput": 148.999, "update_time_ms": 53.365}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.278125, "cur_lr": 5e-05, "total_loss": 0.1322268807562068, "policy_loss": -0.12855540451710112, "vf_loss": 26981.283752441406, "vf_explained_var": -2.980232238769531e-07, "kl": 0.01858314761193469, "entropy": 51.365278005599976, "entropy_coeff": 0.001}}, "num_steps_sampled": 44000, "num_steps_trained": 44000}, "done": false, "episodes_total": 44, "training_iteration": 11, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-07_23-26-21", "timestamp": 1617809181, "time_this_iter_s": 1716.6509642601013, "time_total_s": 18871.138971567154, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 18871.138971567154, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 19.139198036006544, "ram_util_percent": 26.959328968903435}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2632.8398619786367, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2787.6758818697363, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 820.8929272591237, "mean_raw_obs_processing_ms": 2.4284231057517576, "mean_inference_ms": 11.963428530651152, "mean_action_processing_ms": 0.37096812321131}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 48000, "timers": {"sample_time_ms": 1692486.368, "sample_throughput": 2.363, "learn_time_ms": 26844.039, "learn_throughput": 149.009, "update_time_ms": 50.351}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.278125, "cur_lr": 5e-05, "total_loss": 0.15178537723841146, "policy_loss": -0.11051688311272301, "vf_loss": 27343.052612304688, "vf_explained_var": -2.1606683731079102e-07, "kl": 0.017632282280828804, "entropy": 51.296802282333374, "entropy_coeff": 0.001}}, "num_steps_sampled": 48000, "num_steps_trained": 48000}, "done": false, "episodes_total": 48, "training_iteration": 12, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-07_23-54-06", "timestamp": 1617810846, "time_this_iter_s": 1664.8922317028046, "time_total_s": 20536.03120326996, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 20536.03120326996, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 15.482194092827006, "ram_util_percent": 25.1275105485232}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2632.8398619786367, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2779.1369236809746, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 821.0465753604633, "mean_raw_obs_processing_ms": 2.42540550040841, "mean_inference_ms": 11.96689634618187, "mean_action_processing_ms": 0.371913576555797}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 52000, "timers": {"sample_time_ms": 1684087.789, "sample_throughput": 2.375, "learn_time_ms": 26396.05, "learn_throughput": 151.538, "update_time_ms": 51.674}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.278125, "cur_lr": 5e-05, "total_loss": 0.11899928300408646, "policy_loss": -0.10988366563105956, "vf_loss": 24003.248779296875, "vf_explained_var": -1.862645149230957e-07, "kl": 0.017658999131526798, "entropy": 51.3789381980896, "entropy_coeff": 0.001}}, "num_steps_sampled": 52000, "num_steps_trained": 52000}, "done": false, "episodes_total": 52, "training_iteration": 13, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_00-22-24", "timestamp": 1617812544, "time_this_iter_s": 1697.7157428264618, "time_total_s": 22233.74694609642, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 22233.74694609642, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 15.483160943318161, "ram_util_percent": 25.124575920562677}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2632.8398619786367, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2779.8036421961724, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 820.978105533161, "mean_raw_obs_processing_ms": 2.422420815214834, "mean_inference_ms": 11.967941752269033, "mean_action_processing_ms": 0.37258125320459295}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 56000, "timers": {"sample_time_ms": 1673866.968, "sample_throughput": 2.39, "learn_time_ms": 26395.71, "learn_throughput": 151.54, "update_time_ms": 47.301}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.278125, "cur_lr": 5e-05, "total_loss": 0.143081349786371, "policy_loss": -0.11212465591961518, "vf_loss": 26368.1640625, "vf_explained_var": -1.4156103134155273e-07, "kl": 0.018772317678667605, "entropy": 51.24131512641907, "entropy_coeff": 0.001}}, "num_steps_sampled": 56000, "num_steps_trained": 56000}, "done": false, "episodes_total": 56, "training_iteration": 14, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_00-49-32", "timestamp": 1617814172, "time_this_iter_s": 1628.5361273288727, "time_total_s": 23862.283073425293, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 23862.283073425293, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 15.515480810694262, "ram_util_percent": 25.16601983613626}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2632.8398619786367, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2777.3242027557085, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 820.858764790739, "mean_raw_obs_processing_ms": 2.4197201770223304, "mean_inference_ms": 11.96893622548685, "mean_action_processing_ms": 0.37295923766531897}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 60000, "timers": {"sample_time_ms": 1668186.703, "sample_throughput": 2.398, "learn_time_ms": 26702.912, "learn_throughput": 149.796, "update_time_ms": 50.585}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.278125, "cur_lr": 5e-05, "total_loss": 0.12179680482950062, "policy_loss": -0.11745937983505428, "vf_loss": 24895.84832763672, "vf_explained_var": -1.4156103134155273e-07, "kl": 0.018232323694974184, "entropy": 51.23780119419098, "entropy_coeff": 0.001}}, "num_steps_sampled": 60000, "num_steps_trained": 60000}, "done": false, "episodes_total": 60, "training_iteration": 15, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_01-17-28", "timestamp": 1617815848, "time_this_iter_s": 1675.109793663025, "time_total_s": 25537.392867088318, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 25537.392867088318, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 15.540041928721173, "ram_util_percent": 25.21236897274633}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2775.0626190515395, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 820.8226703743197, "mean_raw_obs_processing_ms": 2.417101831644583, "mean_inference_ms": 11.970613179975429, "mean_action_processing_ms": 0.37325004531097306}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 64000, "timers": {"sample_time_ms": 1663600.739, "sample_throughput": 2.404, "learn_time_ms": 26635.748, "learn_throughput": 150.174, "update_time_ms": 49.774}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.278125, "cur_lr": 5e-05, "total_loss": 0.12461720692226663, "policy_loss": -0.1133975975390058, "vf_loss": 24693.848693847656, "vf_explained_var": -1.1920928955078125e-07, "kl": 0.018535619543399662, "entropy": 51.1501339673996, "entropy_coeff": 0.001}}, "num_steps_sampled": 64000, "num_steps_trained": 64000}, "done": false, "episodes_total": 64, "training_iteration": 16, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_01-46-28", "timestamp": 1617817588, "time_this_iter_s": 1740.4014320373535, "time_total_s": 27277.79429912567, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 27277.79429912567, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 15.47993540573274, "ram_util_percent": 25.230763019781993}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2776.0216036668103, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 820.6580318816872, "mean_raw_obs_processing_ms": 2.414481329664548, "mean_inference_ms": 11.971203013425855, "mean_action_processing_ms": 0.3731760138180971}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 68000, "timers": {"sample_time_ms": 1656252.129, "sample_throughput": 2.415, "learn_time_ms": 26695.85, "learn_throughput": 149.836, "update_time_ms": 51.962}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.278125, "cur_lr": 5e-05, "total_loss": 0.11541398607369047, "policy_loss": -0.12371977244038135, "vf_loss": 24787.93099975586, "vf_explained_var": -1.1920928955078125e-07, "kl": 0.01854286261368543, "entropy": 50.988511085510254, "entropy_coeff": 0.001}}, "num_steps_sampled": 68000, "num_steps_trained": 68000}, "done": false, "episodes_total": 68, "training_iteration": 17, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_02-13-38", "timestamp": 1617819218, "time_this_iter_s": 1629.588526725769, "time_total_s": 28907.38282585144, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 28907.38282585144, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 15.518275862068966, "ram_util_percent": 25.284267241379315}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2778.6924488485656, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 820.4211251530486, "mean_raw_obs_processing_ms": 2.4118686938095792, "mean_inference_ms": 11.970880006987459, "mean_action_processing_ms": 0.3731937514019326}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 72000, "timers": {"sample_time_ms": 1653419.01, "sample_throughput": 2.419, "learn_time_ms": 26660.748, "learn_throughput": 150.033, "update_time_ms": 51.037}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.278125, "cur_lr": 5e-05, "total_loss": 0.14411841408582404, "policy_loss": -0.10100125550525263, "vf_loss": 25270.956787109375, "vf_explained_var": -8.568167686462402e-08, "kl": 0.018989926611538976, "entropy": 50.85131061077118, "entropy_coeff": 0.001}}, "num_steps_sampled": 72000, "num_steps_trained": 72000}, "done": false, "episodes_total": 72, "training_iteration": 18, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_02-41-05", "timestamp": 1617820865, "time_this_iter_s": 1647.2389872074127, "time_total_s": 30554.621813058853, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 30554.621813058853, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 15.535650319829427, "ram_util_percent": 25.20012793176972}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2778.855446969126, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 820.2562927819381, "mean_raw_obs_processing_ms": 2.40915754568913, "mean_inference_ms": 11.969976551617973, "mean_action_processing_ms": 0.3732465230837743}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 76000, "timers": {"sample_time_ms": 1651400.289, "sample_throughput": 2.422, "learn_time_ms": 25478.319, "learn_throughput": 156.996, "update_time_ms": 48.188}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.278125, "cur_lr": 5e-05, "total_loss": 0.12904395099030808, "policy_loss": -0.1074798702611588, "vf_loss": 24375.008666992188, "vf_explained_var": -6.705522537231445e-08, "kl": 0.019166850077454, "entropy": 50.89073944091797, "entropy_coeff": 0.001}}, "num_steps_sampled": 76000, "num_steps_trained": 76000}, "done": false, "episodes_total": 76, "training_iteration": 19, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_03-09-43", "timestamp": 1617822583, "time_this_iter_s": 1717.985720872879, "time_total_s": 32272.607533931732, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 32272.607533931732, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 15.53563547200654, "ram_util_percent": 25.18128320392317}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2776.587431498295, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 820.0854525834648, "mean_raw_obs_processing_ms": 2.4070713044578387, "mean_inference_ms": 11.967725491578506, "mean_action_processing_ms": 0.3733746132732839}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 80000, "timers": {"sample_time_ms": 1654483.948, "sample_throughput": 2.418, "learn_time_ms": 25354.875, "learn_throughput": 157.761, "update_time_ms": 47.333}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.278125, "cur_lr": 5e-05, "total_loss": 0.10507515288190916, "policy_loss": -0.11721040974953212, "vf_loss": 22859.447143554688, "vf_explained_var": -5.960464477539063e-08, "kl": 0.01957330940058455, "entropy": 50.89934754371643, "entropy_coeff": 0.001}}, "num_steps_sampled": 80000, "num_steps_trained": 80000}, "done": false, "episodes_total": 80, "training_iteration": 20, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_03-37-44", "timestamp": 1617824264, "time_this_iter_s": 1680.844211101532, "time_total_s": 33953.451745033264, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 33953.451745033264, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 15.523777684914334, "ram_util_percent": 25.193731717509397}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2773.4553863210313, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 819.8443727317111, "mean_raw_obs_processing_ms": 2.4047505737711092, "mean_inference_ms": 11.964324106437372, "mean_action_processing_ms": 0.37342054190453167}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 84000, "timers": {"sample_time_ms": 1644914.051, "sample_throughput": 2.432, "learn_time_ms": 25367.448, "learn_throughput": 157.682, "update_time_ms": 49.38}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.278125, "cur_lr": 5e-05, "total_loss": 0.11944054858759046, "policy_loss": -0.09771768242353573, "vf_loss": 22341.194274902344, "vf_explained_var": -5.960464477539063e-08, "kl": 0.019560122629627585, "entropy": 50.814106702804565, "entropy_coeff": 0.001}}, "num_steps_sampled": 84000, "num_steps_trained": 84000}, "done": false, "episodes_total": 84, "training_iteration": 21, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_04-04-45", "timestamp": 1617825885, "time_this_iter_s": 1621.1130440235138, "time_total_s": 35574.56478905678, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 35574.56478905678, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 15.531239168110922, "ram_util_percent": 25.24488734835355}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2771.584195143323, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 819.5717290431268, "mean_raw_obs_processing_ms": 2.402592723573315, "mean_inference_ms": 11.95992658218766, "mean_action_processing_ms": 0.3736629985490719}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 88000, "timers": {"sample_time_ms": 1642056.6, "sample_throughput": 2.436, "learn_time_ms": 25580.222, "learn_throughput": 156.371, "update_time_ms": 57.383}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.278125, "cur_lr": 5e-05, "total_loss": 0.10559639243001584, "policy_loss": -0.10561010072706267, "vf_loss": 21841.34716796875, "vf_explained_var": -4.470348358154297e-08, "kl": 0.019252213940490037, "entropy": 51.06592333316803, "entropy_coeff": 0.001}}, "num_steps_sampled": 88000, "num_steps_trained": 88000}, "done": false, "episodes_total": 88, "training_iteration": 22, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_04-32-04", "timestamp": 1617827524, "time_this_iter_s": 1638.5242004394531, "time_total_s": 37213.08898949623, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 37213.08898949623, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 15.50921560222889, "ram_util_percent": 25.253107586798112}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2770.379462024353, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 819.3743753366714, "mean_raw_obs_processing_ms": 2.4007478534100852, "mean_inference_ms": 11.956882229224112, "mean_action_processing_ms": 0.37397892505474534}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 92000, "timers": {"sample_time_ms": 1647346.537, "sample_throughput": 2.428, "learn_time_ms": 25013.211, "learn_throughput": 159.915, "update_time_ms": 55.198}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.278125, "cur_lr": 5e-05, "total_loss": 0.10881261347094551, "policy_loss": -0.10335884799133055, "vf_loss": 21908.693420410156, "vf_explained_var": -5.029141902923584e-08, "kl": 0.01931653084466234, "entropy": 50.92094004154205, "entropy_coeff": 0.001}}, "num_steps_sampled": 92000, "num_steps_trained": 92000}, "done": false, "episodes_total": 92, "training_iteration": 23, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_05-01-09", "timestamp": 1617829269, "time_this_iter_s": 1744.9235045909882, "time_total_s": 38958.01249408722, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 38958.01249408722, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 15.502858293075686, "ram_util_percent": 25.234138486312396}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2771.2901177417903, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 819.1635107804301, "mean_raw_obs_processing_ms": 2.3989782663411163, "mean_inference_ms": 11.953764523401402, "mean_action_processing_ms": 0.3743567779221418}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 96000, "timers": {"sample_time_ms": 1650486.719, "sample_throughput": 2.424, "learn_time_ms": 24800.965, "learn_throughput": 161.284, "update_time_ms": 53.525}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.278125, "cur_lr": 5e-05, "total_loss": 0.11703282152302563, "policy_loss": -0.10488172812620178, "vf_loss": 22969.979370117188, "vf_explained_var": -3.725290298461914e-08, "kl": 0.018853305897209793, "entropy": 50.73542511463165, "entropy_coeff": 0.001}}, "num_steps_sampled": 96000, "num_steps_trained": 96000}, "done": false, "episodes_total": 96, "training_iteration": 24, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_05-28-46", "timestamp": 1617830926, "time_this_iter_s": 1657.800711631775, "time_total_s": 40615.813205718994, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 40615.813205718994, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 15.541168996188055, "ram_util_percent": 25.305040237187637}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2769.098889657351, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2838.859125981964, -2886.871261001328, -2864.389032387739, -2754.6227606832485, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 818.9183293652201, "mean_raw_obs_processing_ms": 2.3972580025580834, "mean_inference_ms": 11.951080802032266, "mean_action_processing_ms": 0.3746241717481108}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 100000, "timers": {"sample_time_ms": 1646307.972, "sample_throughput": 2.43, "learn_time_ms": 24806.821, "learn_throughput": 161.246, "update_time_ms": 57.32}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.278125, "cur_lr": 5e-05, "total_loss": 0.08676577010191977, "policy_loss": -0.11513680723146535, "vf_loss": 20598.893005371094, "vf_explained_var": -5.587935447692871e-09, "kl": 0.02043953980319202, "entropy": 50.6501704454422, "entropy_coeff": 0.001}}, "num_steps_sampled": 100000, "num_steps_trained": 100000}, "done": false, "episodes_total": 100, "training_iteration": 25, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_05-56-00", "timestamp": 1617832560, "time_this_iter_s": 1633.418973684311, "time_total_s": 42249.232179403305, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 42249.232179403305, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 15.543612903225807, "ram_util_percent": 25.31187096774194}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2766.873188636544, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2793.319957583595, -2792.325598173369, -2806.984203440533, -2712.1679343322085, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 820.3013129520709, "mean_raw_obs_processing_ms": 2.396325945326015, "mean_inference_ms": 11.95584415241358, "mean_action_processing_ms": 0.37776096238927326}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 104000, "timers": {"sample_time_ms": 1645590.491, "sample_throughput": 2.431, "learn_time_ms": 24078.243, "learn_throughput": 166.125, "update_time_ms": 55.922}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.11549219471635297, "policy_loss": -0.10566719231428578, "vf_loss": 21429.41827392578, "vf_explained_var": -2.60770320892334e-08, "kl": 0.016809717228170484, "entropy": 50.576741218566895, "entropy_coeff": 0.001}}, "num_steps_sampled": 104000, "num_steps_trained": 104000}, "done": false, "episodes_total": 104, "training_iteration": 26, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_06-24-46", "timestamp": 1617834286, "time_this_iter_s": 1725.9270639419556, "time_total_s": 43975.15924334526, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 43975.15924334526, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 15.744932844932846, "ram_util_percent": 25.311680911680916}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2764.3768877385005, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2845.4326319180436, -2871.655685299982, -2810.591705794745, -2780.0612420561392, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 820.6367781787411, "mean_raw_obs_processing_ms": 2.393594527740654, "mean_inference_ms": 11.953635681014749, "mean_action_processing_ms": 0.3790246991109833}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 108000, "timers": {"sample_time_ms": 1646931.44, "sample_throughput": 2.429, "learn_time_ms": 23980.353, "learn_throughput": 166.803, "update_time_ms": 52.826}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.08458308968693018, "policy_loss": -0.11487649072660133, "vf_loss": 19476.233032226562, "vf_explained_var": -2.7939677238464355e-08, "kl": 0.016201093938434497, "entropy": 50.66491520404816, "entropy_coeff": 0.001}}, "num_steps_sampled": 108000, "num_steps_trained": 108000}, "done": false, "episodes_total": 108, "training_iteration": 27, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_06-52-08", "timestamp": 1617835928, "time_this_iter_s": 1641.9775257110596, "time_total_s": 45617.13676905632, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 45617.13676905632, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 15.547647562018817, "ram_util_percent": 25.335457656116343}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2763.0613069772385, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2759.1212939123743, -2756.568853104422, -2760.3161961622477, -2773.453748680339, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 820.213403490248, "mean_raw_obs_processing_ms": 2.3884924424250293, "mean_inference_ms": 11.953756331487488, "mean_action_processing_ms": 0.37971850574570015}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 112000, "timers": {"sample_time_ms": 1648862.715, "sample_throughput": 2.426, "learn_time_ms": 23963.567, "learn_throughput": 166.92, "update_time_ms": 52.412}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.1091932138078846, "policy_loss": -0.11001584120094776, "vf_loss": 21173.812561035156, "vf_explained_var": -1.6763806343078613e-08, "kl": 0.016978993255179375, "entropy": 50.5494589805603, "entropy_coeff": 0.001}}, "num_steps_sampled": 112000, "num_steps_trained": 112000}, "done": false, "episodes_total": 112, "training_iteration": 28, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_07-19-54", "timestamp": 1617837594, "time_this_iter_s": 1666.3798851966858, "time_total_s": 47283.516654253006, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 47283.516654253006, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 15.552908937605396, "ram_util_percent": 25.37213322091063}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2762.071467042146, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2834.631843326772, -2870.17661241964, -2870.7108534976755, -2734.2425150303493, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 819.6596414987772, "mean_raw_obs_processing_ms": 2.3845915937631426, "mean_inference_ms": 11.953455320602353, "mean_action_processing_ms": 0.381118116780584}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 116000, "timers": {"sample_time_ms": 1641796.992, "sample_throughput": 2.436, "learn_time_ms": 24601.971, "learn_throughput": 162.589, "update_time_ms": 54.595}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.105078125721775, "policy_loss": -0.0950751792115625, "vf_loss": 19440.956512451172, "vf_explained_var": -2.9802322387695312e-08, "kl": 0.01648496836423874, "entropy": 50.588481187820435, "entropy_coeff": 0.001}}, "num_steps_sampled": 116000, "num_steps_trained": 116000}, "done": false, "episodes_total": 116, "training_iteration": 29, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_07-47-28", "timestamp": 1617839248, "time_this_iter_s": 1653.7490508556366, "time_total_s": 48937.26570510864, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 48937.26570510864, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 15.526666666666667, "ram_util_percent": 25.424840764331215}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2759.213565230792, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2857.9050072677273, -2730.1762389519536, -2762.8703169058085, -2816.3065082091985, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 819.0763334411275, "mean_raw_obs_processing_ms": 2.3809018114040748, "mean_inference_ms": 11.953160469486809, "mean_action_processing_ms": 0.38130688213399305}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 120000, "timers": {"sample_time_ms": 1643804.397, "sample_throughput": 2.433, "learn_time_ms": 24597.881, "learn_throughput": 162.616, "update_time_ms": 55.824}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.10831391901592724, "policy_loss": -0.09627489390550181, "vf_loss": 19725.502014160156, "vf_explained_var": -1.862645149230957e-08, "kl": 0.01702986567397602, "entropy": 50.860445976257324, "entropy_coeff": 0.001}}, "num_steps_sampled": 120000, "num_steps_trained": 120000}, "done": false, "episodes_total": 120, "training_iteration": 30, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_08-15-49", "timestamp": 1617840949, "time_this_iter_s": 1700.8897829055786, "time_total_s": 50638.15548801422, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 50638.15548801422, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 15.495249896736885, "ram_util_percent": 25.45729037587774}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2757.822429689942, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2803.5490854675127, -2784.7475663312703, -2813.3524574091048, -2795.7975686793225, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 818.2506228001055, "mean_raw_obs_processing_ms": 2.3772730279877305, "mean_inference_ms": 11.945334199513013, "mean_action_processing_ms": 0.3813759080436991}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 124000, "timers": {"sample_time_ms": 1643831.173, "sample_throughput": 2.433, "learn_time_ms": 24599.982, "learn_throughput": 162.602, "update_time_ms": 58.661}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.09561192861292511, "policy_loss": -0.10383343853754923, "vf_loss": 19351.894561767578, "vf_explained_var": -1.1175870895385742e-08, "kl": 0.016556383547140285, "entropy": 50.64984047412872, "entropy_coeff": 0.001}}, "num_steps_sampled": 124000, "num_steps_trained": 124000}, "done": false, "episodes_total": 124, "training_iteration": 31, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_08-42-50", "timestamp": 1617842570, "time_this_iter_s": 1621.4361124038696, "time_total_s": 52259.59160041809, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 52259.59160041809, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 15.52620181896925, "ram_util_percent": 25.48609787786921}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -3014.374842003657, "episode_reward_mean": -2756.6105502440373, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2649.450398444852, -3014.374842003657, -2881.8169654795133, -2828.047691407748, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 817.4848560700522, "mean_raw_obs_processing_ms": 2.374072241987817, "mean_inference_ms": 11.939418846737954, "mean_action_processing_ms": 0.381243388568408}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 128000, "timers": {"sample_time_ms": 1646586.237, "sample_throughput": 2.429, "learn_time_ms": 25152.758, "learn_throughput": 159.028, "update_time_ms": 51.615}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.09218724348465912, "policy_loss": -0.1040960286045447, "vf_loss": 19042.050903320312, "vf_explained_var": -2.0489096641540527e-08, "kl": 0.01653329803957604, "entropy": 50.63460981845856, "entropy_coeff": 0.001}}, "num_steps_sampled": 128000, "num_steps_trained": 128000}, "done": false, "episodes_total": 128, "training_iteration": 32, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_09-10-42", "timestamp": 1617844242, "time_this_iter_s": 1671.5321261882782, "time_total_s": 53931.12372660637, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 53931.12372660637, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 15.768852459016394, "ram_util_percent": 25.507776376628836}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -2946.100733671897, "episode_reward_mean": -2754.209163789165, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2715.016576742015, -2780.249406957759, -2701.768156043252, -2810.281299375422, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 816.8784616285778, "mean_raw_obs_processing_ms": 2.3713638617325854, "mean_inference_ms": 11.934086762552162, "mean_action_processing_ms": 0.3809894884214959}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 132000, "timers": {"sample_time_ms": 1645557.64, "sample_throughput": 2.431, "learn_time_ms": 25818.126, "learn_throughput": 154.93, "update_time_ms": 51.041}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.10270017944276333, "policy_loss": -0.09582254974520765, "vf_loss": 19269.832153320312, "vf_explained_var": -2.9802322387695312e-08, "kl": 0.016470102913444862, "entropy": 50.457008957862854, "entropy_coeff": 0.001}}, "num_steps_sampled": 132000, "num_steps_trained": 132000}, "done": false, "episodes_total": 132, "training_iteration": 33, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_09-39-43", "timestamp": 1617845983, "time_this_iter_s": 1741.2851214408875, "time_total_s": 55672.40884804726, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 55672.40884804726, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 15.55014118596208, "ram_util_percent": 25.464542154094396}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -2946.100733671897, "episode_reward_mean": -2755.565257951989, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2643.057156564834, -2677.726970205045, -2632.8398619786367, -2802.7059852421776, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 816.1756054640666, "mean_raw_obs_processing_ms": 2.3685765013620936, "mean_inference_ms": 11.927924628205078, "mean_action_processing_ms": 0.38083429920606704}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 136000, "timers": {"sample_time_ms": 1642809.128, "sample_throughput": 2.435, "learn_time_ms": 26033.033, "learn_throughput": 153.651, "update_time_ms": 51.801}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.08561913642915897, "policy_loss": -0.10904426076740492, "vf_loss": 18755.273010253906, "vf_explained_var": -1.30385160446167e-08, "kl": 0.016832065652124584, "entropy": 50.407652139663696, "entropy_coeff": 0.001}}, "num_steps_sampled": 136000, "num_steps_trained": 136000}, "done": false, "episodes_total": 136, "training_iteration": 34, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_10-06-56", "timestamp": 1617847616, "time_this_iter_s": 1632.4619920253754, "time_total_s": 57304.87084007263, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 57304.87084007263, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 15.574655765920825, "ram_util_percent": 25.381497418244408}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -2946.100733671897, "episode_reward_mean": -2758.653000533028, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2853.5813992889553, -2787.639729829585, -2728.238801384811, -2687.0340676288115, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 815.5885245262851, "mean_raw_obs_processing_ms": 2.3654416788741766, "mean_inference_ms": 11.92290821062165, "mean_action_processing_ms": 0.3809473078345234}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 140000, "timers": {"sample_time_ms": 1643435.145, "sample_throughput": 2.434, "learn_time_ms": 26085.942, "learn_throughput": 153.339, "update_time_ms": 45.408}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.0853316291468218, "policy_loss": -0.09976733828079887, "vf_loss": 17965.920166015625, "vf_explained_var": -1.862645149230957e-08, "kl": 0.016436098841950297, "entropy": 50.72546076774597, "entropy_coeff": 0.001}}, "num_steps_sampled": 140000, "num_steps_trained": 140000}, "done": false, "episodes_total": 140, "training_iteration": 35, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_10-34-16", "timestamp": 1617849256, "time_this_iter_s": 1640.1440217494965, "time_total_s": 58945.01486182213, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 58945.01486182213, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 16.219948630136987, "ram_util_percent": 25.41819349315069}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -2946.100733671897, "episode_reward_mean": -2759.2890555363347, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2872.292922998992, -2800.00822213007, -2698.484882778185, -2762.6191892544093, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 815.0958474378187, "mean_raw_obs_processing_ms": 2.36319432884811, "mean_inference_ms": 11.917088665568263, "mean_action_processing_ms": 0.38124040700233286}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 144000, "timers": {"sample_time_ms": 1655698.323, "sample_throughput": 2.416, "learn_time_ms": 26141.396, "learn_throughput": 153.014, "update_time_ms": 47.08}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.08868248632643372, "policy_loss": -0.09959289789549075, "vf_loss": 18345.490753173828, "vf_explained_var": -7.450580596923828e-09, "kl": 0.016233689908403903, "entropy": 50.653079986572266, "entropy_coeff": 0.001}}, "num_steps_sampled": 144000, "num_steps_trained": 144000}, "done": false, "episodes_total": 144, "training_iteration": 36, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_11-05-05", "timestamp": 1617851105, "time_this_iter_s": 1849.129903793335, "time_total_s": 60794.14476561546, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 60794.14476561546, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 26.098784194528875, "ram_util_percent": 31.020782674772036}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2621.8775769169047, "episode_reward_min": -2946.100733671897, "episode_reward_mean": -2758.810433741266, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2664.4315938279406, -2655.6174690675507, -2670.0131389926573, -2716.6154997751946, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 814.7154209872466, "mean_raw_obs_processing_ms": 2.3613408725464042, "mean_inference_ms": 11.910382690616416, "mean_action_processing_ms": 0.38138667866533493}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 148000, "timers": {"sample_time_ms": 1667897.15, "sample_throughput": 2.398, "learn_time_ms": 26292.149, "learn_throughput": 152.137, "update_time_ms": 46.279}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.08100472064688802, "policy_loss": -0.10273387160850689, "vf_loss": 17715.453125, "vf_explained_var": -1.6763806343078613e-08, "kl": 0.01678044130676426, "entropy": 50.75784504413605, "entropy_coeff": 0.001}}, "num_steps_sampled": 148000, "num_steps_trained": 148000}, "done": false, "episodes_total": 148, "training_iteration": 37, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_11-34-31", "timestamp": 1617852871, "time_this_iter_s": 1765.461797952652, "time_total_s": 62559.606563568115, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 62559.606563568115, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 27.896260938743044, "ram_util_percent": 29.13464598249801}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2615.165649537959, "episode_reward_min": -2946.100733671897, "episode_reward_mean": -2758.151480022439, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2658.687427056183, -2852.293050859693, -2826.691968550782, -2816.211485108305, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 814.4404076013088, "mean_raw_obs_processing_ms": 2.359959051327163, "mean_inference_ms": 11.903419093900508, "mean_action_processing_ms": 0.38161610937918605}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 152000, "timers": {"sample_time_ms": 1687278.851, "sample_throughput": 2.371, "learn_time_ms": 26624.937, "learn_throughput": 150.235, "update_time_ms": 47.308}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.06463701440952718, "policy_loss": -0.096088288424653, "vf_loss": 15524.048248291016, "vf_explained_var": -9.313225746154785e-09, "kl": 0.016508841334143654, "entropy": 50.928980112075806, "entropy_coeff": 0.001}}, "num_steps_sampled": 152000, "num_steps_trained": 152000}, "done": false, "episodes_total": 152, "training_iteration": 38, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_12-05-34", "timestamp": 1617854734, "time_this_iter_s": 1863.5601370334625, "time_total_s": 64423.16670060158, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 64423.16670060158, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 33.552431209951, "ram_util_percent": 37.81850735016962}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2615.165649537959, "episode_reward_min": -2946.100733671897, "episode_reward_mean": -2756.898793347222, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695, -2834.9208531952418, -2701.484593167758, -2738.5739893655805, -2695.4687666282884, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 814.3523482380085, "mean_raw_obs_processing_ms": 2.358892932221622, "mean_inference_ms": 11.897138727720899, "mean_action_processing_ms": 0.38184419444545653}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 156000, "timers": {"sample_time_ms": 1705436.703, "sample_throughput": 2.345, "learn_time_ms": 26942.912, "learn_throughput": 148.462, "update_time_ms": 47.056}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.07528310138150118, "policy_loss": -0.09910900998511352, "vf_loss": 16919.341217041016, "vf_explained_var": -1.862645149230957e-08, "kl": 0.016390527365729213, "entropy": 50.810800671577454, "entropy_coeff": 0.001}}, "num_steps_sampled": 156000, "num_steps_trained": 156000}, "done": false, "episodes_total": 156, "training_iteration": 39, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_12-36-13", "timestamp": 1617856573, "time_this_iter_s": 1838.4902455806732, "time_total_s": 66261.65694618225, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 66261.65694618225, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 34.25595874713522, "ram_util_percent": 37.584186401833456}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2615.165649537959, "episode_reward_min": -2946.100733671897, "episode_reward_mean": -2759.116068388473, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2754.0004053961557, -2750.1499133460106, -2817.843388153855, -2870.1819995860183, -2855.4310565760184, -2762.496053627218, -2724.750766835865, -2621.8775769169047, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 814.4647937403736, "mean_raw_obs_processing_ms": 2.3580542769134314, "mean_inference_ms": 11.891136030672282, "mean_action_processing_ms": 0.38244493448171984}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 160000, "timers": {"sample_time_ms": 1739272.199, "sample_throughput": 2.3, "learn_time_ms": 27264.175, "learn_throughput": 146.713, "update_time_ms": 48.819}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.06742099346593022, "policy_loss": -0.10435003810562193, "vf_loss": 16745.45883178711, "vf_explained_var": 1.1175870895385742e-08, "kl": 0.016085397044662386, "entropy": 50.650365591049194, "entropy_coeff": 0.001}}, "num_steps_sampled": 160000, "num_steps_trained": 160000}, "done": false, "episodes_total": 160, "training_iteration": 40, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_13-10-15", "timestamp": 1617858615, "time_this_iter_s": 2042.4791061878204, "time_total_s": 68304.13605237007, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 68304.13605237007, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 34.11565187478501, "ram_util_percent": 37.582352941176474}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2615.165649537959, "episode_reward_min": -2946.100733671897, "episode_reward_mean": -2758.19653511897, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2630.4522048469357, -2709.2772659516886, -2745.687715628178, -2787.184940578898, -2855.2706026147803, -2754.805118427789, -2796.140464240544, -2759.2452447614546, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695, -2754.0004053961557, -2750.1499133460106, -2817.843388153855, -2870.1819995860183], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 814.598304760016, "mean_raw_obs_processing_ms": 2.357625166307337, "mean_inference_ms": 11.88454495175984, "mean_action_processing_ms": 0.38307167954581195}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 164000, "timers": {"sample_time_ms": 1761395.461, "sample_throughput": 2.271, "learn_time_ms": 27561.451, "learn_throughput": 145.13, "update_time_ms": 46.002}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.05858565215021372, "policy_loss": -0.09922203188762069, "vf_loss": 15409.1298828125, "vf_explained_var": 3.725290298461914e-09, "kl": 0.015944454877171665, "entropy": 50.768808245658875, "entropy_coeff": 0.001}}, "num_steps_sampled": 164000, "num_steps_trained": 164000}, "done": false, "episodes_total": 164, "training_iteration": 41, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_13-41-01", "timestamp": 1617860461, "time_this_iter_s": 1845.5932879447937, "time_total_s": 70149.72934031487, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 70149.72934031487, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 34.05224505327245, "ram_util_percent": 37.71754185692542}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2615.165649537959, "episode_reward_min": -2946.100733671897, "episode_reward_mean": -2755.9239910234173, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2710.7943456195203, -2735.513990032595, -2776.268911218865, -2715.6297736182446, -2730.9103366314703, -2776.54264486414, -2946.100733671897, -2842.833552586154, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695, -2754.0004053961557, -2750.1499133460106, -2817.843388153855, -2870.1819995860183, -2630.4522048469357, -2709.2772659516886, -2745.687715628178, -2787.184940578898], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 814.881169030444, "mean_raw_obs_processing_ms": 2.3574401246533006, "mean_inference_ms": 11.878041322882991, "mean_action_processing_ms": 0.38399063980333364}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 168000, "timers": {"sample_time_ms": 1777786.305, "sample_throughput": 2.25, "learn_time_ms": 27743.492, "learn_throughput": 144.178, "update_time_ms": 47.268}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.059937202458968386, "policy_loss": -0.10005122428992763, "vf_loss": 15540.79052734375, "vf_explained_var": -1.30385160446167e-08, "kl": 0.016175901633687317, "entropy": 50.69555866718292, "entropy_coeff": 0.001}}, "num_steps_sampled": 168000, "num_steps_trained": 168000}, "done": false, "episodes_total": 168, "training_iteration": 42, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_14-11-38", "timestamp": 1617862298, "time_this_iter_s": 1837.2737169265747, "time_total_s": 71987.00305724144, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 71987.00305724144, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 33.4592125382263, "ram_util_percent": 37.90431957186545}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2615.165649537959, "episode_reward_min": -2879.311829656474, "episode_reward_mean": -2753.3101680796904, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2720.736272209214, -2716.895288600087, -2743.6052432023507, -2853.768169369343, -2743.2818466741255, -2817.8765351859015, -2851.152161767467, -2714.8471089293607, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695, -2754.0004053961557, -2750.1499133460106, -2817.843388153855, -2870.1819995860183, -2630.4522048469357, -2709.2772659516886, -2745.687715628178, -2787.184940578898, -2710.7943456195203, -2735.513990032595, -2776.268911218865, -2715.6297736182446], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 815.2467593310598, "mean_raw_obs_processing_ms": 2.3574739191700256, "mean_inference_ms": 11.87246980050209, "mean_action_processing_ms": 0.3848744511347556}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 172000, "timers": {"sample_time_ms": 1778968.045, "sample_throughput": 2.248, "learn_time_ms": 26417.196, "learn_throughput": 151.417, "update_time_ms": 46.263}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.056938174326205626, "policy_loss": -0.10050554614281282, "vf_loss": 15438.777740478516, "vf_explained_var": -1.4901161193847656e-08, "kl": 0.01581343892030418, "entropy": 50.98153614997864, "entropy_coeff": 0.001}}, "num_steps_sampled": 172000, "num_steps_trained": 172000}, "done": false, "episodes_total": 172, "training_iteration": 43, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_14-40-38", "timestamp": 1617864038, "time_this_iter_s": 1739.8303163051605, "time_total_s": 73726.8333735466, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 73726.8333735466, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 21.07634234961647, "ram_util_percent": 33.850343157044804}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2608.8529966239553, "episode_reward_min": -2879.311829656474, "episode_reward_mean": -2749.582843205353, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2660.6256972047595, -2608.8529966239553, -2737.4259729190917, -2747.5204983753856, -2691.5300853025688, -2723.9486148148962, -2810.4663079352094, -2708.0355421572726, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695, -2754.0004053961557, -2750.1499133460106, -2817.843388153855, -2870.1819995860183, -2630.4522048469357, -2709.2772659516886, -2745.687715628178, -2787.184940578898, -2710.7943456195203, -2735.513990032595, -2776.268911218865, -2715.6297736182446, -2720.736272209214, -2716.895288600087, -2743.6052432023507, -2853.768169369343], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 815.5891403279328, "mean_raw_obs_processing_ms": 2.3578921709860583, "mean_inference_ms": 11.867331020314106, "mean_action_processing_ms": 0.385808762434072}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 176000, "timers": {"sample_time_ms": 1789790.397, "sample_throughput": 2.235, "learn_time_ms": 26470.556, "learn_throughput": 151.111, "update_time_ms": 50.912}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.051773520128335804, "policy_loss": -0.09284596634097397, "vf_loss": 13983.202606201172, "vf_explained_var": -1.6763806343078613e-08, "kl": 0.01632217300357297, "entropy": 50.98845183849335, "entropy_coeff": 0.001}}, "num_steps_sampled": 176000, "num_steps_trained": 176000}, "done": false, "episodes_total": 176, "training_iteration": 44, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_15-09-39", "timestamp": 1617865779, "time_this_iter_s": 1741.2694792747498, "time_total_s": 75468.10285282135, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 75468.10285282135, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 16.851512706736585, "ram_util_percent": 32.130657523194834}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2608.8529966239553, "episode_reward_min": -2879.311829656474, "episode_reward_mean": -2750.2570493553176, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2633.8813109538446, -2858.736143304498, -2698.5568468981282, -2810.2268640498805, -2734.339834735928, -2715.8475578683365, -2742.2904270773533, -2650.780111421427, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695, -2754.0004053961557, -2750.1499133460106, -2817.843388153855, -2870.1819995860183, -2630.4522048469357, -2709.2772659516886, -2745.687715628178, -2787.184940578898, -2710.7943456195203, -2735.513990032595, -2776.268911218865, -2715.6297736182446, -2720.736272209214, -2716.895288600087, -2743.6052432023507, -2853.768169369343, -2660.6256972047595, -2608.8529966239553, -2737.4259729190917, -2747.5204983753856], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 815.9202010774167, "mean_raw_obs_processing_ms": 2.357949139509941, "mean_inference_ms": 11.862692841908151, "mean_action_processing_ms": 0.3866012664763677}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 180000, "timers": {"sample_time_ms": 1790689.049, "sample_throughput": 2.234, "learn_time_ms": 26417.668, "learn_throughput": 151.414, "update_time_ms": 52.569}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.06464056967524812, "policy_loss": -0.09229564646375366, "vf_loss": 15092.213409423828, "vf_explained_var": -1.1175870895385742e-08, "kl": 0.016702742112101987, "entropy": 51.062315702438354, "entropy_coeff": 0.001}}, "num_steps_sampled": 180000, "num_steps_trained": 180000}, "done": false, "episodes_total": 180, "training_iteration": 45, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_15-37-08", "timestamp": 1617867428, "time_this_iter_s": 1648.6189062595367, "time_total_s": 77116.72175908089, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 77116.72175908089, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 17.312143161482744, "ram_util_percent": 32.259181934384316}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2608.8529966239553, "episode_reward_min": -2879.311829656474, "episode_reward_mean": -2751.4997488347767, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2805.225247582826, -2769.766202550395, -2748.4810493346517, -2644.055379581057, -2729.4412348591154, -2786.484619344772, -2679.028580146569, -2734.202287295361, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695, -2754.0004053961557, -2750.1499133460106, -2817.843388153855, -2870.1819995860183, -2630.4522048469357, -2709.2772659516886, -2745.687715628178, -2787.184940578898, -2710.7943456195203, -2735.513990032595, -2776.268911218865, -2715.6297736182446, -2720.736272209214, -2716.895288600087, -2743.6052432023507, -2853.768169369343, -2660.6256972047595, -2608.8529966239553, -2737.4259729190917, -2747.5204983753856, -2633.8813109538446, -2858.736143304498, -2698.5568468981282, -2810.2268640498805], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 816.3205354821882, "mean_raw_obs_processing_ms": 2.358557248145401, "mean_inference_ms": 11.859286714125144, "mean_action_processing_ms": 0.3874133981684295}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 184000, "timers": {"sample_time_ms": 1775865.457, "sample_throughput": 2.252, "learn_time_ms": 27281.045, "learn_throughput": 146.622, "update_time_ms": 54.861}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.04550849803490564, "policy_loss": -0.10362724779406562, "vf_loss": 14539.314544677734, "vf_explained_var": -5.587935447692871e-09, "kl": 0.01599185395753011, "entropy": 50.90455949306488, "entropy_coeff": 0.001}}, "num_steps_sampled": 184000, "num_steps_trained": 184000}, "done": false, "episodes_total": 184, "training_iteration": 46, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_16-05-38", "timestamp": 1617869138, "time_this_iter_s": 1709.5509974956512, "time_total_s": 78826.27275657654, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 78826.27275657654, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 22.52781429745275, "ram_util_percent": 37.5702136400986}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2608.8529966239553, "episode_reward_min": -2879.311829656474, "episode_reward_mean": -2752.292376452863, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2842.924765277288, -2773.039691050436, -2746.937364450819, -2645.517662675978, -2787.549227326163, -2748.3105994961293, -2637.103664278042, -2802.537842527722, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695, -2754.0004053961557, -2750.1499133460106, -2817.843388153855, -2870.1819995860183, -2630.4522048469357, -2709.2772659516886, -2745.687715628178, -2787.184940578898, -2710.7943456195203, -2735.513990032595, -2776.268911218865, -2715.6297736182446, -2720.736272209214, -2716.895288600087, -2743.6052432023507, -2853.768169369343, -2660.6256972047595, -2608.8529966239553, -2737.4259729190917, -2747.5204983753856, -2633.8813109538446, -2858.736143304498, -2698.5568468981282, -2810.2268640498805, -2805.225247582826, -2769.766202550395, -2748.4810493346517, -2644.055379581057], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 816.8257747990451, "mean_raw_obs_processing_ms": 2.359323379599664, "mean_inference_ms": 11.857430826941744, "mean_action_processing_ms": 0.3880981600179419}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 188000, "timers": {"sample_time_ms": 1784401.385, "sample_throughput": 2.242, "learn_time_ms": 26722.2, "learn_throughput": 149.688, "update_time_ms": 57.413}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.049087952298577875, "policy_loss": -0.09872611827449873, "vf_loss": 14316.917053222656, "vf_explained_var": 7.450580596923828e-09, "kl": 0.016298230621032417, "entropy": 51.04920482635498, "entropy_coeff": 0.001}}, "num_steps_sampled": 188000, "num_steps_trained": 188000}, "done": false, "episodes_total": 188, "training_iteration": 47, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_16-36-23", "timestamp": 1617870983, "time_this_iter_s": 1845.258118391037, "time_total_s": 80671.53087496758, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 80671.53087496758, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 26.15367339170156, "ram_util_percent": 45.95055196041111}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2571.5947145870487, "episode_reward_min": -2879.311829656474, "episode_reward_mean": -2751.1349072190073, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2829.4959545463194, -2771.4914003502245, -2571.5947145870487, -2687.1723407587747, -2781.481696762007, -2745.7314654681895, -2879.311829656474, -2762.415805084686, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695, -2754.0004053961557, -2750.1499133460106, -2817.843388153855, -2870.1819995860183, -2630.4522048469357, -2709.2772659516886, -2745.687715628178, -2787.184940578898, -2710.7943456195203, -2735.513990032595, -2776.268911218865, -2715.6297736182446, -2720.736272209214, -2716.895288600087, -2743.6052432023507, -2853.768169369343, -2660.6256972047595, -2608.8529966239553, -2737.4259729190917, -2747.5204983753856, -2633.8813109538446, -2858.736143304498, -2698.5568468981282, -2810.2268640498805, -2805.225247582826, -2769.766202550395, -2748.4810493346517, -2644.055379581057, -2842.924765277288, -2773.039691050436, -2746.937364450819, -2645.517662675978], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 817.2863896985773, "mean_raw_obs_processing_ms": 2.359917257922057, "mean_inference_ms": 11.854930131915067, "mean_action_processing_ms": 0.3886697839602126}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 192000, "timers": {"sample_time_ms": 1771365.837, "sample_throughput": 2.258, "learn_time_ms": 26446.232, "learn_throughput": 151.25, "update_time_ms": 57.86}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.05168958392459899, "policy_loss": -0.09082523465622216, "vf_loss": 13405.384094238281, "vf_explained_var": -1.862645149230957e-08, "kl": 0.01729133553453721, "entropy": 50.62675166130066, "entropy_coeff": 0.001}}, "num_steps_sampled": 192000, "num_steps_trained": 192000}, "done": false, "episodes_total": 192, "training_iteration": 48, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_17-05-13", "timestamp": 1617872713, "time_this_iter_s": 1730.424262046814, "time_total_s": 82401.95513701439, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 82401.95513701439, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 20.280511571254564, "ram_util_percent": 41.88806333739343}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2571.5947145870487, "episode_reward_min": -2870.1819995860183, "episode_reward_mean": -2749.1595872188227, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2730.5746881669, -2713.347112031527, -2799.225746225301, -2728.2612505292373, -2695.8523488712876, -2767.885998788056, -2723.154044972269, -2679.145269891614, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695, -2754.0004053961557, -2750.1499133460106, -2817.843388153855, -2870.1819995860183, -2630.4522048469357, -2709.2772659516886, -2745.687715628178, -2787.184940578898, -2710.7943456195203, -2735.513990032595, -2776.268911218865, -2715.6297736182446, -2720.736272209214, -2716.895288600087, -2743.6052432023507, -2853.768169369343, -2660.6256972047595, -2608.8529966239553, -2737.4259729190917, -2747.5204983753856, -2633.8813109538446, -2858.736143304498, -2698.5568468981282, -2810.2268640498805, -2805.225247582826, -2769.766202550395, -2748.4810493346517, -2644.055379581057, -2842.924765277288, -2773.039691050436, -2746.937364450819, -2645.517662675978, -2829.4959545463194, -2771.4914003502245, -2571.5947145870487, -2687.1723407587747], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 817.744174184711, "mean_raw_obs_processing_ms": 2.3605197863324943, "mean_inference_ms": 11.852893121792404, "mean_action_processing_ms": 0.38911424237477277}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 196000, "timers": {"sample_time_ms": 1751462.642, "sample_throughput": 2.284, "learn_time_ms": 26903.78, "learn_throughput": 148.678, "update_time_ms": 58.802}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.04316677059978247, "policy_loss": -0.09945617459015921, "vf_loss": 13750.077880859375, "vf_explained_var": -1.862645149230957e-09, "kl": 0.016334692860255018, "entropy": 50.696537137031555, "entropy_coeff": 0.001}}, "num_steps_sampled": 196000, "num_steps_trained": 196000}, "done": false, "episodes_total": 196, "training_iteration": 49, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_17-32-37", "timestamp": 1617874357, "time_this_iter_s": 1644.0431842803955, "time_total_s": 84045.99832129478, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 84045.99832129478, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 17.060401537804356, "ram_util_percent": 39.35237078171721}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2571.5947145870487, "episode_reward_min": -2870.1819995860183, "episode_reward_mean": -2749.233847291231, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2723.612901227447, -2789.593983343637, -2611.9745832416984, -2748.282201951249, -2722.261446066596, -2790.502414728195, -2764.6745471717286, -2844.733670007093, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695, -2754.0004053961557, -2750.1499133460106, -2817.843388153855, -2870.1819995860183, -2630.4522048469357, -2709.2772659516886, -2745.687715628178, -2787.184940578898, -2710.7943456195203, -2735.513990032595, -2776.268911218865, -2715.6297736182446, -2720.736272209214, -2716.895288600087, -2743.6052432023507, -2853.768169369343, -2660.6256972047595, -2608.8529966239553, -2737.4259729190917, -2747.5204983753856, -2633.8813109538446, -2858.736143304498, -2698.5568468981282, -2810.2268640498805, -2805.225247582826, -2769.766202550395, -2748.4810493346517, -2644.055379581057, -2842.924765277288, -2773.039691050436, -2746.937364450819, -2645.517662675978, -2829.4959545463194, -2771.4914003502245, -2571.5947145870487, -2687.1723407587747, -2730.5746881669, -2713.347112031527, -2799.225746225301, -2728.2612505292373], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 818.2519787218154, "mean_raw_obs_processing_ms": 2.361234226987904, "mean_inference_ms": 11.850834961213437, "mean_action_processing_ms": 0.38965863897743047}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 200000, "timers": {"sample_time_ms": 1719231.445, "sample_throughput": 2.327, "learn_time_ms": 25868.585, "learn_throughput": 154.628, "update_time_ms": 54.925}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.03792201477335766, "policy_loss": -0.09622554178349674, "vf_loss": 12909.928771972656, "vf_explained_var": 7.450580596923828e-09, "kl": 0.016306237288517877, "entropy": 50.67319369316101, "entropy_coeff": 0.001}}, "num_steps_sampled": 200000, "num_steps_trained": 200000}, "done": false, "episodes_total": 200, "training_iteration": 50, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_18-01-07", "timestamp": 1617876067, "time_this_iter_s": 1709.772436618805, "time_total_s": 85755.77075791359, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 85755.77075791359, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 17.005217748562035, "ram_util_percent": 39.36454396055875}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2571.5947145870487, "episode_reward_min": -2870.1819995860183, "episode_reward_mean": -2749.5664532490573, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2735.607647373093, -2851.355068433021, -2764.4497733462795, -2804.0201846039317, -2773.1626036179296, -2740.0382427393884, -2623.959986706492, -2718.0067706615264, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695, -2754.0004053961557, -2750.1499133460106, -2817.843388153855, -2870.1819995860183, -2630.4522048469357, -2709.2772659516886, -2745.687715628178, -2787.184940578898, -2710.7943456195203, -2735.513990032595, -2776.268911218865, -2715.6297736182446, -2720.736272209214, -2716.895288600087, -2743.6052432023507, -2853.768169369343, -2660.6256972047595, -2608.8529966239553, -2737.4259729190917, -2747.5204983753856, -2633.8813109538446, -2858.736143304498, -2698.5568468981282, -2810.2268640498805, -2805.225247582826, -2769.766202550395, -2748.4810493346517, -2644.055379581057, -2842.924765277288, -2773.039691050436, -2746.937364450819, -2645.517662675978, -2829.4959545463194, -2771.4914003502245, -2571.5947145870487, -2687.1723407587747, -2730.5746881669, -2713.347112031527, -2799.225746225301, -2728.2612505292373, -2723.612901227447, -2789.593983343637, -2611.9745832416984, -2748.282201951249], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 818.7485527050169, "mean_raw_obs_processing_ms": 2.3619343702393736, "mean_inference_ms": 11.848253230124525, "mean_action_processing_ms": 0.39017933528964677}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 204000, "timers": {"sample_time_ms": 1712096.073, "sample_throughput": 2.336, "learn_time_ms": 25655.37, "learn_throughput": 155.913, "update_time_ms": 56.041}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.04644510481739417, "policy_loss": -0.09397174508194439, "vf_loss": 13817.00326538086, "vf_explained_var": 2.2351741790771484e-08, "kl": 0.015424734097905457, "entropy": 50.462387442588806, "entropy_coeff": 0.001}}, "num_steps_sampled": 204000, "num_steps_trained": 204000}, "done": false, "episodes_total": 204, "training_iteration": 51, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_18-30-39", "timestamp": 1617877839, "time_this_iter_s": 1772.118103981018, "time_total_s": 87527.88886189461, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 87527.88886189461, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 22.43067776456599, "ram_util_percent": 43.980816488307575}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2571.5947145870487, "episode_reward_min": -2870.1819995860183, "episode_reward_mean": -2748.8196775197425, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2668.6834483127477, -2717.9245470669653, -2635.856349470649, -2758.0256859433325, -2756.663786213854, -2839.163398586012, -2796.5791238360143, -2783.776880306821, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695, -2754.0004053961557, -2750.1499133460106, -2817.843388153855, -2870.1819995860183, -2630.4522048469357, -2709.2772659516886, -2745.687715628178, -2787.184940578898, -2710.7943456195203, -2735.513990032595, -2776.268911218865, -2715.6297736182446, -2720.736272209214, -2716.895288600087, -2743.6052432023507, -2853.768169369343, -2660.6256972047595, -2608.8529966239553, -2737.4259729190917, -2747.5204983753856, -2633.8813109538446, -2858.736143304498, -2698.5568468981282, -2810.2268640498805, -2805.225247582826, -2769.766202550395, -2748.4810493346517, -2644.055379581057, -2842.924765277288, -2773.039691050436, -2746.937364450819, -2645.517662675978, -2829.4959545463194, -2771.4914003502245, -2571.5947145870487, -2687.1723407587747, -2730.5746881669, -2713.347112031527, -2799.225746225301, -2728.2612505292373, -2723.612901227447, -2789.593983343637, -2611.9745832416984, -2748.282201951249, -2735.607647373093, -2851.355068433021, -2764.4497733462795, -2804.0201846039317], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 819.2860328360294, "mean_raw_obs_processing_ms": 2.362612490991268, "mean_inference_ms": 11.846208804587155, "mean_action_processing_ms": 0.39063888718555617}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 208000, "timers": {"sample_time_ms": 1700762.942, "sample_throughput": 2.352, "learn_time_ms": 25422.554, "learn_throughput": 157.341, "update_time_ms": 55.992}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.024878374417312443, "policy_loss": -0.10009599215118214, "vf_loss": 11943.482299804688, "vf_explained_var": -7.450580596923828e-09, "kl": 0.016403486544732004, "entropy": 50.51423716545105, "entropy_coeff": 0.001}}, "num_steps_sampled": 208000, "num_steps_trained": 208000}, "done": false, "episodes_total": 208, "training_iteration": 52, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_18-59-21", "timestamp": 1617879561, "time_this_iter_s": 1721.6517238616943, "time_total_s": 89249.5405857563, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 89249.5405857563, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 18.68347613219094, "ram_util_percent": 41.51338229294166}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2571.5947145870487, "episode_reward_min": -2870.1819995860183, "episode_reward_mean": -2744.4991847652973, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2679.744073019181, -2730.7517288043896, -2693.694486190576, -2639.943625484112, -2742.7216151515086, -2752.028438952748, -2723.043093298108, -2732.682950947806, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695, -2754.0004053961557, -2750.1499133460106, -2817.843388153855, -2870.1819995860183, -2630.4522048469357, -2709.2772659516886, -2745.687715628178, -2787.184940578898, -2710.7943456195203, -2735.513990032595, -2776.268911218865, -2715.6297736182446, -2720.736272209214, -2716.895288600087, -2743.6052432023507, -2853.768169369343, -2660.6256972047595, -2608.8529966239553, -2737.4259729190917, -2747.5204983753856, -2633.8813109538446, -2858.736143304498, -2698.5568468981282, -2810.2268640498805, -2805.225247582826, -2769.766202550395, -2748.4810493346517, -2644.055379581057, -2842.924765277288, -2773.039691050436, -2746.937364450819, -2645.517662675978, -2829.4959545463194, -2771.4914003502245, -2571.5947145870487, -2687.1723407587747, -2730.5746881669, -2713.347112031527, -2799.225746225301, -2728.2612505292373, -2723.612901227447, -2789.593983343637, -2611.9745832416984, -2748.282201951249, -2735.607647373093, -2851.355068433021, -2764.4497733462795, -2804.0201846039317, -2668.6834483127477, -2717.9245470669653, -2635.856349470649, -2758.0256859433325], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 819.8202044549118, "mean_raw_obs_processing_ms": 2.36335260833185, "mean_inference_ms": 11.844473440035912, "mean_action_processing_ms": 0.3910137067287563}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 212000, "timers": {"sample_time_ms": 1692002.265, "sample_throughput": 2.364, "learn_time_ms": 26454.364, "learn_throughput": 151.204, "update_time_ms": 62.199}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.028070041618775576, "policy_loss": -0.09327086026314646, "vf_loss": 11566.88461303711, "vf_explained_var": 1.6763806343078613e-08, "kl": 0.0163617325888481, "entropy": 50.239052176475525, "entropy_coeff": 0.001}}, "num_steps_sampled": 212000, "num_steps_trained": 212000}, "done": false, "episodes_total": 212, "training_iteration": 53, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_19-27-04", "timestamp": 1617881224, "time_this_iter_s": 1662.6044855117798, "time_total_s": 90912.14507126808, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 90912.14507126808, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 18.393874102239124, "ram_util_percent": 56.01089987325728}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2571.5947145870487, "episode_reward_min": -2870.1819995860183, "episode_reward_mean": -2744.1199689560976, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2776.466689623656, -2704.3142846425167, -2774.886210467324, -2656.887332696767, -2765.982423992244, -2699.9023498735446, -2777.3618025361343, -2780.725066737191, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695, -2754.0004053961557, -2750.1499133460106, -2817.843388153855, -2870.1819995860183, -2630.4522048469357, -2709.2772659516886, -2745.687715628178, -2787.184940578898, -2710.7943456195203, -2735.513990032595, -2776.268911218865, -2715.6297736182446, -2720.736272209214, -2716.895288600087, -2743.6052432023507, -2853.768169369343, -2660.6256972047595, -2608.8529966239553, -2737.4259729190917, -2747.5204983753856, -2633.8813109538446, -2858.736143304498, -2698.5568468981282, -2810.2268640498805, -2805.225247582826, -2769.766202550395, -2748.4810493346517, -2644.055379581057, -2842.924765277288, -2773.039691050436, -2746.937364450819, -2645.517662675978, -2829.4959545463194, -2771.4914003502245, -2571.5947145870487, -2687.1723407587747, -2730.5746881669, -2713.347112031527, -2799.225746225301, -2728.2612505292373, -2723.612901227447, -2789.593983343637, -2611.9745832416984, -2748.282201951249, -2735.607647373093, -2851.355068433021, -2764.4497733462795, -2804.0201846039317, -2668.6834483127477, -2717.9245470669653, -2635.856349470649, -2758.0256859433325, -2679.744073019181, -2730.7517288043896, -2693.694486190576, -2639.943625484112], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 820.3857952702507, "mean_raw_obs_processing_ms": 2.3640981680206643, "mean_inference_ms": 11.842931024588216, "mean_action_processing_ms": 0.39134977355344897}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 216000, "timers": {"sample_time_ms": 1693036.269, "sample_throughput": 2.363, "learn_time_ms": 26354.567, "learn_throughput": 151.776, "update_time_ms": 59.669}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.029053891106741503, "policy_loss": -0.09580699779326096, "vf_loss": 12036.004425048828, "vf_explained_var": 7.450580596923828e-09, "kl": 0.016013321233913302, "entropy": 50.21967101097107, "entropy_coeff": 0.001}}, "num_steps_sampled": 216000, "num_steps_trained": 216000}, "done": false, "episodes_total": 216, "training_iteration": 54, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_19-56-14", "timestamp": 1617882974, "time_this_iter_s": 1750.5998520851135, "time_total_s": 92662.7449233532, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 92662.7449233532, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 17.751243980738366, "ram_util_percent": 64.48154093097914}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2571.5947145870487, "episode_reward_min": -2870.1819995860183, "episode_reward_mean": -2743.672179160033, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2780.035962951159, -2788.793704066607, -2739.5398662619536, -2670.8231302528893, -2786.005206087268, -2721.7806859696834, -2742.747523636078, -2777.6111015565566, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695, -2754.0004053961557, -2750.1499133460106, -2817.843388153855, -2870.1819995860183, -2630.4522048469357, -2709.2772659516886, -2745.687715628178, -2787.184940578898, -2710.7943456195203, -2735.513990032595, -2776.268911218865, -2715.6297736182446, -2720.736272209214, -2716.895288600087, -2743.6052432023507, -2853.768169369343, -2660.6256972047595, -2608.8529966239553, -2737.4259729190917, -2747.5204983753856, -2633.8813109538446, -2858.736143304498, -2698.5568468981282, -2810.2268640498805, -2805.225247582826, -2769.766202550395, -2748.4810493346517, -2644.055379581057, -2842.924765277288, -2773.039691050436, -2746.937364450819, -2645.517662675978, -2829.4959545463194, -2771.4914003502245, -2571.5947145870487, -2687.1723407587747, -2730.5746881669, -2713.347112031527, -2799.225746225301, -2728.2612505292373, -2723.612901227447, -2789.593983343637, -2611.9745832416984, -2748.282201951249, -2735.607647373093, -2851.355068433021, -2764.4497733462795, -2804.0201846039317, -2668.6834483127477, -2717.9245470669653, -2635.856349470649, -2758.0256859433325, -2679.744073019181, -2730.7517288043896, -2693.694486190576, -2639.943625484112, -2776.466689623656, -2704.3142846425167, -2774.886210467324, -2656.887332696767], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 820.9292572556863, "mean_raw_obs_processing_ms": 2.364745540048795, "mean_inference_ms": 11.841392620565014, "mean_action_processing_ms": 0.3917165967627345}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 220000, "timers": {"sample_time_ms": 1696799.642, "sample_throughput": 2.357, "learn_time_ms": 26537.415, "learn_throughput": 150.731, "update_time_ms": 58.821}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.035610002116300166, "policy_loss": -0.09231996937887743, "vf_loss": 12214.671264648438, "vf_explained_var": 7.450580596923828e-09, "kl": 0.01634616788942367, "entropy": 50.074655055999756, "entropy_coeff": 0.001}}, "num_steps_sampled": 220000, "num_steps_trained": 220000}, "done": false, "episodes_total": 220, "training_iteration": 55, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_20-24-23", "timestamp": 1617884663, "time_this_iter_s": 1688.0721592903137, "time_total_s": 94350.81708264351, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 94350.81708264351, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 19.060757386600084, "ram_util_percent": 42.28560133166875}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2571.5947145870487, "episode_reward_min": -2870.1819995860183, "episode_reward_mean": -2743.3039939720074, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2848.8969169850725, -2670.853210558714, -2711.3203493179008, -2760.255521585359, -2746.6655126237292, -2773.1276055041385, -2720.04328508011, -2836.42233008878, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695, -2754.0004053961557, -2750.1499133460106, -2817.843388153855, -2870.1819995860183, -2630.4522048469357, -2709.2772659516886, -2745.687715628178, -2787.184940578898, -2710.7943456195203, -2735.513990032595, -2776.268911218865, -2715.6297736182446, -2720.736272209214, -2716.895288600087, -2743.6052432023507, -2853.768169369343, -2660.6256972047595, -2608.8529966239553, -2737.4259729190917, -2747.5204983753856, -2633.8813109538446, -2858.736143304498, -2698.5568468981282, -2810.2268640498805, -2805.225247582826, -2769.766202550395, -2748.4810493346517, -2644.055379581057, -2842.924765277288, -2773.039691050436, -2746.937364450819, -2645.517662675978, -2829.4959545463194, -2771.4914003502245, -2571.5947145870487, -2687.1723407587747, -2730.5746881669, -2713.347112031527, -2799.225746225301, -2728.2612505292373, -2723.612901227447, -2789.593983343637, -2611.9745832416984, -2748.282201951249, -2735.607647373093, -2851.355068433021, -2764.4497733462795, -2804.0201846039317, -2668.6834483127477, -2717.9245470669653, -2635.856349470649, -2758.0256859433325, -2679.744073019181, -2730.7517288043896, -2693.694486190576, -2639.943625484112, -2776.466689623656, -2704.3142846425167, -2774.886210467324, -2656.887332696767, -2780.035962951159, -2788.793704066607, -2739.5398662619536, -2670.8231302528893], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 821.5208468703036, "mean_raw_obs_processing_ms": 2.365544008811386, "mean_inference_ms": 11.84057995209962, "mean_action_processing_ms": 0.392095611603036}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 224000, "timers": {"sample_time_ms": 1699723.397, "sample_throughput": 2.353, "learn_time_ms": 26379.914, "learn_throughput": 151.631, "update_time_ms": 56.423}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.024280868179630488, "policy_loss": -0.09873505946598016, "vf_loss": 11835.716217041016, "vf_explained_var": -7.450580596923828e-09, "kl": 0.016073826496722177, "entropy": 50.268508315086365, "entropy_coeff": 0.001}}, "num_steps_sampled": 224000, "num_steps_trained": 224000}, "done": false, "episodes_total": 224, "training_iteration": 56, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_20-53-20", "timestamp": 1617886400, "time_this_iter_s": 1737.1894934177399, "time_total_s": 96088.00657606125, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 96088.00657606125, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 19.858528698464024, "ram_util_percent": 41.107356507679874}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2571.5947145870487, "episode_reward_min": -2870.1819995860183, "episode_reward_mean": -2739.632306160582, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2636.6090867617245, -2663.154993409425, -2742.3528758444886, -2666.97299613858, -2781.8858306674756, -2794.0386166024628, -2754.6822047752867, -2802.9445998032843, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695, -2754.0004053961557, -2750.1499133460106, -2817.843388153855, -2870.1819995860183, -2630.4522048469357, -2709.2772659516886, -2745.687715628178, -2787.184940578898, -2710.7943456195203, -2735.513990032595, -2776.268911218865, -2715.6297736182446, -2720.736272209214, -2716.895288600087, -2743.6052432023507, -2853.768169369343, -2660.6256972047595, -2608.8529966239553, -2737.4259729190917, -2747.5204983753856, -2633.8813109538446, -2858.736143304498, -2698.5568468981282, -2810.2268640498805, -2805.225247582826, -2769.766202550395, -2748.4810493346517, -2644.055379581057, -2842.924765277288, -2773.039691050436, -2746.937364450819, -2645.517662675978, -2829.4959545463194, -2771.4914003502245, -2571.5947145870487, -2687.1723407587747, -2730.5746881669, -2713.347112031527, -2799.225746225301, -2728.2612505292373, -2723.612901227447, -2789.593983343637, -2611.9745832416984, -2748.282201951249, -2735.607647373093, -2851.355068433021, -2764.4497733462795, -2804.0201846039317, -2668.6834483127477, -2717.9245470669653, -2635.856349470649, -2758.0256859433325, -2679.744073019181, -2730.7517288043896, -2693.694486190576, -2639.943625484112, -2776.466689623656, -2704.3142846425167, -2774.886210467324, -2656.887332696767, -2780.035962951159, -2788.793704066607, -2739.5398662619536, -2670.8231302528893, -2848.8969169850725, -2670.853210558714, -2711.3203493179008, -2760.255521585359], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 822.1555822830333, "mean_raw_obs_processing_ms": 2.366259464821917, "mean_inference_ms": 11.839713543069557, "mean_action_processing_ms": 0.3925529957465197}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 228000, "timers": {"sample_time_ms": 1695857.206, "sample_throughput": 2.359, "learn_time_ms": 26177.15, "learn_throughput": 152.805, "update_time_ms": 53.259}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.025146009225863963, "policy_loss": -0.08651375412591733, "vf_loss": 10741.643463134766, "vf_explained_var": -3.3527612686157227e-08, "kl": 0.015936048584990203, "entropy": 50.21313405036926, "entropy_coeff": 0.001}}, "num_steps_sampled": 228000, "num_steps_trained": 228000}, "done": false, "episodes_total": 228, "training_iteration": 57, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_21-23-24", "timestamp": 1617888204, "time_this_iter_s": 1804.5375092029572, "time_total_s": 97892.5440852642, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 97892.5440852642, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 19.615219929933826, "ram_util_percent": 32.6150253016738}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2571.5947145870487, "episode_reward_min": -2870.1819995860183, "episode_reward_mean": -2736.6193566460593, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2629.9276571883447, -2795.163041842157, -2675.7808673813315, -2731.3847339843887, -2822.1160144084374, -2791.4824293835704, -2777.6123140439504, -2751.714097564957, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695, -2754.0004053961557, -2750.1499133460106, -2817.843388153855, -2870.1819995860183, -2630.4522048469357, -2709.2772659516886, -2745.687715628178, -2787.184940578898, -2710.7943456195203, -2735.513990032595, -2776.268911218865, -2715.6297736182446, -2720.736272209214, -2716.895288600087, -2743.6052432023507, -2853.768169369343, -2660.6256972047595, -2608.8529966239553, -2737.4259729190917, -2747.5204983753856, -2633.8813109538446, -2858.736143304498, -2698.5568468981282, -2810.2268640498805, -2805.225247582826, -2769.766202550395, -2748.4810493346517, -2644.055379581057, -2842.924765277288, -2773.039691050436, -2746.937364450819, -2645.517662675978, -2829.4959545463194, -2771.4914003502245, -2571.5947145870487, -2687.1723407587747, -2730.5746881669, -2713.347112031527, -2799.225746225301, -2728.2612505292373, -2723.612901227447, -2789.593983343637, -2611.9745832416984, -2748.282201951249, -2735.607647373093, -2851.355068433021, -2764.4497733462795, -2804.0201846039317, -2668.6834483127477, -2717.9245470669653, -2635.856349470649, -2758.0256859433325, -2679.744073019181, -2730.7517288043896, -2693.694486190576, -2639.943625484112, -2776.466689623656, -2704.3142846425167, -2774.886210467324, -2656.887332696767, -2780.035962951159, -2788.793704066607, -2739.5398662619536, -2670.8231302528893, -2848.8969169850725, -2670.853210558714, -2711.3203493179008, -2760.255521585359, -2636.6090867617245, -2663.154993409425, -2742.3528758444886, -2666.97299613858], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 822.7784388697204, "mean_raw_obs_processing_ms": 2.3668934984991887, "mean_inference_ms": 11.838146931528838, "mean_action_processing_ms": 0.39290463657472713}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 232000, "timers": {"sample_time_ms": 1700308.213, "sample_throughput": 2.353, "learn_time_ms": 26338.829, "learn_throughput": 151.867, "update_time_ms": 52.938}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.017626135202590376, "policy_loss": -0.09700570194399916, "vf_loss": 10967.341003417969, "vf_explained_var": -2.60770320892334e-08, "kl": 0.01616801938507706, "entropy": 50.290717005729675, "entropy_coeff": 0.001}}, "num_steps_sampled": 232000, "num_steps_trained": 232000}, "done": false, "episodes_total": 232, "training_iteration": 58, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_21-53-01", "timestamp": 1617889981, "time_this_iter_s": 1776.548053741455, "time_total_s": 99669.09213900566, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 99669.09213900566, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 30.1308026888098, "ram_util_percent": 33.38564650059312}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2571.5947145870487, "episode_reward_min": -2870.1819995860183, "episode_reward_mean": -2732.2225964459726, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2658.937113317723, -2736.0191265886733, -2669.0631686988086, -2639.2294267870543, -2828.83565353426, -2669.5643106015527, -2765.1069910708056, -2801.5972768878783, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695, -2754.0004053961557, -2750.1499133460106, -2817.843388153855, -2870.1819995860183, -2630.4522048469357, -2709.2772659516886, -2745.687715628178, -2787.184940578898, -2710.7943456195203, -2735.513990032595, -2776.268911218865, -2715.6297736182446, -2720.736272209214, -2716.895288600087, -2743.6052432023507, -2853.768169369343, -2660.6256972047595, -2608.8529966239553, -2737.4259729190917, -2747.5204983753856, -2633.8813109538446, -2858.736143304498, -2698.5568468981282, -2810.2268640498805, -2805.225247582826, -2769.766202550395, -2748.4810493346517, -2644.055379581057, -2842.924765277288, -2773.039691050436, -2746.937364450819, -2645.517662675978, -2829.4959545463194, -2771.4914003502245, -2571.5947145870487, -2687.1723407587747, -2730.5746881669, -2713.347112031527, -2799.225746225301, -2728.2612505292373, -2723.612901227447, -2789.593983343637, -2611.9745832416984, -2748.282201951249, -2735.607647373093, -2851.355068433021, -2764.4497733462795, -2804.0201846039317, -2668.6834483127477, -2717.9245470669653, -2635.856349470649, -2758.0256859433325, -2679.744073019181, -2730.7517288043896, -2693.694486190576, -2639.943625484112, -2776.466689623656, -2704.3142846425167, -2774.886210467324, -2656.887332696767, -2780.035962951159, -2788.793704066607, -2739.5398662619536, -2670.8231302528893, -2848.8969169850725, -2670.853210558714, -2711.3203493179008, -2760.255521585359, -2636.6090867617245, -2663.154993409425, -2742.3528758444886, -2666.97299613858, -2629.9276571883447, -2795.163041842157, -2675.7808673813315, -2731.3847339843887], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 823.4655828440984, "mean_raw_obs_processing_ms": 2.3675583936026636, "mean_inference_ms": 11.836269667608287, "mean_action_processing_ms": 0.393346790742019}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 236000, "timers": {"sample_time_ms": 1717227.981, "sample_throughput": 2.329, "learn_time_ms": 26687.305, "learn_throughput": 149.884, "update_time_ms": 50.757}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.001276984898140654, "policy_loss": -0.10788981219229754, "vf_loss": 10347.049270629883, "vf_explained_var": 7.450580596923828e-09, "kl": 0.01646661275299266, "entropy": 50.57319688796997, "entropy_coeff": 0.001}}, "num_steps_sampled": 236000, "num_steps_trained": 236000}, "done": false, "episodes_total": 236, "training_iteration": 59, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_22-23-18", "timestamp": 1617891798, "time_this_iter_s": 1816.7038893699646, "time_total_s": 101485.79602837563, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 101485.79602837563, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 36.26314771848415, "ram_util_percent": 33.40007733952049}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2571.5947145870487, "episode_reward_min": -2870.1819995860183, "episode_reward_mean": -2729.1530520208416, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2676.6088917986776, -2646.9235930359982, -2737.546086499055, -2697.0712182477214, -2845.013344667911, -2835.8871336123143, -2684.261828365457, -2754.9371918172064, -2816.203220994992, -2744.6799271517925, -2760.3227472664166, -2764.337142241615, -2671.099664179244, -2615.165649537959, -2725.884883217467, -2628.6321328460185, -2794.4882892348796, -2822.1033480269625, -2718.0422820815616, -2693.9813447097695, -2754.0004053961557, -2750.1499133460106, -2817.843388153855, -2870.1819995860183, -2630.4522048469357, -2709.2772659516886, -2745.687715628178, -2787.184940578898, -2710.7943456195203, -2735.513990032595, -2776.268911218865, -2715.6297736182446, -2720.736272209214, -2716.895288600087, -2743.6052432023507, -2853.768169369343, -2660.6256972047595, -2608.8529966239553, -2737.4259729190917, -2747.5204983753856, -2633.8813109538446, -2858.736143304498, -2698.5568468981282, -2810.2268640498805, -2805.225247582826, -2769.766202550395, -2748.4810493346517, -2644.055379581057, -2842.924765277288, -2773.039691050436, -2746.937364450819, -2645.517662675978, -2829.4959545463194, -2771.4914003502245, -2571.5947145870487, -2687.1723407587747, -2730.5746881669, -2713.347112031527, -2799.225746225301, -2728.2612505292373, -2723.612901227447, -2789.593983343637, -2611.9745832416984, -2748.282201951249, -2735.607647373093, -2851.355068433021, -2764.4497733462795, -2804.0201846039317, -2668.6834483127477, -2717.9245470669653, -2635.856349470649, -2758.0256859433325, -2679.744073019181, -2730.7517288043896, -2693.694486190576, -2639.943625484112, -2776.466689623656, -2704.3142846425167, -2774.886210467324, -2656.887332696767, -2780.035962951159, -2788.793704066607, -2739.5398662619536, -2670.8231302528893, -2848.8969169850725, -2670.853210558714, -2711.3203493179008, -2760.255521585359, -2636.6090867617245, -2663.154993409425, -2742.3528758444886, -2666.97299613858, -2629.9276571883447, -2795.163041842157, -2675.7808673813315, -2731.3847339843887, -2658.937113317723, -2736.0191265886733, -2669.0631686988086, -2639.2294267870543], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 824.2498909456817, "mean_raw_obs_processing_ms": 2.368221543118737, "mean_inference_ms": 11.835083132666282, "mean_action_processing_ms": 0.3937682224368988}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 240000, "timers": {"sample_time_ms": 1739125.89, "sample_throughput": 2.3, "learn_time_ms": 26766.611, "learn_throughput": 149.44, "update_time_ms": 51.231}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.023295915452763438, "policy_loss": -0.08345817966619506, "vf_loss": 10533.357788085938, "vf_explained_var": 7.450580596923828e-09, "kl": 0.01528169511584565, "entropy": 50.79989206790924, "entropy_coeff": 0.001}}, "num_steps_sampled": 240000, "num_steps_trained": 240000}, "done": false, "episodes_total": 240, "training_iteration": 60, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-08_22-55-27", "timestamp": 1617893727, "time_this_iter_s": 1929.5516533851624, "time_total_s": 103415.34768176079, "pid": 18545, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 103415.34768176079, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 36.33516563523843, "ram_util_percent": 33.41277757553695}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -801.3281276960386, "episode_reward_min": -874.5126833849398, "episode_reward_mean": -824.7486718798078, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-874.5126833849398, -801.3281276960386, -809.2213332823245, -813.9325431559286], "episode_lengths": [1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 242.91046240042593, "mean_raw_obs_processing_ms": 1.715151206783388, "mean_inference_ms": 6.437097174831774, "mean_action_processing_ms": 0.13778568326920526}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 204000, "timers": {"sample_time_ms": 511633.376, "sample_throughput": 7.818, "learn_time_ms": 15965.506, "learn_throughput": 250.54, "update_time_ms": 45.393}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.14474601583788171, "policy_loss": -0.11016150118666701, "vf_loss": 824.1572151184082, "vf_explained_var": 0.0, "kl": 0.03522501850966364, "entropy": 49.87109196186066, "entropy_coeff": 0.001}}, "num_steps_sampled": 204000, "num_steps_trained": 204000}, "done": false, "episodes_total": 204, "training_iteration": 51, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_15-32-49", "timestamp": 1617953569, "time_this_iter_s": 527.6519601345062, "time_total_s": 86283.4227180481, "pid": 12763, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 527.6519601345062, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 11.996143617021277, "ram_util_percent": 14.62912234042553}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -795.2022578359051, "episode_reward_min": -874.5126833849398, "episode_reward_mean": -824.6160984170504, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-796.2402344951504, -854.4524768058873, -852.039130680229, -795.2022578359051, -874.5126833849398, -801.3281276960386, -809.2213332823245, -813.9325431559286], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 238.64768176744747, "mean_raw_obs_processing_ms": 1.7121394773577423, "mean_inference_ms": 6.488488300821276, "mean_action_processing_ms": 0.13258894825713216}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 208000, "timers": {"sample_time_ms": 494426.578, "sample_throughput": 8.09, "learn_time_ms": 13384.533, "learn_throughput": 298.852, "update_time_ms": 39.43}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": -0.1421675604651682, "policy_loss": -0.11144672433147207, "vf_loss": 749.2919340133667, "vf_explained_var": 0.0, "kl": 0.03858420345932245, "entropy": 49.78901731967926, "entropy_coeff": 0.001}}, "num_steps_sampled": 208000, "num_steps_trained": 208000}, "done": false, "episodes_total": 208, "training_iteration": 52, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_15-40-57", "timestamp": 1617954057, "time_this_iter_s": 488.06410002708435, "time_total_s": 86771.48681807518, "pid": 12763, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 1015.7160601615906, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 11.897985611510792, "ram_util_percent": 14.799568345323742}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -787.7212987145922, "episode_reward_min": -890.59884552313, "episode_reward_mean": -832.6388550942416, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-863.4476097134129, -852.9697198433624, -787.7212987145922, -890.59884552313, -874.5126833849398, -801.3281276960386, -809.2213332823245, -813.9325431559286, -796.2402344951504, -854.4524768058873, -852.039130680229, -795.2022578359051], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 237.04093341538746, "mean_raw_obs_processing_ms": 1.7130552364044707, "mean_inference_ms": 6.510116085424823, "mean_action_processing_ms": 0.1268773479273119}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 212000, "timers": {"sample_time_ms": 493987.11, "sample_throughput": 8.097, "learn_time_ms": 14212.983, "learn_throughput": 281.433, "update_time_ms": 39.803}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": -0.13153416302520782, "policy_loss": -0.10371966418460943, "vf_loss": 653.9583597183228, "vf_explained_var": -5.587935447692871e-09, "kl": 0.03422239574138075, "entropy": 49.75415527820587, "entropy_coeff": 0.001}}, "num_steps_sampled": 212000, "num_steps_trained": 212000}, "done": false, "episodes_total": 212, "training_iteration": 53, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_15-49-26", "timestamp": 1617954566, "time_this_iter_s": 509.0260720252991, "time_total_s": 87280.51289010048, "pid": 12763, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 1524.7421321868896, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 11.916804407713501, "ram_util_percent": 14.821212121212122}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -787.7212987145922, "episode_reward_min": -890.59884552313, "episode_reward_mean": -832.2178676158958, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-805.4273351796282, -828.9896218104394, -824.7527977908782, -864.6498659424849, -874.5126833849398, -801.3281276960386, -809.2213332823245, -813.9325431559286, -796.2402344951504, -854.4524768058873, -852.039130680229, -795.2022578359051, -863.4476097134129, -852.9697198433624, -787.7212987145922, -890.59884552313], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 237.157670715804, "mean_raw_obs_processing_ms": 1.7180946186579642, "mean_inference_ms": 6.488683128214592, "mean_action_processing_ms": 0.1258947577555598}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 216000, "timers": {"sample_time_ms": 500328.472, "sample_throughput": 7.995, "learn_time_ms": 14647.239, "learn_throughput": 273.089, "update_time_ms": 41.596}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": -0.1400786572485231, "policy_loss": -0.11744592542527243, "vf_loss": 666.7915048599243, "vf_explained_var": 0.0, "kl": 0.030651292006950825, "entropy": 49.99026656150818, "entropy_coeff": 0.001}}, "num_steps_sampled": 216000, "num_steps_trained": 216000}, "done": false, "episodes_total": 216, "training_iteration": 54, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_15-58-22", "timestamp": 1617955102, "time_this_iter_s": 535.3569173812866, "time_total_s": 87815.86980748177, "pid": 12763, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 2060.0990495681763, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 11.903543307086615, "ram_util_percent": 14.803149606299215}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -787.7212987145922, "episode_reward_min": -890.59884552313, "episode_reward_mean": -834.1505088235408, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-840.5927832235034, -833.8542101092986, -808.8715665300034, -884.2057347536796, -874.5126833849398, -801.3281276960386, -809.2213332823245, -813.9325431559286, -796.2402344951504, -854.4524768058873, -852.039130680229, -795.2022578359051, -863.4476097134129, -852.9697198433624, -787.7212987145922, -890.59884552313, -805.4273351796282, -828.9896218104394, -824.7527977908782, -864.6498659424849], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 237.2065109083137, "mean_raw_obs_processing_ms": 1.7253486009524195, "mean_inference_ms": 6.482046909990801, "mean_action_processing_ms": 0.12696978500120928}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 220000, "timers": {"sample_time_ms": 500312.902, "sample_throughput": 7.995, "learn_time_ms": 14822.889, "learn_throughput": 269.853, "update_time_ms": 40.163}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 5e-05, "total_loss": -0.12024237963487394, "policy_loss": -0.10307156044291332, "vf_loss": 571.2066125869751, "vf_explained_var": 9.313225746154785e-09, "kl": 0.026709514611866325, "entropy": 49.926265835762024, "entropy_coeff": 0.001}}, "num_steps_sampled": 220000, "num_steps_trained": 220000}, "done": false, "episodes_total": 220, "training_iteration": 55, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_16-06-57", "timestamp": 1617955617, "time_this_iter_s": 515.8179783821106, "time_total_s": 88331.68778586388, "pid": 12763, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 2575.917027950287, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 11.915102040816324, "ram_util_percent": 14.844217687074833}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -787.7212987145922, "episode_reward_min": -890.59884552313, "episode_reward_mean": -835.044813599331, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-811.4397955793319, -846.0959843475138, -855.7364594457069, -844.7931105405737, -874.5126833849398, -801.3281276960386, -809.2213332823245, -813.9325431559286, -796.2402344951504, -854.4524768058873, -852.039130680229, -795.2022578359051, -863.4476097134129, -852.9697198433624, -787.7212987145922, -890.59884552313, -805.4273351796282, -828.9896218104394, -824.7527977908782, -864.6498659424849, -840.5927832235034, -833.8542101092986, -808.8715665300034, -884.2057347536796], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 237.30968177858173, "mean_raw_obs_processing_ms": 1.7277442477715796, "mean_inference_ms": 6.482292692214675, "mean_action_processing_ms": 0.12754401606224575}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 224000, "timers": {"sample_time_ms": 501237.275, "sample_throughput": 7.98, "learn_time_ms": 14116.559, "learn_throughput": 283.355, "update_time_ms": 38.834}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5e-05, "total_loss": -0.11111021833494306, "policy_loss": -0.10289190206094645, "vf_loss": 538.7253837585449, "vf_explained_var": -3.725290298461914e-09, "kl": 0.023917150276247412, "entropy": 49.92974090576172, "entropy_coeff": 0.001}}, "num_steps_sampled": 224000, "num_steps_trained": 224000}, "done": false, "episodes_total": 224, "training_iteration": 56, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_16-15-34", "timestamp": 1617956134, "time_this_iter_s": 516.4836337566376, "time_total_s": 88848.17141962051, "pid": 12763, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 3092.4006617069244, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 11.911836734693878, "ram_util_percent": 14.829659863945583}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -776.4786391964428, "episode_reward_min": -890.59884552313, "episode_reward_mean": -831.6643646678873, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-776.4786391964428, -861.4769456648087, -791.7168085016863, -815.8542909539602, -874.5126833849398, -801.3281276960386, -809.2213332823245, -813.9325431559286, -796.2402344951504, -854.4524768058873, -852.039130680229, -795.2022578359051, -863.4476097134129, -852.9697198433624, -787.7212987145922, -890.59884552313, -805.4273351796282, -828.9896218104394, -824.7527977908782, -864.6498659424849, -840.5927832235034, -833.8542101092986, -808.8715665300034, -884.2057347536796, -811.4397955793319, -846.0959843475138, -855.7364594457069, -844.7931105405737], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 237.48492566607592, "mean_raw_obs_processing_ms": 1.729642093873592, "mean_inference_ms": 6.480150800098467, "mean_action_processing_ms": 0.1276387059157628}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 228000, "timers": {"sample_time_ms": 502244.145, "sample_throughput": 7.964, "learn_time_ms": 14384.764, "learn_throughput": 278.072, "update_time_ms": 38.164}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.278125, "cur_lr": 5e-05, "total_loss": -0.0938351750955917, "policy_loss": -0.09840942930895835, "vf_loss": 513.9687261581421, "vf_explained_var": -9.313225746154785e-09, "kl": 0.02167755347909406, "entropy": 49.94960916042328, "entropy_coeff": 0.001}}, "num_steps_sampled": 228000, "num_steps_trained": 228000}, "done": false, "episodes_total": 228, "training_iteration": 57, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_16-24-18", "timestamp": 1617956658, "time_this_iter_s": 524.3211586475372, "time_total_s": 89372.49257826805, "pid": 12763, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 3616.7218203544617, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 11.706024096385542, "ram_util_percent": 14.828915662650603}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -814.3373285476697, "episode_reward_min": -871.8618871690877, "episode_reward_mean": -840.2174279965672, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-871.8618871690877, -855.4511051875749, -819.2193910819365, -814.3373285476697], "episode_lengths": [1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 239.96407922537907, "mean_raw_obs_processing_ms": 1.698747865561543, "mean_inference_ms": 5.960343421428934, "mean_action_processing_ms": 0.16604859134306138}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 204000, "timers": {"sample_time_ms": 502858.986, "sample_throughput": 7.955, "learn_time_ms": 16185.927, "learn_throughput": 247.128, "update_time_ms": 48.756}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.1447642731363885, "policy_loss": -0.10989366850117221, "vf_loss": 799.4803295135498, "vf_explained_var": -1.30385160446167e-08, "kl": 0.03493424295447767, "entropy": 49.85225319862366, "entropy_coeff": 0.001}}, "num_steps_sampled": 204000, "num_steps_trained": 204000}, "done": false, "episodes_total": 204, "training_iteration": 51, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_16-36-49", "timestamp": 1617957409, "time_this_iter_s": 519.1019268035889, "time_total_s": 86274.87268471718, "pid": 15483, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 519.1019268035889, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 12.464324324324322, "ram_util_percent": 14.487837837837837}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -764.7658503932884, "episode_reward_min": -871.8618871690877, "episode_reward_mean": -831.3811188678123, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-825.5977294130967, -855.1477639903676, -844.6678951594768, -764.7658503932884, -871.8618871690877, -855.4511051875749, -819.2193910819365, -814.3373285476697], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 238.49135757066608, "mean_raw_obs_processing_ms": 1.6967770557835138, "mean_inference_ms": 6.077319823326397, "mean_action_processing_ms": 0.154641622715464}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 208000, "timers": {"sample_time_ms": 498165.281, "sample_throughput": 8.029, "learn_time_ms": 16142.447, "learn_throughput": 247.794, "update_time_ms": 44.869}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": -0.13480668456759304, "policy_loss": -0.1033766198088415, "vf_loss": 770.8391456604004, "vf_explained_var": 3.725290298461914e-09, "kl": 0.034973872010596097, "entropy": 49.63061583042145, "entropy_coeff": 0.001}}, "num_steps_sampled": 208000, "num_steps_trained": 208000}, "done": false, "episodes_total": 208, "training_iteration": 52, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_16-45-19", "timestamp": 1617957919, "time_this_iter_s": 509.61904549598694, "time_total_s": 86784.49173021317, "pid": 15483, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 1028.7209722995758, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 11.90993103448276, "ram_util_percent": 14.85544827586207}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -764.7658503932884, "episode_reward_min": -871.8618871690877, "episode_reward_mean": -832.1382387889925, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-854.4284485371602, -846.1004425752683, -820.5485763442076, -813.5324470687741, -871.8618871690877, -855.4511051875749, -819.2193910819365, -814.3373285476697, -825.5977294130967, -855.1477639903676, -844.6678951594768, -764.7658503932884], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 238.83548413938345, "mean_raw_obs_processing_ms": 1.7151226648515527, "mean_inference_ms": 6.1414519420655, "mean_action_processing_ms": 0.151825236546015}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 212000, "timers": {"sample_time_ms": 502023.375, "sample_throughput": 7.968, "learn_time_ms": 16035.853, "learn_throughput": 249.441, "update_time_ms": 36.853}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": -0.15471478761173785, "policy_loss": -0.12646291803685017, "vf_loss": 718.2366275787354, "vf_explained_var": 5.587935447692871e-09, "kl": 0.03159489302197471, "entropy": 49.65194094181061, "entropy_coeff": 0.001}}, "num_steps_sampled": 212000, "num_steps_trained": 212000}, "done": false, "episodes_total": 212, "training_iteration": 53, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_16-54-04", "timestamp": 1617958444, "time_this_iter_s": 525.5904886722565, "time_total_s": 87310.08221888542, "pid": 15483, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 1554.3114609718323, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 11.925767690253673, "ram_util_percent": 14.903070761014687}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -764.7658503932884, "episode_reward_min": -906.4935562848881, "episode_reward_mean": -837.3585393957139, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-805.9251445488678, -859.238234847982, -840.4208291817764, -906.4935562848881, -871.8618871690877, -855.4511051875749, -819.2193910819365, -814.3373285476697, -825.5977294130967, -855.1477639903676, -844.6678951594768, -764.7658503932884, -854.4284485371602, -846.1004425752683, -820.5485763442076, -813.5324470687741], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 238.7320170550735, "mean_raw_obs_processing_ms": 1.7294449430290788, "mean_inference_ms": 6.1729037271743685, "mean_action_processing_ms": 0.1496966193450625}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 216000, "timers": {"sample_time_ms": 500731.429, "sample_throughput": 7.988, "learn_time_ms": 15947.515, "learn_throughput": 250.823, "update_time_ms": 33.892}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": -0.1272088865225669, "policy_loss": -0.10376264064689167, "vf_loss": 563.0842065811157, "vf_explained_var": 0.0, "kl": 0.030773639446124434, "entropy": 49.849292278289795, "entropy_coeff": 0.001}}, "num_steps_sampled": 216000, "num_steps_trained": 216000}, "done": false, "episodes_total": 216, "training_iteration": 54, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_17-02-37", "timestamp": 1617958957, "time_this_iter_s": 512.5705556869507, "time_total_s": 87822.65277457237, "pid": 15483, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 2066.882016658783, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 11.907534246575343, "ram_util_percent": 14.92109589041096}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -764.7658503932884, "episode_reward_min": -906.4935562848881, "episode_reward_mean": -832.458611208675, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-790.3724132708279, -891.6114471451256, -790.6058294105965, -778.845904015527, -871.8618871690877, -855.4511051875749, -819.2193910819365, -814.3373285476697, -825.5977294130967, -855.1477639903676, -844.6678951594768, -764.7658503932884, -854.4284485371602, -846.1004425752683, -820.5485763442076, -813.5324470687741, -805.9251445488678, -859.238234847982, -840.4208291817764, -906.4935562848881], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 238.39576065845586, "mean_raw_obs_processing_ms": 1.7374586668741858, "mean_inference_ms": 6.199976999652979, "mean_action_processing_ms": 0.14771027305503165}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 220000, "timers": {"sample_time_ms": 498601.616, "sample_throughput": 8.022, "learn_time_ms": 15987.727, "learn_throughput": 250.192, "update_time_ms": 36.136}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 5e-05, "total_loss": -0.12863204389577731, "policy_loss": -0.11166009918088093, "vf_loss": 596.5116910934448, "vf_explained_var": 5.587935447692871e-09, "kl": 0.02636571688344702, "entropy": 49.63235092163086, "entropy_coeff": 0.001}}, "num_steps_sampled": 220000, "num_steps_trained": 220000}, "done": false, "episodes_total": 220, "training_iteration": 55, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_17-11-03", "timestamp": 1617959463, "time_this_iter_s": 506.2835490703583, "time_total_s": 88328.93632364273, "pid": 15483, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 2573.1655657291412, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 11.906796116504854, "ram_util_percent": 14.920804438280168}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -764.7658503932884, "episode_reward_min": -906.4935562848881, "episode_reward_mean": -834.0471026009612, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-889.7687423609244, -828.3936503195292, -814.6134365988513, -835.1824089702624, -871.8618871690877, -855.4511051875749, -819.2193910819365, -814.3373285476697, -825.5977294130967, -855.1477639903676, -844.6678951594768, -764.7658503932884, -854.4284485371602, -846.1004425752683, -820.5485763442076, -813.5324470687741, -805.9251445488678, -859.238234847982, -840.4208291817764, -906.4935562848881, -790.3724132708279, -891.6114471451256, -790.6058294105965, -778.845904015527], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 238.39337359881418, "mean_raw_obs_processing_ms": 1.7405273948159496, "mean_inference_ms": 6.217056158097996, "mean_action_processing_ms": 0.14667346708389176}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 224000, "timers": {"sample_time_ms": 501877.485, "sample_throughput": 7.97, "learn_time_ms": 15698.099, "learn_throughput": 254.808, "update_time_ms": 34.946}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5e-05, "total_loss": -0.11415126908104867, "policy_loss": -0.10713160733575933, "vf_loss": 531.621771812439, "vf_explained_var": 0.0, "kl": 0.024638022645376623, "entropy": 49.75487172603607, "entropy_coeff": 0.001}}, "num_steps_sampled": 224000, "num_steps_trained": 224000}, "done": false, "episodes_total": 224, "training_iteration": 56, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_17-19-56", "timestamp": 1617959996, "time_this_iter_s": 532.5433700084686, "time_total_s": 88861.4796936512, "pid": 15483, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 3105.70893573761, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 11.917678100263851, "ram_util_percent": 14.902770448548816}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -764.7658503932884, "episode_reward_min": -906.4935562848881, "episode_reward_mean": -830.6741483524598, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.8527513254834, -845.6632205937702, -789.8802683378358, -803.3494511887181, -871.8618871690877, -855.4511051875749, -819.2193910819365, -814.3373285476697, -825.5977294130967, -855.1477639903676, -844.6678951594768, -764.7658503932884, -854.4284485371602, -846.1004425752683, -820.5485763442076, -813.5324470687741, -805.9251445488678, -859.238234847982, -840.4208291817764, -906.4935562848881, -790.3724132708279, -891.6114471451256, -790.6058294105965, -778.845904015527, -889.7687423609244, -828.3936503195292, -814.6134365988513, -835.1824089702624], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 238.21312585137943, "mean_raw_obs_processing_ms": 1.7442597377265083, "mean_inference_ms": 6.237608430041338, "mean_action_processing_ms": 0.14635159402615364}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 228000, "timers": {"sample_time_ms": 499427.004, "sample_throughput": 8.009, "learn_time_ms": 15727.331, "learn_throughput": 254.334, "update_time_ms": 35.565}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.278125, "cur_lr": 5e-05, "total_loss": -0.0930004544206895, "policy_loss": -0.0973398819915019, "vf_loss": 504.62381649017334, "vf_explained_var": 0.0, "kl": 0.02145174570614472, "entropy": 49.576568484306335, "entropy_coeff": 0.001}}, "num_steps_sampled": 228000, "num_steps_trained": 228000}, "done": false, "episodes_total": 228, "training_iteration": 57, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_17-28-16", "timestamp": 1617960496, "time_this_iter_s": 500.67367148399353, "time_total_s": 89362.1533651352, "pid": 15483, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 3606.3826072216034, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 11.873071528751753, "ram_util_percent": 14.920897615708277}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -764.7658503932884, "episode_reward_min": -906.4935562848881, "episode_reward_mean": -829.6028386346843, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-865.2684655067183, -812.7114162159819, -774.3320683336318, -836.1027323846895, -871.8618871690877, -855.4511051875749, -819.2193910819365, -814.3373285476697, -825.5977294130967, -855.1477639903676, -844.6678951594768, -764.7658503932884, -854.4284485371602, -846.1004425752683, -820.5485763442076, -813.5324470687741, -805.9251445488678, -859.238234847982, -840.4208291817764, -906.4935562848881, -790.3724132708279, -891.6114471451256, -790.6058294105965, -778.845904015527, -889.7687423609244, -828.3936503195292, -814.6134365988513, -835.1824089702624, -802.8527513254834, -845.6632205937702, -789.8802683378358, -803.3494511887181], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 237.97369520015764, "mean_raw_obs_processing_ms": 1.7460431695742713, "mean_inference_ms": 6.2561641981155365, "mean_action_processing_ms": 0.1462203554778345}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 232000, "timers": {"sample_time_ms": 497474.658, "sample_throughput": 8.041, "learn_time_ms": 15228.938, "learn_throughput": 262.658, "update_time_ms": 35.624}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": -0.07862777569971513, "policy_loss": -0.09394994034664705, "vf_loss": 439.01810789108276, "vf_explained_var": 1.862645149230957e-09, "kl": 0.017765602678991854, "entropy": 49.77640652656555, "entropy_coeff": 0.001}}, "num_steps_sampled": 232000, "num_steps_trained": 232000}, "done": false, "episodes_total": 232, "training_iteration": 58, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_17-36-32", "timestamp": 1617960992, "time_this_iter_s": 495.5918836593628, "time_total_s": 89857.74524879456, "pid": 15483, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 4101.974490880966, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 11.915439093484418, "ram_util_percent": 14.919405099150145}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -760.613294479643, "episode_reward_min": -906.4935562848881, "episode_reward_mean": -828.6571296089268, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-760.613294479643, -844.535568345051, -821.478119838636, -857.7388469481383, -871.8618871690877, -855.4511051875749, -819.2193910819365, -814.3373285476697, -825.5977294130967, -855.1477639903676, -844.6678951594768, -764.7658503932884, -854.4284485371602, -846.1004425752683, -820.5485763442076, -813.5324470687741, -805.9251445488678, -859.238234847982, -840.4208291817764, -906.4935562848881, -790.3724132708279, -891.6114471451256, -790.6058294105965, -778.845904015527, -889.7687423609244, -828.3936503195292, -814.6134365988513, -835.1824089702624, -802.8527513254834, -845.6632205937702, -789.8802683378358, -803.3494511887181, -865.2684655067183, -812.7114162159819, -774.3320683336318, -836.1027323846895], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 237.85498318641314, "mean_raw_obs_processing_ms": 1.74861477839353, "mean_inference_ms": 6.269860990556551, "mean_action_processing_ms": 0.14560335807799255}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 236000, "timers": {"sample_time_ms": 499052.486, "sample_throughput": 8.015, "learn_time_ms": 15326.511, "learn_throughput": 260.986, "update_time_ms": 35.177}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": -0.07501571753527969, "policy_loss": -0.0893113644560799, "vf_loss": 427.68785285949707, "vf_explained_var": 3.725290298461914e-09, "kl": 0.01748690096428618, "entropy": 49.737247467041016, "entropy_coeff": 0.001}}, "num_steps_sampled": 236000, "num_steps_trained": 236000}, "done": false, "episodes_total": 236, "training_iteration": 59, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_17-45-20", "timestamp": 1617961520, "time_this_iter_s": 527.8213946819305, "time_total_s": 90385.56664347649, "pid": 15483, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 4629.795885562897, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 11.834840425531914, "ram_util_percent": 14.914228723404255}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -760.613294479643, "episode_reward_min": -906.4935562848881, "episode_reward_mean": -829.5886824314017, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-836.4249612267657, -831.268339184106, -790.1713295830456, -894.0260013407876, -871.8618871690877, -855.4511051875749, -819.2193910819365, -814.3373285476697, -825.5977294130967, -855.1477639903676, -844.6678951594768, -764.7658503932884, -854.4284485371602, -846.1004425752683, -820.5485763442076, -813.5324470687741, -805.9251445488678, -859.238234847982, -840.4208291817764, -906.4935562848881, -790.3724132708279, -891.6114471451256, -790.6058294105965, -778.845904015527, -889.7687423609244, -828.3936503195292, -814.6134365988513, -835.1824089702624, -802.8527513254834, -845.6632205937702, -789.8802683378358, -803.3494511887181, -865.2684655067183, -812.7114162159819, -774.3320683336318, -836.1027323846895, -760.613294479643, -844.535568345051, -821.478119838636, -857.7388469481383], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 237.74528711634426, "mean_raw_obs_processing_ms": 1.749684211764659, "mean_inference_ms": 6.2817726105115055, "mean_action_processing_ms": 0.14509054458165402}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 240000, "timers": {"sample_time_ms": 498657.965, "sample_throughput": 8.022, "learn_time_ms": 15403.339, "learn_throughput": 259.684, "update_time_ms": 35.107}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": -0.08452379959635437, "policy_loss": -0.09714659466408193, "vf_loss": 402.3590226173401, "vf_explained_var": 1.862645149230957e-09, "kl": 0.017080940277082846, "entropy": 49.769567251205444, "entropy_coeff": 0.001}}, "num_steps_sampled": 240000, "num_steps_trained": 240000}, "done": false, "episodes_total": 240, "training_iteration": 60, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_17-53-51", "timestamp": 1617962031, "time_this_iter_s": 511.2440769672394, "time_total_s": 90896.81072044373, "pid": 15483, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 5141.039962530136, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 11.818406593406594, "ram_util_percent": 14.927609890109892}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -760.613294479643, "episode_reward_min": -906.4935562848881, "episode_reward_mean": -832.2453551153968, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-902.7431562791436, -798.3392073631097, -886.7105070298978, -847.4554571492309, -871.8618871690877, -855.4511051875749, -819.2193910819365, -814.3373285476697, -825.5977294130967, -855.1477639903676, -844.6678951594768, -764.7658503932884, -854.4284485371602, -846.1004425752683, -820.5485763442076, -813.5324470687741, -805.9251445488678, -859.238234847982, -840.4208291817764, -906.4935562848881, -790.3724132708279, -891.6114471451256, -790.6058294105965, -778.845904015527, -889.7687423609244, -828.3936503195292, -814.6134365988513, -835.1824089702624, -802.8527513254834, -845.6632205937702, -789.8802683378358, -803.3494511887181, -865.2684655067183, -812.7114162159819, -774.3320683336318, -836.1027323846895, -760.613294479643, -844.535568345051, -821.478119838636, -857.7388469481383, -836.4249612267657, -831.268339184106, -790.1713295830456, -894.0260013407876], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 237.7441479537704, "mean_raw_obs_processing_ms": 1.7504603625073671, "mean_inference_ms": 6.288983324708778, "mean_action_processing_ms": 0.1444887484811006}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 244000, "timers": {"sample_time_ms": 500077.879, "sample_throughput": 7.999, "learn_time_ms": 14861.18, "learn_throughput": 269.158, "update_time_ms": 33.016}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": -0.08011671458370984, "policy_loss": -0.08984141869586892, "vf_loss": 398.88600158691406, "vf_explained_var": 0.0, "kl": 0.016262547171209008, "entropy": 49.83632433414459, "entropy_coeff": 0.001}}, "num_steps_sampled": 244000, "num_steps_trained": 244000}, "done": false, "episodes_total": 244, "training_iteration": 61, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_18-02-39", "timestamp": 1617962559, "time_this_iter_s": 527.8579919338226, "time_total_s": 91424.66871237755, "pid": 15483, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 5668.897954463959, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 11.817553191489361, "ram_util_percent": 14.919414893617024}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -760.613294479643, "episode_reward_min": -906.4935562848881, "episode_reward_mean": -832.6005977476206, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-833.1353844369236, -838.9062110732509, -881.3724548820961, -792.6190164160654, -871.8618871690877, -855.4511051875749, -819.2193910819365, -814.3373285476697, -825.5977294130967, -855.1477639903676, -844.6678951594768, -764.7658503932884, -854.4284485371602, -846.1004425752683, -820.5485763442076, -813.5324470687741, -805.9251445488678, -859.238234847982, -840.4208291817764, -906.4935562848881, -790.3724132708279, -891.6114471451256, -790.6058294105965, -778.845904015527, -889.7687423609244, -828.3936503195292, -814.6134365988513, -835.1824089702624, -802.8527513254834, -845.6632205937702, -789.8802683378358, -803.3494511887181, -865.2684655067183, -812.7114162159819, -774.3320683336318, -836.1027323846895, -760.613294479643, -844.535568345051, -821.478119838636, -857.7388469481383, -836.4249612267657, -831.268339184106, -790.1713295830456, -894.0260013407876, -902.7431562791436, -798.3392073631097, -886.7105070298978, -847.4554571492309], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 237.76521245404936, "mean_raw_obs_processing_ms": 1.750969713828149, "mean_inference_ms": 6.29449292833699, "mean_action_processing_ms": 0.1438619931068218}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 248000, "timers": {"sample_time_ms": 501380.436, "sample_throughput": 7.978, "learn_time_ms": 14850.13, "learn_throughput": 269.358, "update_time_ms": 31.176}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": -0.07688437751494348, "policy_loss": -0.0869707640085835, "vf_loss": 335.7089068889618, "vf_explained_var": -1.1175870895385742e-08, "kl": 0.016516576608410105, "entropy": 49.71094000339508, "entropy_coeff": 0.001}}, "num_steps_sampled": 248000, "num_steps_trained": 248000}, "done": false, "episodes_total": 248, "training_iteration": 62, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_18-11-22", "timestamp": 1617963082, "time_this_iter_s": 522.51562666893, "time_total_s": 91947.18433904648, "pid": 15483, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 6191.413581132889, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 11.848790322580646, "ram_util_percent": 14.911290322580648}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -760.613294479643, "episode_reward_min": -906.4935562848881, "episode_reward_mean": -832.5588858861142, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-812.2633812975744, -818.4502562329557, -875.6982808122742, -821.8214558493559, -871.8618871690877, -855.4511051875749, -819.2193910819365, -814.3373285476697, -825.5977294130967, -855.1477639903676, -844.6678951594768, -764.7658503932884, -854.4284485371602, -846.1004425752683, -820.5485763442076, -813.5324470687741, -805.9251445488678, -859.238234847982, -840.4208291817764, -906.4935562848881, -790.3724132708279, -891.6114471451256, -790.6058294105965, -778.845904015527, -889.7687423609244, -828.3936503195292, -814.6134365988513, -835.1824089702624, -802.8527513254834, -845.6632205937702, -789.8802683378358, -803.3494511887181, -865.2684655067183, -812.7114162159819, -774.3320683336318, -836.1027323846895, -760.613294479643, -844.535568345051, -821.478119838636, -857.7388469481383, -836.4249612267657, -831.268339184106, -790.1713295830456, -894.0260013407876, -902.7431562791436, -798.3392073631097, -886.7105070298978, -847.4554571492309, -833.1353844369236, -838.9062110732509, -881.3724548820961, -792.6190164160654], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 237.77826301181625, "mean_raw_obs_processing_ms": 1.750825589528999, "mean_inference_ms": 6.298892079522228, "mean_action_processing_ms": 0.14349647433640073}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 252000, "timers": {"sample_time_ms": 500455.716, "sample_throughput": 7.993, "learn_time_ms": 14870.749, "learn_throughput": 268.984, "update_time_ms": 35.552}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": -0.08358284234418534, "policy_loss": -0.09177544282283634, "vf_loss": 332.01736402511597, "vf_explained_var": 7.450580596923828e-09, "kl": 0.015965801489073783, "entropy": 49.685709953308105, "entropy_coeff": 0.001}}, "num_steps_sampled": 252000, "num_steps_trained": 252000}, "done": false, "episodes_total": 252, "training_iteration": 63, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_18-19-58", "timestamp": 1617963598, "time_this_iter_s": 516.5933494567871, "time_total_s": 92463.77768850327, "pid": 15483, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 6708.006930589676, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 11.82748299319728, "ram_util_percent": 14.928163265306123}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2697.944525430676, "episode_reward_min": -2800.686872833876, "episode_reward_mean": -2742.840818804177, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196], "episode_lengths": [1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 557.6873657883316, "mean_raw_obs_processing_ms": 1.8659915881178368, "mean_inference_ms": 7.833518486270782, "mean_action_processing_ms": 0.2670273192223163}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 204000, "timers": {"sample_time_ms": 1139539.835, "sample_throughput": 3.51, "learn_time_ms": 15966.102, "learn_throughput": 250.531, "update_time_ms": 66.432}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.2, "cur_lr": 5e-05, "total_loss": -0.02159266927628778, "policy_loss": -0.11141331636463292, "vf_loss": 13312.36148071289, "vf_explained_var": 0.0, "kl": 0.0359463426284492, "entropy": 50.492228627204895, "entropy_coeff": 0.001}}, "num_steps_sampled": 204000, "num_steps_trained": 204000}, "done": false, "episodes_total": 204, "training_iteration": 51, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_18-45-57", "timestamp": 1617965157, "time_this_iter_s": 1155.5798666477203, "time_total_s": 86911.35062456131, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 1155.5798666477203, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 11.916281895504254, "ram_util_percent": 14.898541919805592}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2680.141273276858, "episode_reward_min": -2800.686872833876, "episode_reward_mean": -2728.920056629414, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 551.4349569666217, "mean_raw_obs_processing_ms": 1.851855709326264, "mean_inference_ms": 7.7800741002035565, "mean_action_processing_ms": 0.25269634233975274}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 208000, "timers": {"sample_time_ms": 1113933.452, "sample_throughput": 3.591, "learn_time_ms": 16415.816, "learn_throughput": 243.667, "update_time_ms": 48.247}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.30000000000000004, "cur_lr": 5e-05, "total_loss": -0.02779590751742944, "policy_loss": -0.11295535630779341, "vf_loss": 12535.80404663086, "vf_explained_var": 9.313225746154785e-09, "kl": 0.03567431215196848, "entropy": 50.90087950229645, "entropy_coeff": 0.001}}, "num_steps_sampled": 208000, "num_steps_trained": 208000}, "done": false, "episodes_total": 208, "training_iteration": 52, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_19-04-22", "timestamp": 1617966262, "time_this_iter_s": 1105.2300856113434, "time_total_s": 88016.58071017265, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 2260.8099522590637, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 11.907247298156388, "ram_util_percent": 15.08779402415766}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2680.141273276858, "episode_reward_min": -2813.8868823978214, "episode_reward_mean": -2737.228544466221, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 548.3974477887696, "mean_raw_obs_processing_ms": 1.8432193085069428, "mean_inference_ms": 7.755381653472153, "mean_action_processing_ms": 0.24841677900978257}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 212000, "timers": {"sample_time_ms": 1108206.585, "sample_throughput": 3.609, "learn_time_ms": 16222.329, "learn_throughput": 246.574, "update_time_ms": 42.758}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.45000000000000007, "cur_lr": 5e-05, "total_loss": -0.02393192469025962, "policy_loss": -0.11957266068202443, "vf_loss": 12995.713348388672, "vf_explained_var": -3.725290298461914e-09, "kl": 0.03627783397678286, "entropy": 50.64141809940338, "entropy_coeff": 0.001}}, "num_steps_sampled": 212000, "num_steps_trained": 212000}, "done": false, "episodes_total": 212, "training_iteration": 53, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_19-22-55", "timestamp": 1617967375, "time_this_iter_s": 1112.6274147033691, "time_total_s": 89129.20812487602, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 3373.437366962433, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 11.879027163613392, "ram_util_percent": 15.118003790271633}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2673.5005006152705, "episode_reward_min": -2813.8868823978214, "episode_reward_mean": -2737.8151647129525, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.6957777558439, "mean_raw_obs_processing_ms": 1.8400510696862504, "mean_inference_ms": 7.72852260744693, "mean_action_processing_ms": 0.24275725537828272}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 216000, "timers": {"sample_time_ms": 1106270.754, "sample_throughput": 3.616, "learn_time_ms": 16415.143, "learn_throughput": 243.677, "update_time_ms": 55.45}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.675, "cur_lr": 5e-05, "total_loss": -0.01224267401266843, "policy_loss": -0.10695692664012313, "vf_loss": 12273.098175048828, "vf_explained_var": 0.0, "kl": 0.033342998125590384, "entropy": 50.52324676513672, "entropy_coeff": 0.001}}, "num_steps_sampled": 216000, "num_steps_trained": 216000}, "done": false, "episodes_total": 216, "training_iteration": 54, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_19-41-32", "timestamp": 1617968492, "time_this_iter_s": 1117.557955980301, "time_total_s": 90246.76608085632, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 4490.995322942734, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 11.899497171590195, "ram_util_percent": 15.119233186675045}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2611.545104136591, "episode_reward_min": -2860.618710668252, "episode_reward_mean": -2740.48759004145, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.1179948147629, "mean_raw_obs_processing_ms": 1.8457700386168465, "mean_inference_ms": 7.710981221468179, "mean_action_processing_ms": 0.23870407769229768}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 220000, "timers": {"sample_time_ms": 1110342.843, "sample_throughput": 3.602, "learn_time_ms": 16464.933, "learn_throughput": 242.941, "update_time_ms": 62.915}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0125000000000002, "cur_lr": 5e-05, "total_loss": -0.010388076159870252, "policy_loss": -0.11530530109303072, "vf_loss": 12426.091491699219, "vf_explained_var": -9.313225746154785e-09, "kl": 0.031320059671998024, "entropy": 51.05524730682373, "entropy_coeff": 0.001}}, "num_steps_sampled": 220000, "num_steps_trained": 220000}, "done": false, "episodes_total": 220, "training_iteration": 55, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_20-00-36", "timestamp": 1617969636, "time_this_iter_s": 1143.3958005905151, "time_total_s": 91390.16188144684, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 5634.391123533249, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 11.911977886977887, "ram_util_percent": 15.11744471744471}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2860.618710668252, "episode_reward_mean": -2739.5173088573374, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.5241437199194, "mean_raw_obs_processing_ms": 1.8498957829827567, "mean_inference_ms": 7.701909073446963, "mean_action_processing_ms": 0.23531102890527122}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 224000, "timers": {"sample_time_ms": 1107808.619, "sample_throughput": 3.611, "learn_time_ms": 16550.887, "learn_throughput": 241.679, "update_time_ms": 60.09}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5187500000000003, "cur_lr": 5e-05, "total_loss": 0.0026249383809044957, "policy_loss": -0.1060908111394383, "vf_loss": 11806.663696289062, "vf_explained_var": -1.862645149230957e-09, "kl": 0.027479392709210515, "entropy": 51.08521354198456, "entropy_coeff": 0.001}}, "num_steps_sampled": 224000, "num_steps_trained": 224000}, "done": false, "episodes_total": 224, "training_iteration": 56, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_20-19-08", "timestamp": 1617970748, "time_this_iter_s": 1112.1716706752777, "time_total_s": 92502.33355212212, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 6746.562794208527, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 11.89317751105496, "ram_util_percent": 15.123562855337962}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2860.618710668252, "episode_reward_mean": -2735.182056458702, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.0490574057823, "mean_raw_obs_processing_ms": 1.8540730671725147, "mean_inference_ms": 7.690879351205225, "mean_action_processing_ms": 0.23406789783103907}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 228000, "timers": {"sample_time_ms": 1107442.766, "sample_throughput": 3.612, "learn_time_ms": 16553.844, "learn_throughput": 241.636, "update_time_ms": 55.51}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.278125, "cur_lr": 5e-05, "total_loss": 0.006193614040967077, "policy_loss": -0.10635343994363211, "vf_loss": 11038.378814697266, "vf_explained_var": -7.450580596923828e-09, "kl": 0.023344197252299637, "entropy": 51.01773130893707, "entropy_coeff": 0.001}}, "num_steps_sampled": 228000, "num_steps_trained": 228000}, "done": false, "episodes_total": 228, "training_iteration": 57, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_20-37-50", "timestamp": 1617971870, "time_this_iter_s": 1121.8548815250397, "time_total_s": 93624.18843364716, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 7868.417675733566, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 11.877645585472761, "ram_util_percent": 15.129054477144644}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2860.618710668252, "episode_reward_mean": -2739.0750879332118, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.6650530351637, "mean_raw_obs_processing_ms": 1.857291073821736, "mean_inference_ms": 7.682615453093236, "mean_action_processing_ms": 0.2338878118375815}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 232000, "timers": {"sample_time_ms": 1107494.241, "sample_throughput": 3.612, "learn_time_ms": 16568.955, "learn_throughput": 241.415, "update_time_ms": 54.866}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.4171875000000003, "cur_lr": 5e-05, "total_loss": 0.050743890868034214, "policy_loss": -0.08963822890655138, "vf_loss": 12031.518737792969, "vf_explained_var": -9.313225746154785e-09, "kl": 0.02075455733574927, "entropy": 50.85527765750885, "entropy_coeff": 0.001}}, "num_steps_sampled": 232000, "num_steps_trained": 232000}, "done": false, "episodes_total": 232, "training_iteration": 58, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_20-56-34", "timestamp": 1617972994, "time_this_iter_s": 1124.6071121692657, "time_total_s": 94748.79554581642, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 8993.024787902832, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 11.886641697877653, "ram_util_percent": 15.129400749063668}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2860.618710668252, "episode_reward_mean": -2732.973782754466, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.3261807883149, "mean_raw_obs_processing_ms": 1.8593094577006812, "mean_inference_ms": 7.677023602582723, "mean_action_processing_ms": 0.2339734324321904}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 236000, "timers": {"sample_time_ms": 1106621.326, "sample_throughput": 3.615, "learn_time_ms": 16082.917, "learn_throughput": 248.711, "update_time_ms": 51.883}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.06898628725321032, "policy_loss": -0.07706918066833168, "vf_loss": 10793.82504272461, "vf_explained_var": 2.0489096641540527e-08, "kl": 0.017311918316408992, "entropy": 50.61988425254822, "entropy_coeff": 0.001}}, "num_steps_sampled": 236000, "num_steps_trained": 236000}, "done": false, "episodes_total": 236, "training_iteration": 59, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_21-15-06", "timestamp": 1617974106, "time_this_iter_s": 1111.8681855201721, "time_total_s": 95860.6637313366, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 10104.892973423004, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 11.893173198482932, "ram_util_percent": 15.126801517067001}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2860.618710668252, "episode_reward_mean": -2728.7903414187713, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.2233675761804, "mean_raw_obs_processing_ms": 1.8606623339272577, "mean_inference_ms": 7.676718188920565, "mean_action_processing_ms": 0.2341412570990939}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 240000, "timers": {"sample_time_ms": 1110097.694, "sample_throughput": 3.603, "learn_time_ms": 16139.885, "learn_throughput": 247.833, "update_time_ms": 49.96}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.05332512175664306, "policy_loss": -0.08140206703683361, "vf_loss": 10149.948181152344, "vf_explained_var": -3.725290298461914e-09, "kl": 0.01639556683949195, "entropy": 50.81237351894379, "entropy_coeff": 0.001}}, "num_steps_sampled": 240000, "num_steps_trained": 240000}, "done": false, "episodes_total": 240, "training_iteration": 60, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_21-34-24", "timestamp": 1617975264, "time_this_iter_s": 1158.07803606987, "time_total_s": 97018.74176740646, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 11262.971009492874, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 11.906246209824136, "ram_util_percent": 15.118677986658579}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2860.618710668252, "episode_reward_mean": -2728.9193580562865, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.0811619642899, "mean_raw_obs_processing_ms": 1.8630813710684386, "mean_inference_ms": 7.675779177432602, "mean_action_processing_ms": 0.23398993418186462}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 244000, "timers": {"sample_time_ms": 1105680.014, "sample_throughput": 3.618, "learn_time_ms": 16273.301, "learn_throughput": 245.801, "update_time_ms": 48.931}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.06387921789428219, "policy_loss": -0.07882890437031165, "vf_loss": 10923.846405029297, "vf_explained_var": -7.450580596923828e-09, "kl": 0.01647632144158706, "entropy": 50.98435366153717, "entropy_coeff": 0.001}}, "num_steps_sampled": 244000, "num_steps_trained": 244000}, "done": false, "episodes_total": 244, "training_iteration": 61, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_21-52-57", "timestamp": 1617976377, "time_this_iter_s": 1112.7271137237549, "time_total_s": 98131.46888113022, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 12375.698123216629, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 11.885732323232324, "ram_util_percent": 15.1175505050505}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2863.5216685534715, "episode_reward_mean": -2730.7061864974276, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.9414318408743, "mean_raw_obs_processing_ms": 1.864077663117615, "mean_inference_ms": 7.674563446965725, "mean_action_processing_ms": 0.23369132823884275}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 248000, "timers": {"sample_time_ms": 1107111.365, "sample_throughput": 3.613, "learn_time_ms": 16247.399, "learn_throughput": 246.193, "update_time_ms": 51.415}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.05229993851389736, "policy_loss": -0.0807372365379706, "vf_loss": 10546.262512207031, "vf_explained_var": 0.0, "kl": 0.015309308568248525, "entropy": 50.89761292934418, "entropy_coeff": 0.001}}, "num_steps_sampled": 248000, "num_steps_trained": 248000}, "done": false, "episodes_total": 248, "training_iteration": 62, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_22-11-36", "timestamp": 1617977496, "time_this_iter_s": 1119.3097276687622, "time_total_s": 99250.77860879898, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 13495.007850885391, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 11.883804143126175, "ram_util_percent": 15.116321406151911}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2877.9387920484287, "episode_reward_mean": -2734.142894009516, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.7825960709154, "mean_raw_obs_processing_ms": 1.8645637091035947, "mean_inference_ms": 7.672501108790129, "mean_action_processing_ms": 0.2335426136933463}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 252000, "timers": {"sample_time_ms": 1107192.403, "sample_throughput": 3.613, "learn_time_ms": 16388.969, "learn_throughput": 244.067, "update_time_ms": 52.141}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.05115326924715191, "policy_loss": -0.08305711293360218, "vf_loss": 10718.383117675781, "vf_explained_var": 3.725290298461914e-09, "kl": 0.01522522943560034, "entropy": 51.014634132385254, "entropy_coeff": 0.001}}, "num_steps_sampled": 252000, "num_steps_trained": 252000}, "done": false, "episodes_total": 252, "training_iteration": 63, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_22-30-11", "timestamp": 1617978611, "time_this_iter_s": 1114.8608901500702, "time_total_s": 100365.63949894905, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 14609.868741035461, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 12.231442974165091, "ram_util_percent": 15.196471329552612}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2877.9387920484287, "episode_reward_mean": -2734.609485203027, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.6904764297777, "mean_raw_obs_processing_ms": 1.8645567595105674, "mean_inference_ms": 7.6728146424503825, "mean_action_processing_ms": 0.23367158704599275}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 256000, "timers": {"sample_time_ms": 1109627.952, "sample_throughput": 3.605, "learn_time_ms": 16340.645, "learn_throughput": 244.788, "update_time_ms": 45.677}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.0511365917918738, "policy_loss": -0.08005836754455231, "vf_loss": 10292.542678833008, "vf_explained_var": -3.725290298461914e-09, "kl": 0.015437198337167501, "entropy": 50.85815930366516, "entropy_coeff": 0.001}}, "num_steps_sampled": 256000, "num_steps_trained": 256000}, "done": false, "episodes_total": 256, "training_iteration": 64, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_22-49-13", "timestamp": 1617979753, "time_this_iter_s": 1141.3655924797058, "time_total_s": 101507.00509142876, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 15751.234333515167, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 11.891507692307691, "ram_util_percent": 15.201353846153845}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2877.9387920484287, "episode_reward_mean": -2734.4091366718662, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.5751057377984, "mean_raw_obs_processing_ms": 1.8644514149875417, "mean_inference_ms": 7.671677570225556, "mean_action_processing_ms": 0.23359299219613472}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 260000, "timers": {"sample_time_ms": 1106021.283, "sample_throughput": 3.617, "learn_time_ms": 16374.451, "learn_throughput": 244.283, "update_time_ms": 40.285}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.04305982269579545, "policy_loss": -0.07861405808944255, "vf_loss": 9671.760803222656, "vf_explained_var": 0.0, "kl": 0.01475768256932497, "entropy": 50.68836975097656, "entropy_coeff": 0.001}}, "num_steps_sampled": 260000, "num_steps_trained": 260000}, "done": false, "episodes_total": 260, "training_iteration": 65, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_23-07-40", "timestamp": 1617980860, "time_this_iter_s": 1107.6130771636963, "time_total_s": 102614.61816859245, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 16858.847410678864, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 11.871954314720814, "ram_util_percent": 15.200507614213198}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2877.9387920484287, "episode_reward_mean": -2736.45166810601, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.4537827628258, "mean_raw_obs_processing_ms": 1.8651030068223273, "mean_inference_ms": 7.670654465060228, "mean_action_processing_ms": 0.23371571039026784}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 264000, "timers": {"sample_time_ms": 1106215.822, "sample_throughput": 3.616, "learn_time_ms": 16352.663, "learn_throughput": 244.608, "update_time_ms": 38.354}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.03931191051378846, "policy_loss": -0.07987826515454799, "vf_loss": 9658.65478515625, "vf_explained_var": 7.450580596923828e-09, "kl": 0.014334431645693257, "entropy": 50.87152171134949, "entropy_coeff": 0.001}}, "num_steps_sampled": 264000, "num_steps_trained": 264000}, "done": false, "episodes_total": 264, "training_iteration": 66, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_23-26-14", "timestamp": 1617981974, "time_this_iter_s": 1113.880152463913, "time_total_s": 103728.49832105637, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 17972.727563142776, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 11.901197982345526, "ram_util_percent": 15.209962168978562}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2877.9387920484287, "episode_reward_mean": -2736.339273065291, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.3217835244562, "mean_raw_obs_processing_ms": 1.865893976020413, "mean_inference_ms": 7.670035662046509, "mean_action_processing_ms": 0.23369965168043388}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 268000, "timers": {"sample_time_ms": 1104981.013, "sample_throughput": 3.62, "learn_time_ms": 16385.5, "learn_throughput": 244.118, "update_time_ms": 40.071}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.04770232713781297, "policy_loss": -0.07296696523553692, "vf_loss": 9621.061981201172, "vf_explained_var": 7.450580596923828e-09, "kl": 0.014664587331935763, "entropy": 50.70878303050995, "entropy_coeff": 0.001}}, "num_steps_sampled": 268000, "num_steps_trained": 268000}, "done": false, "episodes_total": 268, "training_iteration": 67, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-09_23-44-44", "timestamp": 1617983084, "time_this_iter_s": 1109.8678650856018, "time_total_s": 104838.36618614197, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 19082.59542822838, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 11.866962025316456, "ram_util_percent": 15.199873417721516}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2877.9387920484287, "episode_reward_mean": -2740.0667517185097, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.2210972975681, "mean_raw_obs_processing_ms": 1.866439988133448, "mean_inference_ms": 7.668707534257717, "mean_action_processing_ms": 0.23378835122056862}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 272000, "timers": {"sample_time_ms": 1105572.634, "sample_throughput": 3.618, "learn_time_ms": 15799.062, "learn_throughput": 253.18, "update_time_ms": 38.543}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.04574544099159539, "policy_loss": -0.07565703702857718, "vf_loss": 9938.346282958984, "vf_explained_var": -7.450580596923828e-09, "kl": 0.014195801835739985, "entropy": 50.745548486709595, "entropy_coeff": 0.001}}, "num_steps_sampled": 272000, "num_steps_trained": 272000}, "done": false, "episodes_total": 272, "training_iteration": 68, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_00-03-29", "timestamp": 1617984209, "time_this_iter_s": 1124.6240231990814, "time_total_s": 105962.99020934105, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 20207.21945142746, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 11.875577763897564, "ram_util_percent": 15.207995003123049}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2877.9387920484287, "episode_reward_mean": -2737.862949085727, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.1498026378626, "mean_raw_obs_processing_ms": 1.8668752671473494, "mean_inference_ms": 7.667270442355879, "mean_action_processing_ms": 0.2339858822831228}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 276000, "timers": {"sample_time_ms": 1107682.384, "sample_throughput": 3.611, "learn_time_ms": 16224.633, "learn_throughput": 246.539, "update_time_ms": 43.238}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.028732433856930584, "policy_loss": -0.07980136637343094, "vf_loss": 8855.121994018555, "vf_explained_var": 1.1175870895385742e-08, "kl": 0.013878610858228058, "entropy": 51.15613389015198, "entropy_coeff": 0.001}}, "num_steps_sampled": 276000, "num_steps_trained": 276000}, "done": false, "episodes_total": 276, "training_iteration": 69, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_00-22-26", "timestamp": 1617985346, "time_this_iter_s": 1137.2809722423553, "time_total_s": 107100.2711815834, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 21344.500423669815, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 11.902285361334158, "ram_util_percent": 15.200555898702902}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2877.9387920484287, "episode_reward_mean": -2736.146853323721, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.0646092948543, "mean_raw_obs_processing_ms": 1.8674521908878083, "mean_inference_ms": 7.665881145186853, "mean_action_processing_ms": 0.2341004437818297}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 280000, "timers": {"sample_time_ms": 1102637.524, "sample_throughput": 3.628, "learn_time_ms": 16263.332, "learn_throughput": 245.952, "update_time_ms": 46.76}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.02776159267523326, "policy_loss": -0.07553508126875386, "vf_loss": 8309.934112548828, "vf_explained_var": 1.30385160446167e-08, "kl": 0.01390813136822544, "entropy": 51.09269857406616, "entropy_coeff": 0.001}}, "num_steps_sampled": 280000, "num_steps_trained": 280000}, "done": false, "episodes_total": 280, "training_iteration": 70, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_00-40-54", "timestamp": 1617986454, "time_this_iter_s": 1108.0723731517792, "time_total_s": 108208.34355473518, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 22452.572796821594, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 11.887698161065314, "ram_util_percent": 15.2}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2877.9387920484287, "episode_reward_mean": -2736.5299968681943, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 542.9748530353367, "mean_raw_obs_processing_ms": 1.8680329876104413, "mean_inference_ms": 7.664458033981491, "mean_action_processing_ms": 0.23426677939454624}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 284000, "timers": {"sample_time_ms": 1102491.44, "sample_throughput": 3.628, "learn_time_ms": 16229.516, "learn_throughput": 246.465, "update_time_ms": 45.802}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.03961066299234517, "policy_loss": -0.07177078473614529, "vf_loss": 9071.048431396484, "vf_explained_var": -1.862645149230957e-09, "kl": 0.013986086909426376, "entropy": 51.01864731311798, "entropy_coeff": 0.001}}, "num_steps_sampled": 284000, "num_steps_trained": 284000}, "done": false, "episodes_total": 284, "training_iteration": 71, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_00-59-25", "timestamp": 1617987565, "time_this_iter_s": 1110.9188604354858, "time_total_s": 109319.26241517067, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 23563.49165725708, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 11.895509171410499, "ram_util_percent": 15.205819101834281}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2877.9387920484287, "episode_reward_mean": -2736.580837827128, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 542.882649797805, "mean_raw_obs_processing_ms": 1.8685046082962868, "mean_inference_ms": 7.6628226341979335, "mean_action_processing_ms": 0.23442810898918962}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 288000, "timers": {"sample_time_ms": 1101708.238, "sample_throughput": 3.631, "learn_time_ms": 16303.75, "learn_throughput": 245.342, "update_time_ms": 43.802}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.031832046632189304, "policy_loss": -0.07444068166660145, "vf_loss": 8746.05386352539, "vf_explained_var": 1.1175870895385742e-08, "kl": 0.01363301943638362, "entropy": 51.06768083572388, "entropy_coeff": 0.001}}, "num_steps_sampled": 288000, "num_steps_trained": 288000}, "done": false, "episodes_total": 288, "training_iteration": 72, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_01-17-57", "timestamp": 1617988677, "time_this_iter_s": 1112.2000195980072, "time_total_s": 110431.46243476868, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 24675.691676855087, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 11.876689829437776, "ram_util_percent": 15.210170562223624}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2877.9387920484287, "episode_reward_mean": -2735.640038901686, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 542.8176339949467, "mean_raw_obs_processing_ms": 1.8690250049575292, "mean_inference_ms": 7.662024290490827, "mean_action_processing_ms": 0.23455598431183047}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 292000, "timers": {"sample_time_ms": 1104444.661, "sample_throughput": 3.622, "learn_time_ms": 16263.568, "learn_throughput": 245.948, "update_time_ms": 45.02}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.025350564217660576, "policy_loss": -0.0727484006783925, "vf_loss": 7888.398834228516, "vf_explained_var": 0.0, "kl": 0.013706764235394076, "entropy": 51.042895555496216, "entropy_coeff": 0.001}}, "num_steps_sampled": 292000, "num_steps_trained": 292000}, "done": false, "episodes_total": 292, "training_iteration": 73, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_01-36-59", "timestamp": 1617989819, "time_this_iter_s": 1141.83562374115, "time_total_s": 111573.29805850983, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 25817.527300596237, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 11.873493234932349, "ram_util_percent": 15.201476014760146}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2877.9387920484287, "episode_reward_mean": -2735.4421162101094, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 542.7522881254542, "mean_raw_obs_processing_ms": 1.8695269469718356, "mean_inference_ms": 7.660881862320292, "mean_action_processing_ms": 0.23460233511471854}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 296000, "timers": {"sample_time_ms": 1101767.157, "sample_throughput": 3.631, "learn_time_ms": 16326.113, "learn_throughput": 245.006, "update_time_ms": 45.319}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.029855996719561517, "policy_loss": -0.07115891612193082, "vf_loss": 8363.216766357422, "vf_explained_var": 1.862645149230957e-09, "kl": 0.013338889722945169, "entropy": 50.98947203159332, "entropy_coeff": 0.001}}, "num_steps_sampled": 296000, "num_steps_trained": 296000}, "done": false, "episodes_total": 296, "training_iteration": 74, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_01-55-35", "timestamp": 1617990935, "time_this_iter_s": 1115.2190947532654, "time_total_s": 112688.51715326309, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 26932.746395349503, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 11.904282115869018, "ram_util_percent": 15.201448362720399}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2910.7881775907745, "episode_reward_mean": -2734.747729580465, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2697.944525430676, -2800.686872833876, -2742.145937740138, -2730.5859392120196, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 542.6803463038536, "mean_raw_obs_processing_ms": 1.86992784647911, "mean_inference_ms": 7.659546070554622, "mean_action_processing_ms": 0.2345515026920048}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 300000, "timers": {"sample_time_ms": 1101689.592, "sample_throughput": 3.631, "learn_time_ms": 16300.172, "learn_throughput": 245.396, "update_time_ms": 45.137}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.027072799843153916, "policy_loss": -0.07054382708156481, "vf_loss": 8249.518737792969, "vf_explained_var": 0.0, "kl": 0.012875189713668078, "entropy": 50.873960971832275, "entropy_coeff": 0.001}}, "num_steps_sampled": 300000, "num_steps_trained": 300000}, "done": false, "episodes_total": 300, "training_iteration": 75, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_02-14-01", "timestamp": 1617992041, "time_this_iter_s": 1106.576533794403, "time_total_s": 113795.0936870575, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 28039.322929143906, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 11.891804320203304, "ram_util_percent": 15.201588310038119}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2910.7881775907745, "episode_reward_mean": -2733.4577326270937, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2696.8857827503484, -2709.334825577276, -2773.6352962141177, -2680.141273276858, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 542.0037528889764, "mean_raw_obs_processing_ms": 1.8704170612481923, "mean_inference_ms": 7.651618736005619, "mean_action_processing_ms": 0.23313640181085202}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 304000, "timers": {"sample_time_ms": 1101467.134, "sample_throughput": 3.632, "learn_time_ms": 16344.285, "learn_throughput": 244.734, "update_time_ms": 47.133}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.01080865680705756, "policy_loss": -0.08287248597480357, "vf_loss": 7690.106216430664, "vf_explained_var": 3.725290298461914e-09, "kl": 0.013257718033855781, "entropy": 51.176077365875244, "entropy_coeff": 0.001}}, "num_steps_sampled": 304000, "num_steps_trained": 304000}, "done": false, "episodes_total": 304, "training_iteration": 76, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_02-32-33", "timestamp": 1617993153, "time_this_iter_s": 1112.1182432174683, "time_total_s": 114907.21193027496, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 29151.441172361374, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 11.873910296904613, "ram_util_percent": 15.208843967150978}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2910.7881775907745, "episode_reward_mean": -2730.4160146485483, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2713.8460062835884, -2794.4949599965053, -2813.8868823978214, -2693.1542318814277, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.8451432285467, "mean_raw_obs_processing_ms": 1.8720893467067237, "mean_inference_ms": 7.648095383351595, "mean_action_processing_ms": 0.23279102202131738}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 308000, "timers": {"sample_time_ms": 1105039.87, "sample_throughput": 3.62, "learn_time_ms": 16306.363, "learn_throughput": 245.303, "update_time_ms": 46.182}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.003498238103929907, "policy_loss": -0.07792490848805755, "vf_loss": 6729.901275634766, "vf_explained_var": 7.450580596923828e-09, "kl": 0.012708844966255128, "entropy": 51.01861798763275, "entropy_coeff": 0.001}}, "num_steps_sampled": 308000, "num_steps_trained": 308000}, "done": false, "episodes_total": 308, "training_iteration": 77, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_02-51-39", "timestamp": 1617994299, "time_this_iter_s": 1145.1910862922668, "time_total_s": 116052.40301656723, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 30296.63225865364, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 11.899018404907975, "ram_util_percent": 15.202392638036807}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2910.7881775907745, "episode_reward_mean": -2728.8181132653413, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2807.909352637852, -2673.5005006152705, -2689.8136729943903, -2787.0765755650723, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.7930916427978, "mean_raw_obs_processing_ms": 1.8741840677303165, "mean_inference_ms": 7.645596180237721, "mean_action_processing_ms": 0.2323508712868029}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 312000, "timers": {"sample_time_ms": 1103066.397, "sample_throughput": 3.626, "learn_time_ms": 16938.424, "learn_throughput": 236.149, "update_time_ms": 45.918}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.023695523326750845, "policy_loss": -0.0679047150479164, "vf_loss": 7350.368072509766, "vf_explained_var": 1.1175870895385742e-08, "kl": 0.013474954554112628, "entropy": 50.97310721874237, "entropy_coeff": 0.001}}, "num_steps_sampled": 312000, "num_steps_trained": 312000}, "done": false, "episodes_total": 312, "training_iteration": 78, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_03-10-10", "timestamp": 1617995410, "time_this_iter_s": 1111.2071890830994, "time_total_s": 117163.61020565033, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 31407.83944773674, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 11.862010113780025, "ram_util_percent": 15.203919089759797}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2910.7881775907745, "episode_reward_mean": -2726.448141764299, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2611.545104136591, -2810.7272914134683, -2860.618710668252, -2721.818059203457, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.756784629798, "mean_raw_obs_processing_ms": 1.8759473280180743, "mean_inference_ms": 7.6450793738478104, "mean_action_processing_ms": 0.23243444731887655}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 316000, "timers": {"sample_time_ms": 1099715.935, "sample_throughput": 3.637, "learn_time_ms": 16974.745, "learn_throughput": 235.644, "update_time_ms": 41.052}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.010712995892390609, "policy_loss": -0.07802771852584556, "vf_loss": 7169.114212036133, "vf_explained_var": 7.450580596923828e-09, "kl": 0.013262769760331139, "entropy": 50.93248152732849, "entropy_coeff": 0.001}}, "num_steps_sampled": 316000, "num_steps_trained": 316000}, "done": false, "episodes_total": 316, "training_iteration": 79, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_03-28-34", "timestamp": 1617996514, "time_this_iter_s": 1104.078640460968, "time_total_s": 118267.6888461113, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 32511.918088197708, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 11.867493638676844, "ram_util_percent": 15.201463104325699}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2566.2140320740873, "episode_reward_min": -2910.7881775907745, "episode_reward_mean": -2724.545004526598, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2746.12913229671, -2818.2641282215723, -2566.2140320740873, -2808.0563191547217, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.6263047863891, "mean_raw_obs_processing_ms": 1.8760861945672405, "mean_inference_ms": 7.644585093008511, "mean_action_processing_ms": 0.23254467862679026}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 320000, "timers": {"sample_time_ms": 1100364.083, "sample_throughput": 3.635, "learn_time_ms": 16973.519, "learn_throughput": 235.661, "update_time_ms": 36.348}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.011275680677499622, "policy_loss": -0.07184040118590929, "vf_loss": 6968.995208740234, "vf_explained_var": 5.587935447692871e-09, "kl": 0.01247545296791941, "entropy": 50.520307540893555, "entropy_coeff": 0.001}}, "num_steps_sampled": 320000, "num_steps_trained": 320000}, "done": false, "episodes_total": 320, "training_iteration": 80, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_03-47-08", "timestamp": 1617997628, "time_this_iter_s": 1114.4738965034485, "time_total_s": 119382.16274261475, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 33626.39198470116, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 11.90957781978576, "ram_util_percent": 15.21039697542533}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2570.508443068517, "episode_reward_min": -2910.7881775907745, "episode_reward_mean": -2722.7209624853313, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2667.980472667205, -2738.9134068878357, -2759.7116808313162, -2670.0766078811766, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.5453778293174, "mean_raw_obs_processing_ms": 1.8761006863943146, "mean_inference_ms": 7.643357597980531, "mean_action_processing_ms": 0.23281803104562088}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 324000, "timers": {"sample_time_ms": 1101444.169, "sample_throughput": 3.632, "learn_time_ms": 16395.182, "learn_throughput": 243.974, "update_time_ms": 35.893}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.01254008786054328, "policy_loss": -0.07060406447271816, "vf_loss": 6983.299102783203, "vf_explained_var": 5.587935447692871e-09, "kl": 0.012484719918575138, "entropy": 50.68277657032013, "entropy_coeff": 0.001}}, "num_steps_sampled": 324000, "num_steps_trained": 324000}, "done": false, "episodes_total": 324, "training_iteration": 81, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_04-05-44", "timestamp": 1617998744, "time_this_iter_s": 1115.9315943717957, "time_total_s": 120498.09433698654, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 34742.32357907295, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 11.886091881686596, "ram_util_percent": 15.211202013845185}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2570.508443068517, "episode_reward_min": -2910.7881775907745, "episode_reward_mean": -2723.435953518964, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2785.6373052029144, -2748.7039889975367, -2769.104153258762, -2761.859785559925, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.49139347329, "mean_raw_obs_processing_ms": 1.8758292306640596, "mean_inference_ms": 7.643770970314788, "mean_action_processing_ms": 0.2328136326467957}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 328000, "timers": {"sample_time_ms": 1104589.124, "sample_throughput": 3.621, "learn_time_ms": 16351.363, "learn_throughput": 244.628, "update_time_ms": 35.934}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.0064597818127367646, "policy_loss": -0.07836386500275694, "vf_loss": 7134.005599975586, "vf_explained_var": 3.725290298461914e-09, "kl": 0.012472489092033356, "entropy": 50.447657108306885, "entropy_coeff": 0.001}}, "num_steps_sampled": 328000, "num_steps_trained": 328000}, "done": false, "episodes_total": 328, "training_iteration": 82, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_04-24-48", "timestamp": 1617999888, "time_this_iter_s": 1143.2118480205536, "time_total_s": 121641.3061850071, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 35885.535427093506, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 11.882667486170865, "ram_util_percent": 15.212108174554393}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2570.508443068517, "episode_reward_min": -2910.7881775907745, "episode_reward_mean": -2722.587704889949, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2650.7866233219424, -2733.162732038196, -2662.427633462682, -2690.276376475201, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.4378301772806, "mean_raw_obs_processing_ms": 1.875558400746258, "mean_inference_ms": 7.64440976630706, "mean_action_processing_ms": 0.23256015442793435}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 332000, "timers": {"sample_time_ms": 1101212.016, "sample_throughput": 3.632, "learn_time_ms": 16409.344, "learn_throughput": 243.764, "update_time_ms": 33.987}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.007647031801752746, "policy_loss": -0.07696230406872928, "vf_loss": 7034.764877319336, "vf_explained_var": 1.1175870895385742e-08, "kl": 0.012638112442800775, "entropy": 50.518505811691284, "entropy_coeff": 0.001}}, "num_steps_sampled": 332000, "num_steps_trained": 332000}, "done": false, "episodes_total": 332, "training_iteration": 83, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_04-43-16", "timestamp": 1618000996, "time_this_iter_s": 1108.624814748764, "time_total_s": 122749.93099975586, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 36994.16024184227, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 11.870234325522482, "ram_util_percent": 15.205129829005699}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2570.508443068517, "episode_reward_min": -2910.7881775907745, "episode_reward_mean": -2723.5753765213926, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2640.460403360026, -2701.7167593821946, -2786.8982286459586, -2635.4820862018687, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.3980415445457, "mean_raw_obs_processing_ms": 1.8753221444496067, "mean_inference_ms": 7.644457294024408, "mean_action_processing_ms": 0.2321978031782814}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 336000, "timers": {"sample_time_ms": 1101862.984, "sample_throughput": 3.63, "learn_time_ms": 16406.182, "learn_throughput": 243.811, "update_time_ms": 34.39}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.0018199094920419157, "policy_loss": -0.0819720544241136, "vf_loss": 6569.284774780273, "vf_explained_var": 7.450580596923828e-09, "kl": 0.012691637908574194, "entropy": 50.59525692462921, "entropy_coeff": 0.001}}, "num_steps_sampled": 336000, "num_steps_trained": 336000}, "done": false, "episodes_total": 336, "training_iteration": 84, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_05-01-58", "timestamp": 1618002118, "time_this_iter_s": 1121.7031059265137, "time_total_s": 123871.63410568237, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 38115.86334776878, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 11.862241703193488, "ram_util_percent": 15.201565435190979}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2570.508443068517, "episode_reward_min": -2910.7881775907745, "episode_reward_mean": -2724.5251446107604, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2771.433015991704, -2620.984105798835, -2786.0532494722797, -2742.3677264629378, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.2874898626702, "mean_raw_obs_processing_ms": 1.8752851434545053, "mean_inference_ms": 7.642554270604146, "mean_action_processing_ms": 0.23184500839212313}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 340000, "timers": {"sample_time_ms": 1102552.674, "sample_throughput": 3.628, "learn_time_ms": 16490.772, "learn_throughput": 242.56, "update_time_ms": 34.473}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.010544998134719208, "policy_loss": -0.06809873614110984, "vf_loss": 6462.695007324219, "vf_explained_var": 7.450580596923828e-09, "kl": 0.012552461354061961, "entropy": 50.324378967285156, "entropy_coeff": 0.001}}, "num_steps_sampled": 340000, "num_steps_trained": 340000}, "done": false, "episodes_total": 340, "training_iteration": 85, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_05-20-32", "timestamp": 1618003232, "time_this_iter_s": 1114.3201820850372, "time_total_s": 124985.95428776741, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 39230.18352985382, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 11.893698802772528, "ram_util_percent": 15.210207939508505}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2570.508443068517, "episode_reward_min": -2910.7881775907745, "episode_reward_mean": -2723.6250652645313, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2646.975344323075, -2716.505642595957, -2863.5216685534715, -2774.44254192743, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.2155191545637, "mean_raw_obs_processing_ms": 1.8746521604646225, "mean_inference_ms": 7.641020081133578, "mean_action_processing_ms": 0.2317078884620205}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 344000, "timers": {"sample_time_ms": 1105829.491, "sample_throughput": 3.617, "learn_time_ms": 16466.231, "learn_throughput": 242.921, "update_time_ms": 31.643}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.002612135256640613, "policy_loss": -0.07418876350857317, "vf_loss": 6434.1363525390625, "vf_explained_var": 7.450580596923828e-09, "kl": 0.012255675450433046, "entropy": 50.360373854637146, "entropy_coeff": 0.001}}, "num_steps_sampled": 344000, "num_steps_trained": 344000}, "done": false, "episodes_total": 344, "training_iteration": 86, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_05-39-37", "timestamp": 1618004377, "time_this_iter_s": 1144.6204299926758, "time_total_s": 126130.57471776009, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 40374.8039598465, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 11.865377532228361, "ram_util_percent": 15.206691221608347}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2570.508443068517, "episode_reward_min": -2910.7881775907745, "episode_reward_mean": -2723.661658898988, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2831.4898322498047, -2706.8400385328073, -2877.9387920484287, -2685.264873787269, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.1523598866604, "mean_raw_obs_processing_ms": 1.8745264128741044, "mean_inference_ms": 7.639953085683939, "mean_action_processing_ms": 0.2316175969726973}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 348000, "timers": {"sample_time_ms": 1103337.232, "sample_throughput": 3.625, "learn_time_ms": 16553.333, "learn_throughput": 241.643, "update_time_ms": 30.808}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.009227238071616739, "policy_loss": -0.0707144023035653, "vf_loss": 6840.615585327148, "vf_explained_var": 2.421438694000244e-08, "kl": 0.012096806021872908, "entropy": 50.47009086608887, "entropy_coeff": 0.001}}, "num_steps_sampled": 348000, "num_steps_trained": 348000}, "done": false, "episodes_total": 348, "training_iteration": 87, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_05-58-18", "timestamp": 1618005498, "time_this_iter_s": 1121.1310377120972, "time_total_s": 127251.70575547218, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 41495.934997558594, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 11.893984962406014, "ram_util_percent": 15.201503759398495}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2570.508443068517, "episode_reward_min": -2910.7881775907745, "episode_reward_mean": -2720.662977886046, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2699.2574860851705, -2680.839497066496, -2742.981005286395, -2839.622694436617, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.1072887787191, "mean_raw_obs_processing_ms": 1.8745778330064526, "mean_inference_ms": 7.6392293617344755, "mean_action_processing_ms": 0.23148265364033033}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 352000, "timers": {"sample_time_ms": 1103978.939, "sample_throughput": 3.623, "learn_time_ms": 16525.099, "learn_throughput": 242.056, "update_time_ms": 31.806}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.003852578578516841, "policy_loss": -0.07491218310315162, "vf_loss": 5782.431381225586, "vf_explained_var": 1.4901161193847656e-08, "kl": 0.012367964460281655, "entropy": 50.16018450260162, "entropy_coeff": 0.001}}, "num_steps_sampled": 352000, "num_steps_trained": 352000}, "done": false, "episodes_total": 352, "training_iteration": 88, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_06-16-56", "timestamp": 1618006616, "time_this_iter_s": 1117.3519594669342, "time_total_s": 128369.05771493912, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 42613.28695702553, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 11.890440251572329, "ram_util_percent": 15.216729559748426}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2570.508443068517, "episode_reward_min": -2910.7881775907745, "episode_reward_mean": -2717.88068657947, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2720.1144159895903, -2690.942831276173, -2726.6208630619317, -2788.7389186147448, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.0343113572173, "mean_raw_obs_processing_ms": 1.8748901300058662, "mean_inference_ms": 7.637283795414979, "mean_action_processing_ms": 0.23121306879072434}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 356000, "timers": {"sample_time_ms": 1104919.52, "sample_throughput": 3.62, "learn_time_ms": 16585.649, "learn_throughput": 241.172, "update_time_ms": 33.804}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.007958627305924892, "policy_loss": -0.07401249537360854, "vf_loss": 5640.133255004883, "vf_explained_var": 2.2351741790771484e-08, "kl": 0.011672676861053333, "entropy": 50.17904591560364, "entropy_coeff": 0.001}}, "num_steps_sampled": 356000, "num_steps_trained": 356000}, "done": false, "episodes_total": 356, "training_iteration": 89, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_06-35-30", "timestamp": 1618007730, "time_this_iter_s": 1114.1098074913025, "time_total_s": 129483.16752243042, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 43727.39676451683, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 11.876166456494325, "ram_util_percent": 15.210340479192936}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2570.508443068517, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2720.8356175582358, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2811.61167782255, -2744.9986165318846, -2761.8752595550914, -2749.873004563139, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 540.9990471348094, "mean_raw_obs_processing_ms": 1.8753028974402026, "mean_inference_ms": 7.636552279689872, "mean_action_processing_ms": 0.2310556824772069}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 360000, "timers": {"sample_time_ms": 1109262.515, "sample_throughput": 3.606, "learn_time_ms": 15981.902, "learn_throughput": 250.283, "update_time_ms": 33.998}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.005790759707451798, "policy_loss": -0.07602721499279141, "vf_loss": 6892.655410766602, "vf_explained_var": 1.862645149230957e-08, "kl": 0.012310975027503446, "entropy": 50.211942076683044, "entropy_coeff": 0.001}}, "num_steps_sampled": 360000, "num_steps_trained": 360000}, "done": false, "episodes_total": 360, "training_iteration": 90, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_06-54-42", "timestamp": 1618008882, "time_this_iter_s": 1151.8682844638824, "time_total_s": 130635.0358068943, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 44879.26504898071, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 12.08907870652837, "ram_util_percent": 15.221659548505185}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2570.508443068517, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2722.7782503743088, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.642409056373, -2724.4873602435623, -2678.0008657998615, -2777.0331745553385, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 540.9820163049916, "mean_raw_obs_processing_ms": 1.8752064254141478, "mean_inference_ms": 7.635792445315298, "mean_action_processing_ms": 0.23080572894004475}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 364000, "timers": {"sample_time_ms": 1110323.652, "sample_throughput": 3.603, "learn_time_ms": 16572.239, "learn_throughput": 241.368, "update_time_ms": 33.712}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": 0.003930713195586577, "policy_loss": -0.07451401109574363, "vf_loss": 6895.4637451171875, "vf_explained_var": 1.4901161193847656e-08, "kl": 0.011713021522155032, "entropy": 50.54829549789429, "entropy_coeff": 0.001}}, "num_steps_sampled": 364000, "num_steps_trained": 364000}, "done": false, "episodes_total": 364, "training_iteration": 91, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_07-13-34", "timestamp": 1618010014, "time_this_iter_s": 1132.4433844089508, "time_total_s": 131767.47919130325, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 46011.708433389664, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 11.614073155610663, "ram_util_percent": 15.206385616862987}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2570.508443068517, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2723.7591297429854, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2827.5461266229627, -2823.4900716131046, -2707.9572258637645, -2854.742131193115, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 540.9767600932635, "mean_raw_obs_processing_ms": 1.8749261170103408, "mean_inference_ms": 7.634752799700904, "mean_action_processing_ms": 0.2306124731591616}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 368000, "timers": {"sample_time_ms": 1107097.445, "sample_throughput": 3.613, "learn_time_ms": 16622.916, "learn_throughput": 240.632, "update_time_ms": 31.419}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.013131654093740508, "policy_loss": -0.0855883619224187, "vf_loss": 6237.027923583984, "vf_explained_var": 3.166496753692627e-08, "kl": 0.011800029285950586, "entropy": 50.39793860912323, "entropy_coeff": 0.001}}, "num_steps_sampled": 368000, "num_steps_trained": 368000}, "done": false, "episodes_total": 368, "training_iteration": 92, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_07-32-06", "timestamp": 1618011126, "time_this_iter_s": 1111.4427621364594, "time_total_s": 132878.9219534397, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 47123.15119552612, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 11.620922882427307, "ram_util_percent": 15.21630847029077}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2570.508443068517, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2718.916237856088, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2606.5847695991174, -2692.300000974741, -2700.241551165241, -2793.6516850434264, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 540.9665145811655, "mean_raw_obs_processing_ms": 1.8747483394284208, "mean_inference_ms": 7.634124736633326, "mean_action_processing_ms": 0.23034737061228533}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 372000, "timers": {"sample_time_ms": 1109886.422, "sample_throughput": 3.604, "learn_time_ms": 16670.349, "learn_throughput": 239.947, "update_time_ms": 30.561}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.008267986588180065, "policy_loss": -0.07091791252605617, "vf_loss": 5364.312393188477, "vf_explained_var": 2.7939677238464355e-08, "kl": 0.01160266573424451, "entropy": 50.46591913700104, "entropy_coeff": 0.001}}, "num_steps_sampled": 372000, "num_steps_trained": 372000}, "done": false, "episodes_total": 372, "training_iteration": 93, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_07-51-03", "timestamp": 1618012263, "time_this_iter_s": 1136.9805064201355, "time_total_s": 134015.90245985985, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 48260.13170194626, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 17.322805933250926, "ram_util_percent": 16.621446229913474}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2570.508443068517, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2718.0272940562795, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2735.2184978465784, -2687.596458436728, -2694.2238031705247, -2697.1253759286265, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 540.9473499793993, "mean_raw_obs_processing_ms": 1.8746117964616753, "mean_inference_ms": 7.633661950894603, "mean_action_processing_ms": 0.2299746412230634}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 376000, "timers": {"sample_time_ms": 1111059.629, "sample_throughput": 3.6, "learn_time_ms": 16703.874, "learn_throughput": 239.465, "update_time_ms": 31.866}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.010786991158965975, "policy_loss": -0.07421326087205671, "vf_loss": 5466.893280029297, "vf_explained_var": 2.2351741790771484e-08, "kl": 0.011489704716950655, "entropy": 50.13636612892151, "entropy_coeff": 0.001}}, "num_steps_sampled": 376000, "num_steps_trained": 376000}, "done": false, "episodes_total": 376, "training_iteration": 94, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_08-09-56", "timestamp": 1618013396, "time_this_iter_s": 1133.7817492485046, "time_total_s": 135149.68420910835, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 49393.91345119476, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 21.832403965303595, "ram_util_percent": 18.048636926889714}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2570.508443068517, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2719.3476920403405, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2697.648791200743, -2815.0085644669093, -2849.28861940615, -2614.8254959568476, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 540.9732573091825, "mean_raw_obs_processing_ms": 1.8744078994944215, "mean_inference_ms": 7.633586042324853, "mean_action_processing_ms": 0.22961622675642027}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 380000, "timers": {"sample_time_ms": 1118380.34, "sample_throughput": 3.577, "learn_time_ms": 16598.614, "learn_throughput": 240.984, "update_time_ms": 33.378}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01002595026511699, "policy_loss": -0.07641794945811853, "vf_loss": 5669.873306274414, "vf_explained_var": 3.166496753692627e-08, "kl": 0.011708356527378783, "entropy": 50.32120227813721, "entropy_coeff": 0.001}}, "num_steps_sampled": 380000, "num_steps_trained": 380000}, "done": false, "episodes_total": 380, "training_iteration": 95, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_08-29-43", "timestamp": 1618014583, "time_this_iter_s": 1186.5061371326447, "time_total_s": 136336.190346241, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 50580.41958832741, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 21.835701598579043, "ram_util_percent": 18.055476613380698}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2570.508443068517, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2718.3002073603257, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2776.430694679153, -2629.655562562359, -2737.1927955143797, -2807.3149391030547, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.0151786762856, "mean_raw_obs_processing_ms": 1.8742478563233993, "mean_inference_ms": 7.633707385026282, "mean_action_processing_ms": 0.22923682227001302}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 384000, "timers": {"sample_time_ms": 1117652.094, "sample_throughput": 3.579, "learn_time_ms": 16676.156, "learn_throughput": 239.863, "update_time_ms": 37.082}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.00914802830084227, "policy_loss": -0.07315122186264489, "vf_loss": 5600.106185913086, "vf_explained_var": 2.7939677238464355e-08, "kl": 0.011431333754444495, "entropy": 50.59237718582153, "entropy_coeff": 0.001}}, "num_steps_sampled": 384000, "num_steps_trained": 384000}, "done": false, "episodes_total": 384, "training_iteration": 96, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_08-48-41", "timestamp": 1618015721, "time_this_iter_s": 1138.141172170639, "time_total_s": 137474.33151841164, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 51718.56076049805, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 21.862037037037037, "ram_util_percent": 18.073765432098764}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2570.508443068517, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2715.822412819681, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2822.5321713749427, -2693.338578469457, -2699.888249305632, -2644.010851017727, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.0852089123078, "mean_raw_obs_processing_ms": 1.8741023285217164, "mean_inference_ms": 7.6340598644527855, "mean_action_processing_ms": 0.22886416709960267}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 388000, "timers": {"sample_time_ms": 1122509.35, "sample_throughput": 3.563, "learn_time_ms": 16647.067, "learn_throughput": 240.283, "update_time_ms": 37.549}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01583161047892645, "policy_loss": -0.07374162756605074, "vf_loss": 5023.2113037109375, "vf_explained_var": 4.284083843231201e-08, "kl": 0.011313895607599989, "entropy": 50.314648389816284, "entropy_coeff": 0.001}}, "num_steps_sampled": 388000, "num_steps_trained": 388000}, "done": false, "episodes_total": 388, "training_iteration": 97, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_09-08-11", "timestamp": 1618016891, "time_this_iter_s": 1169.4174427986145, "time_total_s": 138643.74896121025, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 52887.97820329666, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 20.871051051051055, "ram_util_percent": 17.91903903903904}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2570.508443068517, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2717.231345085458, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2742.4179672423184, -2753.7704013875364, -2727.598064773283, -2699.773143812315, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.13734776337, "mean_raw_obs_processing_ms": 1.8739227131171854, "mean_inference_ms": 7.633594631536369, "mean_action_processing_ms": 0.22849408015850917}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 392000, "timers": {"sample_time_ms": 1123276.274, "sample_throughput": 3.561, "learn_time_ms": 16691.785, "learn_throughput": 239.639, "update_time_ms": 37.124}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.016743208601837978, "policy_loss": -0.08107428345829248, "vf_loss": 5654.014312744141, "vf_explained_var": 2.60770320892334e-08, "kl": 0.011361102078808472, "entropy": 50.44358670711517, "entropy_coeff": 0.001}}, "num_steps_sampled": 392000, "num_steps_trained": 392000}, "done": false, "episodes_total": 392, "training_iteration": 98, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_09-26-56", "timestamp": 1618018016, "time_this_iter_s": 1125.4642884731293, "time_total_s": 139769.21324968338, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 54013.44249176979, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 12.596689569019365, "ram_util_percent": 15.362273579013122}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2570.508443068517, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2717.5055897079687, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2910.7881775907745, -2712.7612916104354, -2664.296552773273, -2584.4837799015286, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.2045561134225, "mean_raw_obs_processing_ms": 1.87374575149651, "mean_inference_ms": 7.633704723818694, "mean_action_processing_ms": 0.22819400347673185}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 396000, "timers": {"sample_time_ms": 1127156.567, "sample_throughput": 3.549, "learn_time_ms": 16637.142, "learn_throughput": 240.426, "update_time_ms": 36.169}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.005135526502272114, "policy_loss": -0.06978581423754804, "vf_loss": 5682.206771850586, "vf_explained_var": 3.3527612686157227e-08, "kl": 0.011366282065864652, "entropy": 50.43285274505615, "entropy_coeff": 0.001}}, "num_steps_sampled": 396000, "num_steps_trained": 396000}, "done": false, "episodes_total": 396, "training_iteration": 99, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_09-46-09", "timestamp": 1618019169, "time_this_iter_s": 1152.3566689491272, "time_total_s": 140921.5699186325, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 55165.79916071892, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 12.567276051188301, "ram_util_percent": 15.369165143205366}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2570.508443068517, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2719.495577705224, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2769.1523972931577, -2684.1384377769523, -2721.382513158322, -2667.690231651181, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.2820736571812, "mean_raw_obs_processing_ms": 1.8736007575337856, "mean_inference_ms": 7.634010244302033, "mean_action_processing_ms": 0.22793347619798537}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 400000, "timers": {"sample_time_ms": 1123449.657, "sample_throughput": 3.56, "learn_time_ms": 17263.395, "learn_throughput": 231.704, "update_time_ms": 37.523}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.002858986670617014, "policy_loss": -0.06339684312115423, "vf_loss": 5499.331314086914, "vf_explained_var": 3.166496753692627e-08, "kl": 0.010921399138169363, "entropy": 50.43615365028381, "entropy_coeff": 0.001}}, "num_steps_sampled": 400000, "num_steps_trained": 400000}, "done": false, "episodes_total": 400, "training_iteration": 100, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_10-04-50", "timestamp": 1618020290, "time_this_iter_s": 1121.0752398967743, "time_total_s": 142042.64515852928, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 56286.87440061569, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 12.514608150470217, "ram_util_percent": 15.377115987460819}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2570.508443068517, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2721.226422215945, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2656.1304196898213, -2570.508443068517, -2738.3803553807784, -2590.806161824958, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.3617433684199, "mean_raw_obs_processing_ms": 1.873532056357691, "mean_inference_ms": 7.633886718482526, "mean_action_processing_ms": 0.227720831298303}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 404000, "timers": {"sample_time_ms": 1121349.141, "sample_throughput": 3.567, "learn_time_ms": 17252.221, "learn_throughput": 231.854, "update_time_ms": 39.714}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.015407586586661637, "policy_loss": -0.0762859653623309, "vf_loss": 5446.740325927734, "vf_explained_var": 4.0978193283081055e-08, "kl": 0.011046581959817559, "entropy": 50.211381673812866, "entropy_coeff": 0.001}}, "num_steps_sampled": 404000, "num_steps_trained": 404000}, "done": false, "episodes_total": 404, "training_iteration": 101, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_10-23-21", "timestamp": 1618021401, "time_this_iter_s": 1111.348505973816, "time_total_s": 143153.9936645031, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 57398.22290658951, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 12.519089759797723, "ram_util_percent": 15.367572692793937}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2595.774676264516, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2726.1125962828664, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2634.4472650948605, -2741.6813950292044, -2718.0223089126853, -2761.4409732018607, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.4181250562816, "mean_raw_obs_processing_ms": 1.8734522302027075, "mean_inference_ms": 7.633503240909062, "mean_action_processing_ms": 0.2276111571472855}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 408000, "timers": {"sample_time_ms": 1121233.163, "sample_throughput": 3.568, "learn_time_ms": 17227.677, "learn_throughput": 232.185, "update_time_ms": 41.355}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.013201289577409625, "policy_loss": -0.07587294458062388, "vf_loss": 5562.161041259766, "vf_explained_var": 3.3527612686157227e-08, "kl": 0.011137995374156162, "entropy": 50.04087829589844, "entropy_coeff": 0.001}}, "num_steps_sampled": 408000, "num_steps_trained": 408000}, "done": false, "episodes_total": 408, "training_iteration": 102, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_10-41-51", "timestamp": 1618022511, "time_this_iter_s": 1110.0448200702667, "time_total_s": 144264.03848457336, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 58508.267726659775, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 12.518734177215189, "ram_util_percent": 15.36575949367089}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2595.774676264516, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2725.1610674721614, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2657.750252018907, -2622.473454661405, -2749.5772723175774, -2691.5019727104536, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.4863532450216, "mean_raw_obs_processing_ms": 1.87339862770367, "mean_inference_ms": 7.632945873938812, "mean_action_processing_ms": 0.22749878599335172}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 412000, "timers": {"sample_time_ms": 1121173.146, "sample_throughput": 3.568, "learn_time_ms": 16523.783, "learn_throughput": 242.075, "update_time_ms": 42.042}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.016844718455104157, "policy_loss": -0.07091211091028526, "vf_loss": 4665.706748962402, "vf_explained_var": 4.6566128730773926e-08, "kl": 0.011245442845392972, "entropy": 50.23134624958038, "entropy_coeff": 0.001}}, "num_steps_sampled": 412000, "num_steps_trained": 412000}, "done": false, "episodes_total": 412, "training_iteration": 103, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_11-00-41", "timestamp": 1618023641, "time_this_iter_s": 1129.3482031822205, "time_total_s": 145393.38668775558, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 59637.615929841995, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 12.563619402985076, "ram_util_percent": 15.370833333333337}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2595.774676264516, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2728.01176051394, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2631.2941988497023, -2697.279003308798, -2732.973004053947, -2752.8492354391888, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.5722515470534, "mean_raw_obs_processing_ms": 1.8735277663575371, "mean_inference_ms": 7.6325497693488735, "mean_action_processing_ms": 0.227443198237999}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 416000, "timers": {"sample_time_ms": 1121815.612, "sample_throughput": 3.566, "learn_time_ms": 16482.508, "learn_throughput": 242.682, "update_time_ms": 41.864}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01479244657093659, "policy_loss": -0.07816998605267145, "vf_loss": 5588.634246826172, "vf_explained_var": 1.4901161193847656e-08, "kl": 0.011247135495068505, "entropy": 50.15915393829346, "entropy_coeff": 0.001}}, "num_steps_sampled": 416000, "num_steps_trained": 416000}, "done": false, "episodes_total": 416, "training_iteration": 104, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_11-19-40", "timestamp": 1618024780, "time_this_iter_s": 1139.791674375534, "time_total_s": 146533.17836213112, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 60777.40760421753, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 12.565187923598277, "ram_util_percent": 15.375169439309925}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2595.774676264516, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2726.9922240620335, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2688.584295990437, -2673.142420386059, -2723.9479043168058, -2670.584786927156, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.6587924729844, "mean_raw_obs_processing_ms": 1.8737525004147724, "mean_inference_ms": 7.632589898354801, "mean_action_processing_ms": 0.22747085579560888}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 420000, "timers": {"sample_time_ms": 1114357.282, "sample_throughput": 3.59, "learn_time_ms": 16560.316, "learn_throughput": 241.541, "update_time_ms": 39.768}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02187060471624136, "policy_loss": -0.07685542263789102, "vf_loss": 4881.2498779296875, "vf_explained_var": 3.3527612686157227e-08, "kl": 0.011022315913578495, "entropy": 50.325650691986084, "entropy_coeff": 0.001}}, "num_steps_sampled": 420000, "num_steps_trained": 420000}, "done": false, "episodes_total": 420, "training_iteration": 105, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_11-38-13", "timestamp": 1618025893, "time_this_iter_s": 1112.6685173511505, "time_total_s": 147645.84687948227, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 61890.07612156868, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 12.608591282375238, "ram_util_percent": 15.375742261528744}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2595.774676264516, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2725.6380596135573, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2701.0099553852688, -2735.592983366747, -2735.3847430539845, -2736.1935898248075, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.7438709351035, "mean_raw_obs_processing_ms": 1.873969300280644, "mean_inference_ms": 7.632671877348554, "mean_action_processing_ms": 0.22750172422109763}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 424000, "timers": {"sample_time_ms": 1112475.591, "sample_throughput": 3.596, "learn_time_ms": 16488.091, "learn_throughput": 242.599, "update_time_ms": 41.635}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.010958990751532838, "policy_loss": -0.06503419461660087, "vf_loss": 4598.087249755859, "vf_explained_var": 3.5390257835388184e-08, "kl": 0.011417593690566719, "entropy": 50.42974817752838, "entropy_coeff": 0.001}}, "num_steps_sampled": 424000, "num_steps_trained": 424000}, "done": false, "episodes_total": 424, "training_iteration": 106, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_11-56-52", "timestamp": 1618027012, "time_this_iter_s": 1118.6205389499664, "time_total_s": 148764.46741843224, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 63008.696660518646, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 12.624607658505964, "ram_util_percent": 15.365787821720028}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2595.774676264516, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2723.7855276473497, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2697.2147618722574, -2730.0999668745276, -2796.3723689460194, -2756.793272424775, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.8124361683672, "mean_raw_obs_processing_ms": 1.8741834861900697, "mean_inference_ms": 7.632401345371688, "mean_action_processing_ms": 0.22749402066324204}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 428000, "timers": {"sample_time_ms": 1106960.6, "sample_throughput": 3.613, "learn_time_ms": 16511.075, "learn_throughput": 242.262, "update_time_ms": 42.284}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.024419064808171242, "policy_loss": -0.07687407627236098, "vf_loss": 4684.935729980469, "vf_explained_var": 1.862645149230957e-08, "kl": 0.010899558052187786, "entropy": 50.26309263706207, "entropy_coeff": 0.001}}, "num_steps_sampled": 428000, "num_steps_trained": 428000}, "done": false, "episodes_total": 428, "training_iteration": 107, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_12-15-26", "timestamp": 1618028126, "time_this_iter_s": 1114.5039594173431, "time_total_s": 149878.97137784958, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 64123.20061993599, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 12.82061790668348, "ram_util_percent": 15.358007566204291}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2595.774676264516, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2723.2045494335684, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2690.1704491034307, -2661.9919374374454, -2681.9013195927187, -2801.356822308782, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.8993421236942, "mean_raw_obs_processing_ms": 1.8743954941292895, "mean_inference_ms": 7.631904877721773, "mean_action_processing_ms": 0.22748295378239242}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 432000, "timers": {"sample_time_ms": 1109809.509, "sample_throughput": 3.604, "learn_time_ms": 16469.811, "learn_throughput": 242.869, "update_time_ms": 42.173}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01185231446288526, "policy_loss": -0.06761170318350196, "vf_loss": 5049.720359802246, "vf_explained_var": 3.91155481338501e-08, "kl": 0.010849583690287545, "entropy": 50.35040771961212, "entropy_coeff": 0.001}}, "num_steps_sampled": 432000, "num_steps_trained": 432000}, "done": false, "episodes_total": 432, "training_iteration": 108, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_12-34-40", "timestamp": 1618029280, "time_this_iter_s": 1153.5397236347198, "time_total_s": 151032.5111014843, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 65276.74034357071, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 12.710718635809988, "ram_util_percent": 15.38544457978076}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2595.774676264516, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2724.7575067165535, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2720.6430897238033, -2647.4369629537837, -2683.319803470827, -2808.13443037846, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 541.9839949892105, "mean_raw_obs_processing_ms": 1.8747525065113075, "mean_inference_ms": 7.631766585817079, "mean_action_processing_ms": 0.22750797308848902}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 436000, "timers": {"sample_time_ms": 1106520.721, "sample_throughput": 3.615, "learn_time_ms": 16495.357, "learn_throughput": 242.492, "update_time_ms": 41.109}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.021411052817711607, "policy_loss": -0.08023129697539844, "vf_loss": 5169.268707275391, "vf_explained_var": 3.166496753692627e-08, "kl": 0.011159684712765738, "entropy": 50.074540853500366, "entropy_coeff": 0.001}}, "num_steps_sampled": 436000, "num_steps_trained": 436000}, "done": false, "episodes_total": 436, "training_iteration": 109, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_12-53-20", "timestamp": 1618030400, "time_this_iter_s": 1119.7137265205383, "time_total_s": 152152.22482800484, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 66396.45407009125, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 12.617063989962357, "ram_util_percent": 15.382998745294861}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2595.774676264516, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2724.755122693074, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2744.7525205860125, -2717.0097238172857, -2630.6519028282237, -2738.416015871329, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 542.0809208410845, "mean_raw_obs_processing_ms": 1.874987156511598, "mean_inference_ms": 7.631834837977224, "mean_action_processing_ms": 0.22754485476167247}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 440000, "timers": {"sample_time_ms": 1109474.9, "sample_throughput": 3.605, "learn_time_ms": 16482.996, "learn_throughput": 242.674, "update_time_ms": 40.125}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.009249226131942123, "policy_loss": -0.0702622189419344, "vf_loss": 5361.442840576172, "vf_explained_var": 4.470348358154297e-08, "kl": 0.01124450794304721, "entropy": 50.23831784725189, "entropy_coeff": 0.001}}, "num_steps_sampled": 440000, "num_steps_trained": 440000}, "done": false, "episodes_total": 440, "training_iteration": 110, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_13-12-30", "timestamp": 1618031550, "time_this_iter_s": 1150.4841723442078, "time_total_s": 153302.70900034904, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 67546.93824243546, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 16.53089133089133, "ram_util_percent": 16.52490842490843}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2595.774676264516, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2725.6406307614675, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2741.065157803217, -2732.016812851417, -2723.176156987648, -2808.8464332033054, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 542.170923196152, "mean_raw_obs_processing_ms": 1.8752763652132844, "mean_inference_ms": 7.631811918538408, "mean_action_processing_ms": 0.22755852312054414}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 444000, "timers": {"sample_time_ms": 1112682.94, "sample_throughput": 3.595, "learn_time_ms": 16461.616, "learn_throughput": 242.99, "update_time_ms": 39.468}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.018874936416978016, "policy_loss": -0.07375069189583883, "vf_loss": 4948.188591003418, "vf_explained_var": 2.60770320892334e-08, "kl": 0.010796809248859063, "entropy": 49.94821000099182, "entropy_coeff": 0.001}}, "num_steps_sampled": 444000, "num_steps_trained": 444000}, "done": false, "episodes_total": 444, "training_iteration": 111, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_13-31-33", "timestamp": 1618032693, "time_this_iter_s": 1143.2084650993347, "time_total_s": 154445.91746544838, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 68690.14670753479, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 21.674861708666256, "ram_util_percent": 18.303380454824836}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2595.774676264516, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2725.270625493045, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2760.867828760898, -2683.288598802283, -2696.9768689531857, -2660.5321388077277, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 542.2772882093583, "mean_raw_obs_processing_ms": 1.8755613029690672, "mean_inference_ms": 7.631577183085031, "mean_action_processing_ms": 0.227630708036257}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 448000, "timers": {"sample_time_ms": 1119193.991, "sample_throughput": 3.574, "learn_time_ms": 15764.357, "learn_throughput": 253.737, "update_time_ms": 40.561}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.025857379398075864, "policy_loss": -0.0837274074438028, "vf_loss": 5150.1772537231445, "vf_explained_var": 1.30385160446167e-08, "kl": 0.011064022895880044, "entropy": 50.34350597858429, "entropy_coeff": 0.001}}, "num_steps_sampled": 448000, "num_steps_trained": 448000}, "done": false, "episodes_total": 448, "training_iteration": 112, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_13-51-02", "timestamp": 1618033862, "time_this_iter_s": 1168.1937811374664, "time_total_s": 155614.11124658585, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 69858.34048867226, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 21.694527961515334, "ram_util_percent": 18.287612748045703}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2595.774676264516, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2724.80158066637, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2708.9286368460394, -2651.2340508333714, -2682.215201671063, -2642.0936628666295, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 542.3981163866658, "mean_raw_obs_processing_ms": 1.8758935073670449, "mean_inference_ms": 7.631558815406372, "mean_action_processing_ms": 0.22771109008351137}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 452000, "timers": {"sample_time_ms": 1121892.285, "sample_throughput": 3.565, "learn_time_ms": 16420.326, "learn_throughput": 243.601, "update_time_ms": 41.145}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02015385846607387, "policy_loss": -0.07319111988181248, "vf_loss": 4655.836524963379, "vf_explained_var": 3.725290298461914e-09, "kl": 0.011089119361713529, "entropy": 50.36149764060974, "entropy_coeff": 0.001}}, "num_steps_sampled": 452000, "num_steps_trained": 452000}, "done": false, "episodes_total": 452, "training_iteration": 113, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_14-10-25", "timestamp": 1618035025, "time_this_iter_s": 1162.896677494049, "time_total_s": 156777.0079240799, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 71021.2371661663, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 21.74082125603865, "ram_util_percent": 18.281884057971016}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2595.774676264516, "episode_reward_min": -2927.617612158774, "episode_reward_mean": -2725.638557072176, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2927.617612158774, -2820.182487397573, -2747.7741955669017, -2726.335831695738, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 542.525194861387, "mean_raw_obs_processing_ms": 1.8762158522985637, "mean_inference_ms": 7.631684556820379, "mean_action_processing_ms": 0.22774289529540048}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 456000, "timers": {"sample_time_ms": 1121768.535, "sample_throughput": 3.566, "learn_time_ms": 16467.524, "learn_throughput": 242.902, "update_time_ms": 39.172}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.027648280403809622, "policy_loss": -0.08418807457201183, "vf_loss": 4969.851989746094, "vf_explained_var": 2.2351741790771484e-08, "kl": 0.01116500108037144, "entropy": 50.38807439804077, "entropy_coeff": 0.001}}, "num_steps_sampled": 456000, "num_steps_trained": 456000}, "done": false, "episodes_total": 456, "training_iteration": 114, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_14-29-24", "timestamp": 1618036164, "time_this_iter_s": 1139.0073940753937, "time_total_s": 157916.0153181553, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 72160.2445602417, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 21.526033312769894, "ram_util_percent": 18.258359037631088}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2595.774676264516, "episode_reward_min": -2889.936649090601, "episode_reward_mean": -2721.2043846822908, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2719.6611636161115, -2889.936649090601, -2885.634658914313, -2767.389368458926, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 542.6439737056398, "mean_raw_obs_processing_ms": 1.876561608910188, "mean_inference_ms": 7.631537857551644, "mean_action_processing_ms": 0.22782954617148957}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 460000, "timers": {"sample_time_ms": 1125981.873, "sample_throughput": 3.552, "learn_time_ms": 16456.581, "learn_throughput": 243.064, "update_time_ms": 39.239}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02374392218189314, "policy_loss": -0.074400607671123, "vf_loss": 4570.868560791016, "vf_explained_var": 1.862645149230957e-08, "kl": 0.01081527880160138, "entropy": 50.48875057697296, "entropy_coeff": 0.001}}, "num_steps_sampled": 460000, "num_steps_trained": 460000}, "done": false, "episodes_total": 460, "training_iteration": 115, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_14-48-38", "timestamp": 1618037318, "time_this_iter_s": 1154.6881458759308, "time_total_s": 159070.70346403122, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 73314.93270611763, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 20.888077858880777, "ram_util_percent": 18.167639902676402}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2595.774676264516, "episode_reward_min": -2836.037576951636, "episode_reward_mean": -2716.515811659856, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2758.7154179471195, -2739.560530631992, -2821.7139168430795, -2716.2618811006355, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 542.7571616892513, "mean_raw_obs_processing_ms": 1.8769140684075167, "mean_inference_ms": 7.631512761891736, "mean_action_processing_ms": 0.2278472310891914}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 464000, "timers": {"sample_time_ms": 1126900.386, "sample_throughput": 3.55, "learn_time_ms": 15832.551, "learn_throughput": 252.644, "update_time_ms": 34.047}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.016989466217637528, "policy_loss": -0.0700329533428885, "vf_loss": 4751.948257446289, "vf_explained_var": 1.862645149230957e-08, "kl": 0.01095751696266234, "entropy": 50.64182496070862, "entropy_coeff": 0.001}}, "num_steps_sampled": 464000, "num_steps_trained": 464000}, "done": false, "episodes_total": 464, "training_iteration": 116, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_15-07-20", "timestamp": 1618038440, "time_this_iter_s": 1121.513488292694, "time_total_s": 160192.2169523239, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 74436.44619441032, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 11.887844611528822, "ram_util_percent": 15.53627819548872}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2595.774676264516, "episode_reward_min": -2836.037576951636, "episode_reward_mean": -2713.5874090197535, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2685.1372194298765, -2653.0333099517206, -2673.035537316759, -2718.240299904909, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 542.8785098747317, "mean_raw_obs_processing_ms": 1.8773378259259514, "mean_inference_ms": 7.631468110495292, "mean_action_processing_ms": 0.2278833742764731}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 468000, "timers": {"sample_time_ms": 1129176.418, "sample_throughput": 3.542, "learn_time_ms": 15796.384, "learn_throughput": 253.223, "update_time_ms": 32.74}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.021445741411298513, "policy_loss": -0.07403242017608136, "vf_loss": 4831.1990966796875, "vf_explained_var": 7.450580596923828e-09, "kl": 0.010698838013922796, "entropy": 50.565207839012146, "entropy_coeff": 0.001}}, "num_steps_sampled": 468000, "num_steps_trained": 468000}, "done": false, "episodes_total": 468, "training_iteration": 117, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_15-26-17", "timestamp": 1618039577, "time_this_iter_s": 1136.8893992900848, "time_total_s": 161329.106351614, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 75573.33559370041, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 11.87726991970352, "ram_util_percent": 15.54126003705991}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2595.774676264516, "episode_reward_min": -2836.037576951636, "episode_reward_mean": -2717.0601694755424, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2629.3174206688127, -2742.3298452413947, -2689.875557288467, -2642.3608036029887, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 542.9878518663248, "mean_raw_obs_processing_ms": 1.8777739121059551, "mean_inference_ms": 7.63162641435568, "mean_action_processing_ms": 0.22788795774153564}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 472000, "timers": {"sample_time_ms": 1125248.055, "sample_throughput": 3.555, "learn_time_ms": 15858.646, "learn_throughput": 252.228, "update_time_ms": 31.947}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.018510416586650535, "policy_loss": -0.07877743826247752, "vf_loss": 5392.599014282227, "vf_explained_var": 7.450580596923828e-09, "kl": 0.011097496520960703, "entropy": 50.54230093955994, "entropy_coeff": 0.001}}, "num_steps_sampled": 472000, "num_steps_trained": 472000}, "done": false, "episodes_total": 472, "training_iteration": 118, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_15-44-52", "timestamp": 1618040692, "time_this_iter_s": 1114.900307416916, "time_total_s": 162444.0066590309, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 76688.23590111732, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 11.89042218021424, "ram_util_percent": 15.549842470069311}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2595.774676264516, "episode_reward_min": -2836.037576951636, "episode_reward_mean": -2717.923668201165, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2804.163056526743, -2754.3373321937524, -2707.351558017017, -2680.351987051085, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.089408580037, "mean_raw_obs_processing_ms": 1.8781674756901512, "mean_inference_ms": 7.631814733717781, "mean_action_processing_ms": 0.2278921928241541}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 476000, "timers": {"sample_time_ms": 1125201.076, "sample_throughput": 3.555, "learn_time_ms": 15839.549, "learn_throughput": 252.532, "update_time_ms": 34.896}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01518413401208818, "policy_loss": -0.06644049845635891, "vf_loss": 4802.150047302246, "vf_explained_var": 5.587935447692871e-09, "kl": 0.010501467681024224, "entropy": 50.59335899353027, "entropy_coeff": 0.001}}, "num_steps_sampled": 476000, "num_steps_trained": 476000}, "done": false, "episodes_total": 476, "training_iteration": 119, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_16-03-31", "timestamp": 1618041811, "time_this_iter_s": 1119.0824575424194, "time_total_s": 163563.08911657333, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 77807.31835865974, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 11.901632140615193, "ram_util_percent": 15.555053358443187}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2595.774676264516, "episode_reward_min": -2836.037576951636, "episode_reward_mean": -2717.2962929449423, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2711.3484452749935, -2728.862304537994, -2595.774676264516, -2836.037576951636, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.1578738800463, "mean_raw_obs_processing_ms": 1.8784651478965742, "mean_inference_ms": 7.631714220052602, "mean_action_processing_ms": 0.2279429821027824}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 480000, "timers": {"sample_time_ms": 1121414.638, "sample_throughput": 3.567, "learn_time_ms": 15880.269, "learn_throughput": 251.885, "update_time_ms": 35.177}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02333762642228976, "policy_loss": -0.07605922941002063, "vf_loss": 4934.197471618652, "vf_explained_var": 1.862645149230957e-08, "kl": 0.010478781623532996, "entropy": 50.33230781555176, "entropy_coeff": 0.001}}, "num_steps_sampled": 480000, "num_steps_trained": 480000}, "done": false, "episodes_total": 480, "training_iteration": 120, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_16-22-04", "timestamp": 1618042924, "time_this_iter_s": 1113.0293214321136, "time_total_s": 164676.11843800545, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 78920.34768009186, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 11.898738170347004, "ram_util_percent": 15.55552050473186}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2602.941050421245, "episode_reward_min": -2822.6056368488435, "episode_reward_mean": -2716.6832070454134, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2711.454408338787, -2673.825334691529, -2670.5927872914986, -2646.9420074726904, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.2251705095907, "mean_raw_obs_processing_ms": 1.8786744884467215, "mean_inference_ms": 7.631699986483784, "mean_action_processing_ms": 0.22795872148483182}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 484000, "timers": {"sample_time_ms": 1121561.724, "sample_throughput": 3.566, "learn_time_ms": 15879.275, "learn_throughput": 251.901, "update_time_ms": 33.361}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.024031288470723666, "policy_loss": -0.07255217217607424, "vf_loss": 4563.778175354004, "vf_explained_var": -1.862645149230957e-09, "kl": 0.010407692170701921, "entropy": 50.46444547176361, "entropy_coeff": 0.001}}, "num_steps_sampled": 484000, "num_steps_trained": 484000}, "done": false, "episodes_total": 484, "training_iteration": 121, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_16-41-09", "timestamp": 1618044069, "time_this_iter_s": 1144.651295185089, "time_total_s": 165820.76973319054, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 80064.99897527695, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 11.897237569060772, "ram_util_percent": 15.548127685696743}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2592.914601533088, "episode_reward_min": -2822.6056368488435, "episode_reward_mean": -2717.641655589381, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2680.02968759357, -2774.983229630488, -2799.660383333804, -2745.9897761876005, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.2691823497953, "mean_raw_obs_processing_ms": 1.8788901793442054, "mean_inference_ms": 7.631698572036678, "mean_action_processing_ms": 0.22795400347519645}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 488000, "timers": {"sample_time_ms": 1115118.891, "sample_throughput": 3.587, "learn_time_ms": 16548.717, "learn_throughput": 241.711, "update_time_ms": 32.589}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.023157954768976197, "policy_loss": -0.07650078478036448, "vf_loss": 4919.581497192383, "vf_explained_var": 0.0, "kl": 0.010659763793228194, "entropy": 50.492592573165894, "entropy_coeff": 0.001}}, "num_steps_sampled": 488000, "num_steps_trained": 488000}, "done": false, "episodes_total": 488, "training_iteration": 122, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_16-59-39", "timestamp": 1618045179, "time_this_iter_s": 1110.4520869255066, "time_total_s": 166931.22182011604, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 81175.45106220245, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 11.89126582278481, "ram_util_percent": 15.55411392405063}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2592.914601533088, "episode_reward_min": -2847.4466824282213, "episode_reward_mean": -2718.167746883561, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2806.577126088855, -2686.6519972022325, -2635.1492793265384, -2822.6056368488435, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.3171931475023, "mean_raw_obs_processing_ms": 1.8790085965875016, "mean_inference_ms": 7.631876170138782, "mean_action_processing_ms": 0.2279788056625603}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 492000, "timers": {"sample_time_ms": 1113006.702, "sample_throughput": 3.594, "learn_time_ms": 16533.086, "learn_throughput": 241.939, "update_time_ms": 31.311}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.015267103386577219, "policy_loss": -0.06997783912811428, "vf_loss": 5190.177131652832, "vf_explained_var": 2.7939677238464355e-08, "kl": 0.010432822105940431, "entropy": 50.667394399642944, "entropy_coeff": 0.001}}, "num_steps_sampled": 492000, "num_steps_trained": 492000}, "done": false, "episodes_total": 492, "training_iteration": 123, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_17-18-41", "timestamp": 1618046321, "time_this_iter_s": 1141.605899810791, "time_total_s": 168072.82771992683, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 82317.05696201324, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 15.289292307692307, "ram_util_percent": 16.347015384615382}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2592.914601533088, "episode_reward_min": -2847.4466824282213, "episode_reward_mean": -2716.415688970327, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2776.881342298425, -2756.039592505844, -2761.740961837905, -2776.666704959377, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.3657107281545, "mean_raw_obs_processing_ms": 1.8790940034378871, "mean_inference_ms": 7.631825295317787, "mean_action_processing_ms": 0.22799388995892556}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 496000, "timers": {"sample_time_ms": 1115575.255, "sample_throughput": 3.586, "learn_time_ms": 16484.925, "learn_throughput": 242.646, "update_time_ms": 32.903}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.020262552570784464, "policy_loss": -0.06749238743213937, "vf_loss": 4468.091720581055, "vf_explained_var": 1.4901161193847656e-08, "kl": 0.010383998393081129, "entropy": 50.67718267440796, "entropy_coeff": 0.001}}, "num_steps_sampled": 496000, "num_steps_trained": 496000}, "done": false, "episodes_total": 496, "training_iteration": 124, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_17-38-05", "timestamp": 1618047485, "time_this_iter_s": 1164.2263734340668, "time_total_s": 169237.0540933609, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 83481.28333544731, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 23.36996381182147, "ram_util_percent": 19.547889022919186}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2592.914601533088, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2715.7784722183233, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2773.743013813639, -2801.842521194098, -2690.002456299358, -2749.8600396446095, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.4337494148909, "mean_raw_obs_processing_ms": 1.879226889365399, "mean_inference_ms": 7.632016982785233, "mean_action_processing_ms": 0.22809986582906852}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 500000, "timers": {"sample_time_ms": 1119845.633, "sample_throughput": 3.572, "learn_time_ms": 15836.849, "learn_throughput": 252.575, "update_time_ms": 31.768}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.014295547764049843, "policy_loss": -0.070466450357344, "vf_loss": 5187.446891784668, "vf_explained_var": 1.862645149230957e-09, "kl": 0.010737933946074918, "entropy": 50.74386012554169, "entropy_coeff": 0.001}}, "num_steps_sampled": 500000, "num_steps_trained": 500000}, "done": false, "episodes_total": 500, "training_iteration": 125, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_17-57-56", "timestamp": 1618048676, "time_this_iter_s": 1190.9000482559204, "time_total_s": 170427.95414161682, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 84672.18338370323, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 23.30873156342183, "ram_util_percent": 19.297935103244843}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2547.2058155701534, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2713.024495353269, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2714.5475363212768, -2768.856970559561, -2754.0933356430824, -2806.944944132312, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.5219310445767, "mean_raw_obs_processing_ms": 1.8793569607515719, "mean_inference_ms": 7.632393646793871, "mean_action_processing_ms": 0.22823151309208328}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 504000, "timers": {"sample_time_ms": 1125734.071, "sample_throughput": 3.553, "learn_time_ms": 16478.589, "learn_throughput": 242.739, "update_time_ms": 32.371}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.022504332882817835, "policy_loss": -0.07138462486909702, "vf_loss": 4545.096336364746, "vf_explained_var": -1.862645149230957e-09, "kl": 0.01052563390112482, "entropy": 50.52276349067688, "entropy_coeff": 0.001}}, "num_steps_sampled": 504000, "num_steps_trained": 504000}, "done": false, "episodes_total": 504, "training_iteration": 126, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_18-17-43", "timestamp": 1618049863, "time_this_iter_s": 1186.8213982582092, "time_total_s": 171614.77553987503, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 85859.00478196144, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 23.269508584961514, "ram_util_percent": 19.28981645944346}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2547.2058155701534, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2710.1658656786826, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2655.3166830228506, -2687.043152381282, -2718.7720131912542, -2699.307212572685, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.6197562252487, "mean_raw_obs_processing_ms": 1.8794966202565058, "mean_inference_ms": 7.632936830781977, "mean_action_processing_ms": 0.22835784674163634}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 508000, "timers": {"sample_time_ms": 1126672.573, "sample_throughput": 3.55, "learn_time_ms": 16929.32, "learn_throughput": 236.276, "update_time_ms": 33.033}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.021102028622408397, "policy_loss": -0.0729566535592312, "vf_loss": 4976.8458251953125, "vf_explained_var": 1.4901161193847656e-08, "kl": 0.010266720200888813, "entropy": 50.5387886762619, "entropy_coeff": 0.001}}, "num_steps_sampled": 508000, "num_steps_trained": 508000}, "done": false, "episodes_total": 508, "training_iteration": 127, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_18-36-54", "timestamp": 1618051014, "time_this_iter_s": 1150.7907257080078, "time_total_s": 172765.56626558304, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 87009.79550766945, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 23.113239780353872, "ram_util_percent": 19.305979255643688}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2547.2058155701534, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2712.4597984149586, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2812.700181320671, -2690.7695211985942, -2787.4017658506705, -2715.500787516305, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.7232820766446, "mean_raw_obs_processing_ms": 1.879670854406085, "mean_inference_ms": 7.6336076561837265, "mean_action_processing_ms": 0.22853508548351104}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 512000, "timers": {"sample_time_ms": 1132247.408, "sample_throughput": 3.533, "learn_time_ms": 17058.724, "learn_throughput": 234.484, "update_time_ms": 33.388}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.023259099514689296, "policy_loss": -0.07536498546687653, "vf_loss": 4688.247215270996, "vf_explained_var": -7.450580596923828e-09, "kl": 0.010862868541153148, "entropy": 50.45726537704468, "entropy_coeff": 0.001}}, "num_steps_sampled": 512000, "num_steps_trained": 512000}, "done": false, "episodes_total": 512, "training_iteration": 128, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_18-56-26", "timestamp": 1618052186, "time_this_iter_s": 1171.916519165039, "time_total_s": 173937.48278474808, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 88181.71202683449, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 22.89586330935252, "ram_util_percent": 19.31145083932854}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2547.2058155701534, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2709.080107989064, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2704.8939083381265, -2679.749586718517, -2662.002503253313, -2665.795798151012, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.8282990938991, "mean_raw_obs_processing_ms": 1.8797841497367471, "mean_inference_ms": 7.634634973671326, "mean_action_processing_ms": 0.22870822497697652}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 516000, "timers": {"sample_time_ms": 1135629.365, "sample_throughput": 3.522, "learn_time_ms": 16457.404, "learn_throughput": 243.052, "update_time_ms": 29.538}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.025706367508973926, "policy_loss": -0.07369111076695845, "vf_loss": 4424.465316772461, "vf_explained_var": -1.862645149230957e-09, "kl": 0.010565954318735749, "entropy": 50.41867470741272, "entropy_coeff": 0.001}}, "num_steps_sampled": 516000, "num_steps_trained": 516000}, "done": false, "episodes_total": 516, "training_iteration": 129, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_19-15-32", "timestamp": 1618053332, "time_this_iter_s": 1146.8504757881165, "time_total_s": 175084.3332605362, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 89328.5625026226, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 15.491181873851806, "ram_util_percent": 17.24023270055113}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2547.2058155701534, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2709.216882988863, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2611.0848568635374, -2666.1657240645936, -2677.677021648777, -2665.915360195975, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 543.9449846199603, "mean_raw_obs_processing_ms": 1.879979911981848, "mean_inference_ms": 7.635733114383979, "mean_action_processing_ms": 0.22892621691608986}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 520000, "timers": {"sample_time_ms": 1140556.228, "sample_throughput": 3.507, "learn_time_ms": 16416.984, "learn_throughput": 243.65, "update_time_ms": 29.992}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.027605224662693217, "policy_loss": -0.07776983722578734, "vf_loss": 4661.724143981934, "vf_explained_var": -5.587935447692871e-09, "kl": 0.01048876458662562, "entropy": 50.21573519706726, "entropy_coeff": 0.001}}, "num_steps_sampled": 520000, "num_steps_trained": 520000}, "done": false, "episodes_total": 520, "training_iteration": 130, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_19-34-54", "timestamp": 1618054494, "time_this_iter_s": 1161.8982174396515, "time_total_s": 176246.23147797585, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 90490.46072006226, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 14.279201934703748, "ram_util_percent": 16.628355501813783}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2547.2058155701534, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2710.3807589827466, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2704.853698917262, -2708.8902542096994, -2641.1483526543348, -2668.035769228671, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.0666510683499, "mean_raw_obs_processing_ms": 1.8802495223342226, "mean_inference_ms": 7.6370108966289605, "mean_action_processing_ms": 0.2291382510310086}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 524000, "timers": {"sample_time_ms": 1140358.421, "sample_throughput": 3.508, "learn_time_ms": 16537.666, "learn_throughput": 241.872, "update_time_ms": 30.645}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02415615861536935, "policy_loss": -0.07775335246697068, "vf_loss": 4990.145606994629, "vf_explained_var": -9.313225746154785e-09, "kl": 0.0105640918482095, "entropy": 50.453484416007996, "entropy_coeff": 0.001}}, "num_steps_sampled": 524000, "num_steps_trained": 524000}, "done": false, "episodes_total": 524, "training_iteration": 131, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_19-53-58", "timestamp": 1618055638, "time_this_iter_s": 1143.891270160675, "time_total_s": 177390.12274813652, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 91634.35199022293, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 22.141707616707613, "ram_util_percent": 19.412837837837838}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2547.2058155701534, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2710.2015943023307, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2761.3764264867414, -2797.396610301581, -2689.46370796713, -2674.1458039840186, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.1977920177785, "mean_raw_obs_processing_ms": 1.8804635618182233, "mean_inference_ms": 7.63831839348878, "mean_action_processing_ms": 0.2293246049499887}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 528000, "timers": {"sample_time_ms": 1144926.641, "sample_throughput": 3.494, "learn_time_ms": 16779.094, "learn_throughput": 238.392, "update_time_ms": 31.349}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01954790120362304, "policy_loss": -0.06890568864764646, "vf_loss": 4700.93058013916, "vf_explained_var": -1.862645149230957e-09, "kl": 0.010344229493057355, "entropy": 50.673774003982544, "entropy_coeff": 0.001}}, "num_steps_sampled": 528000, "num_steps_trained": 528000}, "done": false, "episodes_total": 528, "training_iteration": 132, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_20-13-17", "timestamp": 1618056797, "time_this_iter_s": 1158.5679025650024, "time_total_s": 178548.69065070152, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 92792.91989278793, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 23.046606060606063, "ram_util_percent": 19.473515151515155}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2547.2058155701534, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2709.2208578888412, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2812.590420935109, -2799.8102750830435, -2665.0648709539146, -2713.250689768776, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.3250524217285, "mean_raw_obs_processing_ms": 1.8806150725927069, "mean_inference_ms": 7.639753962717611, "mean_action_processing_ms": 0.2295225550264519}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 532000, "timers": {"sample_time_ms": 1146414.188, "sample_throughput": 3.489, "learn_time_ms": 16713.801, "learn_throughput": 239.323, "update_time_ms": 36.202}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01840482364059426, "policy_loss": -0.06900135107571259, "vf_loss": 4759.9278564453125, "vf_explained_var": 1.1175870895385742e-08, "kl": 0.01038039507693611, "entropy": 50.2103796005249, "entropy_coeff": 0.001}}, "num_steps_sampled": 532000, "num_steps_trained": 532000}, "done": false, "episodes_total": 532, "training_iteration": 133, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_20-32-33", "timestamp": 1618057953, "time_this_iter_s": 1155.8814039230347, "time_total_s": 179704.57205462456, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 93948.80129671097, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 22.956899696048637, "ram_util_percent": 19.507963525835866}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2547.2058155701534, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2706.891210681295, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2660.9301580128076, -2681.2621827194203, -2738.434636496826, -2778.668906949894, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.4725582558337, "mean_raw_obs_processing_ms": 1.8807842201911302, "mean_inference_ms": 7.641465756339736, "mean_action_processing_ms": 0.22974059598882998}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 536000, "timers": {"sample_time_ms": 1150593.629, "sample_throughput": 3.476, "learn_time_ms": 16696.41, "learn_throughput": 239.572, "update_time_ms": 34.557}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.013371897570323199, "policy_loss": -0.06358120136428624, "vf_loss": 4631.909446716309, "vf_explained_var": 3.725290298461914e-09, "kl": 0.010624487942550331, "entropy": 50.568586587905884, "entropy_coeff": 0.001}}, "num_steps_sampled": 536000, "num_steps_trained": 536000}, "done": false, "episodes_total": 536, "training_iteration": 134, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_20-52-39", "timestamp": 1618059159, "time_this_iter_s": 1205.8303818702698, "time_total_s": 180910.40243649483, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 95154.63167858124, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 22.917239370995922, "ram_util_percent": 19.501514269073965}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2547.2058155701534, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2704.2889569000713, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2776.6576589086676, -2715.8850095777198, -2754.120397789924, -2672.717903665939, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.6180371502204, "mean_raw_obs_processing_ms": 1.880996101037628, "mean_inference_ms": 7.643285159450578, "mean_action_processing_ms": 0.22989317081019411}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 540000, "timers": {"sample_time_ms": 1147184.036, "sample_throughput": 3.487, "learn_time_ms": 17402.185, "learn_throughput": 229.856, "update_time_ms": 33.543}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.016203883453272283, "policy_loss": -0.06700823415303603, "vf_loss": 4777.489334106445, "vf_explained_var": -1.6763806343078613e-08, "kl": 0.010401063365861773, "entropy": 50.28411555290222, "entropy_coeff": 0.001}}, "num_steps_sampled": 540000, "num_steps_trained": 540000}, "done": false, "episodes_total": 540, "training_iteration": 135, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_21-12-03", "timestamp": 1618060323, "time_this_iter_s": 1163.876017332077, "time_total_s": 182074.2784538269, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 96318.50769591331, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 22.955823777911892, "ram_util_percent": 19.497163548581774}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2547.2058155701534, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2701.6082739241097, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2708.7425005945884, -2714.189379653697, -2796.101085486853, -2749.0710682680874, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.763374499445, "mean_raw_obs_processing_ms": 1.8811658368304427, "mean_inference_ms": 7.6450113456774895, "mean_action_processing_ms": 0.22998441956194685}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 544000, "timers": {"sample_time_ms": 1144412.79, "sample_throughput": 3.495, "learn_time_ms": 17420.949, "learn_throughput": 229.609, "update_time_ms": 34.407}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01575678723747842, "policy_loss": -0.0660390065604588, "vf_loss": 4795.577713012695, "vf_explained_var": 1.30385160446167e-08, "kl": 0.010301222442649305, "entropy": 50.47536373138428, "entropy_coeff": 0.001}}, "num_steps_sampled": 544000, "num_steps_trained": 544000}, "done": false, "episodes_total": 544, "training_iteration": 136, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_21-31-22", "timestamp": 1618061482, "time_this_iter_s": 1159.3053345680237, "time_total_s": 183233.58378839493, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 97477.81303048134, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 22.495878787878787, "ram_util_percent": 19.523575757575756}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2547.2058155701534, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2699.1528307064214, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2633.997076965942, -2696.981255270296, -2670.997067007512, -2752.7855534128707, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.8932989201397, "mean_raw_obs_processing_ms": 1.8813388605660908, "mean_inference_ms": 7.646737242068228, "mean_action_processing_ms": 0.2300332227264989}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 548000, "timers": {"sample_time_ms": 1142837.809, "sample_throughput": 3.5, "learn_time_ms": 17030.173, "learn_throughput": 234.877, "update_time_ms": 33.516}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.011994968765066005, "policy_loss": -0.06513319580699317, "vf_loss": 4888.415061950684, "vf_explained_var": 3.725290298461914e-09, "kl": 0.01067640885594301, "entropy": 50.470855474472046, "entropy_coeff": 0.001}}, "num_steps_sampled": 548000, "num_steps_trained": 548000}, "done": false, "episodes_total": 548, "training_iteration": 137, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_21-50-13", "timestamp": 1618062613, "time_this_iter_s": 1131.1235926151276, "time_total_s": 184364.70738101006, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 98608.93662309647, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 15.001490683229814, "ram_util_percent": 17.304968944099375}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2547.2058155701534, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2700.1041986157215, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2625.3321081829795, -2760.50926774827, -2687.9408750914035, -2694.386941775073, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.0246146690126, "mean_raw_obs_processing_ms": 1.8815116199183628, "mean_inference_ms": 7.648569024783351, "mean_action_processing_ms": 0.2300721559200008}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 552000, "timers": {"sample_time_ms": 1144851.646, "sample_throughput": 3.494, "learn_time_ms": 16867.936, "learn_throughput": 237.136, "update_time_ms": 32.846}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.013699024158995599, "policy_loss": -0.06756075890734792, "vf_loss": 4926.882476806641, "vf_explained_var": -5.587935447692871e-09, "kl": 0.010788846062496305, "entropy": 50.708348870277405, "entropy_coeff": 0.001}}, "num_steps_sampled": 552000, "num_steps_trained": 552000}, "done": false, "episodes_total": 552, "training_iteration": 138, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_22-10-04", "timestamp": 1618063804, "time_this_iter_s": 1190.425831079483, "time_total_s": 185555.13321208954, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 99799.36245417595, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 19.794982290436838, "ram_util_percent": 18.75165289256198}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2547.2058155701534, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2699.1602381970665, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2715.920629193082, -2758.820824134371, -2654.092914605514, -2649.6585198974303, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.1627310560757, "mean_raw_obs_processing_ms": 1.8816865735394999, "mean_inference_ms": 7.650397287510178, "mean_action_processing_ms": 0.23013866976262956}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 556000, "timers": {"sample_time_ms": 1147455.444, "sample_throughput": 3.486, "learn_time_ms": 17530.461, "learn_throughput": 228.174, "update_time_ms": 36.499}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01700087168137543, "policy_loss": -0.06461832992499694, "vf_loss": 4503.896011352539, "vf_explained_var": 3.725290298461914e-09, "kl": 0.010383311775512993, "entropy": 50.64407980442047, "entropy_coeff": 0.001}}, "num_steps_sampled": 556000, "num_steps_trained": 556000}, "done": false, "episodes_total": 556, "training_iteration": 139, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_22-29-43", "timestamp": 1618064983, "time_this_iter_s": 1179.5500073432922, "time_total_s": 186734.68321943283, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 100978.91246151924, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 22.868254913639074, "ram_util_percent": 19.518344252531264}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2547.2058155701534, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2698.27849028413, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2652.6302435010048, -2602.941050421245, -2725.642574400494, -2812.55066951383, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.301865712355, "mean_raw_obs_processing_ms": 1.8817742877207664, "mean_inference_ms": 7.652169824296268, "mean_action_processing_ms": 0.23017797702296833}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 560000, "timers": {"sample_time_ms": 1148924.384, "sample_throughput": 3.482, "learn_time_ms": 17575.96, "learn_throughput": 227.584, "update_time_ms": 36.06}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.009287294407840818, "policy_loss": -0.061241062212502584, "vf_loss": 4833.470794677734, "vf_explained_var": 7.450580596923828e-09, "kl": 0.01053582294844091, "entropy": 50.385262846946716, "entropy_coeff": 0.001}}, "num_steps_sampled": 560000, "num_steps_trained": 560000}, "done": false, "episodes_total": 560, "training_iteration": 140, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_22-49-20", "timestamp": 1618066160, "time_this_iter_s": 1177.0382251739502, "time_total_s": 187911.72144460678, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 102155.95068669319, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 23.046507462686566, "ram_util_percent": 19.57229850746268}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2696.610337362196, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2694.162209012823, -2700.270072325342, -2658.7022055595285, -2690.276995614895, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.4444677997928, "mean_raw_obs_processing_ms": 1.88191710412578, "mean_inference_ms": 7.654101518307166, "mean_action_processing_ms": 0.23025041211889125}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 564000, "timers": {"sample_time_ms": 1149722.893, "sample_throughput": 3.479, "learn_time_ms": 17460.096, "learn_throughput": 229.094, "update_time_ms": 34.837}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.0193676911003422, "policy_loss": -0.06772252063819906, "vf_loss": 4684.081039428711, "vf_explained_var": -2.421438694000244e-08, "kl": 0.010129832429811358, "entropy": 50.40928065776825, "entropy_coeff": 0.001}}, "num_steps_sampled": 564000, "num_steps_trained": 564000}, "done": false, "episodes_total": 564, "training_iteration": 141, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_23-08-31", "timestamp": 1618067311, "time_this_iter_s": 1150.7008032798767, "time_total_s": 189062.42224788666, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 103306.65148997307, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 22.996947496947495, "ram_util_percent": 19.570024420024417}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2696.185174853716, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2813.8430382712636, -2700.124052778571, -2820.9083101390893, -2741.847010993195, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.6040967261764, "mean_raw_obs_processing_ms": 1.8820247721492545, "mean_inference_ms": 7.656389499153451, "mean_action_processing_ms": 0.23034129672880932}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 568000, "timers": {"sample_time_ms": 1157266.887, "sample_throughput": 3.456, "learn_time_ms": 16600.637, "learn_throughput": 240.955, "update_time_ms": 32.803}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02132031603832729, "policy_loss": -0.06881945618079044, "vf_loss": 4577.895202636719, "vf_explained_var": -1.862645149230957e-09, "kl": 0.010132637224160135, "entropy": 50.21749234199524, "entropy_coeff": 0.001}}, "num_steps_sampled": 568000, "num_steps_trained": 568000}, "done": false, "episodes_total": 568, "training_iteration": 142, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_23-28-56", "timestamp": 1618068536, "time_this_iter_s": 1225.380897283554, "time_total_s": 190287.8031451702, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 104532.03238725662, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 23.051777522935783, "ram_util_percent": 19.573509174311926}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2692.2857280284243, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2725.256980809034, -2640.6765398536368, -2778.042100455373, -2646.2578782458827, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.778251684911, "mean_raw_obs_processing_ms": 1.882127888909407, "mean_inference_ms": 7.658651165669446, "mean_action_processing_ms": 0.23046554488022017}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 572000, "timers": {"sample_time_ms": 1159578.008, "sample_throughput": 3.45, "learn_time_ms": 16815.195, "learn_throughput": 237.88, "update_time_ms": 31.042}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02620209741871804, "policy_loss": -0.07146481319796294, "vf_loss": 4303.054641723633, "vf_explained_var": -1.862645149230957e-09, "kl": 0.010328632721211761, "entropy": 50.71014082431793, "entropy_coeff": 0.001}}, "num_steps_sampled": 572000, "num_steps_trained": 572000}, "done": false, "episodes_total": 572, "training_iteration": 143, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-10_23-48-37", "timestamp": 1618069717, "time_this_iter_s": 1181.116174697876, "time_total_s": 191468.9193198681, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 105713.1485619545, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 22.46448542534206, "ram_util_percent": 19.59131469363474}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2689.458607373225, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2803.3224042981738, -2632.994822954728, -2697.0229787585527, -2750.126202154862, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.9519092770598, "mean_raw_obs_processing_ms": 1.8822654961000131, "mean_inference_ms": 7.661005193840987, "mean_action_processing_ms": 0.23064185057753014}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 576000, "timers": {"sample_time_ms": 1151400.226, "sample_throughput": 3.474, "learn_time_ms": 16531.54, "learn_throughput": 241.962, "update_time_ms": 32.101}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02162096934625879, "policy_loss": -0.0649022253928706, "vf_loss": 4238.1917724609375, "vf_explained_var": -3.725290298461914e-09, "kl": 0.010057692503323779, "entropy": 50.65418303012848, "entropy_coeff": 0.001}}, "num_steps_sampled": 576000, "num_steps_trained": 576000}, "done": false, "episodes_total": 576, "training_iteration": 144, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_00-07-19", "timestamp": 1618070839, "time_this_iter_s": 1121.2266294956207, "time_total_s": 192590.1459493637, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 106834.37519145012, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 13.681026925485284, "ram_util_percent": 16.932561051972456}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2689.3533042899217, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2706.5502852342374, -2676.9212006930898, -2725.8263890270687, -2701.4165381219227, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.1279470598045, "mean_raw_obs_processing_ms": 1.8824040569757425, "mean_inference_ms": 7.6632892917886855, "mean_action_processing_ms": 0.2308010297079912}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 580000, "timers": {"sample_time_ms": 1147538.173, "sample_throughput": 3.486, "learn_time_ms": 16433.637, "learn_throughput": 243.403, "update_time_ms": 34.673}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.016793231014162302, "policy_loss": -0.06673864484764636, "vf_loss": 4811.533348083496, "vf_explained_var": -1.1175870895385742e-08, "kl": 0.010177894058870152, "entropy": 50.3395721912384, "entropy_coeff": 0.001}}, "num_steps_sampled": 580000, "num_steps_trained": 580000}, "done": false, "episodes_total": 580, "training_iteration": 145, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_00-26-03", "timestamp": 1618071963, "time_this_iter_s": 1124.2787897586823, "time_total_s": 193714.4247391224, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 107958.6539812088, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 13.264250000000002, "ram_util_percent": 16.629500000000004}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2689.4888917142466, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2789.861659737995, -2592.914601533088, -2710.1307610750423, -2705.752369845136, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.2946360733787, "mean_raw_obs_processing_ms": 1.8825599828648905, "mean_inference_ms": 7.665325666430863, "mean_action_processing_ms": 0.23094896331382764}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 584000, "timers": {"sample_time_ms": 1142874.686, "sample_throughput": 3.5, "learn_time_ms": 16201.191, "learn_throughput": 246.895, "update_time_ms": 38.782}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.014220717479474843, "policy_loss": -0.06695378049334977, "vf_loss": 5050.476333618164, "vf_explained_var": -9.313225746154785e-09, "kl": 0.010325093840947375, "entropy": 50.69586634635925, "entropy_coeff": 0.001}}, "num_steps_sampled": 584000, "num_steps_trained": 584000}, "done": false, "episodes_total": 584, "training_iteration": 146, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_00-44-33", "timestamp": 1618073073, "time_this_iter_s": 1110.3869004249573, "time_total_s": 194824.81163954735, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 109069.04088163376, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 11.609113924050634, "ram_util_percent": 15.818354430379749}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2688.005719737946, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2847.4466824282213, -2773.5591155440543, -2681.3877452412326, -2750.8786629498777, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.4673410021346, "mean_raw_obs_processing_ms": 1.8827639848977982, "mean_inference_ms": 7.667493078113266, "mean_action_processing_ms": 0.23108793835555042}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 588000, "timers": {"sample_time_ms": 1144275.641, "sample_throughput": 3.496, "learn_time_ms": 16112.64, "learn_throughput": 248.252, "update_time_ms": 41.372}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.011239549436140805, "policy_loss": -0.06393212964758277, "vf_loss": 4953.151916503906, "vf_explained_var": -1.862645149230957e-08, "kl": 0.010476096911588684, "entropy": 50.53711760044098, "entropy_coeff": 0.001}}, "num_steps_sampled": 588000, "num_steps_trained": 588000}, "done": false, "episodes_total": 588, "training_iteration": 147, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_01-03-38", "timestamp": 1618074218, "time_this_iter_s": 1144.2765369415283, "time_total_s": 195969.08817648888, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 110213.31741857529, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 11.591405770411296, "ram_util_percent": 15.813812154696135}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2684.282121895737, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2741.8894142916383, -2658.2713187633994, -2734.9396074083934, -2640.67790767961, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.630387054676, "mean_raw_obs_processing_ms": 1.8829917239564145, "mean_inference_ms": 7.669471931964543, "mean_action_processing_ms": 0.23119259961680597}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 592000, "timers": {"sample_time_ms": 1135834.487, "sample_throughput": 3.522, "learn_time_ms": 16130.466, "learn_throughput": 247.978, "update_time_ms": 42.331}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.013039184443186969, "policy_loss": -0.06240651599364355, "vf_loss": 4731.059761047363, "vf_explained_var": -1.6763806343078613e-08, "kl": 0.010283732670359313, "entropy": 50.65542662143707, "entropy_coeff": 0.001}}, "num_steps_sampled": 592000, "num_steps_trained": 592000}, "done": false, "episodes_total": 592, "training_iteration": 148, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_01-22-04", "timestamp": 1618075324, "time_this_iter_s": 1106.2021446228027, "time_total_s": 197075.29032111168, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 111319.51956319809, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 11.592312579415504, "ram_util_percent": 15.817979669631514}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2881.413912853516, "episode_reward_mean": -2684.381313395803, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2762.7908373515575, -2675.135370228646, -2688.266805967452, -2881.413912853516, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.777506246103, "mean_raw_obs_processing_ms": 1.8832173203564373, "mean_inference_ms": 7.671369088096866, "mean_action_processing_ms": 0.23130387810828532}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 596000, "timers": {"sample_time_ms": 1128544.701, "sample_throughput": 3.544, "learn_time_ms": 16054.668, "learn_throughput": 249.149, "update_time_ms": 41.165}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01909063127823174, "policy_loss": -0.06955505610676482, "vf_loss": 4932.698799133301, "vf_explained_var": -7.450580596923828e-09, "kl": 0.010092254116898403, "entropy": 50.5932457447052, "entropy_coeff": 0.001}}, "num_steps_sampled": 596000, "num_steps_trained": 596000}, "done": false, "episodes_total": 596, "training_iteration": 149, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_01-40-30", "timestamp": 1618076430, "time_this_iter_s": 1105.8826832771301, "time_total_s": 198181.1730043888, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 112425.40224647522, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 11.602858958068616, "ram_util_percent": 15.81620076238882}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2867.4182585335666, "episode_reward_mean": -2681.065425432482, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2658.3831717988655, -2755.3417325885953, -2547.2058155701534, -2779.119624488653, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.900344720742, "mean_raw_obs_processing_ms": 1.8834586361062526, "mean_inference_ms": 7.673063025982928, "mean_action_processing_ms": 0.23136751212146017}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 600000, "timers": {"sample_time_ms": 1121335.331, "sample_throughput": 3.567, "learn_time_ms": 16029.212, "learn_throughput": 249.544, "update_time_ms": 42.385}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.019885785412043333, "policy_loss": -0.0673652985424269, "vf_loss": 4550.315872192383, "vf_explained_var": -3.725290298461914e-09, "kl": 0.010239119088510051, "entropy": 50.50712275505066, "entropy_coeff": 0.001}}, "num_steps_sampled": 600000, "num_steps_trained": 600000}, "done": false, "episodes_total": 600, "training_iteration": 150, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_01-58-55", "timestamp": 1618077535, "time_this_iter_s": 1104.7022230625153, "time_total_s": 199285.87522745132, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 113530.10446953773, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 11.591481246026701, "ram_util_percent": 15.813413858868406}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2867.4182585335666, "episode_reward_mean": -2679.1435104009, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2786.0160225561567, -2662.3292221198026, -2683.8313169511343, -2626.4032575705464, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.0093370198665, "mean_raw_obs_processing_ms": 1.8836691392619491, "mean_inference_ms": 7.674751885751098, "mean_action_processing_ms": 0.2313990503451572}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 604000, "timers": {"sample_time_ms": 1120322.733, "sample_throughput": 3.57, "learn_time_ms": 16034.046, "learn_throughput": 249.469, "update_time_ms": 41.931}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.03044277452863753, "policy_loss": -0.078611185279442, "vf_loss": 4681.205215454102, "vf_explained_var": -3.725290298461914e-09, "kl": 0.010119507467607036, "entropy": 50.51401937007904, "entropy_coeff": 0.001}}, "num_steps_sampled": 604000, "num_steps_trained": 604000}, "done": false, "episodes_total": 604, "training_iteration": 151, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_02-17-55", "timestamp": 1618078675, "time_this_iter_s": 1140.6184525489807, "time_total_s": 200426.4936800003, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 114670.72292208672, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 11.594211822660098, "ram_util_percent": 15.816687192118229}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2867.4182585335666, "episode_reward_mean": -2678.2471615142877, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2766.48706256221, -2775.9883130344006, -2730.843259549692, -2716.513699649397, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.1093188292302, "mean_raw_obs_processing_ms": 1.8838315560569605, "mean_inference_ms": 7.6763705137174405, "mean_action_processing_ms": 0.23142008160069494}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 608000, "timers": {"sample_time_ms": 1108066.453, "sample_throughput": 3.61, "learn_time_ms": 16675.329, "learn_throughput": 239.875, "update_time_ms": 45.264}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.016679061358445324, "policy_loss": -0.06594628666061908, "vf_loss": 4844.614532470703, "vf_explained_var": 3.725290298461914e-09, "kl": 0.010013106104452163, "entropy": 50.50390541553497, "entropy_coeff": 0.001}}, "num_steps_sampled": 608000, "num_steps_trained": 608000}, "done": false, "episodes_total": 608, "training_iteration": 152, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_02-36-25", "timestamp": 1618079785, "time_this_iter_s": 1109.2638432979584, "time_total_s": 201535.75752329826, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 115779.98676538467, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 11.57534854245881, "ram_util_percent": 15.808681875792146}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2867.4182585335666, "episode_reward_mean": -2674.6253325363105, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2625.9642741106254, -2669.088455878416, -2652.362066401881, -2720.9884169058187, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.1953122175701, "mean_raw_obs_processing_ms": 1.8839508006875951, "mean_inference_ms": 7.677864696594803, "mean_action_processing_ms": 0.23141054897633906}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 612000, "timers": {"sample_time_ms": 1101794.511, "sample_throughput": 3.63, "learn_time_ms": 16481.288, "learn_throughput": 242.699, "update_time_ms": 43.116}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.015379160351585597, "policy_loss": -0.0617009021807462, "vf_loss": 4633.036079406738, "vf_explained_var": 9.313225746154785e-09, "kl": 0.009862850740319118, "entropy": 50.56342840194702, "entropy_coeff": 0.001}}, "num_steps_sampled": 612000, "num_steps_trained": 612000}, "done": false, "episodes_total": 612, "training_iteration": 153, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_02-55-01", "timestamp": 1618080901, "time_this_iter_s": 1116.4347066879272, "time_total_s": 202652.1922299862, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 116896.4214720726, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 11.589175582127123, "ram_util_percent": 15.82190056639396}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2867.4182585335666, "episode_reward_mean": -2673.8375009129113, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2684.5471824072406, -2717.992479491069, -2684.446235831325, -2639.1333987112803, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.2710284607665, "mean_raw_obs_processing_ms": 1.8841078543677292, "mean_inference_ms": 7.679046005054178, "mean_action_processing_ms": 0.23139565438659407}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 616000, "timers": {"sample_time_ms": 1100374.544, "sample_throughput": 3.635, "learn_time_ms": 16787.778, "learn_throughput": 238.269, "update_time_ms": 42.658}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02525215626519639, "policy_loss": -0.07367302756756544, "vf_loss": 4581.622268676758, "vf_explained_var": -3.725290298461914e-09, "kl": 0.010403407359262928, "entropy": 50.72093975543976, "entropy_coeff": 0.001}}, "num_steps_sampled": 616000, "num_steps_trained": 616000}, "done": false, "episodes_total": 616, "training_iteration": 154, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_03-13-31", "timestamp": 1618082011, "time_this_iter_s": 1110.0888924598694, "time_total_s": 203762.28112244606, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 118006.51036453247, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 11.589746835443039, "ram_util_percent": 15.81715189873418}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2867.4182585335666, "episode_reward_mean": -2671.2586359635684, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2681.5780736210736, -2677.033655293479, -2696.692006123988, -2681.926827122758, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.3371766118988, "mean_raw_obs_processing_ms": 1.8841332245967246, "mean_inference_ms": 7.6799857496885355, "mean_action_processing_ms": 0.2313504169985564}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 620000, "timers": {"sample_time_ms": 1099742.733, "sample_throughput": 3.637, "learn_time_ms": 16199.314, "learn_throughput": 246.924, "update_time_ms": 40.639}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02521345260902308, "policy_loss": -0.07141326414421201, "vf_loss": 4587.194885253906, "vf_explained_var": -5.587935447692871e-09, "kl": 0.009917336661601439, "entropy": 50.50622856616974, "entropy_coeff": 0.001}}, "num_steps_sampled": 620000, "num_steps_trained": 620000}, "done": false, "episodes_total": 620, "training_iteration": 155, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_03-32-03", "timestamp": 1618083123, "time_this_iter_s": 1112.0547754764557, "time_total_s": 204874.33589792252, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 119118.56514000893, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 11.580669614655715, "ram_util_percent": 15.819583070120027}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2867.4182585335666, "episode_reward_mean": -2669.915588839984, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2730.8849906866, -2663.0538154588744, -2670.476487406545, -2640.596313416307, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.4000839448252, "mean_raw_obs_processing_ms": 1.884176423255259, "mean_inference_ms": 7.680775845681123, "mean_action_processing_ms": 0.23129428215928732}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 624000, "timers": {"sample_time_ms": 1102085.435, "sample_throughput": 3.629, "learn_time_ms": 16352.735, "learn_throughput": 244.607, "update_time_ms": 35.807}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.021979518642183393, "policy_loss": -0.06797112681670114, "vf_loss": 4615.4873046875, "vf_explained_var": -5.587935447692871e-09, "kl": 0.009855642740149051, "entropy": 50.681130051612854, "entropy_coeff": 0.001}}, "num_steps_sampled": 624000, "num_steps_trained": 624000}, "done": false, "episodes_total": 624, "training_iteration": 156, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_03-50-59", "timestamp": 1618084259, "time_this_iter_s": 1135.2998430728912, "time_total_s": 206009.6357409954, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 120253.86498308182, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 11.596722325293754, "ram_util_percent": 15.816883116883117}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2867.4182585335666, "episode_reward_mean": -2669.3328012025927, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2747.9744780801975, -2627.7041896789356, -2733.535038725561, -2715.0952009058483, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.4517942299562, "mean_raw_obs_processing_ms": 1.8841836639685272, "mean_inference_ms": 7.681468507470149, "mean_action_processing_ms": 0.23125999045300527}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 628000, "timers": {"sample_time_ms": 1098252.089, "sample_throughput": 3.642, "learn_time_ms": 16436.275, "learn_throughput": 243.364, "update_time_ms": 37.506}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.021334113174816594, "policy_loss": -0.06976053272956051, "vf_loss": 4660.148986816406, "vf_explained_var": -1.862645149230957e-09, "kl": 0.010213115921942517, "entropy": 50.52526497840881, "entropy_coeff": 0.001}}, "num_steps_sampled": 628000, "num_steps_trained": 628000}, "done": false, "episodes_total": 628, "training_iteration": 157, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_04-09-25", "timestamp": 1618085365, "time_this_iter_s": 1106.790990114212, "time_total_s": 207116.42673110962, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 121360.65597319603, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 11.597525380710659, "ram_util_percent": 15.811928934010155}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2867.4182585335666, "episode_reward_mean": -2666.508513703573, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2649.2395347207125, -2657.4417543090553, -2742.6778236036253, -2708.392423352789, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.492431728473, "mean_raw_obs_processing_ms": 1.884236829692622, "mean_inference_ms": 7.6819795522348375, "mean_action_processing_ms": 0.2312173614468016}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 632000, "timers": {"sample_time_ms": 1098395.032, "sample_throughput": 3.642, "learn_time_ms": 16396.032, "learn_throughput": 243.961, "update_time_ms": 39.937}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.015636851865565404, "policy_loss": -0.06089713022811338, "vf_loss": 4441.77864074707, "vf_explained_var": 9.313225746154785e-09, "kl": 0.010055754013592377, "entropy": 50.70109832286835, "entropy_coeff": 0.001}}, "num_steps_sampled": 632000, "num_steps_trained": 632000}, "done": false, "episodes_total": 632, "training_iteration": 158, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_04-27-53", "timestamp": 1618086473, "time_this_iter_s": 1107.2535631656647, "time_total_s": 208223.68029427528, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 122467.9095363617, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 11.589593908629439, "ram_util_percent": 15.809073604060917}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2867.4182585335666, "episode_reward_mean": -2664.8755305279406, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2661.0079416978206, -2604.486139715078, -2742.44884239699, -2591.127582246737, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.5105007669282, "mean_raw_obs_processing_ms": 1.8842399727463934, "mean_inference_ms": 7.682020380851343, "mean_action_processing_ms": 0.23111826788238882}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 636000, "timers": {"sample_time_ms": 1098179.694, "sample_throughput": 3.642, "learn_time_ms": 16483.165, "learn_throughput": 242.672, "update_time_ms": 39.028}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.027528219274245203, "policy_loss": -0.07484165468486026, "vf_loss": 4574.201095581055, "vf_explained_var": -7.450580596923828e-09, "kl": 0.010177732940064743, "entropy": 50.59739947319031, "entropy_coeff": 0.001}}, "num_steps_sampled": 636000, "num_steps_trained": 636000}, "done": false, "episodes_total": 636, "training_iteration": 159, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_04-46-17", "timestamp": 1618087577, "time_this_iter_s": 1104.5960688591003, "time_total_s": 209328.27636313438, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 123572.5056052208, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 11.609535918626827, "ram_util_percent": 15.821106166560716}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2867.4182585335666, "episode_reward_mean": -2664.839027688702, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2676.028837534986, -2645.150852227233, -2680.8764291650223, -2649.2565534187656, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.5233724676182, "mean_raw_obs_processing_ms": 1.8842293907706678, "mean_inference_ms": 7.68209920018042, "mean_action_processing_ms": 0.23102529633196944}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 640000, "timers": {"sample_time_ms": 1102186.28, "sample_throughput": 3.629, "learn_time_ms": 16443.089, "learn_throughput": 243.263, "update_time_ms": 38.018}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.015235129307257012, "policy_loss": -0.06548174924682826, "vf_loss": 4872.164215087891, "vf_explained_var": 9.313225746154785e-09, "kl": 0.010192968882620335, "entropy": 50.72194504737854, "entropy_coeff": 0.001}}, "num_steps_sampled": 640000, "num_steps_trained": 640000}, "done": false, "episodes_total": 640, "training_iteration": 160, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_05-05-22", "timestamp": 1618088722, "time_this_iter_s": 1144.3570182323456, "time_total_s": 210472.63338136673, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 124716.86262345314, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 11.594413750767341, "ram_util_percent": 15.817065684469004}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2867.4182585335666, "episode_reward_mean": -2665.51816434353, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2705.3321227587635, -2740.768824475268, -2711.6651472149506, -2564.793617785515, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.5272290770527, "mean_raw_obs_processing_ms": 1.884229369227952, "mean_inference_ms": 7.682286306796759, "mean_action_processing_ms": 0.23090650381476532}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 644000, "timers": {"sample_time_ms": 1099905.375, "sample_throughput": 3.637, "learn_time_ms": 16474.719, "learn_throughput": 242.796, "update_time_ms": 37.798}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.013153579493518919, "policy_loss": -0.06566331131034531, "vf_loss": 4806.254409790039, "vf_explained_var": 0.0, "kl": 0.010690161754610017, "entropy": 50.34823226928711, "entropy_coeff": 0.001}}, "num_steps_sampled": 644000, "num_steps_trained": 644000}, "done": false, "episodes_total": 644, "training_iteration": 161, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_05-24-00", "timestamp": 1618089840, "time_this_iter_s": 1118.123521566391, "time_total_s": 211590.75690293312, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 125834.98614501953, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 11.910873664362034, "ram_util_percent": 15.827655562539285}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2867.4182585335666, "episode_reward_mean": -2663.1321727309023, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2736.509316980417, -2696.189933030829, -2772.257825748265, -2644.9406678270584, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.5278304957094, "mean_raw_obs_processing_ms": 1.8841965052679894, "mean_inference_ms": 7.682470463690695, "mean_action_processing_ms": 0.23079510672522957}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 648000, "timers": {"sample_time_ms": 1100320.098, "sample_throughput": 3.635, "learn_time_ms": 16446.055, "learn_throughput": 243.219, "update_time_ms": 35.301}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01880269117827993, "policy_loss": -0.06250794036895968, "vf_loss": 4324.432388305664, "vf_explained_var": -1.1175870895385742e-08, "kl": 0.009889477805700153, "entropy": 50.230366349220276, "entropy_coeff": 0.001}}, "num_steps_sampled": 648000, "num_steps_trained": 648000}, "done": false, "episodes_total": 648, "training_iteration": 162, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_05-42-33", "timestamp": 1618090953, "time_this_iter_s": 1113.099690437317, "time_total_s": 212703.85659337044, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 126948.08583545685, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 11.603659305993691, "ram_util_percent": 15.835141955835965}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2867.4182585335666, "episode_reward_mean": -2660.942947459257, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2617.2225310848467, -2614.282507340815, -2700.4278584656777, -2741.840254040951, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.5124241279865, "mean_raw_obs_processing_ms": 1.884101547392431, "mean_inference_ms": 7.682490860914125, "mean_action_processing_ms": 0.23070235163978314}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 652000, "timers": {"sample_time_ms": 1100334.053, "sample_throughput": 3.635, "learn_time_ms": 16438.557, "learn_throughput": 243.33, "update_time_ms": 34.731}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.023575617175083607, "policy_loss": -0.06536384238279425, "vf_loss": 4204.965972900391, "vf_explained_var": 1.862645149230957e-09, "kl": 0.00970418078941293, "entropy": 50.00293755531311, "entropy_coeff": 0.001}}, "num_steps_sampled": 652000, "num_steps_trained": 652000}, "done": false, "episodes_total": 652, "training_iteration": 163, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_06-01-10", "timestamp": 1618092070, "time_this_iter_s": 1116.4937233924866, "time_total_s": 213820.35031676292, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 128064.57955884933, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 11.597986154814347, "ram_util_percent": 15.83637507866583}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2867.4182585335666, "episode_reward_mean": -2659.7940602334943, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2734.7619159565434, -2662.4469412859034, -2626.6573809654974, -2666.451858328705, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.4866632191444, "mean_raw_obs_processing_ms": 1.8839626805813774, "mean_inference_ms": 7.682296471074311, "mean_action_processing_ms": 0.23062150959384872}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 656000, "timers": {"sample_time_ms": 1102107.788, "sample_throughput": 3.629, "learn_time_ms": 15821.144, "learn_throughput": 252.826, "update_time_ms": 33.286}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.020665975695010275, "policy_loss": -0.07085631613153964, "vf_loss": 4757.447021484375, "vf_explained_var": 9.313225746154785e-09, "kl": 0.010272480372805148, "entropy": 50.038617849349976, "entropy_coeff": 0.001}}, "num_steps_sampled": 656000, "num_steps_trained": 656000}, "done": false, "episodes_total": 656, "training_iteration": 164, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_06-19-51", "timestamp": 1618093191, "time_this_iter_s": 1121.6361196041107, "time_total_s": 214941.98643636703, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 129186.21567845345, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 11.89937343358396, "ram_util_percent": 15.833583959899753}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2502.1698541386413, "episode_reward_min": -2867.4182585335666, "episode_reward_mean": -2660.11554825936, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2753.8705471212656, -2636.786154995025, -2502.1698541386413, -2734.1226893883013, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.4509379192614, "mean_raw_obs_processing_ms": 1.8838370581504646, "mean_inference_ms": 7.682211439884571, "mean_action_processing_ms": 0.2305105475431413}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 660000, "timers": {"sample_time_ms": 1103389.287, "sample_throughput": 3.625, "learn_time_ms": 16416.799, "learn_throughput": 243.653, "update_time_ms": 35.412}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.026045966078527272, "policy_loss": -0.07384090055711567, "vf_loss": 4729.605445861816, "vf_explained_var": 3.725290298461914e-09, "kl": 0.009854819683823735, "entropy": 50.01476550102234, "entropy_coeff": 0.001}}, "num_steps_sampled": 660000, "num_steps_trained": 660000}, "done": false, "episodes_total": 660, "training_iteration": 165, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_06-38-42", "timestamp": 1618094322, "time_this_iter_s": 1130.8475172519684, "time_total_s": 216072.833953619, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 130317.06319570541, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 11.605214152700187, "ram_util_percent": 15.850775915580389}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2536.4048572715315, "episode_reward_min": -2867.4182585335666, "episode_reward_mean": -2660.555172132778, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2625.1093666312363, -2628.5494381234857, -2703.225822888351, -2744.01060402152, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.4077850108373, "mean_raw_obs_processing_ms": 1.8836724829072407, "mean_inference_ms": 7.68172179287516, "mean_action_processing_ms": 0.23040672800281825}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 664000, "timers": {"sample_time_ms": 1100514.331, "sample_throughput": 3.635, "learn_time_ms": 16515.907, "learn_throughput": 242.191, "update_time_ms": 38.47}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01930383636499755, "policy_loss": -0.06845518940826878, "vf_loss": 4833.243301391602, "vf_explained_var": -9.313225746154785e-09, "kl": 0.00993656725040637, "entropy": 50.11374223232269, "entropy_coeff": 0.001}}, "num_steps_sampled": 664000, "num_steps_trained": 664000}, "done": false, "episodes_total": 664, "training_iteration": 166, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_06-57-10", "timestamp": 1618095430, "time_this_iter_s": 1107.5718824863434, "time_total_s": 217180.40583610535, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 131424.63507819176, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 11.609200507614215, "ram_util_percent": 15.86345177664975}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2536.4048572715315, "episode_reward_min": -2867.4182585335666, "episode_reward_mean": -2660.171537961308, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2579.2082105124223, -2636.826860980649, -2764.2828907255707, -2706.459767434239, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.3407031332326, "mean_raw_obs_processing_ms": 1.8834982298459004, "mean_inference_ms": 7.680878307272395, "mean_action_processing_ms": 0.23028861695289543}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 668000, "timers": {"sample_time_ms": 1100940.494, "sample_throughput": 3.633, "learn_time_ms": 16454.657, "learn_throughput": 243.092, "update_time_ms": 34.841}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02070339533383958, "policy_loss": -0.07053133302542847, "vf_loss": 4631.242721557617, "vf_explained_var": 1.862645149230957e-09, "kl": 0.010452625749167055, "entropy": 50.062358260154724, "entropy_coeff": 0.001}}, "num_steps_sampled": 668000, "num_steps_trained": 668000}, "done": false, "episodes_total": 668, "training_iteration": 167, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_07-15-40", "timestamp": 1618096540, "time_this_iter_s": 1110.4035685062408, "time_total_s": 218290.8094046116, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 132535.038646698, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 11.611258697027198, "ram_util_percent": 15.85439595192916}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2536.4048572715315, "episode_reward_min": -2867.4182585335666, "episode_reward_mean": -2658.911871126002, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2563.823959439741, -2623.301955405342, -2690.188406010885, -2630.207112988065, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.2609763612705, "mean_raw_obs_processing_ms": 1.8833052523076421, "mean_inference_ms": 7.68004924598632, "mean_action_processing_ms": 0.23015297773853777}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 672000, "timers": {"sample_time_ms": 1102231.723, "sample_throughput": 3.629, "learn_time_ms": 16486.114, "learn_throughput": 242.628, "update_time_ms": 31.893}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02295837164274417, "policy_loss": -0.06885260027775075, "vf_loss": 4408.7266845703125, "vf_explained_var": 0.0, "kl": 0.010102109896251932, "entropy": 49.97423791885376, "entropy_coeff": 0.001}}, "num_steps_sampled": 672000, "num_steps_trained": 672000}, "done": false, "episodes_total": 672, "training_iteration": 168, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_07-34-21", "timestamp": 1618097661, "time_this_iter_s": 1120.4508953094482, "time_total_s": 219411.26029992104, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 133655.48954200745, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 11.602695924764893, "ram_util_percent": 15.849341692789972}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2536.4048572715315, "episode_reward_min": -2867.4182585335666, "episode_reward_mean": -2659.53108613818, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2752.124372355074, -2722.4526016714194, -2751.723327093931, -2646.63579871561, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.1858160515675, "mean_raw_obs_processing_ms": 1.8831155836106865, "mean_inference_ms": 7.679110009579842, "mean_action_processing_ms": 0.22997834409269316}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 676000, "timers": {"sample_time_ms": 1106208.441, "sample_throughput": 3.616, "learn_time_ms": 16415.596, "learn_throughput": 243.671, "update_time_ms": 31.799}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.018961859750561416, "policy_loss": -0.06774941037292592, "vf_loss": 4680.971748352051, "vf_explained_var": -1.862645149230957e-09, "kl": 0.010186189407249913, "entropy": 50.23433721065521, "entropy_coeff": 0.001}}, "num_steps_sampled": 676000, "num_steps_trained": 676000}, "done": false, "episodes_total": 676, "training_iteration": 169, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_07-53-24", "timestamp": 1618098804, "time_this_iter_s": 1143.6540610790253, "time_total_s": 220554.91436100006, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 134799.14360308647, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 11.573587223587225, "ram_util_percent": 15.85761670761671}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2536.4048572715315, "episode_reward_min": -2867.4182585335666, "episode_reward_mean": -2657.0869954248674, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2616.2411207086016, -2720.905459355839, -2867.4182585335666, -2619.7083169107414, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.1099049378629, "mean_raw_obs_processing_ms": 1.882944631329466, "mean_inference_ms": 7.678055886936861, "mean_action_processing_ms": 0.22980927407702625}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 680000, "timers": {"sample_time_ms": 1103078.249, "sample_throughput": 3.626, "learn_time_ms": 16427.573, "learn_throughput": 243.493, "update_time_ms": 32.615}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.022660273360088468, "policy_loss": -0.07093921513296664, "vf_loss": 4533.469497680664, "vf_explained_var": 0.0, "kl": 0.010397647216450423, "entropy": 50.35180985927582, "entropy_coeff": 0.001}}, "num_steps_sampled": 680000, "num_steps_trained": 680000}, "done": false, "episodes_total": 680, "training_iteration": 170, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_08-11-58", "timestamp": 1618099918, "time_this_iter_s": 1113.18314909935, "time_total_s": 221668.0975100994, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 135912.32675218582, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 11.606813880126184, "ram_util_percent": 15.860315457413252}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2515.3555337036364, "episode_reward_min": -2763.661204231933, "episode_reward_mean": -2652.1212809103054, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2612.6910005464274, -2700.772577252368, -2646.964378059633, -2689.9142387028046, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.0363290340565, "mean_raw_obs_processing_ms": 1.8827510319048424, "mean_inference_ms": 7.677138391537444, "mean_action_processing_ms": 0.22966225200529458}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 684000, "timers": {"sample_time_ms": 1102906.306, "sample_throughput": 3.627, "learn_time_ms": 16359.007, "learn_throughput": 244.514, "update_time_ms": 32.628}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.010860365189728327, "policy_loss": -0.05944343938608654, "vf_loss": 4631.2854080200195, "vf_explained_var": -1.862645149230957e-08, "kl": 0.010215604561381042, "entropy": 50.09272837638855, "entropy_coeff": 0.001}}, "num_steps_sampled": 684000, "num_steps_trained": 684000}, "done": false, "episodes_total": 684, "training_iteration": 171, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_08-30-33", "timestamp": 1618101033, "time_this_iter_s": 1115.7188577651978, "time_total_s": 222783.8163678646, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 137028.04560995102, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 11.585201511335015, "ram_util_percent": 15.861901763224184}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2515.3555337036364, "episode_reward_min": -2763.661204231933, "episode_reward_mean": -2653.2412781908033, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2616.604585902237, -2755.4643430386996, -2623.8324221183134, -2685.0110708832726, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.9568165399779, "mean_raw_obs_processing_ms": 1.8825077894515037, "mean_inference_ms": 7.676003997414723, "mean_action_processing_ms": 0.22953377270468828}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 688000, "timers": {"sample_time_ms": 1102054.647, "sample_throughput": 3.63, "learn_time_ms": 16385.401, "learn_throughput": 244.12, "update_time_ms": 34.824}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01929974260565359, "policy_loss": -0.07087836437858641, "vf_loss": 4748.2644119262695, "vf_explained_var": 1.862645149230957e-09, "kl": 0.01058878205367364, "entropy": 50.17979562282562, "entropy_coeff": 0.001}}, "num_steps_sampled": 688000, "num_steps_trained": 688000}, "done": false, "episodes_total": 688, "training_iteration": 172, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_08-48-58", "timestamp": 1618102138, "time_this_iter_s": 1104.881624698639, "time_total_s": 223888.69799256325, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 138132.92723464966, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 11.590343074968231, "ram_util_percent": 15.853303684879291}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2515.3555337036364, "episode_reward_min": -2763.661204231933, "episode_reward_mean": -2652.631100962057, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2722.2382222475862, -2731.4160064235316, -2731.224558111077, -2600.8186113674587, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.8823052646089, "mean_raw_obs_processing_ms": 1.8823029948832208, "mean_inference_ms": 7.675066085482549, "mean_action_processing_ms": 0.22943356173828236}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 692000, "timers": {"sample_time_ms": 1103113.277, "sample_throughput": 3.626, "learn_time_ms": 15791.746, "learn_throughput": 253.297, "update_time_ms": 34.555}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.015239190659485757, "policy_loss": -0.06368951688637026, "vf_loss": 4802.343437194824, "vf_explained_var": -1.862645149230957e-09, "kl": 0.009834232303546742, "entropy": 49.981223702430725, "entropy_coeff": 0.001}}, "num_steps_sampled": 692000, "num_steps_trained": 692000}, "done": false, "episodes_total": 692, "training_iteration": 173, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_09-07-39", "timestamp": 1618103259, "time_this_iter_s": 1121.1405022144318, "time_total_s": 225009.83849477768, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 139254.0677368641, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 11.578007518796992, "ram_util_percent": 15.845551378446117}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2515.3555337036364, "episode_reward_min": -2763.661204231933, "episode_reward_mean": -2648.842221168606, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2746.9803380159533, -2653.7747718710407, -2640.0037466354784, -2635.259273546509, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.8136120031343, "mean_raw_obs_processing_ms": 1.882100910292398, "mean_inference_ms": 7.674352283334493, "mean_action_processing_ms": 0.2293414581557495}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 696000, "timers": {"sample_time_ms": 1103526.365, "sample_throughput": 3.625, "learn_time_ms": 16355.573, "learn_throughput": 244.565, "update_time_ms": 37.702}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01831201510503888, "policy_loss": -0.06502749648643658, "vf_loss": 4273.70881652832, "vf_explained_var": -1.862645149230957e-09, "kl": 0.01053406807477586, "entropy": 50.016926884651184, "entropy_coeff": 0.001}}, "num_steps_sampled": 696000, "num_steps_trained": 696000}, "done": false, "episodes_total": 696, "training_iteration": 174, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_09-26-31", "timestamp": 1618104391, "time_this_iter_s": 1131.436795949936, "time_total_s": 226141.27529072762, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 140385.50453281403, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 11.595527950310556, "ram_util_percent": 15.850000000000001}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2515.3555337036364, "episode_reward_min": -2763.661204231933, "episode_reward_mean": -2647.2860923118646, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2676.251741569642, -2593.732878137163, -2729.099982337481, -2548.7742392438745, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.746967802273, "mean_raw_obs_processing_ms": 1.881871478869844, "mean_inference_ms": 7.6736149313306825, "mean_action_processing_ms": 0.22923214005654927}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 700000, "timers": {"sample_time_ms": 1100899.564, "sample_throughput": 3.633, "learn_time_ms": 16394.675, "learn_throughput": 243.982, "update_time_ms": 36.183}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.018781815830152482, "policy_loss": -0.06606154097244143, "vf_loss": 4615.831390380859, "vf_explained_var": 9.313225746154785e-09, "kl": 0.00998711955617182, "entropy": 50.07037603855133, "entropy_coeff": 0.001}}, "num_steps_sampled": 700000, "num_steps_trained": 700000}, "done": false, "episodes_total": 700, "training_iteration": 175, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_09-44-56", "timestamp": 1618105496, "time_this_iter_s": 1104.9552133083344, "time_total_s": 227246.23050403595, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 141490.45974612236, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 11.61106166560712, "ram_util_percent": 15.859694850603944}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2515.3555337036364, "episode_reward_min": -2763.661204231933, "episode_reward_mean": -2647.3251187117585, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2630.98385502719, -2585.104588942577, -2689.1952823345837, -2763.661204231933, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.6766033132261, "mean_raw_obs_processing_ms": 1.8816574857283774, "mean_inference_ms": 7.672774023254923, "mean_action_processing_ms": 0.22918342922313534}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 704000, "timers": {"sample_time_ms": 1101736.412, "sample_throughput": 3.631, "learn_time_ms": 16307.091, "learn_throughput": 245.292, "update_time_ms": 32.455}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.016153486852999777, "policy_loss": -0.061637996637728065, "vf_loss": 4458.554183959961, "vf_explained_var": 5.587935447692871e-09, "kl": 0.010016549058491364, "entropy": 50.443665742874146, "entropy_coeff": 0.001}}, "num_steps_sampled": 704000, "num_steps_trained": 704000}, "done": false, "episodes_total": 704, "training_iteration": 176, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_10-03-31", "timestamp": 1618106611, "time_this_iter_s": 1115.02721118927, "time_total_s": 228361.25771522522, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 142605.48695731163, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 11.609703843730308, "ram_util_percent": 15.853749212350348}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2515.3555337036364, "episode_reward_min": -2756.0903893592767, "episode_reward_mean": -2647.0341408925283, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2665.902184049461, -2689.1524414824175, -2622.1639315565267, -2650.430879909553, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.6079647648049, "mean_raw_obs_processing_ms": 1.8814379082767982, "mean_inference_ms": 7.671883010485194, "mean_action_processing_ms": 0.2291332199849302}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 708000, "timers": {"sample_time_ms": 1101829.967, "sample_throughput": 3.63, "learn_time_ms": 16365.132, "learn_throughput": 244.422, "update_time_ms": 32.652}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01375263201771304, "policy_loss": -0.06339951607515104, "vf_loss": 4788.009819030762, "vf_explained_var": -1.30385160446167e-08, "kl": 0.010186578991124406, "entropy": 50.44738304615021, "entropy_coeff": 0.001}}, "num_steps_sampled": 708000, "num_steps_trained": 708000}, "done": false, "episodes_total": 708, "training_iteration": 177, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_10-22-03", "timestamp": 1618107723, "time_this_iter_s": 1111.9216997623444, "time_total_s": 229473.17941498756, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 143717.40865707397, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 11.599810486418193, "ram_util_percent": 15.849147188881872}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2756.0903893592767, "episode_reward_mean": -2644.2674554470777, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2600.730159832518, -2751.36330572372, -2580.7913046088047, -2656.735280791881, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.5437265458008, "mean_raw_obs_processing_ms": 1.881247499230067, "mean_inference_ms": 7.670969182382448, "mean_action_processing_ms": 0.2290859634604501}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 712000, "timers": {"sample_time_ms": 1103027.865, "sample_throughput": 3.626, "learn_time_ms": 16271.897, "learn_throughput": 245.823, "update_time_ms": 32.188}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.0277730823145248, "policy_loss": -0.07489014678867534, "vf_loss": 4547.67325592041, "vf_explained_var": 1.862645149230957e-09, "kl": 0.010137758712517098, "entropy": 50.323596358299255, "entropy_coeff": 0.001}}, "num_steps_sampled": 712000, "num_steps_trained": 712000}, "done": false, "episodes_total": 712, "training_iteration": 178, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_10-40-54", "timestamp": 1618108854, "time_this_iter_s": 1131.4929411411285, "time_total_s": 230604.6723561287, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 144848.9015982151, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 11.588019863438857, "ram_util_percent": 15.858597144630666}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2777.804273262319, "episode_reward_mean": -2646.34795799162, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2575.6894260170293, -2631.2445528444955, -2614.716015467837, -2646.5828071772403, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.4815019072421, "mean_raw_obs_processing_ms": 1.88102841761429, "mean_inference_ms": 7.670044629958852, "mean_action_processing_ms": 0.22903785156539797}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 716000, "timers": {"sample_time_ms": 1099904.189, "sample_throughput": 3.637, "learn_time_ms": 16261.054, "learn_throughput": 245.987, "update_time_ms": 31.647}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01335316727636382, "policy_loss": -0.062215500278398395, "vf_loss": 4728.249244689941, "vf_explained_var": 7.450580596923828e-09, "kl": 0.010158955992665142, "entropy": 50.492738008499146, "entropy_coeff": 0.001}}, "num_steps_sampled": 716000, "num_steps_trained": 716000}, "done": false, "episodes_total": 716, "training_iteration": 179, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_10-59-27", "timestamp": 1618109967, "time_this_iter_s": 1112.301730632782, "time_total_s": 231716.97408676147, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 145961.20332884789, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 11.602653190145293, "ram_util_percent": 15.85874921036008}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2777.804273262319, "episode_reward_mean": -2647.6280191582996, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2680.271944410816, -2633.7580526871825, -2647.664075593019, -2641.2317771118924, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.4195635263183, "mean_raw_obs_processing_ms": 1.8808833516531627, "mean_inference_ms": 7.668997385302451, "mean_action_processing_ms": 0.22899020294561598}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 720000, "timers": {"sample_time_ms": 1099976.155, "sample_throughput": 3.636, "learn_time_ms": 16236.741, "learn_throughput": 246.355, "update_time_ms": 33.01}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.027417443139711395, "policy_loss": -0.07121615041978657, "vf_loss": 4290.978485107422, "vf_explained_var": 1.30385160446167e-08, "kl": 0.010020194691605866, "entropy": 50.47239577770233, "entropy_coeff": 0.001}}, "num_steps_sampled": 720000, "num_steps_trained": 720000}, "done": false, "episodes_total": 720, "training_iteration": 180, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_11-18-01", "timestamp": 1618111081, "time_this_iter_s": 1113.675677537918, "time_total_s": 232830.6497642994, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 147074.8790063858, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 11.597097791798108, "ram_util_percent": 15.867697160883285}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2648.60821028149, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2633.499219147806, -2655.1905525531015, -2645.765512119703, -2712.2775594085774, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.3546284815908, "mean_raw_obs_processing_ms": 1.8807170619234872, "mean_inference_ms": 7.667998627373794, "mean_action_processing_ms": 0.22896966808496436}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 724000, "timers": {"sample_time_ms": 1099342.332, "sample_throughput": 3.639, "learn_time_ms": 16284.283, "learn_throughput": 245.636, "update_time_ms": 34.154}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.018738510785624385, "policy_loss": -0.06382239307276905, "vf_loss": 4493.2264404296875, "vf_explained_var": -9.313225746154785e-09, "kl": 0.00989120060694404, "entropy": 50.54851007461548, "entropy_coeff": 0.001}}, "num_steps_sampled": 724000, "num_steps_trained": 724000}, "done": false, "episodes_total": 724, "training_iteration": 181, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_11-36-30", "timestamp": 1618112190, "time_this_iter_s": 1109.8671219348907, "time_total_s": 233940.51688623428, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 148184.7461283207, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 11.604933586337761, "ram_util_percent": 15.86451612903226}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2646.3358113745176, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2702.153721280338, -2583.289834474287, -2677.3337237346855, -2579.102877999271, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.2943938041575, "mean_raw_obs_processing_ms": 1.8805617421905705, "mean_inference_ms": 7.667079101765312, "mean_action_processing_ms": 0.22892872814159781}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 728000, "timers": {"sample_time_ms": 1101629.763, "sample_throughput": 3.631, "learn_time_ms": 15653.27, "learn_throughput": 255.538, "update_time_ms": 32.85}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.012237709248438478, "policy_loss": -0.05744084948673844, "vf_loss": 4441.104873657227, "vf_explained_var": -1.4901161193847656e-08, "kl": 0.010006647207774222, "entropy": 50.49978709220886, "entropy_coeff": 0.001}}, "num_steps_sampled": 728000, "num_steps_trained": 728000}, "done": false, "episodes_total": 728, "training_iteration": 182, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_11-55-12", "timestamp": 1618113312, "time_this_iter_s": 1121.42023229599, "time_total_s": 235061.93711853027, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 149306.16636061668, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 11.598433583959899, "ram_util_percent": 15.852380952380958}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2646.2956003288673, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2713.5405249174714, -2617.3524505602554, -2727.155385673667, -2536.4048572715315, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.2384454022606, "mean_raw_obs_processing_ms": 1.8803989792926803, "mean_inference_ms": 7.666166426203758, "mean_action_processing_ms": 0.22890611326115554}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 732000, "timers": {"sample_time_ms": 1101410.771, "sample_throughput": 3.632, "learn_time_ms": 16267.488, "learn_throughput": 245.889, "update_time_ms": 34.4}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.015223273658193648, "policy_loss": -0.0626512891612947, "vf_loss": 4501.680107116699, "vf_explained_var": 1.862645149230957e-09, "kl": 0.01027013111161068, "entropy": 50.23122477531433, "entropy_coeff": 0.001}}, "num_steps_sampled": 732000, "num_steps_trained": 732000}, "done": false, "episodes_total": 732, "training_iteration": 183, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_12-13-57", "timestamp": 1618114437, "time_this_iter_s": 1125.108339548111, "time_total_s": 236187.04545807838, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 150431.2747001648, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 11.619737663960025, "ram_util_percent": 15.847407870081202}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2646.194877535986, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2624.5941148243683, -2692.99494001522, -2621.7048993154917, -2656.1262679777196, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.1840070982164, "mean_raw_obs_processing_ms": 1.880258524642183, "mean_inference_ms": 7.665281966386796, "mean_action_processing_ms": 0.22889867693400284}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 736000, "timers": {"sample_time_ms": 1098596.957, "sample_throughput": 3.641, "learn_time_ms": 16337.442, "learn_throughput": 244.836, "update_time_ms": 33.74}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02193707798141986, "policy_loss": -0.06748842337401584, "vf_loss": 4374.688369750977, "vf_explained_var": -1.862645149230957e-09, "kl": 0.010218000883469358, "entropy": 50.57076835632324, "entropy_coeff": 0.001}}, "num_steps_sampled": 736000, "num_steps_trained": 736000}, "done": false, "episodes_total": 736, "training_iteration": 184, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_12-32-21", "timestamp": 1618115541, "time_this_iter_s": 1103.9914665222168, "time_total_s": 237291.0369246006, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 151535.266166687, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 11.618256997455472, "ram_util_percent": 15.866475826972014}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2646.749039043327, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2647.2880449002027, -2686.8284803966685, -2687.5333142857567, -2697.5764982461337, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.1250727376271, "mean_raw_obs_processing_ms": 1.8801060803599734, "mean_inference_ms": 7.664323405575397, "mean_action_processing_ms": 0.22889465451775778}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 740000, "timers": {"sample_time_ms": 1099284.664, "sample_throughput": 3.639, "learn_time_ms": 16305.523, "learn_throughput": 245.316, "update_time_ms": 35.173}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.011991437175311148, "policy_loss": -0.06121645565144718, "vf_loss": 4675.105163574219, "vf_explained_var": 7.450580596923828e-09, "kl": 0.010318388405721635, "entropy": 50.41582381725311, "entropy_coeff": 0.001}}, "num_steps_sampled": 740000, "num_steps_trained": 740000}, "done": false, "episodes_total": 740, "training_iteration": 185, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_12-50-53", "timestamp": 1618116653, "time_this_iter_s": 1111.5275139808655, "time_total_s": 238402.56443858147, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 152646.79368066788, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 11.602402022756005, "ram_util_percent": 15.851517067003796}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2645.726281206396, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2650.194285788851, -2536.8675526137026, -2663.7842367331514, -2633.114475836019, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.0669224297271, "mean_raw_obs_processing_ms": 1.8799259091001306, "mean_inference_ms": 7.663343458727191, "mean_action_processing_ms": 0.22890863691816815}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 744000, "timers": {"sample_time_ms": 1099261.837, "sample_throughput": 3.639, "learn_time_ms": 16390.904, "learn_throughput": 244.038, "update_time_ms": 37.156}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02060628976323642, "policy_loss": -0.062278381519718096, "vf_loss": 4220.886863708496, "vf_explained_var": 1.30385160446167e-08, "kl": 0.009730568912345916, "entropy": 50.4135377407074, "entropy_coeff": 0.001}}, "num_steps_sampled": 744000, "num_steps_trained": 744000}, "done": false, "episodes_total": 744, "training_iteration": 186, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_13-09-28", "timestamp": 1618117768, "time_this_iter_s": 1115.6725838184357, "time_total_s": 239518.2370223999, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 153762.4662644863, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 11.59653652392947, "ram_util_percent": 15.84987405541562}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2645.221370806306, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2717.2076637316577, -2634.7503265229457, -2672.8965533762885, -2606.1206727911467, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.015123579689, "mean_raw_obs_processing_ms": 1.879757426781271, "mean_inference_ms": 7.662359373459207, "mean_action_processing_ms": 0.22893763688737942}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 748000, "timers": {"sample_time_ms": 1103039.042, "sample_throughput": 3.626, "learn_time_ms": 16325.821, "learn_throughput": 245.011, "update_time_ms": 37.8}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.021362148341722786, "policy_loss": -0.06566231593023986, "vf_loss": 4498.365798950195, "vf_explained_var": -7.450580596923828e-09, "kl": 0.009687706071417779, "entropy": 50.340545892715454, "entropy_coeff": 0.001}}, "num_steps_sampled": 748000, "num_steps_trained": 748000}, "done": false, "episodes_total": 748, "training_iteration": 187, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_13-28-37", "timestamp": 1618118917, "time_this_iter_s": 1149.0492570400238, "time_total_s": 240667.28627943993, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 154911.51552152634, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 11.592176039119805, "ram_util_percent": 15.860024449877752}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2643.0413521324435, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2653.7130283046336, -2675.689693445824, -2610.4622038763027, -2619.0195027292393, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.9632562331411, "mean_raw_obs_processing_ms": 1.8796033264541767, "mean_inference_ms": 7.661396840840549, "mean_action_processing_ms": 0.22893598950596547}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 752000, "timers": {"sample_time_ms": 1100656.501, "sample_throughput": 3.634, "learn_time_ms": 16395.659, "learn_throughput": 243.967, "update_time_ms": 39.618}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.019630855254945345, "policy_loss": -0.060961609677178785, "vf_loss": 4230.267478942871, "vf_explained_var": -1.30385160446167e-08, "kl": 0.009649946790887043, "entropy": 50.435434103012085, "entropy_coeff": 0.001}}, "num_steps_sampled": 752000, "num_steps_trained": 752000}, "done": false, "episodes_total": 752, "training_iteration": 188, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_13-47-06", "timestamp": 1618120026, "time_this_iter_s": 1108.3839094638824, "time_total_s": 241775.6701889038, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 156019.89943099022, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 11.61318124207858, "ram_util_percent": 15.867363751584287}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2642.9613310048903, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2658.361158084787, -2691.783225515215, -2722.8447011166418, -2649.477814406568, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.9085436165656, "mean_raw_obs_processing_ms": 1.8794578040169823, "mean_inference_ms": 7.660514019476843, "mean_action_processing_ms": 0.22894305793289732}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 756000, "timers": {"sample_time_ms": 1100074.916, "sample_throughput": 3.636, "learn_time_ms": 16388.266, "learn_throughput": 244.077, "update_time_ms": 40.123}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01754137279931456, "policy_loss": -0.0649816736986395, "vf_loss": 4696.438621520996, "vf_explained_var": 1.862645149230957e-09, "kl": 0.009944572142558172, "entropy": 50.497780084609985, "entropy_coeff": 0.001}}, "num_steps_sampled": 756000, "num_steps_trained": 756000}, "done": false, "episodes_total": 756, "training_iteration": 189, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_14-05-32", "timestamp": 1618121132, "time_this_iter_s": 1106.4171211719513, "time_total_s": 242882.08731007576, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 157126.31655216217, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 11.60864040660737, "ram_util_percent": 15.86975857687421}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2642.194673285242, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2742.909339520634, -2647.180598666534, -2610.3350796038612, -2670.486615194067, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.8518789703743, "mean_raw_obs_processing_ms": 1.879317261035509, "mean_inference_ms": 7.659348865966352, "mean_action_processing_ms": 0.2289527299367631}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 760000, "timers": {"sample_time_ms": 1099670.026, "sample_throughput": 3.637, "learn_time_ms": 16395.992, "learn_throughput": 243.962, "update_time_ms": 37.963}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.029549588332884014, "policy_loss": -0.07385155913652852, "vf_loss": 4560.56494140625, "vf_explained_var": 9.313225746154785e-09, "kl": 0.009512468561297283, "entropy": 50.06250560283661, "entropy_coeff": 0.001}}, "num_steps_sampled": 760000, "num_steps_trained": 760000}, "done": false, "episodes_total": 760, "training_iteration": 190, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_14-24-02", "timestamp": 1618122242, "time_this_iter_s": 1109.6799640655518, "time_total_s": 243991.7672741413, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 158235.99651622772, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 11.607278481012658, "ram_util_percent": 15.872784810126587}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2642.3905528542346, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2667.591510593884, -2641.407654335595, -2669.656023557426, -2683.8766260306406, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.7991918813722, "mean_raw_obs_processing_ms": 1.8791597529505355, "mean_inference_ms": 7.6583904982156135, "mean_action_processing_ms": 0.22895497856663188}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 764000, "timers": {"sample_time_ms": 1101374.361, "sample_throughput": 3.632, "learn_time_ms": 15781.724, "learn_throughput": 253.458, "update_time_ms": 36.298}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02526132995262742, "policy_loss": -0.0749158296675887, "vf_loss": 4997.586334228516, "vf_explained_var": 1.4901161193847656e-08, "kl": 0.009689170692581683, "entropy": 49.98592960834503, "entropy_coeff": 0.001}}, "num_steps_sampled": 764000, "num_steps_trained": 764000}, "done": false, "episodes_total": 764, "training_iteration": 191, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_14-42-43", "timestamp": 1618123363, "time_this_iter_s": 1120.7513463497162, "time_total_s": 245112.51862049103, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 159356.74786257744, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 11.60438596491228, "ram_util_percent": 15.851879699248125}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2641.9609528250903, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2676.110248821488, -2632.9297901377795, -2586.8932619275047, -2664.877745235493, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.7501582994201, "mean_raw_obs_processing_ms": 1.8790120506185854, "mean_inference_ms": 7.657511993180396, "mean_action_processing_ms": 0.22897367638817273}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 768000, "timers": {"sample_time_ms": 1101489.61, "sample_throughput": 3.631, "learn_time_ms": 16387.587, "learn_throughput": 244.087, "update_time_ms": 34.756}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02417341392720118, "policy_loss": -0.07217185574700125, "vf_loss": 4733.448341369629, "vf_explained_var": -1.862645149230957e-09, "kl": 0.00985534695792012, "entropy": 49.85239017009735, "entropy_coeff": 0.001}}, "num_steps_sampled": 768000, "num_steps_trained": 768000}, "done": false, "episodes_total": 768, "training_iteration": 192, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_15-01-31", "timestamp": 1618124491, "time_this_iter_s": 1128.6227042675018, "time_total_s": 246241.14132475853, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 160485.37056684494, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 11.62173100871731, "ram_util_percent": 15.856288916562892}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2641.8783030583336, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2726.6281896545574, -2710.965415360831, -2575.512992592, -2556.3363374544315, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.7009422034349, "mean_raw_obs_processing_ms": 1.8788799726636296, "mean_inference_ms": 7.656570479919578, "mean_action_processing_ms": 0.22901206412991626}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 772000, "timers": {"sample_time_ms": 1099976.471, "sample_throughput": 3.636, "learn_time_ms": 16419.358, "learn_throughput": 243.615, "update_time_ms": 34.298}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.012348937190836295, "policy_loss": -0.05641641918919049, "vf_loss": 4374.773826599121, "vf_explained_var": 3.725290298461914e-09, "kl": 0.009860125079285353, "entropy": 50.2210967540741, "entropy_coeff": 0.001}}, "num_steps_sampled": 772000, "num_steps_trained": 772000}, "done": false, "episodes_total": 772, "training_iteration": 193, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_15-20-02", "timestamp": 1618125602, "time_this_iter_s": 1110.294371843338, "time_total_s": 247351.43569660187, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 161595.66493868828, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 11.608665401644528, "ram_util_percent": 15.873244781783685}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2640.961500784962, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2646.1677451140804, -2561.3969462177474, -2741.866762122811, -2679.095575050184, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.6469799542045, "mean_raw_obs_processing_ms": 1.8787477368305696, "mean_inference_ms": 7.65562832776472, "mean_action_processing_ms": 0.22904228628432818}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 776000, "timers": {"sample_time_ms": 1100650.61, "sample_throughput": 3.634, "learn_time_ms": 16381.739, "learn_throughput": 244.174, "update_time_ms": 32.559}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.027898254862520844, "policy_loss": -0.07591278283507563, "vf_loss": 4587.480056762695, "vf_explained_var": -1.30385160446167e-08, "kl": 0.010148431756533682, "entropy": 49.87890613079071, "entropy_coeff": 0.001}}, "num_steps_sampled": 776000, "num_steps_trained": 776000}, "done": false, "episodes_total": 776, "training_iteration": 194, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_15-38-32", "timestamp": 1618126712, "time_this_iter_s": 1110.3390958309174, "time_total_s": 248461.77479243279, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 162706.0040345192, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 11.600822784810125, "ram_util_percent": 15.864493670886079}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2637.7350103665412, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2635.4717137674515, -2515.3555337036364, -2557.009304731069, -2619.865151850343, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.592714131186, "mean_raw_obs_processing_ms": 1.878611881306914, "mean_inference_ms": 7.6548194157967036, "mean_action_processing_ms": 0.22906642813154593}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 780000, "timers": {"sample_time_ms": 1099968.158, "sample_throughput": 3.636, "learn_time_ms": 16442.349, "learn_throughput": 243.274, "update_time_ms": 32.049}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.011806661263108253, "policy_loss": -0.06360726291313767, "vf_loss": 5003.823715209961, "vf_explained_var": -3.725290298461914e-09, "kl": 0.01010852656327188, "entropy": 50.05172646045685, "entropy_coeff": 0.001}}, "num_steps_sampled": 780000, "num_steps_trained": 780000}, "done": false, "episodes_total": 780, "training_iteration": 195, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_15-56-58", "timestamp": 1618127818, "time_this_iter_s": 1105.3040142059326, "time_total_s": 249567.07880663872, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 163811.30804872513, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 11.59961880559085, "ram_util_percent": 15.860101651842443}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2640.9419612943393, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2657.2978273678773, -2756.0903893592767, -2673.2482814576983, -2675.705424426185, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.5429592075722, "mean_raw_obs_processing_ms": 1.8784740424930737, "mean_inference_ms": 7.653951207507159, "mean_action_processing_ms": 0.22908389769727555}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 784000, "timers": {"sample_time_ms": 1102607.299, "sample_throughput": 3.628, "learn_time_ms": 16369.573, "learn_throughput": 244.356, "update_time_ms": 31.799}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.026760372100397944, "policy_loss": -0.07120137001038529, "vf_loss": 4447.725494384766, "vf_explained_var": 1.862645149230957e-09, "kl": 0.009755001403391361, "entropy": 50.03825604915619, "entropy_coeff": 0.001}}, "num_steps_sampled": 784000, "num_steps_trained": 784000}, "done": false, "episodes_total": 784, "training_iteration": 196, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_16-15-59", "timestamp": 1618128959, "time_this_iter_s": 1141.3338873386383, "time_total_s": 250708.41269397736, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 164952.64193606377, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 11.608866995073894, "ram_util_percent": 15.859482758620691}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2639.384656937184, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2683.3578883666014, -2705.74640864948, -2577.961322030077, -2652.8290800217287, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.4951301313737, "mean_raw_obs_processing_ms": 1.8783707256109452, "mean_inference_ms": 7.653116705828472, "mean_action_processing_ms": 0.229107637716492}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 788000, "timers": {"sample_time_ms": 1098913.547, "sample_throughput": 3.64, "learn_time_ms": 16402.363, "learn_throughput": 243.867, "update_time_ms": 31.66}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.021203020151006058, "policy_loss": -0.06743772269692272, "vf_loss": 4588.229034423828, "vf_explained_var": 0.0, "kl": 0.009770148521056399, "entropy": 49.72722554206848, "entropy_coeff": 0.001}}, "num_steps_sampled": 788000, "num_steps_trained": 788000}, "done": false, "episodes_total": 788, "training_iteration": 197, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_16-34-31", "timestamp": 1618130071, "time_this_iter_s": 1112.4383602142334, "time_total_s": 251820.8510541916, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 166065.080296278, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 11.616982323232325, "ram_util_percent": 15.870896464646469}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2639.650811450388, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2578.3062744328276, -2687.9493953360375, -2615.9285134477204, -2524.6252355879906, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.4456899809197, "mean_raw_obs_processing_ms": 1.8782657003814103, "mean_inference_ms": 7.652250477612597, "mean_action_processing_ms": 0.2291254081766039}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 792000, "timers": {"sample_time_ms": 1099299.447, "sample_throughput": 3.639, "learn_time_ms": 16354.482, "learn_throughput": 244.581, "update_time_ms": 34.278}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.019352279137820005, "policy_loss": -0.06922235479578376, "vf_loss": 4838.669105529785, "vf_explained_var": -5.587935447692871e-09, "kl": 0.010041816422017291, "entropy": 49.98876202106476, "entropy_coeff": 0.001}}, "num_steps_sampled": 792000, "num_steps_trained": 792000}, "done": false, "episodes_total": 792, "training_iteration": 198, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_16-53-03", "timestamp": 1618131183, "time_this_iter_s": 1111.7903289794922, "time_total_s": 252932.64138317108, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 167176.8706252575, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 11.605559065066329, "ram_util_percent": 15.862160454832601}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2639.642861782082, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2587.9781168177938, -2669.5191189275756, -2649.289534300951, -2613.618474348462, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.3939191805193, "mean_raw_obs_processing_ms": 1.8781649399710383, "mean_inference_ms": 7.651235566978979, "mean_action_processing_ms": 0.22911430361221582}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 796000, "timers": {"sample_time_ms": 1099797.461, "sample_throughput": 3.637, "learn_time_ms": 16395.31, "learn_throughput": 243.972, "update_time_ms": 36.949}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02912175448727794, "policy_loss": -0.07350864278851077, "vf_loss": 4357.770729064941, "vf_explained_var": -1.862645149230957e-09, "kl": 0.009931657288689166, "entropy": 50.09831666946411, "entropy_coeff": 0.001}}, "num_steps_sampled": 796000, "num_steps_trained": 796000}, "done": false, "episodes_total": 796, "training_iteration": 199, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_17-11-35", "timestamp": 1618132295, "time_this_iter_s": 1111.832384109497, "time_total_s": 254044.47376728058, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 168288.703009367, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 11.603600758054327, "ram_util_percent": 15.861276058117502}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2639.6226155402505, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2597.066369953359, -2634.925826015138, -2671.6544749878994, -2648.114810321216, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.3454391697587, "mean_raw_obs_processing_ms": 1.878081058452079, "mean_inference_ms": 7.65023299813053, "mean_action_processing_ms": 0.22911780424756512}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 800000, "timers": {"sample_time_ms": 1100932.084, "sample_throughput": 3.633, "learn_time_ms": 15791.9, "learn_throughput": 253.294, "update_time_ms": 38.032}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.031246836006175727, "policy_loss": -0.07432847132440656, "vf_loss": 4313.805839538574, "vf_explained_var": -1.1175870895385742e-08, "kl": 0.00970743308425881, "entropy": 49.814597964286804, "entropy_coeff": 0.001}}, "num_steps_sampled": 800000, "num_steps_trained": 800000}, "done": false, "episodes_total": 800, "training_iteration": 200, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_17-30-10", "timestamp": 1618133410, "time_this_iter_s": 1115.0034201145172, "time_total_s": 255159.4771873951, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 169403.7064294815, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 11.602772526780088, "ram_util_percent": 15.859609325771899}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2640.072210248635, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2661.1341929996556, -2701.8707868777306, -2647.2073467535843, -2629.6348219822667, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.2995259412395, "mean_raw_obs_processing_ms": 1.8779931800074368, "mean_inference_ms": 7.649282344317737, "mean_action_processing_ms": 0.22908156183114733}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 804000, "timers": {"sample_time_ms": 1101357.712, "sample_throughput": 3.632, "learn_time_ms": 16398.834, "learn_throughput": 243.92, "update_time_ms": 39.523}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.014156836754409596, "policy_loss": -0.05801299290033057, "vf_loss": 4385.789161682129, "vf_explained_var": -7.450580596923828e-09, "kl": 0.009682885487563908, "entropy": 49.63408362865448, "entropy_coeff": 0.001}}, "num_steps_sampled": 804000, "num_steps_trained": 804000}, "done": false, "episodes_total": 804, "training_iteration": 201, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_17-49-01", "timestamp": 1618134541, "time_this_iter_s": 1131.0918259620667, "time_total_s": 256290.56901335716, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 170534.79825544357, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 11.604037267080745, "ram_util_percent": 15.85857142857143}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.260019984114, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2640.3849441576986, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2506.260019984114, -2613.2281114920256, -2649.78499876856, -2581.7077622081806, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.253839105092, "mean_raw_obs_processing_ms": 1.877926064209238, "mean_inference_ms": 7.648259619333167, "mean_action_processing_ms": 0.22904745482955072}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 808000, "timers": {"sample_time_ms": 1099309.694, "sample_throughput": 3.639, "learn_time_ms": 16467.277, "learn_throughput": 242.906, "update_time_ms": 40.367}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.024558857345255092, "policy_loss": -0.07275439411750995, "vf_loss": 4722.029426574707, "vf_explained_var": -5.587935447692871e-09, "kl": 0.009907558414852247, "entropy": 49.80873084068298, "entropy_coeff": 0.001}}, "num_steps_sampled": 808000, "num_steps_trained": 808000}, "done": false, "episodes_total": 808, "training_iteration": 202, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_18-07-30", "timestamp": 1618135650, "time_this_iter_s": 1108.8285953998566, "time_total_s": 257399.39760875702, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 171643.62685084343, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 11.61855604813173, "ram_util_percent": 15.862951234958839}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2537.6253381233846, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2645.35526095177, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2777.804273262319, -2629.8109311023645, -2721.4752440283332, -2668.579857018152, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.2060570864398, "mean_raw_obs_processing_ms": 1.8778535403782626, "mean_inference_ms": 7.647208945277594, "mean_action_processing_ms": 0.22902139143703068}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 812000, "timers": {"sample_time_ms": 1099555.197, "sample_throughput": 3.638, "learn_time_ms": 16438.362, "learn_throughput": 243.333, "update_time_ms": 41.939}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02059849549550563, "policy_loss": -0.07246242923429236, "vf_loss": 5018.340560913086, "vf_explained_var": 1.30385160446167e-08, "kl": 0.010037297033704817, "entropy": 49.768454909324646, "entropy_coeff": 0.001}}, "num_steps_sampled": 812000, "num_steps_trained": 812000}, "done": false, "episodes_total": 812, "training_iteration": 203, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_18-26-03", "timestamp": 1618136763, "time_this_iter_s": 1112.4716510772705, "time_total_s": 258511.8692598343, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 172756.0985019207, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 11.90157927984839, "ram_util_percent": 15.88932406822489}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2537.6253381233846, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2644.217829136683, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2725.9378282182074, -2568.8969621614006, -2647.295144583485, -2654.108983211459, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.1581122272834, "mean_raw_obs_processing_ms": 1.87781619571438, "mean_inference_ms": 7.646256333890478, "mean_action_processing_ms": 0.22898086077254193}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 816000, "timers": {"sample_time_ms": 1099231.747, "sample_throughput": 3.639, "learn_time_ms": 16498.085, "learn_throughput": 242.452, "update_time_ms": 44.767}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.020158983752480708, "policy_loss": -0.07040668494300917, "vf_loss": 4924.528762817383, "vf_explained_var": 1.862645149230957e-09, "kl": 0.009993060288252309, "entropy": 50.21981883049011, "entropy_coeff": 0.001}}, "num_steps_sampled": 816000, "num_steps_trained": 816000}, "done": false, "episodes_total": 816, "training_iteration": 204, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_18-44-30", "timestamp": 1618137870, "time_this_iter_s": 1107.7302780151367, "time_total_s": 259619.59953784943, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 173863.82877993584, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 11.910526315789472, "ram_util_percent": 15.911604311984785}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2532.910118416508, "episode_reward_min": -2819.752097332491, "episode_reward_mean": -2642.187539003846, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2819.752097332491, -2649.847547105742, -2690.107342623548, -2541.237975060181, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.1142735159934, "mean_raw_obs_processing_ms": 1.8777500982804032, "mean_inference_ms": 7.645441664042783, "mean_action_processing_ms": 0.2289282812107295}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 820000, "timers": {"sample_time_ms": 1102831.659, "sample_throughput": 3.627, "learn_time_ms": 16399.742, "learn_throughput": 243.906, "update_time_ms": 44.388}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01777165729436092, "policy_loss": -0.06452797865495086, "vf_loss": 4520.187927246094, "vf_explained_var": -2.2351741790771484e-08, "kl": 0.010035619226982817, "entropy": 49.88594150543213, "entropy_coeff": 0.001}}, "num_steps_sampled": 820000, "num_steps_trained": 820000}, "done": false, "episodes_total": 820, "training_iteration": 205, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_19-03-31", "timestamp": 1618139011, "time_this_iter_s": 1140.3158836364746, "time_total_s": 260759.9154214859, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 175004.1446635723, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 11.900677339901478, "ram_util_percent": 15.913669950738921}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2532.910118416508, "episode_reward_min": -2759.4730966178463, "episode_reward_mean": -2640.9876858750517, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2537.6253381233846, -2600.36521583868, -2708.610830721349, -2572.8915678485623, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.0713924340919, "mean_raw_obs_processing_ms": 1.8776544663812973, "mean_inference_ms": 7.644572108485818, "mean_action_processing_ms": 0.22885932666048364}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 824000, "timers": {"sample_time_ms": 1099679.699, "sample_throughput": 3.637, "learn_time_ms": 16427.388, "learn_throughput": 243.496, "update_time_ms": 44.967}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.022887735336553305, "policy_loss": -0.06911782152019441, "vf_loss": 4598.859596252441, "vf_explained_var": -1.862645149230957e-09, "kl": 0.009784207359189168, "entropy": 49.910208225250244, "entropy_coeff": 0.001}}, "num_steps_sampled": 824000, "num_steps_trained": 824000}, "done": false, "episodes_total": 824, "training_iteration": 206, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_19-22-01", "timestamp": 1618140121, "time_this_iter_s": 1110.0963275432587, "time_total_s": 261870.01174902916, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 176114.24099111557, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 11.884556962025318, "ram_util_percent": 15.902531645569624}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2532.910118416508, "episode_reward_min": -2759.4730966178463, "episode_reward_mean": -2642.650488175608, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2665.2902338578447, -2626.699431255248, -2612.7672826729504, -2633.1021051375246, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.0269168229424, "mean_raw_obs_processing_ms": 1.8775805182840788, "mean_inference_ms": 7.643652283954368, "mean_action_processing_ms": 0.22878618984598048}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 828000, "timers": {"sample_time_ms": 1099254.693, "sample_throughput": 3.639, "learn_time_ms": 16392.319, "learn_throughput": 244.017, "update_time_ms": 46.966}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02081517336773686, "policy_loss": -0.06390952493529767, "vf_loss": 4510.49161529541, "vf_explained_var": -1.862645149230957e-09, "kl": 0.009355638059787452, "entropy": 49.96551465988159, "entropy_coeff": 0.001}}, "num_steps_sampled": 828000, "num_steps_trained": 828000}, "done": false, "episodes_total": 828, "training_iteration": 207, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_19-40-29", "timestamp": 1618141229, "time_this_iter_s": 1107.8713278770447, "time_total_s": 262977.8830769062, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 177222.11231899261, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 11.91274571972099, "ram_util_percent": 15.925364616360179}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2532.910118416508, "episode_reward_min": -2759.4730966178463, "episode_reward_mean": -2643.7128878113494, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2656.1245322695745, -2595.943916014089, -2646.4621324892482, -2685.850358361839, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.9810589493678, "mean_raw_obs_processing_ms": 1.877489233176285, "mean_inference_ms": 7.642702948118154, "mean_action_processing_ms": 0.22869298465992846}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 832000, "timers": {"sample_time_ms": 1099330.8, "sample_throughput": 3.639, "learn_time_ms": 16454.936, "learn_throughput": 243.088, "update_time_ms": 44.336}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.018207479326520115, "policy_loss": -0.062432596168946475, "vf_loss": 4475.875671386719, "vf_explained_var": -7.450580596923828e-09, "kl": 0.009675056528067216, "entropy": 50.12586259841919, "entropy_coeff": 0.001}}, "num_steps_sampled": 832000, "num_steps_trained": 832000}, "done": false, "episodes_total": 832, "training_iteration": 208, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_19-59-02", "timestamp": 1618142342, "time_this_iter_s": 1113.1513214111328, "time_total_s": 264091.03439831734, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 178335.26364040375, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 11.901829652996847, "ram_util_percent": 15.913564668769721}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2532.910118416508, "episode_reward_min": -2759.4730966178463, "episode_reward_mean": -2643.2382968429565, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2664.993883551407, -2628.324236411022, -2668.670602087533, -2688.8476508169592, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.9381300099544, "mean_raw_obs_processing_ms": 1.8773861657179816, "mean_inference_ms": 7.641808330123313, "mean_action_processing_ms": 0.22862020601424213}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 836000, "timers": {"sample_time_ms": 1100444.55, "sample_throughput": 3.635, "learn_time_ms": 15819.339, "learn_throughput": 252.855, "update_time_ms": 41.72}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.023648348811548203, "policy_loss": -0.07004273257916793, "vf_loss": 4700.932090759277, "vf_explained_var": -1.862645149230957e-08, "kl": 0.009640154312364757, "entropy": 50.02825105190277, "entropy_coeff": 0.001}}, "num_steps_sampled": 836000, "num_steps_trained": 836000}, "done": false, "episodes_total": 836, "training_iteration": 209, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_20-17-39", "timestamp": 1618143459, "time_this_iter_s": 1116.5876865386963, "time_total_s": 265207.62208485603, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 179451.85132694244, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 11.916740088105724, "ram_util_percent": 15.91327879169289}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2532.910118416508, "episode_reward_min": -2759.4730966178463, "episode_reward_mean": -2642.617762555139, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2713.2699821747156, -2630.354913329756, -2674.5183241114532, -2598.8073345197336, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.8983258538326, "mean_raw_obs_processing_ms": 1.8773054623501775, "mean_inference_ms": 7.640939583652862, "mean_action_processing_ms": 0.22855110602241024}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 840000, "timers": {"sample_time_ms": 1101423.709, "sample_throughput": 3.632, "learn_time_ms": 16427.026, "learn_throughput": 243.501, "update_time_ms": 41.095}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.017883077292935923, "policy_loss": -0.06467400240944698, "vf_loss": 4688.464012145996, "vf_explained_var": 0.0, "kl": 0.009798068262171, "entropy": 50.316463470458984, "entropy_coeff": 0.001}}, "num_steps_sampled": 840000, "num_steps_trained": 840000}, "done": false, "episodes_total": 840, "training_iteration": 210, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_20-36-29", "timestamp": 1618144589, "time_this_iter_s": 1130.8654091358185, "time_total_s": 266338.48749399185, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 180582.71673607826, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 11.900496894409937, "ram_util_percent": 15.912298136645967}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2512.050541484681, "episode_reward_min": -2759.4730966178463, "episode_reward_mean": -2640.721070088113, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2587.433098701031, -2641.7575066087556, -2591.883367032404, -2612.3955386205353, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.8587242112194, "mean_raw_obs_processing_ms": 1.8772592876788539, "mean_inference_ms": 7.640133740482506, "mean_action_processing_ms": 0.22848288165306324}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 844000, "timers": {"sample_time_ms": 1099452.747, "sample_throughput": 3.638, "learn_time_ms": 16466.444, "learn_throughput": 242.918, "update_time_ms": 41.852}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.024570356006734073, "policy_loss": -0.06518505272106268, "vf_loss": 4212.288948059082, "vf_explained_var": -9.313225746154785e-09, "kl": 0.009490797237958759, "entropy": 50.15593492984772, "entropy_coeff": 0.001}}, "num_steps_sampled": 844000, "num_steps_trained": 844000}, "done": false, "episodes_total": 844, "training_iteration": 211, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_20-55-01", "timestamp": 1618145701, "time_this_iter_s": 1111.7850623130798, "time_total_s": 267450.27255630493, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 181694.50179839134, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 11.917435249526218, "ram_util_percent": 15.918066961465573}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2512.050541484681, "episode_reward_min": -2759.4730966178463, "episode_reward_mean": -2643.184651971286, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2713.9082492596704, -2595.8996025775036, -2543.8125107623214, -2559.352986436296, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.8141919325356, "mean_raw_obs_processing_ms": 1.8772226932589209, "mean_inference_ms": 7.639272702911834, "mean_action_processing_ms": 0.22840264981872863}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 848000, "timers": {"sample_time_ms": 1099524.673, "sample_throughput": 3.638, "learn_time_ms": 16384.27, "learn_throughput": 244.137, "update_time_ms": 42.298}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.03325861998018809, "policy_loss": -0.08134387416066602, "vf_loss": 4677.698501586914, "vf_explained_var": 3.725290298461914e-09, "kl": 0.009984865930164233, "entropy": 49.871962547302246, "entropy_coeff": 0.001}}, "num_steps_sampled": 848000, "num_steps_trained": 848000}, "done": false, "episodes_total": 848, "training_iteration": 212, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_21-13-30", "timestamp": 1618146810, "time_this_iter_s": 1108.730545282364, "time_total_s": 268559.0031015873, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 182803.2323436737, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 11.8989226869455, "ram_util_percent": 15.911343472750321}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2512.050541484681, "episode_reward_min": -2759.4730966178463, "episode_reward_mean": -2644.7088826999766, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2666.634628371351, -2635.055399988219, -2580.4745918022027, -2668.7176954389224, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.7699580431954, "mean_raw_obs_processing_ms": 1.8771898758582912, "mean_inference_ms": 7.638390702445754, "mean_action_processing_ms": 0.22831737120602738}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 852000, "timers": {"sample_time_ms": 1098632.233, "sample_throughput": 3.641, "learn_time_ms": 16441.268, "learn_throughput": 243.29, "update_time_ms": 40.772}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.03131507306534331, "policy_loss": -0.07903965638251975, "vf_loss": 4683.71378326416, "vf_explained_var": -1.4901161193847656e-08, "kl": 0.009935079229762778, "entropy": 50.03759217262268, "entropy_coeff": 0.001}}, "num_steps_sampled": 852000, "num_steps_trained": 852000}, "done": false, "episodes_total": 852, "training_iteration": 213, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_21-31-54", "timestamp": 1618147914, "time_this_iter_s": 1104.1022210121155, "time_total_s": 269663.1053225994, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 183907.33456468582, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 11.902226463104327, "ram_util_percent": 15.915712468193387}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2512.050541484681, "episode_reward_min": -2759.4730966178463, "episode_reward_mean": -2644.715113604333, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2668.4486064062203, -2610.795111551842, -2645.483672193504, -2721.073737006808, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.7311419418704, "mean_raw_obs_processing_ms": 1.877171995894654, "mean_inference_ms": 7.637601431244633, "mean_action_processing_ms": 0.22822101334853684}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 856000, "timers": {"sample_time_ms": 1102415.67, "sample_throughput": 3.628, "learn_time_ms": 16381.15, "learn_throughput": 244.183, "update_time_ms": 38.413}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.03337964357342571, "policy_loss": -0.08014643203932792, "vf_loss": 4602.562103271484, "vf_explained_var": 3.725290298461914e-09, "kl": 0.009880156285362318, "entropy": 49.902345180511475, "entropy_coeff": 0.001}}, "num_steps_sampled": 856000, "num_steps_trained": 856000}, "done": false, "episodes_total": 856, "training_iteration": 214, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_21-50-59", "timestamp": 1618149059, "time_this_iter_s": 1144.939826965332, "time_total_s": 270808.04514956474, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 185052.27439165115, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 11.918220858895706, "ram_util_percent": 15.913680981595096}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2512.050541484681, "episode_reward_min": -2759.4730966178463, "episode_reward_mean": -2642.848929176404, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2593.2039278031743, -2691.666579198062, -2678.7152587689543, -2726.9138241141736, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.6933052394431, "mean_raw_obs_processing_ms": 1.8771408052997414, "mean_inference_ms": 7.636945074562529, "mean_action_processing_ms": 0.228123442072686}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 860000, "timers": {"sample_time_ms": 1099701.757, "sample_throughput": 3.637, "learn_time_ms": 16428.27, "learn_throughput": 243.483, "update_time_ms": 39.795}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.024517319398000836, "policy_loss": -0.06830871547572315, "vf_loss": 4379.18058013916, "vf_explained_var": -1.1175870895385742e-08, "kl": 0.009760799002833664, "entropy": 50.032126903533936, "entropy_coeff": 0.001}}, "num_steps_sampled": 860000, "num_steps_trained": 860000}, "done": false, "episodes_total": 860, "training_iteration": 215, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_22-09-33", "timestamp": 1618150173, "time_this_iter_s": 1113.6618626117706, "time_total_s": 271921.7070121765, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 186165.93625426292, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 11.915762925598992, "ram_util_percent": 15.907313997477933}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2512.050541484681, "episode_reward_min": -2759.4730966178463, "episode_reward_mean": -2639.359828054962, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2639.7285049056227, -2724.8740516097932, -2644.609231426685, -2610.3600236610114, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.6562678637156, "mean_raw_obs_processing_ms": 1.8771410677488947, "mean_inference_ms": 7.636253244055204, "mean_action_processing_ms": 0.22802402586259185}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 864000, "timers": {"sample_time_ms": 1101852.486, "sample_throughput": 3.63, "learn_time_ms": 16418.179, "learn_throughput": 243.632, "update_time_ms": 37.567}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.028941426775418222, "policy_loss": -0.07437918911455199, "vf_loss": 4507.765426635742, "vf_explained_var": -1.4901161193847656e-08, "kl": 0.009815162513405085, "entropy": 49.95026469230652, "entropy_coeff": 0.001}}, "num_steps_sampled": 864000, "num_steps_trained": 864000}, "done": false, "episodes_total": 864, "training_iteration": 216, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_22-28-24", "timestamp": 1618151304, "time_this_iter_s": 1131.480536699295, "time_total_s": 273053.1875488758, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 187297.41679096222, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 14.132546583850933, "ram_util_percent": 16.677515527950312}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2512.050541484681, "episode_reward_min": -2759.4730966178463, "episode_reward_mean": -2638.9244885805483, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2611.0175634090824, -2664.9383463618706, -2678.738311042111, -2597.8518486335215, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.6205016871279, "mean_raw_obs_processing_ms": 1.8771727888859386, "mean_inference_ms": 7.6355958710320495, "mean_action_processing_ms": 0.22792345199565253}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 868000, "timers": {"sample_time_ms": 1104740.188, "sample_throughput": 3.621, "learn_time_ms": 16491.872, "learn_throughput": 242.544, "update_time_ms": 35.406}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.019208930316381156, "policy_loss": -0.06612321772263385, "vf_loss": 4578.161758422852, "vf_explained_var": -5.587935447692871e-09, "kl": 0.009904578502755612, "entropy": 49.63602817058563, "entropy_coeff": 0.001}}, "num_steps_sampled": 868000, "num_steps_trained": 868000}, "done": false, "episodes_total": 868, "training_iteration": 217, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_22-47-22", "timestamp": 1618152442, "time_this_iter_s": 1137.4508092403412, "time_total_s": 274190.63835811615, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 188434.86760020256, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 19.112469135802467, "ram_util_percent": 20.834814814814813}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2512.050541484681, "episode_reward_min": -2759.4730966178463, "episode_reward_mean": -2640.3132148535647, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2694.127753898394, -2613.2191694308235, -2613.8118918106097, -2556.6038925848593, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.5938661149571, "mean_raw_obs_processing_ms": 1.8772073097098838, "mean_inference_ms": 7.635105162311871, "mean_action_processing_ms": 0.22780430355067835}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 872000, "timers": {"sample_time_ms": 1111299.254, "sample_throughput": 3.599, "learn_time_ms": 15855.812, "learn_throughput": 252.273, "update_time_ms": 33.499}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.015438642236404121, "policy_loss": -0.06171314846142195, "vf_loss": 4631.298400878906, "vf_explained_var": -3.725290298461914e-09, "kl": 0.009699883521534503, "entropy": 49.75795269012451, "entropy_coeff": 0.001}}, "num_steps_sampled": 872000, "num_steps_trained": 872000}, "done": false, "episodes_total": 872, "training_iteration": 218, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_23-06-54", "timestamp": 1618153614, "time_this_iter_s": 1172.3622336387634, "time_total_s": 275363.0005917549, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 189607.22983384132, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 23.164448441247004, "ram_util_percent": 22.3697242206235}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2503.3509113464524, "episode_reward_min": -2759.4730966178463, "episode_reward_mean": -2638.2886539570945, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2578.333424038074, -2576.074788363252, -2562.989559714337, -2588.4802145470417, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.574670308953, "mean_raw_obs_processing_ms": 1.877250629540539, "mean_inference_ms": 7.6345888337447505, "mean_action_processing_ms": 0.2277011485319251}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 876000, "timers": {"sample_time_ms": 1115854.705, "sample_throughput": 3.585, "learn_time_ms": 16470.703, "learn_throughput": 242.855, "update_time_ms": 34.033}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02216589087038301, "policy_loss": -0.06514998778584413, "vf_loss": 4218.991859436035, "vf_explained_var": -2.2351741790771484e-08, "kl": 0.009893198759527877, "entropy": 49.91619372367859, "entropy_coeff": 0.001}}, "num_steps_sampled": 876000, "num_steps_trained": 876000}, "done": false, "episodes_total": 876, "training_iteration": 219, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_23-26-23", "timestamp": 1618154783, "time_this_iter_s": 1168.2962899208069, "time_total_s": 276531.2968816757, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 190775.52612376213, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 22.76861094407697, "ram_util_percent": 20.638484666265782}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2759.4730966178463, "episode_reward_mean": -2637.805278119608, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2650.4059721576427, -2702.9429281434936, -2615.295565204444, -2679.752331326749, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.5632857449536, "mean_raw_obs_processing_ms": 1.8773038894313783, "mean_inference_ms": 7.634094888489885, "mean_action_processing_ms": 0.2276081371600467}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 880000, "timers": {"sample_time_ms": 1119621.153, "sample_throughput": 3.573, "learn_time_ms": 16527.466, "learn_throughput": 242.021, "update_time_ms": 33.513}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.025775117974262685, "policy_loss": -0.06921179901110008, "vf_loss": 4406.85205078125, "vf_explained_var": -2.2351741790771484e-08, "kl": 0.009658489434514195, "entropy": 50.13913559913635, "entropy_coeff": 0.001}}, "num_steps_sampled": 880000, "num_steps_trained": 880000}, "done": false, "episodes_total": 880, "training_iteration": 220, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-11_23-45-52", "timestamp": 1618155952, "time_this_iter_s": 1169.0925073623657, "time_total_s": 277700.3893890381, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 191944.6186311245, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 21.40174174174174, "ram_util_percent": 20.20144144144144}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2759.4730966178463, "episode_reward_mean": -2635.6517880356314, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2640.425520308056, -2605.9346336019557, -2679.4887189168344, -2680.7626140686416, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.5511756461398, "mean_raw_obs_processing_ms": 1.8773788208902351, "mean_inference_ms": 7.633584987636757, "mean_action_processing_ms": 0.22751133413156993}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 884000, "timers": {"sample_time_ms": 1122129.961, "sample_throughput": 3.565, "learn_time_ms": 16687.865, "learn_throughput": 239.695, "update_time_ms": 34.038}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02246991836000234, "policy_loss": -0.06582954313489608, "vf_loss": 4334.468078613281, "vf_explained_var": -1.862645149230957e-09, "kl": 0.009754305792739615, "entropy": 49.98348641395569, "entropy_coeff": 0.001}}, "num_steps_sampled": 884000, "num_steps_trained": 884000}, "done": false, "episodes_total": 884, "training_iteration": 221, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_00-04-50", "timestamp": 1618157090, "time_this_iter_s": 1138.4812443256378, "time_total_s": 278838.8706333637, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 193083.09987545013, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 21.466481481481484, "ram_util_percent": 20.22148148148148}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2759.4730966178463, "episode_reward_mean": -2631.1668133237627, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2728.213805286852, -2648.5017841418353, -2658.2906109391033, -2611.5039500205103, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.5435387915546, "mean_raw_obs_processing_ms": 1.8774675739985176, "mean_inference_ms": 7.633175031581758, "mean_action_processing_ms": 0.22740189302852648}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 888000, "timers": {"sample_time_ms": 1125752.718, "sample_throughput": 3.553, "learn_time_ms": 16683.214, "learn_throughput": 239.762, "update_time_ms": 33.712}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.017813191807363182, "policy_loss": -0.05918514373479411, "vf_loss": 4077.160972595215, "vf_explained_var": -7.450580596923828e-09, "kl": 0.009897065290715545, "entropy": 50.12984323501587, "entropy_coeff": 0.001}}, "num_steps_sampled": 888000, "num_steps_trained": 888000}, "done": false, "episodes_total": 888, "training_iteration": 222, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_00-23-55", "timestamp": 1618158235, "time_this_iter_s": 1144.909204006195, "time_total_s": 279983.7798373699, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 194228.00907945633, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 21.533496932515337, "ram_util_percent": 20.23723926380368}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2759.4730966178463, "episode_reward_mean": -2629.9217828134147, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2598.857508349934, -2615.6485253930564, -2571.1455688249157, -2620.362849406055, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.546887876372, "mean_raw_obs_processing_ms": 1.8775345164192347, "mean_inference_ms": 7.632819490784019, "mean_action_processing_ms": 0.22729052495448201}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 892000, "timers": {"sample_time_ms": 1135672.314, "sample_throughput": 3.522, "learn_time_ms": 16656.711, "learn_throughput": 240.143, "update_time_ms": 35.471}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.022599084302783012, "policy_loss": -0.06965429696720093, "vf_loss": 4529.497184753418, "vf_explained_var": -1.4901161193847656e-08, "kl": 0.010066132730571553, "entropy": 49.836548924446106, "entropy_coeff": 0.001}}, "num_steps_sampled": 892000, "num_steps_trained": 892000}, "done": false, "episodes_total": 892, "training_iteration": 223, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_00-43-58", "timestamp": 1618159438, "time_this_iter_s": 1203.0505757331848, "time_total_s": 281186.8304131031, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 195431.0596551895, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 21.50367775831874, "ram_util_percent": 20.281727962638648}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2759.4730966178463, "episode_reward_mean": -2630.6743370247095, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2582.2818856414037, -2683.9571491463744, -2608.544013534522, -2643.5975718893333, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.5530871652783, "mean_raw_obs_processing_ms": 1.8776121382075892, "mean_inference_ms": 7.63250197201115, "mean_action_processing_ms": 0.227193870385169}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 896000, "timers": {"sample_time_ms": 1134364.275, "sample_throughput": 3.526, "learn_time_ms": 16709.057, "learn_throughput": 239.391, "update_time_ms": 36.359}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02311993669718504, "policy_loss": -0.06632559059653431, "vf_loss": 4440.766510009766, "vf_explained_var": -1.862645149230957e-09, "kl": 0.009500203712377697, "entropy": 49.89797568321228, "entropy_coeff": 0.001}}, "num_steps_sampled": 896000, "num_steps_trained": 896000}, "done": false, "episodes_total": 896, "training_iteration": 224, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_01-02-51", "timestamp": 1618160571, "time_this_iter_s": 1132.391968011856, "time_total_s": 282319.22238111496, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 196563.45162320137, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 21.50235878336437, "ram_util_percent": 20.296896337678465}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2759.4730966178463, "episode_reward_mean": -2631.329324297499, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2665.6273484475137, -2657.4024535894837, -2602.9374676287357, -2670.7536824504004, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.56195671395, "mean_raw_obs_processing_ms": 1.877687565892498, "mean_inference_ms": 7.632205725431191, "mean_action_processing_ms": 0.22710896073697637}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 900000, "timers": {"sample_time_ms": 1137647.937, "sample_throughput": 3.516, "learn_time_ms": 16732.617, "learn_throughput": 239.054, "update_time_ms": 34.751}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.025738655123859644, "policy_loss": -0.07177870196755975, "vf_loss": 4468.964164733887, "vf_explained_var": -1.862645149230957e-09, "kl": 0.009990735445171595, "entropy": 49.85991597175598, "entropy_coeff": 0.001}}, "num_steps_sampled": 900000, "num_steps_trained": 900000}, "done": false, "episodes_total": 900, "training_iteration": 225, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_01-21-57", "timestamp": 1618161717, "time_this_iter_s": 1146.7180182933807, "time_total_s": 283465.94039940834, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 197710.16964149475, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 21.413839559093695, "ram_util_percent": 20.29699938763013}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2759.4730966178463, "episode_reward_mean": -2631.139268345017, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2698.982779104327, -2759.4730966178463, -2562.6662000958, -2649.9984637015773, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.57343598263, "mean_raw_obs_processing_ms": 1.8777625930568624, "mean_inference_ms": 7.631880936945013, "mean_action_processing_ms": 0.22702769354089128}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 904000, "timers": {"sample_time_ms": 1139798.482, "sample_throughput": 3.509, "learn_time_ms": 16827.115, "learn_throughput": 237.712, "update_time_ms": 35.511}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.014619582798331976, "policy_loss": -0.06406581727787852, "vf_loss": 4770.683219909668, "vf_explained_var": -3.725290298461914e-09, "kl": 0.009980666305636987, "entropy": 49.41930377483368, "entropy_coeff": 0.001}}, "num_steps_sampled": 904000, "num_steps_trained": 904000}, "done": false, "episodes_total": 904, "training_iteration": 226, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_01-41-11", "timestamp": 1618162871, "time_this_iter_s": 1153.9385769367218, "time_total_s": 284619.87897634506, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 198864.10821843147, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 21.49104750304507, "ram_util_percent": 20.29129110840439}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2749.531528153844, "episode_reward_mean": -2627.3115490253886, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2651.5465434149473, -2742.4489530205838, -2749.531528153844, -2704.4855472706085, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.5934090894749, "mean_raw_obs_processing_ms": 1.8778121407609387, "mean_inference_ms": 7.63176036922498, "mean_action_processing_ms": 0.22695140941052042}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 908000, "timers": {"sample_time_ms": 1144467.412, "sample_throughput": 3.495, "learn_time_ms": 16735.079, "learn_throughput": 239.019, "update_time_ms": 35.162}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.019503412360791117, "policy_loss": -0.06430708669358864, "vf_loss": 4412.97819519043, "vf_explained_var": -3.725290298461914e-09, "kl": 0.009940729913068935, "entropy": 50.28010880947113, "entropy_coeff": 0.001}}, "num_steps_sampled": 908000, "num_steps_trained": 908000}, "done": false, "episodes_total": 908, "training_iteration": 227, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_02-00-55", "timestamp": 1618164055, "time_this_iter_s": 1183.2153692245483, "time_total_s": 285803.0943455696, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 200047.32358765602, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 21.553741092636578, "ram_util_percent": 20.292399049881237}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2728.5899288765745, "episode_reward_mean": -2624.8333575001107, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2641.752968671012, -2699.001984847141, -2658.4007348475707, -2684.771435536813, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.617837611864, "mean_raw_obs_processing_ms": 1.8779075448963851, "mean_inference_ms": 7.631582540081383, "mean_action_processing_ms": 0.22687894974492728}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 912000, "timers": {"sample_time_ms": 1141803.16, "sample_throughput": 3.503, "learn_time_ms": 17386.442, "learn_throughput": 230.064, "update_time_ms": 35.52}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.022308657236862928, "policy_loss": -0.07146169293264393, "vf_loss": 4721.773529052734, "vf_explained_var": 5.587935447692871e-09, "kl": 0.010071813710965216, "entropy": 49.690606474876404, "entropy_coeff": 0.001}}, "num_steps_sampled": 912000, "num_steps_trained": 912000}, "done": false, "episodes_total": 912, "training_iteration": 228, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_02-20-07", "timestamp": 1618165207, "time_this_iter_s": 1152.2368965148926, "time_total_s": 286955.3312420845, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 201199.5604841709, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 21.48470444850701, "ram_util_percent": 20.295246800731267}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2728.5899288765745, "episode_reward_mean": -2620.330955753435, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2596.785424132545, -2532.910118416508, -2634.3370426544025, -2629.177319687376, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.6459136729303, "mean_raw_obs_processing_ms": 1.877982974347738, "mean_inference_ms": 7.631394445218716, "mean_action_processing_ms": 0.22681093668276786}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 916000, "timers": {"sample_time_ms": 1138732.484, "sample_throughput": 3.513, "learn_time_ms": 17372.285, "learn_throughput": 230.252, "update_time_ms": 33.704}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02286318936967291, "policy_loss": -0.07207917387131602, "vf_loss": 4695.816123962402, "vf_explained_var": -9.313225746154785e-09, "kl": 0.01018276673858054, "entropy": 49.93680453300476, "entropy_coeff": 0.001}}, "num_steps_sampled": 916000, "num_steps_trained": 916000}, "done": false, "episodes_total": 916, "training_iteration": 229, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_02-39-04", "timestamp": 1618166344, "time_this_iter_s": 1137.4380614757538, "time_total_s": 288092.76930356026, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 202336.99854564667, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 21.496479308214948, "ram_util_percent": 20.297220506485488}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2728.5899288765745, "episode_reward_mean": -2620.053855936985, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2677.4345329086464, -2611.9287784746757, -2728.5899288765745, -2563.0064089826296, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.6715180968266, "mean_raw_obs_processing_ms": 1.8780582255540927, "mean_inference_ms": 7.631154884540174, "mean_action_processing_ms": 0.2267584943481113}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 920000, "timers": {"sample_time_ms": 1134409.465, "sample_throughput": 3.526, "learn_time_ms": 17321.293, "learn_throughput": 230.93, "update_time_ms": 35.173}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02899291057838127, "policy_loss": -0.07527619993197732, "vf_loss": 4481.737533569336, "vf_explained_var": 0.0, "kl": 0.009981981856981292, "entropy": 49.699533343315125, "entropy_coeff": 0.001}}, "num_steps_sampled": 920000, "num_steps_trained": 920000}, "done": false, "episodes_total": 920, "training_iteration": 230, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_02-57-50", "timestamp": 1618167470, "time_this_iter_s": 1125.3668086528778, "time_total_s": 289218.13611221313, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 203462.36535429955, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 21.516791510611736, "ram_util_percent": 20.290823970037458}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2717.2085095561815, "episode_reward_mean": -2617.3896714166817, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2632.258442859032, -2617.158290869554, -2663.9378028922424, -2672.4186459667962, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.7016021145763, "mean_raw_obs_processing_ms": 1.8781389172915397, "mean_inference_ms": 7.630980598604025, "mean_action_processing_ms": 0.22671842797167074}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 924000, "timers": {"sample_time_ms": 1135826.542, "sample_throughput": 3.522, "learn_time_ms": 16801.471, "learn_throughput": 238.074, "update_time_ms": 33.552}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01917469725594856, "policy_loss": -0.06428071003756486, "vf_loss": 4377.02091217041, "vf_explained_var": -1.1175870895385742e-08, "kl": 0.010010390164097771, "entropy": 49.975263714790344, "entropy_coeff": 0.001}}, "num_steps_sampled": 924000, "num_steps_trained": 924000}, "done": false, "episodes_total": 924, "training_iteration": 231, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_03-16-57", "timestamp": 1618168617, "time_this_iter_s": 1147.4375758171082, "time_total_s": 290365.57368803024, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 204609.80293011665, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 21.386964504283966, "ram_util_percent": 20.296940024479813}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2717.2085095561815, "episode_reward_mean": -2614.463463613121, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2645.578210146034, -2652.4455680437873, -2673.887189393669, -2672.1880489142, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.7363601507918, "mean_raw_obs_processing_ms": 1.8782231629322337, "mean_inference_ms": 7.630895661433961, "mean_action_processing_ms": 0.22669331384783833}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 928000, "timers": {"sample_time_ms": 1136499.069, "sample_throughput": 3.52, "learn_time_ms": 16881.444, "learn_throughput": 236.947, "update_time_ms": 35.414}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.018096316256560385, "policy_loss": -0.060846630338346586, "vf_loss": 4092.0600090026855, "vf_explained_var": -3.725290298461914e-09, "kl": 0.010069314419524744, "entropy": 49.78338408470154, "entropy_coeff": 0.001}}, "num_steps_sampled": 928000, "num_steps_trained": 928000}, "done": false, "episodes_total": 928, "training_iteration": 232, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_03-36-10", "timestamp": 1618169770, "time_this_iter_s": 1152.4522132873535, "time_total_s": 291518.0259013176, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 205762.255143404, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 20.939670932358318, "ram_util_percent": 20.306337599024992}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2717.2085095561815, "episode_reward_mean": -2613.4104167237006, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2614.3949929454993, -2592.64288063947, -2613.685009612739, -2716.198959097717, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.7715585314415, "mean_raw_obs_processing_ms": 1.8783223237129951, "mean_inference_ms": 7.6308103727455725, "mean_action_processing_ms": 0.2266840836826035}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 932000, "timers": {"sample_time_ms": 1127608.255, "sample_throughput": 3.547, "learn_time_ms": 16514.701, "learn_throughput": 242.208, "update_time_ms": 34.901}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02838666326715611, "policy_loss": -0.0761134986532852, "vf_loss": 4301.719757080078, "vf_explained_var": -1.862645149230957e-09, "kl": 0.010608840268105268, "entropy": 49.66894829273224, "entropy_coeff": 0.001}}, "num_steps_sampled": 932000, "num_steps_trained": 932000}, "done": false, "episodes_total": 932, "training_iteration": 233, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_03-54-40", "timestamp": 1618170880, "time_this_iter_s": 1110.4700219631195, "time_total_s": 292628.4959232807, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 206872.72516536713, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 14.139620253164557, "ram_util_percent": 18.205379746835444}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2717.2085095561815, "episode_reward_mean": -2612.0724423535144, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2597.5663978394864, -2640.497790777282, -2673.894922947504, -2676.823832520921, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.8055489074768, "mean_raw_obs_processing_ms": 1.8784624447766425, "mean_inference_ms": 7.630716874816393, "mean_action_processing_ms": 0.22668113727092018}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 936000, "timers": {"sample_time_ms": 1125830.847, "sample_throughput": 3.553, "learn_time_ms": 16418.549, "learn_throughput": 243.627, "update_time_ms": 33.195}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02311877613828983, "policy_loss": -0.06915078783640638, "vf_loss": 4427.262619018555, "vf_explained_var": 1.862645149230957e-09, "kl": 0.010020484100095928, "entropy": 49.603421092033386, "entropy_coeff": 0.001}}, "num_steps_sampled": 936000, "num_steps_trained": 936000}, "done": false, "episodes_total": 936, "training_iteration": 234, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_04-13-14", "timestamp": 1618171994, "time_this_iter_s": 1113.6393103599548, "time_total_s": 293742.13523364067, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 207986.36447572708, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 11.79546027742749, "ram_util_percent": 17.42843631778058}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2717.2085095561815, "episode_reward_mean": -2608.9951167852178, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2677.7656456406617, -2613.5731457654774, -2512.050541484681, -2623.8919745422186, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.8369174328053, "mean_raw_obs_processing_ms": 1.8785793853183321, "mean_inference_ms": 7.630650704999542, "mean_action_processing_ms": 0.22665822527497803}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 940000, "timers": {"sample_time_ms": 1122067.899, "sample_throughput": 3.565, "learn_time_ms": 16384.917, "learn_throughput": 244.127, "update_time_ms": 34.75}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.016246229963144287, "policy_loss": -0.05959689499286469, "vf_loss": 4361.41960144043, "vf_explained_var": -1.1175870895385742e-08, "kl": 0.009655311441747472, "entropy": 49.75454258918762, "entropy_coeff": 0.001}}, "num_steps_sampled": 940000, "num_steps_trained": 940000}, "done": false, "episodes_total": 940, "training_iteration": 235, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_04-31-43", "timestamp": 1618173103, "time_this_iter_s": 1108.7677490711212, "time_total_s": 294850.9029827118, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 209095.1322247982, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 11.586058301647654, "ram_util_percent": 17.42414448669202}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2717.2085095561815, "episode_reward_mean": -2609.4933815117947, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2601.035105507918, -2715.4154131454297, -2650.749652031453, -2712.6275285952534, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.8711140326081, "mean_raw_obs_processing_ms": 1.8786803467659388, "mean_inference_ms": 7.630579593212149, "mean_action_processing_ms": 0.22663701126672134}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 944000, "timers": {"sample_time_ms": 1120768.384, "sample_throughput": 3.569, "learn_time_ms": 16230.153, "learn_throughput": 246.455, "update_time_ms": 40.544}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02970033383462578, "policy_loss": -0.07576104887994006, "vf_loss": 4315.816452026367, "vf_explained_var": -5.587935447692871e-09, "kl": 0.010313460021279752, "entropy": 49.96197962760925, "entropy_coeff": 0.001}}, "num_steps_sampled": 944000, "num_steps_trained": 944000}, "done": false, "episodes_total": 944, "training_iteration": 236, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_04-50-42", "timestamp": 1618174242, "time_this_iter_s": 1139.4667580127716, "time_total_s": 295990.36974072456, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 210234.59898281097, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 11.564673242909986, "ram_util_percent": 17.420036991368686}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2717.2085095561815, "episode_reward_mean": -2607.0602474536727, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2691.614119381049, -2568.061295346729, -2631.96735580559, -2673.753651371455, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.9050318516037, "mean_raw_obs_processing_ms": 1.8787713758969737, "mean_inference_ms": 7.630457241215222, "mean_action_processing_ms": 0.22661662904864413}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 948000, "timers": {"sample_time_ms": 1113074.76, "sample_throughput": 3.594, "learn_time_ms": 16245.475, "learn_throughput": 246.222, "update_time_ms": 40.941}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.017542912159115076, "policy_loss": -0.06223409663653001, "vf_loss": 4435.621192932129, "vf_explained_var": -1.862645149230957e-09, "kl": 0.009809111419599503, "entropy": 49.94438028335571, "entropy_coeff": 0.001}}, "num_steps_sampled": 948000, "num_steps_trained": 948000}, "done": false, "episodes_total": 948, "training_iteration": 237, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_05-09-09", "timestamp": 1618175349, "time_this_iter_s": 1106.4362478256226, "time_total_s": 297096.8059885502, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 211341.0352306366, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 11.582106598984772, "ram_util_percent": 17.429505076142135}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2717.2085095561815, "episode_reward_mean": -2607.76813129921, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2595.918149491975, -2662.6302630039554, -2624.6569069011844, -2668.300086639219, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.9395147803813, "mean_raw_obs_processing_ms": 1.878879446784356, "mean_inference_ms": 7.630278220212216, "mean_action_processing_ms": 0.22661798799328994}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 952000, "timers": {"sample_time_ms": 1108645.958, "sample_throughput": 3.608, "learn_time_ms": 16195.111, "learn_throughput": 246.988, "update_time_ms": 42.992}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.018381503658019938, "policy_loss": -0.06709542108001187, "vf_loss": 4460.614593505859, "vf_explained_var": 1.1175870895385742e-08, "kl": 0.010457234049681574, "entropy": 49.4937139749527, "entropy_coeff": 0.001}}, "num_steps_sampled": 952000, "num_steps_trained": 952000}, "done": false, "episodes_total": 952, "training_iteration": 238, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_05-27-36", "timestamp": 1618176456, "time_this_iter_s": 1107.4697256088257, "time_total_s": 298204.275714159, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 212448.50495624542, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 11.576522842639593, "ram_util_percent": 17.428743654822338}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2717.2085095561815, "episode_reward_mean": -2606.2584611072634, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2562.076532617119, -2610.1475273154, -2603.007912572867, -2683.9507118601023, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 544.969918225852, "mean_raw_obs_processing_ms": 1.8789888121703218, "mean_inference_ms": 7.630048238788036, "mean_action_processing_ms": 0.2266134193774429}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 956000, "timers": {"sample_time_ms": 1105883.089, "sample_throughput": 3.617, "learn_time_ms": 16218.793, "learn_throughput": 246.627, "update_time_ms": 45.247}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01959567843005061, "policy_loss": -0.06785672990372404, "vf_loss": 4616.6085205078125, "vf_explained_var": 5.587935447692871e-09, "kl": 0.01007853081682697, "entropy": 49.565375328063965, "entropy_coeff": 0.001}}, "num_steps_sampled": 956000, "num_steps_trained": 956000}, "done": false, "episodes_total": 956, "training_iteration": 239, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_05-46-06", "timestamp": 1618177566, "time_this_iter_s": 1110.0605990886688, "time_total_s": 299314.3363132477, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 213558.5655553341, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 11.583111954459204, "ram_util_percent": 17.430170777988618}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2717.2085095561815, "episode_reward_mean": -2605.7284902366905, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2622.5131147218945, -2595.8870490483328, -2556.9302696748605, -2566.259044295072, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.0029783197335, "mean_raw_obs_processing_ms": 1.8791032491699635, "mean_inference_ms": 7.629825871885148, "mean_action_processing_ms": 0.22660037358934937}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 960000, "timers": {"sample_time_ms": 1107092.904, "sample_throughput": 3.613, "learn_time_ms": 15963.178, "learn_throughput": 250.577, "update_time_ms": 40.843}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.014409837647690438, "policy_loss": -0.06148710132401902, "vf_loss": 4485.391258239746, "vf_explained_var": -1.1175870895385742e-08, "kl": 0.01004184881458059, "entropy": 49.24896311759949, "entropy_coeff": 0.001}}, "num_steps_sampled": 960000, "num_steps_trained": 960000}, "done": false, "episodes_total": 960, "training_iteration": 240, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_06-05-01", "timestamp": 1618178701, "time_this_iter_s": 1134.8647491931915, "time_total_s": 300449.2010624409, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 214693.43030452728, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 11.562538699690402, "ram_util_percent": 17.425386996904027}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2717.2085095561815, "episode_reward_mean": -2607.606591952765, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2553.205287631489, -2649.7951284440155, -2695.1371774763365, -2677.900270609925, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.0330501682655, "mean_raw_obs_processing_ms": 1.8792148171417842, "mean_inference_ms": 7.62956010221879, "mean_action_processing_ms": 0.22658958682038385}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 964000, "timers": {"sample_time_ms": 1102423.798, "sample_throughput": 3.628, "learn_time_ms": 16274.388, "learn_throughput": 245.785, "update_time_ms": 40.318}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.015712796506704763, "policy_loss": -0.06213325235876255, "vf_loss": 4525.181121826172, "vf_explained_var": 9.313225746154785e-09, "kl": 0.009894809045363218, "entropy": 49.549978256225586, "entropy_coeff": 0.001}}, "num_steps_sampled": 964000, "num_steps_trained": 964000}, "done": false, "episodes_total": 964, "training_iteration": 241, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_06-23-25", "timestamp": 1618179805, "time_this_iter_s": 1103.8534140586853, "time_total_s": 301553.05447649956, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 215797.28371858597, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 11.585486950986635, "ram_util_percent": 17.432081476766392}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2717.2085095561815, "episode_reward_mean": -2606.4050965858487, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2603.3104519021063, -2657.2126305357824, -2713.6871047541654, -2717.2085095561815, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.0610214974753, "mean_raw_obs_processing_ms": 1.8793093088165636, "mean_inference_ms": 7.629246234767716, "mean_action_processing_ms": 0.22657589295241082}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 968000, "timers": {"sample_time_ms": 1099128.263, "sample_throughput": 3.639, "learn_time_ms": 15863.009, "learn_throughput": 252.159, "update_time_ms": 38.616}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.018753121490590274, "policy_loss": -0.0669494973262772, "vf_loss": 4574.629928588867, "vf_explained_var": 0.0, "kl": 0.010129996051546186, "entropy": 49.47406280040741, "entropy_coeff": 0.001}}, "num_steps_sampled": 968000, "num_steps_trained": 968000}, "done": false, "episodes_total": 968, "training_iteration": 242, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_06-42-01", "timestamp": 1618180921, "time_this_iter_s": 1115.365692615509, "time_total_s": 302668.42016911507, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 216912.64941120148, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 11.942164883574574, "ram_util_percent": 17.444304594084333}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2711.5714086329285, "episode_reward_mean": -2604.786208522435, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2572.164251875855, -2640.03452604259, -2503.3509113464524, -2559.7569288127142, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.0805746618101, "mean_raw_obs_processing_ms": 1.8794118026365243, "mean_inference_ms": 7.628803874340945, "mean_action_processing_ms": 0.22657019209954762}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 972000, "timers": {"sample_time_ms": 1098636.267, "sample_throughput": 3.641, "learn_time_ms": 16108.578, "learn_throughput": 248.315, "update_time_ms": 38.137}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02128910511964932, "policy_loss": -0.07026780775049701, "vf_loss": 4493.6877517700195, "vf_explained_var": 1.30385160446167e-08, "kl": 0.010496226605027914, "entropy": 49.759528160095215, "entropy_coeff": 0.001}}, "num_steps_sampled": 972000, "num_steps_trained": 972000}, "done": false, "episodes_total": 972, "training_iteration": 243, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_07-00-29", "timestamp": 1618182029, "time_this_iter_s": 1108.0007770061493, "time_total_s": 303776.4209461212, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 218020.65018820763, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 11.591878172588835, "ram_util_percent": 17.433629441624365}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2473.3079583230046, "episode_reward_min": -2711.5714086329285, "episode_reward_mean": -2607.721473833482, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2626.9015578470558, -2473.3079583230046, -2534.431894238894, -2622.8989925051374, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.0936740800266, "mean_raw_obs_processing_ms": 1.8794847143802451, "mean_inference_ms": 7.628458634872348, "mean_action_processing_ms": 0.22656038709752063}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 976000, "timers": {"sample_time_ms": 1098223.772, "sample_throughput": 3.642, "learn_time_ms": 16105.314, "learn_throughput": 248.365, "update_time_ms": 39.988}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.020784631080459803, "policy_loss": -0.07043071376392618, "vf_loss": 4817.271270751953, "vf_explained_var": -9.313225746154785e-09, "kl": 0.009943798941094428, "entropy": 49.496358036994934, "entropy_coeff": 0.001}}, "num_steps_sampled": 976000, "num_steps_trained": 976000}, "done": false, "episodes_total": 976, "training_iteration": 244, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_07-18-58", "timestamp": 1618183138, "time_this_iter_s": 1109.5001134872437, "time_total_s": 304885.92105960846, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 219130.15030169487, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 11.571184293856872, "ram_util_percent": 17.433818872704247}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2476.313314102808, "episode_reward_min": -2711.5714086329285, "episode_reward_mean": -2609.624903029242, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2601.0625801310957, -2562.865869009201, -2632.20167648467, -2636.9176628096457, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.1033847316492, "mean_raw_obs_processing_ms": 1.8795411171472813, "mean_inference_ms": 7.628160222731512, "mean_action_processing_ms": 0.22654609023499422}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 980000, "timers": {"sample_time_ms": 1101089.051, "sample_throughput": 3.633, "learn_time_ms": 16093.788, "learn_throughput": 248.543, "update_time_ms": 43.933}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.019434099609497935, "policy_loss": -0.06505951008875854, "vf_loss": 4304.923568725586, "vf_explained_var": 0.0, "kl": 0.010155459778616205, "entropy": 49.478484749794006, "entropy_coeff": 0.001}}, "num_steps_sampled": 980000, "num_steps_trained": 980000}, "done": false, "episodes_total": 980, "training_iteration": 245, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_07-37-56", "timestamp": 1618184276, "time_this_iter_s": 1137.3614838123322, "time_total_s": 306023.2825434208, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 220267.5117855072, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 11.570925925925927, "ram_util_percent": 17.43067901234568}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2476.313314102808, "episode_reward_min": -2711.5714086329285, "episode_reward_mean": -2609.3158220437313, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2547.283649214905, -2492.876816516944, -2505.3364398334334, -2612.6171101433524, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.109542635878, "mean_raw_obs_processing_ms": 1.879572947568505, "mean_inference_ms": 7.627840469004139, "mean_action_processing_ms": 0.22652634089803642}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 984000, "timers": {"sample_time_ms": 1097641.849, "sample_throughput": 3.644, "learn_time_ms": 16185.365, "learn_throughput": 247.137, "update_time_ms": 37.359}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.016463132749777287, "policy_loss": -0.0628604421945056, "vf_loss": 4341.0834884643555, "vf_explained_var": 1.1175870895385742e-08, "kl": 0.01030964232631959, "entropy": 49.85849070549011, "entropy_coeff": 0.001}}, "num_steps_sampled": 984000, "num_steps_trained": 984000}, "done": false, "episodes_total": 984, "training_iteration": 246, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_07-56-21", "timestamp": 1618185381, "time_this_iter_s": 1105.8318047523499, "time_total_s": 307129.11434817314, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 221373.34359025955, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 11.591423125794156, "ram_util_percent": 17.435133418043204}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2476.313314102808, "episode_reward_min": -2711.5714086329285, "episode_reward_mean": -2611.3570801872206, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2625.3630551520246, -2624.2530283058763, -2694.150868986751, -2578.2401469088895, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.111976014732, "mean_raw_obs_processing_ms": 1.8795783003438589, "mean_inference_ms": 7.627571765924118, "mean_action_processing_ms": 0.22649995847249474}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 988000, "timers": {"sample_time_ms": 1098249.967, "sample_throughput": 3.642, "learn_time_ms": 16157.627, "learn_throughput": 247.561, "update_time_ms": 37.537}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01756252010818571, "policy_loss": -0.06457300501642749, "vf_loss": 4262.284873962402, "vf_explained_var": -1.1175870895385742e-08, "kl": 0.0105327669007238, "entropy": 49.60101842880249, "entropy_coeff": 0.001}}, "num_steps_sampled": 988000, "num_steps_trained": 988000}, "done": false, "episodes_total": 988, "training_iteration": 247, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_08-14-54", "timestamp": 1618186494, "time_this_iter_s": 1112.2417743206024, "time_total_s": 308241.35612249374, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 222485.58536458015, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 11.578837650031586, "ram_util_percent": 17.438155401137085}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2476.313314102808, "episode_reward_min": -2711.5714086329285, "episode_reward_mean": -2610.9490841603138, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.3020011338153, -2620.6727368197994, -2657.5223282471193, -2609.772806902689, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.1037257954672, "mean_raw_obs_processing_ms": 1.8795846919277763, "mean_inference_ms": 7.627275154993495, "mean_action_processing_ms": 0.2264752645181216}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 992000, "timers": {"sample_time_ms": 1098172.056, "sample_throughput": 3.642, "learn_time_ms": 16189.423, "learn_throughput": 247.075, "update_time_ms": 37.294}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.018466623208951205, "policy_loss": -0.06900970962306019, "vf_loss": 4702.681411743164, "vf_explained_var": -3.725290298461914e-09, "kl": 0.010310775018297136, "entropy": 49.33450222015381, "entropy_coeff": 0.001}}, "num_steps_sampled": 992000, "num_steps_trained": 992000}, "done": false, "episodes_total": 992, "training_iteration": 248, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_08-33-21", "timestamp": 1618187601, "time_this_iter_s": 1107.0021800994873, "time_total_s": 309348.35830259323, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 223592.58754467964, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 11.59796954314721, "ram_util_percent": 17.435025380710663}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2476.313314102808, "episode_reward_min": -2711.5714086329285, "episode_reward_mean": -2609.711985738559, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2671.277685332353, -2595.7068707460053, -2638.684979764231, -2678.209811647989, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.0967913625194, "mean_raw_obs_processing_ms": 1.8795773901315482, "mean_inference_ms": 7.627095944519157, "mean_action_processing_ms": 0.22644986442372508}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 996000, "timers": {"sample_time_ms": 1101928.592, "sample_throughput": 3.63, "learn_time_ms": 16181.179, "learn_throughput": 247.201, "update_time_ms": 37.708}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.020477557089179754, "policy_loss": -0.06631088050198741, "vf_loss": 4370.869163513184, "vf_explained_var": -3.725290298461914e-09, "kl": 0.010086393187521026, "entropy": 49.57601082324982, "entropy_coeff": 0.001}}, "num_steps_sampled": 996000, "num_steps_trained": 996000}, "done": false, "episodes_total": 996, "training_iteration": 249, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_08-52-28", "timestamp": 1618188748, "time_this_iter_s": 1147.5683498382568, "time_total_s": 310495.9266524315, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 224740.1558945179, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 12.892533659730724, "ram_util_percent": 17.694430844553246}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2476.313314102808, "episode_reward_min": -2711.5714086329285, "episode_reward_mean": -2607.964912572535, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2543.4591554401068, -2651.6834632315035, -2709.2935454344706, -2673.279192761893, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.0994828540722, "mean_raw_obs_processing_ms": 1.8795654285514474, "mean_inference_ms": 7.627038434199253, "mean_action_processing_ms": 0.22642994622292842}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1000000, "timers": {"sample_time_ms": 1112752.608, "sample_throughput": 3.595, "learn_time_ms": 16702.615, "learn_throughput": 239.483, "update_time_ms": 45.434}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.024219556944444776, "policy_loss": -0.0710578462749254, "vf_loss": 4382.450088500977, "vf_explained_var": -1.1175870895385742e-08, "kl": 0.010288528545061126, "entropy": 49.72295081615448, "entropy_coeff": 0.001}}, "num_steps_sampled": 1000000, "num_steps_trained": 1000000}, "done": false, "episodes_total": 1000, "training_iteration": 250, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_09-13-17", "timestamp": 1618189997, "time_this_iter_s": 1248.3994615077972, "time_total_s": 311744.3261139393, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 225988.5553560257, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 28.75120990433314, "ram_util_percent": 22.262070906021382}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2476.313314102808, "episode_reward_min": -2711.5714086329285, "episode_reward_mean": -2606.428060752457, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2665.299172257831, -2525.813658507146, -2534.2888485505546, -2562.9469282411674, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.1152351827036, "mean_raw_obs_processing_ms": 1.8795930297087438, "mean_inference_ms": 7.627019026311191, "mean_action_processing_ms": 0.22643091539963708}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1004000, "timers": {"sample_time_ms": 1131427.786, "sample_throughput": 3.535, "learn_time_ms": 16821.398, "learn_throughput": 237.792, "update_time_ms": 46.939}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.018595716974232346, "policy_loss": -0.0646902521548327, "vf_loss": 4381.101547241211, "vf_explained_var": 5.587935447692871e-09, "kl": 0.010175511473789811, "entropy": 49.87392044067383, "entropy_coeff": 0.001}}, "num_steps_sampled": 1004000, "num_steps_trained": 1004000}, "done": false, "episodes_total": 1004, "training_iteration": 251, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_09-34-49", "timestamp": 1618191289, "time_this_iter_s": 1291.8084948062897, "time_total_s": 313036.1346087456, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 227280.363850832, "timesteps_since_restore": 0, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 35.563186514410006, "ram_util_percent": 24.37830342577488}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2476.313314102808, "episode_reward_min": -2711.5714086329285, "episode_reward_mean": -2607.8981699963206, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2675.3102974273907, -2697.2195731603692, -2614.465866357261, -2613.1976823871983, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.1388461154769, "mean_raw_obs_processing_ms": 1.8796536135375994, "mean_inference_ms": 7.627043081047158, "mean_action_processing_ms": 0.22642508958216928}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1008000, "timers": {"sample_time_ms": 1146344.506, "sample_throughput": 3.489, "learn_time_ms": 17383.616, "learn_throughput": 230.102, "update_time_ms": 49.058}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.026203877408988774, "policy_loss": -0.07416271106922068, "vf_loss": 4551.629196166992, "vf_explained_var": -3.725290298461914e-09, "kl": 0.01014899360598065, "entropy": 49.5789749622345, "entropy_coeff": 0.001}}, "num_steps_sampled": 1008000, "num_steps_trained": 1008000}, "done": false, "episodes_total": 1008, "training_iteration": 252, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_09-55-59", "timestamp": 1618192559, "time_this_iter_s": 1270.1766855716705, "time_total_s": 314306.31129431725, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 228550.54053640366, "timesteps_since_restore": 0, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 34.40564471499723, "ram_util_percent": 24.335307138904263}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2476.313314102808, "episode_reward_min": -2711.5714086329285, "episode_reward_mean": -2604.280872011881, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2613.505143225536, -2504.2862820849246, -2518.8207330861505, -2597.074790838304, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.1672755390214, "mean_raw_obs_processing_ms": 1.879668710286937, "mean_inference_ms": 7.6272131304194115, "mean_action_processing_ms": 0.22642667970645597}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1012000, "timers": {"sample_time_ms": 1156384.344, "sample_throughput": 3.459, "learn_time_ms": 16828.077, "learn_throughput": 237.698, "update_time_ms": 47.568}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.023083721098373644, "policy_loss": -0.06753357575507835, "vf_loss": 4179.2373123168945, "vf_explained_var": -5.587935447692871e-09, "kl": 0.010173085902351886, "entropy": 49.487531423568726, "entropy_coeff": 0.001}}, "num_steps_sampled": 1012000, "num_steps_trained": 1012000}, "done": false, "episodes_total": 1012, "training_iteration": 253, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_10-16-02", "timestamp": 1618193762, "time_this_iter_s": 1202.8287553787231, "time_total_s": 315509.14004969597, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 229753.36929178238, "timesteps_since_restore": 0, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 24.108523058960888, "ram_util_percent": 21.895329830706363}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2476.313314102808, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2608.064028842266, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.699352866751, -2602.900878497228, -2505.9693874012273, -2646.9303044806497, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.2028958877607, "mean_raw_obs_processing_ms": 1.8797109670853955, "mean_inference_ms": 7.6274802346126975, "mean_action_processing_ms": 0.22642016430216066}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1016000, "timers": {"sample_time_ms": 1166799.391, "sample_throughput": 3.428, "learn_time_ms": 17438.554, "learn_throughput": 229.377, "update_time_ms": 49.405}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.012794411246431991, "policy_loss": -0.06502935770549811, "vf_loss": 4761.803352355957, "vf_explained_var": -7.450580596923828e-09, "kl": 0.010524159704800695, "entropy": 49.32762587070465, "entropy_coeff": 0.001}}, "num_steps_sampled": 1016000, "num_steps_trained": 1016000}, "done": false, "episodes_total": 1016, "training_iteration": 254, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_10-36-21", "timestamp": 1618194981, "time_this_iter_s": 1219.7759795188904, "time_total_s": 316728.91602921486, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 230973.14527130127, "timesteps_since_restore": 0, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 21.57384792626728, "ram_util_percent": 21.40714285714286}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2476.313314102808, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2608.0049611302475, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2634.0873843388063, -2635.3859651882954, -2527.915995901465, -2517.151851783611, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.238603436815, "mean_raw_obs_processing_ms": 1.8797851347903543, "mean_inference_ms": 7.627763386815436, "mean_action_processing_ms": 0.22641576388566528}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1020000, "timers": {"sample_time_ms": 1165461.647, "sample_throughput": 3.432, "learn_time_ms": 17567.59, "learn_throughput": 227.692, "update_time_ms": 45.553}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.019420087584876455, "policy_loss": -0.06665082869585603, "vf_loss": 4325.94522857666, "vf_explained_var": 0.0, "kl": 0.01048934503342025, "entropy": 49.794795989990234, "entropy_coeff": 0.001}}, "num_steps_sampled": 1020000, "num_steps_trained": 1020000}, "done": false, "episodes_total": 1020, "training_iteration": 255, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_10-55-07", "timestamp": 1618196107, "time_this_iter_s": 1125.2191994190216, "time_total_s": 317854.1352286339, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 232098.3644707203, "timesteps_since_restore": 0, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 21.573923892701185, "ram_util_percent": 21.41310043668122}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2476.313314102808, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2611.600109986224, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2523.2036051376544, -2657.685296727543, -2558.585600418166, -2553.677899948156, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.2725421904539, "mean_raw_obs_processing_ms": 1.8798917152807968, "mean_inference_ms": 7.6279919850444005, "mean_action_processing_ms": 0.2264020991410108}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1024000, "timers": {"sample_time_ms": 1168860.821, "sample_throughput": 3.422, "learn_time_ms": 17626.414, "learn_throughput": 226.932, "update_time_ms": 46.478}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01211003921343945, "policy_loss": -0.06466207531047985, "vf_loss": 4992.064193725586, "vf_explained_var": 0.0, "kl": 0.010140106489416212, "entropy": 49.34456384181976, "entropy_coeff": 0.001}}, "num_steps_sampled": 1024000, "num_steps_trained": 1024000}, "done": false, "episodes_total": 1024, "training_iteration": 256, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_11-14-07", "timestamp": 1618197247, "time_this_iter_s": 1140.4211452007294, "time_total_s": 318994.5563738346, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 233238.78561592102, "timesteps_since_restore": 0, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 21.605668515095502, "ram_util_percent": 21.41337030191004}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2476.313314102808, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2611.3790589100468, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2636.251428380778, -2641.1381430583674, -2626.3489728996547, -2635.0557832169106, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.3033799824722, "mean_raw_obs_processing_ms": 1.8799865216165508, "mean_inference_ms": 7.628097115876253, "mean_action_processing_ms": 0.2263926851461861}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1028000, "timers": {"sample_time_ms": 1169762.046, "sample_throughput": 3.419, "learn_time_ms": 17796.53, "learn_throughput": 224.763, "update_time_ms": 47.0}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.018968963500810787, "policy_loss": -0.06591160531388596, "vf_loss": 4332.692848205566, "vf_explained_var": -5.587935447692871e-09, "kl": 0.010381200059782714, "entropy": 49.59604096412659, "entropy_coeff": 0.001}}, "num_steps_sampled": 1028000, "num_steps_trained": 1028000}, "done": false, "episodes_total": 1028, "training_iteration": 257, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_11-32-50", "timestamp": 1618198370, "time_this_iter_s": 1122.9629163742065, "time_total_s": 320117.5192902088, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 234361.74853229523, "timesteps_since_restore": 0, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 21.60794246404003, "ram_util_percent": 21.399812382739213}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2476.313314102808, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2611.0936439131497, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2622.8122309719283, -2582.0487219014403, -2556.482318492901, -2641.781133910466, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.3424898431995, "mean_raw_obs_processing_ms": 1.8801101880625666, "mean_inference_ms": 7.628363955205129, "mean_action_processing_ms": 0.2263831278049058}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1032000, "timers": {"sample_time_ms": 1179281.031, "sample_throughput": 3.392, "learn_time_ms": 17806.81, "learn_throughput": 224.633, "update_time_ms": 48.07}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02048854540043976, "policy_loss": -0.06917413114570081, "vf_loss": 4490.066696166992, "vf_explained_var": -1.862645149230957e-09, "kl": 0.010397201811429113, "entropy": 49.50885510444641, "entropy_coeff": 0.001}}, "num_steps_sampled": 1032000, "num_steps_trained": 1032000}, "done": false, "episodes_total": 1032, "training_iteration": 258, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_11-52-53", "timestamp": 1618199573, "time_this_iter_s": 1202.3056614398956, "time_total_s": 321319.8249516487, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 235564.05419373512, "timesteps_since_restore": 0, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 21.349970777323204, "ram_util_percent": 21.317299824663944}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2476.313314102808, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2610.3258942968737, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2580.3568857956475, -2620.6469043191464, -2603.733283037984, -2476.313314102808, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.384466360277, "mean_raw_obs_processing_ms": 1.880233260268634, "mean_inference_ms": 7.628652271176495, "mean_action_processing_ms": 0.22636836834820592}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1036000, "timers": {"sample_time_ms": 1178539.766, "sample_throughput": 3.394, "learn_time_ms": 18061.56, "learn_throughput": 221.465, "update_time_ms": 47.568}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.027905496477615088, "policy_loss": -0.07202338159549981, "vf_loss": 4283.716606140137, "vf_explained_var": -1.862645149230957e-09, "kl": 0.009955348883522674, "entropy": 49.74821853637695, "entropy_coeff": 0.001}}, "num_steps_sampled": 1036000, "num_steps_trained": 1036000}, "done": false, "episodes_total": 1036, "training_iteration": 259, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_12-11-55", "timestamp": 1618200715, "time_this_iter_s": 1142.692284822464, "time_total_s": 322462.5172364712, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 236706.7464785576, "timesteps_since_restore": 0, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 21.332944068838355, "ram_util_percent": 21.324093423478796}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2610.6195498469765, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2626.073797211219, -2630.067687602071, -2621.994258318158, -2598.972036959244, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.4286717639008, "mean_raw_obs_processing_ms": 1.8803515332387977, "mean_inference_ms": 7.628936841577605, "mean_action_processing_ms": 0.226357961199639}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1040000, "timers": {"sample_time_ms": 1167386.76, "sample_throughput": 3.426, "learn_time_ms": 17761.735, "learn_throughput": 225.203, "update_time_ms": 43.782}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01627095678122714, "policy_loss": -0.06044359703082591, "vf_loss": 4129.907531738281, "vf_explained_var": -9.313225746154785e-09, "kl": 0.010147949040401727, "entropy": 49.142595171928406, "entropy_coeff": 0.001}}, "num_steps_sampled": 1040000, "num_steps_trained": 1040000}, "done": false, "episodes_total": 1040, "training_iteration": 260, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_12-30-49", "timestamp": 1618201849, "time_this_iter_s": 1133.8304018974304, "time_total_s": 323596.3476383686, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 237840.57688045502, "timesteps_since_restore": 0, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 16.89814126394052, "ram_util_percent": 20.06257744733581}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2611.656251291545, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2536.3677651277503, -2544.438625496559, -2671.1934171500397, -2684.514485693503, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.4695833860694, "mean_raw_obs_processing_ms": 1.880479726475395, "mean_inference_ms": 7.62916117652633, "mean_action_processing_ms": 0.22635072992201785}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1044000, "timers": {"sample_time_ms": 1148979.082, "sample_throughput": 3.481, "learn_time_ms": 17705.403, "learn_throughput": 225.92, "update_time_ms": 43.834}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.012013756146188825, "policy_loss": -0.061293874809052795, "vf_loss": 4591.311470031738, "vf_explained_var": 5.587935447692871e-09, "kl": 0.010290135949617252, "entropy": 49.37797689437866, "entropy_coeff": 0.001}}, "num_steps_sampled": 1044000, "num_steps_trained": 1044000}, "done": false, "episodes_total": 1044, "training_iteration": 261, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_12-49-16", "timestamp": 1618202956, "time_this_iter_s": 1107.1687107086182, "time_total_s": 324703.5163490772, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 238947.74559116364, "timesteps_since_restore": 0, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 11.755456852791877, "ram_util_percent": 18.54695431472081}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2613.4288236076354, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2667.550687685255, -2692.9060656411075, -2650.517668569589, -2625.2103845626457, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.513161925863, "mean_raw_obs_processing_ms": 1.8806212436889576, "mean_inference_ms": 7.629483770076658, "mean_action_processing_ms": 0.22635187921360284}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1048000, "timers": {"sample_time_ms": 1135449.999, "sample_throughput": 3.523, "learn_time_ms": 17485.838, "learn_throughput": 228.757, "update_time_ms": 42.238}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.026545013635768555, "policy_loss": -0.07790685517829843, "vf_loss": 4721.506034851074, "vf_explained_var": 5.587935447692871e-09, "kl": 0.010365054156864062, "entropy": 48.982210874557495, "entropy_coeff": 0.001}}, "num_steps_sampled": 1048000, "num_steps_trained": 1048000}, "done": false, "episodes_total": 1048, "training_iteration": 262, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_13-08-09", "timestamp": 1618204089, "time_this_iter_s": 1132.6737415790558, "time_total_s": 325836.1900906563, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 240080.4193327427, "timesteps_since_restore": 0, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 11.763670179789212, "ram_util_percent": 18.540793552386855}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2613.486456675678, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2610.152767465898, -2555.8814748577583, -2594.8056323552773, -2639.6985121627654, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.5569782008231, "mean_raw_obs_processing_ms": 1.8807607709710157, "mean_inference_ms": 7.629857704459112, "mean_action_processing_ms": 0.22633889622711706}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1052000, "timers": {"sample_time_ms": 1125599.243, "sample_throughput": 3.554, "learn_time_ms": 18139.457, "learn_throughput": 220.514, "update_time_ms": 42.405}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.014351922611240298, "policy_loss": -0.06359478112426586, "vf_loss": 4635.474464416504, "vf_explained_var": 5.587935447692871e-09, "kl": 0.010221912991255522, "entropy": 49.507174253463745, "entropy_coeff": 0.001}}, "num_steps_sampled": 1052000, "num_steps_trained": 1052000}, "done": false, "episodes_total": 1052, "training_iteration": 263, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_13-26-40", "timestamp": 1618205200, "time_this_iter_s": 1110.8591725826263, "time_total_s": 326947.0492632389, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 241191.27850532532, "timesteps_since_restore": 0, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 11.771410499683743, "ram_util_percent": 18.556862745098037}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2612.9800938852686, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2553.176029381406, -2563.6084321130606, -2651.353449347752, -2638.047686465977, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.6003076299553, "mean_raw_obs_processing_ms": 1.880923344158444, "mean_inference_ms": 7.630234826441958, "mean_action_processing_ms": 0.226328863157312}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1056000, "timers": {"sample_time_ms": 1114636.631, "sample_throughput": 3.589, "learn_time_ms": 17565.067, "learn_throughput": 227.725, "update_time_ms": 40.663}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02588620566530153, "policy_loss": -0.07514330378035083, "vf_loss": 4563.319961547852, "vf_explained_var": 0.0, "kl": 0.01034351356793195, "entropy": 49.39468038082123, "entropy_coeff": 0.001}}, "num_steps_sampled": 1056000, "num_steps_trained": 1056000}, "done": false, "episodes_total": 1056, "training_iteration": 264, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_13-45-04", "timestamp": 1618206304, "time_this_iter_s": 1104.386197566986, "time_total_s": 328051.4354608059, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 242295.6647028923, "timesteps_since_restore": 0, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 11.76668785759695, "ram_util_percent": 18.546726001271452}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2613.566798641006, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2688.475026337842, -2547.731192906082, -2711.5714086329285, -2581.622021470744, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.6407367689121, "mean_raw_obs_processing_ms": 1.8811099555634423, "mean_inference_ms": 7.630542903381635, "mean_action_processing_ms": 0.22633048255069355}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1060000, "timers": {"sample_time_ms": 1113197.485, "sample_throughput": 3.593, "learn_time_ms": 17456.637, "learn_throughput": 229.139, "update_time_ms": 41.036}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02542756695766002, "policy_loss": -0.07168092293431982, "vf_loss": 4462.598915100098, "vf_explained_var": -5.587935447692871e-09, "kl": 0.009926573256962001, "entropy": 49.25406801700592, "entropy_coeff": 0.001}}, "num_steps_sampled": 1060000, "num_steps_trained": 1060000}, "done": false, "episodes_total": 1060, "training_iteration": 265, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_14-03-34", "timestamp": 1618207414, "time_this_iter_s": 1109.7615807056427, "time_total_s": 329161.19704151154, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 243405.42628359795, "timesteps_since_restore": 0, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 11.772911392405064, "ram_util_percent": 18.55120253164557}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2613.8023842468265, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2601.4169465396453, -2645.7903373893, -2556.520035742015, -2652.1610077991154, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.6825835769606, "mean_raw_obs_processing_ms": 1.8812874673351, "mean_inference_ms": 7.630883502260404, "mean_action_processing_ms": 0.22635029961575448}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1064000, "timers": {"sample_time_ms": 1111207.604, "sample_throughput": 3.6, "learn_time_ms": 16742.07, "learn_throughput": 238.919, "update_time_ms": 42.024}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02289045150973834, "policy_loss": -0.06880225444911048, "vf_loss": 4444.270645141602, "vf_explained_var": -3.725290298461914e-09, "kl": 0.009991758590331301, "entropy": 49.74647045135498, "entropy_coeff": 0.001}}, "num_steps_sampled": 1064000, "num_steps_trained": 1064000}, "done": false, "episodes_total": 1064, "training_iteration": 266, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_14-22-08", "timestamp": 1618208528, "time_this_iter_s": 1113.3864068984985, "time_total_s": 330274.58344841003, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 244518.81269049644, "timesteps_since_restore": 0, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 11.782902208201893, "ram_util_percent": 18.553753943217664}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2614.889165900151, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2675.8710538894093, -2678.5704549087473, -2612.0883541142853, -2563.000027494452, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.7258899969685, "mean_raw_obs_processing_ms": 1.8814552723447533, "mean_inference_ms": 7.631289844604416, "mean_action_processing_ms": 0.2263613789107503}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1068000, "timers": {"sample_time_ms": 1112614.338, "sample_throughput": 3.595, "learn_time_ms": 16621.696, "learn_throughput": 240.649, "update_time_ms": 43.482}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02084812882822007, "policy_loss": -0.06484690419165418, "vf_loss": 4358.746070861816, "vf_explained_var": 0.0, "kl": 0.009809854120248929, "entropy": 49.87184751033783, "entropy_coeff": 0.001}}, "num_steps_sampled": 1068000, "num_steps_trained": 1068000}, "done": false, "episodes_total": 1068, "training_iteration": 267, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_14-41-03", "timestamp": 1618209663, "time_this_iter_s": 1135.860439300537, "time_total_s": 331410.4438877106, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 245654.67312979698, "timesteps_since_restore": 0, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 11.77555693069307, "ram_util_percent": 18.544925742574257}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2614.8078100157013, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2635.1929575144463, -2631.5716894313623, -2692.5715062311706, -2609.4969960052963, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.7697657333998, "mean_raw_obs_processing_ms": 1.8816156705422815, "mean_inference_ms": 7.631647163396078, "mean_action_processing_ms": 0.22637085846811345}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1072000, "timers": {"sample_time_ms": 1103237.535, "sample_throughput": 3.626, "learn_time_ms": 16624.857, "learn_throughput": 240.604, "update_time_ms": 40.964}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.019100686942692846, "policy_loss": -0.06949007016373798, "vf_loss": 4625.004119873047, "vf_explained_var": -1.862645149230957e-09, "kl": 0.010444091400131583, "entropy": 49.394776463508606, "entropy_coeff": 0.001}}, "num_steps_sampled": 1072000, "num_steps_trained": 1072000}, "done": false, "episodes_total": 1072, "training_iteration": 268, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_14-59-32", "timestamp": 1618210772, "time_this_iter_s": 1108.5440170764923, "time_total_s": 332518.98790478706, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 246763.21714687347, "timesteps_since_restore": 0, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 11.767300380228136, "ram_util_percent": 18.55291508238276}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2613.1255068379037, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2609.0563570835357, -2524.72778287834, -2707.3016383817526, -2606.7975441464896, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.8135457967676, "mean_raw_obs_processing_ms": 1.8817937991031481, "mean_inference_ms": 7.631870804854745, "mean_action_processing_ms": 0.2263887082793529}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1076000, "timers": {"sample_time_ms": 1099881.41, "sample_throughput": 3.637, "learn_time_ms": 16367.944, "learn_throughput": 244.38, "update_time_ms": 39.449}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.022334505920298398, "policy_loss": -0.07036311115371063, "vf_loss": 4270.787521362305, "vf_explained_var": -2.0489096641540527e-08, "kl": 0.010686575231375173, "entropy": 49.456311106681824, "entropy_coeff": 0.001}}, "num_steps_sampled": 1076000, "num_steps_trained": 1076000}, "done": false, "episodes_total": 1076, "training_iteration": 269, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_15-17-59", "timestamp": 1618211879, "time_this_iter_s": 1106.5426659584045, "time_total_s": 333625.53057074547, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 247869.75981283188, "timesteps_since_restore": 0, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 11.772969543147207, "ram_util_percent": 18.552855329949235}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2614.028899624512, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2595.029373061988, -2545.0628808929737, -2675.1638416824067, -2586.883594246265, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.854483757936, "mean_raw_obs_processing_ms": 1.881983620075436, "mean_inference_ms": 7.632088583534591, "mean_action_processing_ms": 0.22639772366091102}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1080000, "timers": {"sample_time_ms": 1097419.582, "sample_throughput": 3.645, "learn_time_ms": 16439.197, "learn_throughput": 243.321, "update_time_ms": 37.924}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01477755478117615, "policy_loss": -0.06433316261973232, "vf_loss": 4515.830017089844, "vf_explained_var": 3.725290298461914e-09, "kl": 0.010488426429219544, "entropy": 49.36406755447388, "entropy_coeff": 0.001}}, "num_steps_sampled": 1080000, "num_steps_trained": 1080000}, "done": false, "episodes_total": 1080, "training_iteration": 270, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_15-36-29", "timestamp": 1618212989, "time_this_iter_s": 1109.9093594551086, "time_total_s": 334735.4399302006, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 248979.669172287, "timesteps_since_restore": 0, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 11.762784810126583, "ram_util_percent": 18.54772151898734}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2615.6139722293906, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2591.6540499598145, -2587.555757378685, -2584.973628737265, -2598.056393981737, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.8988572416113, "mean_raw_obs_processing_ms": 1.8821998578604364, "mean_inference_ms": 7.6323991589964635, "mean_action_processing_ms": 0.22642004395965024}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1084000, "timers": {"sample_time_ms": 1100951.517, "sample_throughput": 3.633, "learn_time_ms": 16383.08, "learn_throughput": 244.154, "update_time_ms": 38.082}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.011820540821645409, "policy_loss": -0.0611773786804406, "vf_loss": 4748.582733154297, "vf_explained_var": 1.862645149230957e-09, "kl": 0.010030499310232699, "entropy": 49.54313325881958, "entropy_coeff": 0.001}}, "num_steps_sampled": 1084000, "num_steps_trained": 1084000}, "done": false, "episodes_total": 1084, "training_iteration": 271, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_15-55-31", "timestamp": 1618214131, "time_this_iter_s": 1141.9280824661255, "time_total_s": 335877.3680126667, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 250121.5972547531, "timesteps_since_restore": 0, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 11.763099630996312, "ram_util_percent": 18.545141451414512}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2615.14625478222, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2652.1680988655125, -2607.5180702601756, -2593.571796472704, -2627.949531064467, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.943210890154, "mean_raw_obs_processing_ms": 1.8824207508146495, "mean_inference_ms": 7.632639429227929, "mean_action_processing_ms": 0.22645390890951644}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1088000, "timers": {"sample_time_ms": 1099210.705, "sample_throughput": 3.639, "learn_time_ms": 16419.947, "learn_throughput": 243.606, "update_time_ms": 38.156}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.0228069014265202, "policy_loss": -0.0689049131469801, "vf_loss": 4190.571090698242, "vf_explained_var": 1.862645149230957e-09, "kl": 0.010392761236289516, "entropy": 49.07871341705322, "entropy_coeff": 0.001}}, "num_steps_sampled": 1088000, "num_steps_trained": 1088000}, "done": false, "episodes_total": 1088, "training_iteration": 272, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_16-14-06", "timestamp": 1618215246, "time_this_iter_s": 1115.635268688202, "time_total_s": 336993.0032813549, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 251237.23252344131, "timesteps_since_restore": 0, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 11.80478589420655, "ram_util_percent": 18.554471032745592}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2616.012383745051, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2593.588413776437, -2554.3496809998, -2585.02654094172, -2624.5953952099812, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 545.9889574275261, "mean_raw_obs_processing_ms": 1.8826633257900054, "mean_inference_ms": 7.632875132320184, "mean_action_processing_ms": 0.22648744448651256}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1092000, "timers": {"sample_time_ms": 1100443.49, "sample_throughput": 3.635, "learn_time_ms": 16416.819, "learn_throughput": 243.653, "update_time_ms": 37.721}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.018584036559332162, "policy_loss": -0.0656389708747156, "vf_loss": 4653.41291809082, "vf_explained_var": -1.30385160446167e-08, "kl": 0.009730621299240738, "entropy": 49.35622680187225, "entropy_coeff": 0.001}}, "num_steps_sampled": 1092000, "num_steps_trained": 1092000}, "done": false, "episodes_total": 1092, "training_iteration": 273, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_16-32-49", "timestamp": 1618216369, "time_this_iter_s": 1123.1516959667206, "time_total_s": 338116.1549773216, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 252360.38421940804, "timesteps_since_restore": 0, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 21.272170106316445, "ram_util_percent": 21.8432770481551}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2617.2941851020437, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2603.6155562528247, -2555.8256713166697, -2582.9619124312385, -2666.7688908874848, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.0341429161724, "mean_raw_obs_processing_ms": 1.8829266817141361, "mean_inference_ms": 7.632980773936635, "mean_action_processing_ms": 0.2265259113990328}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1096000, "timers": {"sample_time_ms": 1104360.829, "sample_throughput": 3.622, "learn_time_ms": 16619.702, "learn_throughput": 240.678, "update_time_ms": 38.179}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.024525617656763643, "policy_loss": -0.0724987702560611, "vf_loss": 4569.670639038086, "vf_explained_var": 1.4901161193847656e-08, "kl": 0.010007021250203252, "entropy": 49.01734900474548, "entropy_coeff": 0.001}}, "num_steps_sampled": 1096000, "num_steps_trained": 1096000}, "done": false, "episodes_total": 1096, "training_iteration": 274, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_16-51-55", "timestamp": 1618217515, "time_this_iter_s": 1145.5931253433228, "time_total_s": 339261.74810266495, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 253505.97734475136, "timesteps_since_restore": 0, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 23.50564417177914, "ram_util_percent": 22.353496932515345}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2615.9633831369706, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2550.3110802538245, -2688.4249405728906, -2619.973320004174, -2565.3208340292563, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.076041870064, "mean_raw_obs_processing_ms": 1.8831705421023957, "mean_inference_ms": 7.633102174659512, "mean_action_processing_ms": 0.2265565218342121}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1100000, "timers": {"sample_time_ms": 1115676.425, "sample_throughput": 3.585, "learn_time_ms": 16085.323, "learn_throughput": 248.674, "update_time_ms": 37.135}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01530397916212678, "policy_loss": -0.06141614291118458, "vf_loss": 4550.395729064941, "vf_explained_var": -2.0489096641540527e-08, "kl": 0.009738616296090186, "entropy": 49.30980587005615, "entropy_coeff": 0.001}}, "num_steps_sampled": 1100000, "num_steps_trained": 1100000}, "done": false, "episodes_total": 1100, "training_iteration": 275, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_17-12-13", "timestamp": 1618218733, "time_this_iter_s": 1217.548922777176, "time_total_s": 340479.2970254421, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 254723.52626752853, "timesteps_since_restore": 0, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 27.0402769763416, "ram_util_percent": 23.685862665897286}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2615.952994862824, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2562.013666296151, -2668.229767961954, -2610.3675870359707, -2594.748510649008, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.1097489787558, "mean_raw_obs_processing_ms": 1.8834029422327032, "mean_inference_ms": 7.633255013927975, "mean_action_processing_ms": 0.2265684651395029}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1104000, "timers": {"sample_time_ms": 1125672.61, "sample_throughput": 3.553, "learn_time_ms": 16717.035, "learn_throughput": 239.277, "update_time_ms": 35.893}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02091126938466914, "policy_loss": -0.06788656412390992, "vf_loss": 4424.509941101074, "vf_explained_var": -1.1175870895385742e-08, "kl": 0.010201895463978872, "entropy": 49.56248366832733, "entropy_coeff": 0.001}}, "num_steps_sampled": 1104000, "num_steps_trained": 1104000}, "done": false, "episodes_total": 1104, "training_iteration": 276, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_17-32-32", "timestamp": 1618219952, "time_this_iter_s": 1219.652847290039, "time_total_s": 341698.94987273216, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 255943.17911481857, "timesteps_since_restore": 0, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 24.8944156591825, "ram_util_percent": 24.068566493955093}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2615.029181470634, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2532.7819255554455, -2573.697887965854, -2530.0744994086817, -2601.9093079582594, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.1346150862194, "mean_raw_obs_processing_ms": 1.8836299214876255, "mean_inference_ms": 7.633343737572054, "mean_action_processing_ms": 0.2265841651559595}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1108000, "timers": {"sample_time_ms": 1130635.037, "sample_throughput": 3.538, "learn_time_ms": 16814.285, "learn_throughput": 237.893, "update_time_ms": 33.533}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.014215859875548631, "policy_loss": -0.06050869124010205, "vf_loss": 4473.720512390137, "vf_explained_var": -7.450580596923828e-09, "kl": 0.010031659825472161, "entropy": 49.8644654750824, "entropy_coeff": 0.001}}, "num_steps_sampled": 1108000, "num_steps_trained": 1108000}, "done": false, "episodes_total": 1108, "training_iteration": 277, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_17-52-19", "timestamp": 1618221139, "time_this_iter_s": 1186.4121749401093, "time_total_s": 342885.3620476723, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 257129.59128975868, "timesteps_since_restore": 0, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 23.91694312796209, "ram_util_percent": 24.09419431279621}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2744.4747970936282, "episode_reward_mean": -2617.1944034267594, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2656.420573438528, -2639.024885785184, -2572.0823759560485, -2744.4747970936282, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.1531006929548, "mean_raw_obs_processing_ms": 1.883853629479258, "mean_inference_ms": 7.633333096928506, "mean_action_processing_ms": 0.22659667625644184}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1112000, "timers": {"sample_time_ms": 1134212.042, "sample_throughput": 3.527, "learn_time_ms": 16841.716, "learn_throughput": 237.505, "update_time_ms": 33.662}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02220885962015018, "policy_loss": -0.0678502532246057, "vf_loss": 4428.802757263184, "vf_explained_var": -9.313225746154785e-09, "kl": 0.009931193810189143, "entropy": 49.551753997802734, "entropy_coeff": 0.001}}, "num_steps_sampled": 1112000, "num_steps_trained": 1112000}, "done": false, "episodes_total": 1112, "training_iteration": 278, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_18-11-23", "timestamp": 1618222283, "time_this_iter_s": 1144.5898096561432, "time_total_s": 344029.9518573284, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 258274.18109941483, "timesteps_since_restore": 0, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 23.18969325153374, "ram_util_percent": 24.07680981595092}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2743.440156507488, "episode_reward_mean": -2615.1475859301263, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2609.510627553229, -2529.162186748087, -2613.9935296918698, -2606.9268080508105, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.166019690862, "mean_raw_obs_processing_ms": 1.8840488129063262, "mean_inference_ms": 7.633289461788184, "mean_action_processing_ms": 0.22662533474048824}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1116000, "timers": {"sample_time_ms": 1139687.672, "sample_throughput": 3.51, "learn_time_ms": 17005.958, "learn_throughput": 235.212, "update_time_ms": 36.622}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.016607638186542317, "policy_loss": -0.06722992300637998, "vf_loss": 4572.883827209473, "vf_explained_var": 0.0, "kl": 0.01057173011940904, "entropy": 49.294923543930054, "entropy_coeff": 0.001}}, "num_steps_sampled": 1116000, "num_steps_trained": 1116000}, "done": false, "episodes_total": 1116, "training_iteration": 279, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_18-30-46", "timestamp": 1618223446, "time_this_iter_s": 1162.960333108902, "time_total_s": 345192.9121904373, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 259437.14143252373, "timesteps_since_restore": 0, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 24.957643504531724, "ram_util_percent": 26.72549848942598}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2743.440156507488, "episode_reward_mean": -2616.7074646274677, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2589.567722489024, -2733.4651739009455, -2679.489047931011, -2671.534138488939, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.1871403507731, "mean_raw_obs_processing_ms": 1.8842348900424835, "mean_inference_ms": 7.633397297975221, "mean_action_processing_ms": 0.22665582208467405}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1120000, "timers": {"sample_time_ms": 1150629.414, "sample_throughput": 3.476, "learn_time_ms": 17048.095, "learn_throughput": 234.63, "update_time_ms": 36.547}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02425649120414164, "policy_loss": -0.07217622731695883, "vf_loss": 4611.5139083862305, "vf_explained_var": 1.862645149230957e-09, "kl": 0.010049888747744262, "entropy": 49.708930253982544, "entropy_coeff": 0.001}}, "num_steps_sampled": 1120000, "num_steps_trained": 1120000}, "done": false, "episodes_total": 1120, "training_iteration": 280, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_18-51-06", "timestamp": 1618224666, "time_this_iter_s": 1219.747606754303, "time_total_s": 346412.6597971916, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 260656.88903927803, "timesteps_since_restore": 0, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 23.983870967741936, "ram_util_percent": 28.643202764976962}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2743.440156507488, "episode_reward_mean": -2614.235557613532, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2559.318351952794, -2505.0839485242195, -2591.3275054134874, -2615.3174887232635, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.2101912439822, "mean_raw_obs_processing_ms": 1.884390261779225, "mean_inference_ms": 7.63363575541727, "mean_action_processing_ms": 0.22668615722290306}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1124000, "timers": {"sample_time_ms": 1152586.366, "sample_throughput": 3.47, "learn_time_ms": 17107.466, "learn_throughput": 233.816, "update_time_ms": 35.477}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01961165643297136, "policy_loss": -0.06443742834380828, "vf_loss": 4357.007225036621, "vf_explained_var": -1.1175870895385742e-08, "kl": 0.009908632171573117, "entropy": 49.533777832984924, "entropy_coeff": 0.001}}, "num_steps_sampled": 1124000, "num_steps_trained": 1124000}, "done": false, "episodes_total": 1124, "training_iteration": 281, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_19-10-28", "timestamp": 1618225828, "time_this_iter_s": 1162.0807621479034, "time_total_s": 347574.7405593395, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 261818.96980142593, "timesteps_since_restore": 0, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 20.4392749244713, "ram_util_percent": 27.54495468277946}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2615.7093849954035, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2557.0380128367296, -2675.968221559627, -2585.8890868035137, -2691.3575066660555, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.2334883635205, "mean_raw_obs_processing_ms": 1.8845570976349633, "mean_inference_ms": 7.633989529876707, "mean_action_processing_ms": 0.2267073978388439}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1128000, "timers": {"sample_time_ms": 1154028.882, "sample_throughput": 3.466, "learn_time_ms": 17026.083, "learn_throughput": 234.934, "update_time_ms": 35.223}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02886719285743311, "policy_loss": -0.07683587845531292, "vf_loss": 4580.528289794922, "vf_explained_var": 5.587935447692871e-09, "kl": 0.010043275105999783, "entropy": 49.316219210624695, "entropy_coeff": 0.001}}, "num_steps_sampled": 1128000, "num_steps_trained": 1128000}, "done": false, "episodes_total": 1128, "training_iteration": 282, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_19-29-18", "timestamp": 1618226958, "time_this_iter_s": 1129.2439334392548, "time_total_s": 348703.9844927788, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 262948.2137348652, "timesteps_since_restore": 0, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 14.278220286247665, "ram_util_percent": 26.22874922215308}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2615.369495022181, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2616.2086481827473, -2579.648743203534, -2615.3079933095682, -2515.1840589533126, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.2500000004976, "mean_raw_obs_processing_ms": 1.8846987198025646, "mean_inference_ms": 7.6343131211441895, "mean_action_processing_ms": 0.22671380038691794}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1132000, "timers": {"sample_time_ms": 1154848.76, "sample_throughput": 3.464, "learn_time_ms": 17054.567, "learn_throughput": 234.541, "update_time_ms": 37.328}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02320612021139823, "policy_loss": -0.06532777173561044, "vf_loss": 4166.126167297363, "vf_explained_var": -1.862645149230957e-09, "kl": 0.009735839761560783, "entropy": 49.443390250205994, "entropy_coeff": 0.001}}, "num_steps_sampled": 1132000, "num_steps_trained": 1132000}, "done": false, "episodes_total": 1132, "training_iteration": 283, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_19-48-09", "timestamp": 1618228089, "time_this_iter_s": 1131.6560561656952, "time_total_s": 349835.6405489445, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 264079.8697910309, "timesteps_since_restore": 0, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 14.402048417132216, "ram_util_percent": 26.25487274984482}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2459.0216813078946, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2614.4288233554807, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2672.2056066882087, -2592.40365275421, -2459.0216813078946, -2586.7850015156037, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.2679344051918, "mean_raw_obs_processing_ms": 1.8848187722885945, "mean_inference_ms": 7.634676740870275, "mean_action_processing_ms": 0.22671009705102868}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1136000, "timers": {"sample_time_ms": 1156453.716, "sample_throughput": 3.459, "learn_time_ms": 17048.857, "learn_throughput": 234.62, "update_time_ms": 35.784}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02542328491108492, "policy_loss": -0.0697081470862031, "vf_loss": 4279.004699707031, "vf_explained_var": -1.6763806343078613e-08, "kl": 0.009902044927002862, "entropy": 49.260895133018494, "entropy_coeff": 0.001}}, "num_steps_sampled": 1136000, "num_steps_trained": 1136000}, "done": false, "episodes_total": 1136, "training_iteration": 284, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_20-07-31", "timestamp": 1618229251, "time_this_iter_s": 1161.5723927021027, "time_total_s": 350997.2129416466, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 265241.442183733, "timesteps_since_restore": 0, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 14.691596130592504, "ram_util_percent": 26.29733978234583}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2508.7634514838596, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2616.1887186807758, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2655.31783972214, -2628.1850420642077, -2677.443185085063, -2619.8318576760353, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.286081985934, "mean_raw_obs_processing_ms": 1.8849594139064527, "mean_inference_ms": 7.635029704580941, "mean_action_processing_ms": 0.22671389151053148}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1140000, "timers": {"sample_time_ms": 1147521.837, "sample_throughput": 3.486, "learn_time_ms": 17756.406, "learn_throughput": 225.271, "update_time_ms": 35.151}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.014475828647846356, "policy_loss": -0.06329288534470834, "vf_loss": 4719.397994995117, "vf_explained_var": -1.862645149230957e-09, "kl": 0.009951366839231923, "entropy": 49.38544988632202, "entropy_coeff": 0.001}}, "num_steps_sampled": 1140000, "num_steps_trained": 1140000}, "done": false, "episodes_total": 1140, "training_iteration": 285, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_20-26-26", "timestamp": 1618230386, "time_this_iter_s": 1135.3155825138092, "time_total_s": 352132.5285241604, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 266376.7577662468, "timesteps_since_restore": 0, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 15.729993815708102, "ram_util_percent": 26.52096474953618}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2508.7634514838596, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2616.2760716081098, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2672.221990068801, -2598.319648118727, -2665.3473313820905, -2677.882555507355, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.3113646751666, "mean_raw_obs_processing_ms": 1.8850927697022934, "mean_inference_ms": 7.635510873633305, "mean_action_processing_ms": 0.22671026265811148}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1144000, "timers": {"sample_time_ms": 1144359.167, "sample_throughput": 3.495, "learn_time_ms": 17819.414, "learn_throughput": 224.474, "update_time_ms": 36.447}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.015752346836961806, "policy_loss": -0.06365114921936765, "vf_loss": 4670.109176635742, "vf_explained_var": 1.862645149230957e-09, "kl": 0.009839788544923067, "entropy": 49.2388881444931, "entropy_coeff": 0.001}}, "num_steps_sampled": 1144000, "num_steps_trained": 1144000}, "done": false, "episodes_total": 1144, "training_iteration": 286, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_20-46-15", "timestamp": 1618231575, "time_this_iter_s": 1188.6694712638855, "time_total_s": 353321.19799542427, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 267565.4272375107, "timesteps_since_restore": 0, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 24.96371158392435, "ram_util_percent": 28.96099290780142}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2508.7634514838596, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2612.9280240905287, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2623.1264751225294, -2743.440156507488, -2648.9420697881114, -2626.4394118446526, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.3421365884361, "mean_raw_obs_processing_ms": 1.8852222821223408, "mean_inference_ms": 7.636004994361462, "mean_action_processing_ms": 0.22670579245182412}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1148000, "timers": {"sample_time_ms": 1145958.702, "sample_throughput": 3.491, "learn_time_ms": 17810.688, "learn_throughput": 224.584, "update_time_ms": 35.272}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02056357479887083, "policy_loss": -0.0626061768271029, "vf_loss": 4276.495056152344, "vf_explained_var": -5.587935447692871e-09, "kl": 0.009386026358697563, "entropy": 48.83306086063385, "entropy_coeff": 0.001}}, "num_steps_sampled": 1148000, "num_steps_trained": 1148000}, "done": false, "episodes_total": 1148, "training_iteration": 287, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_21-06-17", "timestamp": 1618232777, "time_this_iter_s": 1202.3083341121674, "time_total_s": 354523.50632953644, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 268767.73557162285, "timesteps_since_restore": 0, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 27.802045587375805, "ram_util_percent": 29.604967855055524}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2493.8781959186626, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2608.3171079885337, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2672.9059065348515, -2544.9087054907477, -2572.2158440446524, -2559.871651730577, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.3827222715729, "mean_raw_obs_processing_ms": 1.885343464353558, "mean_inference_ms": 7.636707939557307, "mean_action_processing_ms": 0.22670678408014358}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1152000, "timers": {"sample_time_ms": 1154252.932, "sample_throughput": 3.465, "learn_time_ms": 17134.256, "learn_throughput": 233.45, "update_time_ms": 36.094}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.02321538532851264, "policy_loss": -0.06850403599673882, "vf_loss": 4508.641662597656, "vf_explained_var": -2.421438694000244e-08, "kl": 0.009609256609110162, "entropy": 49.05270493030548, "entropy_coeff": 0.001}}, "num_steps_sampled": 1152000, "num_steps_trained": 1152000}, "done": false, "episodes_total": 1152, "training_iteration": 288, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_21-26-38", "timestamp": 1618233998, "time_this_iter_s": 1220.7759201526642, "time_total_s": 355744.2822496891, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 269988.5114917755, "timesteps_since_restore": 0, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 28.10990213010938, "ram_util_percent": 35.66845135290731}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2486.3573183694075, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2606.9144560078594, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2609.208979518543, -2626.114610357102, -2618.194963467997, -2611.337519538195, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.4321834158853, "mean_raw_obs_processing_ms": 1.8854520183998595, "mean_inference_ms": 7.637445173254295, "mean_action_processing_ms": 0.2267171061357428}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1156000, "timers": {"sample_time_ms": 1159296.132, "sample_throughput": 3.45, "learn_time_ms": 17092.786, "learn_throughput": 234.017, "update_time_ms": 34.304}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.03057947776687797, "policy_loss": -0.07306638726731762, "vf_loss": 4163.753692626953, "vf_explained_var": 0.0, "kl": 0.009756706596817821, "entropy": 49.161365151405334, "entropy_coeff": 0.001}}, "num_steps_sampled": 1156000, "num_steps_trained": 1156000}, "done": false, "episodes_total": 1156, "training_iteration": 289, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_21-46-51", "timestamp": 1618235211, "time_this_iter_s": 1212.9603095054626, "time_total_s": 356957.24255919456, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 271201.471801281, "timesteps_since_restore": 0, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 25.907006369426753, "ram_util_percent": 36.21187029530979}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2486.3573183694075, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2605.165436682711, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2655.43572774368, -2634.3324751952377, -2621.2043026939873, -2641.985704296848, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.4888315279168, "mean_raw_obs_processing_ms": 1.885558840821202, "mean_inference_ms": 7.638256613313883, "mean_action_processing_ms": 0.2267320395484383}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1160000, "timers": {"sample_time_ms": 1156994.148, "sample_throughput": 3.457, "learn_time_ms": 17156.145, "learn_throughput": 233.153, "update_time_ms": 36.962}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.016597833222476766, "policy_loss": -0.06310448201838881, "vf_loss": 4447.147682189941, "vf_explained_var": -9.313225746154785e-09, "kl": 0.009966690966393799, "entropy": 49.05189836025238, "entropy_coeff": 0.001}}, "num_steps_sampled": 1160000, "num_steps_trained": 1160000}, "done": false, "episodes_total": 1160, "training_iteration": 290, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_22-06-49", "timestamp": 1618236409, "time_this_iter_s": 1197.3925199508667, "time_total_s": 358154.63507914543, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 272398.86432123184, "timesteps_since_restore": 0, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 27.243192488262913, "ram_util_percent": 38.43679577464789}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2486.3573183694075, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2602.639243955737, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2709.129664350019, -2592.5372692385736, -2550.9865079189954, -2711.913051294955, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.5508987823, "mean_raw_obs_processing_ms": 1.8856838184375055, "mean_inference_ms": 7.639165642345258, "mean_action_processing_ms": 0.22673751559777514}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1164000, "timers": {"sample_time_ms": 1159509.18, "sample_throughput": 3.45, "learn_time_ms": 17356.788, "learn_throughput": 230.457, "update_time_ms": 37.323}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.015294163342332467, "policy_loss": -0.05835111055057496, "vf_loss": 4238.640563964844, "vf_explained_var": -7.450580596923828e-09, "kl": 0.009728418168378994, "entropy": 49.195194125175476, "entropy_coeff": 0.001}}, "num_steps_sampled": 1164000, "num_steps_trained": 1164000}, "done": false, "episodes_total": 1164, "training_iteration": 291, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_22-26-38", "timestamp": 1618237598, "time_this_iter_s": 1189.2419362068176, "time_total_s": 359343.87701535225, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 273588.10625743866, "timesteps_since_restore": 0, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 25.64615839243499, "ram_util_percent": 39.954846335697404}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2486.3573183694075, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2602.123217529348, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2711.5720448105435, -2579.1129746759384, -2578.1382462566917, -2652.5710362186937, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.618490650306, "mean_raw_obs_processing_ms": 1.8857999410155457, "mean_inference_ms": 7.640124750682145, "mean_action_processing_ms": 0.22674900506393098}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1168000, "timers": {"sample_time_ms": 1167377.662, "sample_throughput": 3.426, "learn_time_ms": 17716.158, "learn_throughput": 225.783, "update_time_ms": 38.597}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01809587358729914, "policy_loss": -0.06510180630721152, "vf_loss": 4600.468231201172, "vf_explained_var": 7.450580596923828e-09, "kl": 0.009758824715390801, "entropy": 49.020346999168396, "entropy_coeff": 0.001}}, "num_steps_sampled": 1168000, "num_steps_trained": 1168000}, "done": false, "episodes_total": 1168, "training_iteration": 292, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_22-46-49", "timestamp": 1618238809, "time_this_iter_s": 1211.5600028038025, "time_total_s": 360555.43701815605, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 274799.66626024246, "timesteps_since_restore": 0, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 27.46863768115942, "ram_util_percent": 35.20886956521739}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2486.3573183694075, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2601.0848644930643, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2633.649973910375, -2618.662658219439, -2618.8818727860353, -2529.4083264867336, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.6928998523757, "mean_raw_obs_processing_ms": 1.8859195162278695, "mean_inference_ms": 7.641229666701487, "mean_action_processing_ms": 0.22676989008419163}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1172000, "timers": {"sample_time_ms": 1173862.862, "sample_throughput": 3.408, "learn_time_ms": 17669.72, "learn_throughput": 226.376, "update_time_ms": 39.407}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.015850914001930505, "policy_loss": -0.06671335667488165, "vf_loss": 4923.639221191406, "vf_explained_var": -7.450580596923828e-09, "kl": 0.009903228521579877, "entropy": 49.13572680950165, "entropy_coeff": 0.001}}, "num_steps_sampled": 1172000, "num_steps_trained": 1172000}, "done": false, "episodes_total": 1172, "training_iteration": 293, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_23-06-46", "timestamp": 1618240006, "time_this_iter_s": 1196.0518825054169, "time_total_s": 361751.48890066147, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 275995.7181427479, "timesteps_since_restore": 0, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 21.889782736347623, "ram_util_percent": 35.43546682325309}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2486.3573183694075, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2600.3384440439036, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2660.2491989703635, -2600.655383485041, -2626.8503481122566, -2650.467670583241, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.7698105961975, "mean_raw_obs_processing_ms": 1.8860473094272012, "mean_inference_ms": 7.642365468177438, "mean_action_processing_ms": 0.22678227830689957}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1176000, "timers": {"sample_time_ms": 1171896.534, "sample_throughput": 3.413, "learn_time_ms": 17539.487, "learn_throughput": 228.057, "update_time_ms": 38.815}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.025259858375648037, "policy_loss": -0.07315999374259263, "vf_loss": 4591.017845153809, "vf_explained_var": -3.725290298461914e-09, "kl": 0.009972953383112326, "entropy": 49.12921392917633, "entropy_coeff": 0.001}}, "num_steps_sampled": 1176000, "num_steps_trained": 1176000}, "done": false, "episodes_total": 1176, "training_iteration": 294, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_23-25-46", "timestamp": 1618241146, "time_this_iter_s": 1140.6295733451843, "time_total_s": 362892.11847400665, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 277136.34771609306, "timesteps_since_restore": 0, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 22.29679802955665, "ram_util_percent": 35.489593596059116}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2484.1948464527354, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2599.2190015736032, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2666.7337780412627, -2643.729145164863, -2592.756423165738, -2657.427603999639, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.8481978514651, "mean_raw_obs_processing_ms": 1.8861582824191743, "mean_inference_ms": 7.643444104679987, "mean_action_processing_ms": 0.22680836849884095}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1180000, "timers": {"sample_time_ms": 1171530.8, "sample_throughput": 3.414, "learn_time_ms": 17385.554, "learn_throughput": 230.076, "update_time_ms": 39.76}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.026522668485995382, "policy_loss": -0.07104530293145217, "vf_loss": 4330.895095825195, "vf_explained_var": -7.450580596923828e-09, "kl": 0.009806541842408478, "entropy": 49.05249810218811, "entropy_coeff": 0.001}}, "num_steps_sampled": 1180000, "num_steps_trained": 1180000}, "done": false, "episodes_total": 1180, "training_iteration": 295, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-12_23-44-36", "timestamp": 1618242276, "time_this_iter_s": 1130.1118371486664, "time_total_s": 364022.2303111553, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 278266.45955324173, "timesteps_since_restore": 0, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 22.272947761194025, "ram_util_percent": 35.6627487562189}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2484.1948464527354, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2596.356573216617, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2620.1631745662016, -2515.4409826074448, -2581.344099506184, -2598.5198286605637, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 546.9249984466766, "mean_raw_obs_processing_ms": 1.886249313797891, "mean_inference_ms": 7.644514097796186, "mean_action_processing_ms": 0.2268345581139946}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1184000, "timers": {"sample_time_ms": 1165488.045, "sample_throughput": 3.432, "learn_time_ms": 17391.602, "learn_throughput": 229.996, "update_time_ms": 41.179}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.027352807752322406, "policy_loss": -0.06950416040490381, "vf_loss": 4241.642074584961, "vf_explained_var": -1.4901161193847656e-08, "kl": 0.009544733416987583, "entropy": 49.18927526473999, "entropy_coeff": 0.001}}, "num_steps_sampled": 1184000, "num_steps_trained": 1184000}, "done": false, "episodes_total": 1184, "training_iteration": 296, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_00-03-25", "timestamp": 1618243405, "time_this_iter_s": 1128.316409111023, "time_total_s": 365150.54672026634, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 279394.77596235275, "timesteps_since_restore": 0, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 22.2681195516812, "ram_util_percent": 35.66295143212951}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2484.1948464527354, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2597.943727922645, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2684.4907734282046, -2632.801699551593, -2588.478330394194, -2662.0495895719937, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.0065337701512, "mean_raw_obs_processing_ms": 1.8863598878223353, "mean_inference_ms": 7.645719638807566, "mean_action_processing_ms": 0.22685293998540237}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1188000, "timers": {"sample_time_ms": 1162653.535, "sample_throughput": 3.44, "learn_time_ms": 17304.922, "learn_throughput": 231.148, "update_time_ms": 41.346}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.017886773130157962, "policy_loss": -0.06763074517948553, "vf_loss": 4595.518936157227, "vf_explained_var": -1.862645149230957e-09, "kl": 0.01036595564801246, "entropy": 49.34483289718628, "entropy_coeff": 0.001}}, "num_steps_sampled": 1188000, "num_steps_trained": 1188000}, "done": false, "episodes_total": 1188, "training_iteration": 297, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_00-22-58", "timestamp": 1618244578, "time_this_iter_s": 1173.0979089736938, "time_total_s": 366323.64462924004, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 280567.87387132645, "timesteps_since_restore": 0, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 22.346798324356673, "ram_util_percent": 35.6690604428486}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2484.1948464527354, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2596.8506334726144, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2670.041624436074, -2612.066412017512, -2663.9735036955485, -2539.658626478118, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.0900751155611, "mean_raw_obs_processing_ms": 1.8864917937410703, "mean_inference_ms": 7.646955702285805, "mean_action_processing_ms": 0.2268684838114416}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1192000, "timers": {"sample_time_ms": 1155273.52, "sample_throughput": 3.462, "learn_time_ms": 18083.859, "learn_throughput": 221.192, "update_time_ms": 41.512}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.012908855656860396, "policy_loss": -0.060388829064322636, "vf_loss": 4497.19499206543, "vf_explained_var": -5.587935447692871e-09, "kl": 0.010072119097458199, "entropy": 49.11945450305939, "entropy_coeff": 0.001}}, "num_steps_sampled": 1192000, "num_steps_trained": 1192000}, "done": false, "episodes_total": 1192, "training_iteration": 298, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_00-42-13", "timestamp": 1618245733, "time_this_iter_s": 1154.7668907642365, "time_total_s": 367478.4115200043, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 281722.6407620907, "timesteps_since_restore": 0, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 22.370541692026784, "ram_util_percent": 35.63377967133293}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2593.0549425259783, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2552.196795540311, -2593.4114510411237, -2537.228584946915, -2593.255002852556, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.1725334202515, "mean_raw_obs_processing_ms": 1.886597564530905, "mean_inference_ms": 7.64823962202697, "mean_action_processing_ms": 0.2268864705552797}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1196000, "timers": {"sample_time_ms": 1147760.765, "sample_throughput": 3.485, "learn_time_ms": 17924.161, "learn_throughput": 223.162, "update_time_ms": 44.703}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01604417120688595, "policy_loss": -0.060114381019957364, "vf_loss": 4163.472274780273, "vf_explained_var": -1.30385160446167e-08, "kl": 0.010046434676041827, "entropy": 49.060333490371704, "entropy_coeff": 0.001}}, "num_steps_sampled": 1196000, "num_steps_trained": 1196000}, "done": false, "episodes_total": 1196, "training_iteration": 299, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_01-01-09", "timestamp": 1618246869, "time_this_iter_s": 1136.2855250835419, "time_total_s": 368614.6970450878, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 282858.9262871742, "timesteps_since_restore": 0, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 22.289678615574783, "ram_util_percent": 35.627626699629175}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2596.69119094029, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2654.2915363746006, -2612.2562242142426, -2589.0601071715396, -2567.383479685087, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.2456746339748, "mean_raw_obs_processing_ms": 1.8867093254117726, "mean_inference_ms": 7.649379317778153, "mean_action_processing_ms": 0.22690792828780232}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1200000, "timers": {"sample_time_ms": 1140235.567, "sample_throughput": 3.508, "learn_time_ms": 17834.197, "learn_throughput": 224.288, "update_time_ms": 43.019}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01256297147483565, "policy_loss": -0.06373173379688524, "vf_loss": 4893.491172790527, "vf_explained_var": 1.6763806343078613e-08, "kl": 0.00999397665145807, "entropy": 48.99308180809021, "entropy_coeff": 0.001}}, "num_steps_sampled": 1200000, "num_steps_trained": 1200000}, "done": false, "episodes_total": 1200, "training_iteration": 300, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_01-19-50", "timestamp": 1618247990, "time_this_iter_s": 1121.2193112373352, "time_total_s": 369735.91635632515, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 283980.14559841156, "timesteps_since_restore": 0, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 22.26672932330827, "ram_util_percent": 35.62280701754386}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2596.3535000406855, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2622.3633639897625, -2574.4704180283543, -2581.549142061895, -2564.595268644022, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.3133764812445, "mean_raw_obs_processing_ms": 1.8867996872443016, "mean_inference_ms": 7.650488807060565, "mean_action_processing_ms": 0.2269337550852194}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1204000, "timers": {"sample_time_ms": 1137676.473, "sample_throughput": 3.516, "learn_time_ms": 17335.79, "learn_throughput": 230.737, "update_time_ms": 41.262}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.024923808232415468, "policy_loss": -0.07598068323568441, "vf_loss": 4759.96297454834, "vf_explained_var": -1.30385160446167e-08, "kl": 0.010217895469395444, "entropy": 48.91744589805603, "entropy_coeff": 0.001}}, "num_steps_sampled": 1204000, "num_steps_trained": 1204000}, "done": false, "episodes_total": 1204, "training_iteration": 301, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_01-39-09", "timestamp": 1618249149, "time_this_iter_s": 1158.6487505435944, "time_total_s": 370894.56510686874, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 285138.79434895515, "timesteps_since_restore": 0, "iterations_since_restore": 251, "perf": {"cpu_util_percent": 22.24620982413584, "ram_util_percent": 35.62953305033354}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2596.2388899024963, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2517.556555298419, -2662.8485674171575, -2613.270001078197, -2661.3106927070025, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.375239047347, "mean_raw_obs_processing_ms": 1.8868718067018018, "mean_inference_ms": 7.651542376454532, "mean_action_processing_ms": 0.22694868724201941}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1208000, "timers": {"sample_time_ms": 1128755.041, "sample_throughput": 3.544, "learn_time_ms": 17086.134, "learn_throughput": 234.108, "update_time_ms": 39.106}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.018298234441317618, "policy_loss": -0.06355967390118167, "vf_loss": 4528.779006958008, "vf_explained_var": -9.313225746154785e-09, "kl": 0.009630043641664088, "entropy": 49.38784110546112, "entropy_coeff": 0.001}}, "num_steps_sampled": 1208000, "num_steps_trained": 1208000}, "done": false, "episodes_total": 1208, "training_iteration": 302, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_01-57-49", "timestamp": 1618250269, "time_this_iter_s": 1119.8028028011322, "time_total_s": 372014.3679096699, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 286258.5971517563, "timesteps_since_restore": 0, "iterations_since_restore": 252, "perf": {"cpu_util_percent": 22.287515683814306, "ram_util_percent": 35.614366373902136}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2596.285027997187, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2679.7656970899875, -2573.6965997801826, -2514.346433842366, -2639.512151897572, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.4348531763238, "mean_raw_obs_processing_ms": 1.8869526836575228, "mean_inference_ms": 7.6526759344803805, "mean_action_processing_ms": 0.226966533001438}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1212000, "timers": {"sample_time_ms": 1121166.363, "sample_throughput": 3.568, "learn_time_ms": 17109.473, "learn_throughput": 233.789, "update_time_ms": 38.549}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.027436032658442855, "policy_loss": -0.07302996655926108, "vf_loss": 4328.6002197265625, "vf_explained_var": 1.1175870895385742e-08, "kl": 0.010012612823629752, "entropy": 49.014522314071655, "entropy_coeff": 0.001}}, "num_steps_sampled": 1212000, "num_steps_trained": 1212000}, "done": false, "episodes_total": 1212, "training_iteration": 303, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_02-16-29", "timestamp": 1618251389, "time_this_iter_s": 1120.3926861286163, "time_total_s": 373134.7605957985, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 287378.9898378849, "timesteps_since_restore": 0, "iterations_since_restore": 253, "perf": {"cpu_util_percent": 22.270783699059567, "ram_util_percent": 35.633479623824456}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2594.248840222806, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817, -2701.7791566981227, -2581.912073788952, -2594.621813486837, -2637.2679778042448, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.4920021201542, "mean_raw_obs_processing_ms": 1.887040496388606, "mean_inference_ms": 7.653776648288369, "mean_action_processing_ms": 0.22697360434039798}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1216000, "timers": {"sample_time_ms": 1120645.214, "sample_throughput": 3.569, "learn_time_ms": 17157.032, "learn_throughput": 233.141, "update_time_ms": 41.014}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.021172695385757834, "policy_loss": -0.06523262697737664, "vf_loss": 4232.035751342773, "vf_explained_var": 3.725290298461914e-09, "kl": 0.009953429689630866, "entropy": 49.27952766418457, "entropy_coeff": 0.001}}, "num_steps_sampled": 1216000, "num_steps_trained": 1216000}, "done": false, "episodes_total": 1216, "training_iteration": 304, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_02-35-25", "timestamp": 1618252525, "time_this_iter_s": 1135.8873631954193, "time_total_s": 374270.6479589939, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 288514.8772010803, "timesteps_since_restore": 0, "iterations_since_restore": 254, "perf": {"cpu_util_percent": 22.257575757575758, "ram_util_percent": 35.64638218923933}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2593.9059253043347, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2714.745867531087, -2656.7738994675174, -2568.5156543898556, -2541.254108542578, -2593.04217092019, -2562.142420423713, -2646.490760187195, -2625.1900298852484, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.5451830150398, "mean_raw_obs_processing_ms": 1.8871177125968004, "mean_inference_ms": 7.65473726726158, "mean_action_processing_ms": 0.22698053706955754}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1220000, "timers": {"sample_time_ms": 1125458.27, "sample_throughput": 3.554, "learn_time_ms": 16489.757, "learn_throughput": 242.575, "update_time_ms": 40.528}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01999773591160192, "policy_loss": -0.06588263370213099, "vf_loss": 4503.421356201172, "vf_explained_var": -7.450580596923828e-09, "kl": 0.009747903299285099, "entropy": 49.1149263381958, "entropy_coeff": 0.001}}, "num_steps_sampled": 1220000, "num_steps_trained": 1220000}, "done": false, "episodes_total": 1220, "training_iteration": 305, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_02-54-57", "timestamp": 1618253697, "time_this_iter_s": 1171.5648922920227, "time_total_s": 375442.21285128593, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 289686.44209337234, "timesteps_since_restore": 0, "iterations_since_restore": 255, "perf": {"cpu_util_percent": 22.221223021582734, "ram_util_percent": 35.75359712230215}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2751.380455724581, "episode_reward_mean": -2594.773265081108, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2591.048002510315, -2684.519263104769, -2642.483433834375, -2595.5486596441974, -2751.380455724581, -2569.654724715412, -2540.233235949424, -2557.1616164115308, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817, -2714.745867531087, -2656.7738994675174, -2568.5156543898556, -2541.254108542578], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.597739703147, "mean_raw_obs_processing_ms": 1.8872188373630139, "mean_inference_ms": 7.655561110974477, "mean_action_processing_ms": 0.2269853856005598}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1224000, "timers": {"sample_time_ms": 1128614.644, "sample_throughput": 3.544, "learn_time_ms": 16481.603, "learn_throughput": 242.695, "update_time_ms": 37.439}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.015153522981563583, "policy_loss": -0.05995233863359317, "vf_loss": 4426.307525634766, "vf_explained_var": 0.0, "kl": 0.009736242616781965, "entropy": 49.370099663734436, "entropy_coeff": 0.001}}, "num_steps_sampled": 1224000, "num_steps_trained": 1224000}, "done": false, "episodes_total": 1224, "training_iteration": 306, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_03-14-17", "timestamp": 1618254857, "time_this_iter_s": 1159.767587184906, "time_total_s": 376601.98043847084, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 290846.20968055725, "timesteps_since_restore": 0, "iterations_since_restore": 256, "perf": {"cpu_util_percent": 22.19151515151515, "ram_util_percent": 35.86484848484848}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2738.1510741594684, "episode_reward_mean": -2593.5622685731996, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2615.512396102583, -2597.121081422249, -2517.4072859762264, -2567.2896185090913, -2685.350186288835, -2611.6461904829425, -2547.639546264362, -2631.6279075074854, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817, -2714.745867531087, -2656.7738994675174, -2568.5156543898556, -2541.254108542578, -2591.048002510315, -2684.519263104769, -2642.483433834375, -2595.5486596441974], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.6503537187459, "mean_raw_obs_processing_ms": 1.887312495133949, "mean_inference_ms": 7.65632778735918, "mean_action_processing_ms": 0.2269968978575135}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1228000, "timers": {"sample_time_ms": 1124477.932, "sample_throughput": 3.557, "learn_time_ms": 16580.665, "learn_throughput": 241.245, "update_time_ms": 38.909}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.028698787617031485, "policy_loss": -0.07126740759122185, "vf_loss": 4095.377830505371, "vf_explained_var": -5.587935447692871e-09, "kl": 0.009909953572787344, "entropy": 49.18140757083893, "entropy_coeff": 0.001}}, "num_steps_sampled": 1228000, "num_steps_trained": 1228000}, "done": false, "episodes_total": 1228, "training_iteration": 307, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_03-33-09", "timestamp": 1618255989, "time_this_iter_s": 1132.7360248565674, "time_total_s": 377734.7164633274, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 291978.9457054138, "timesteps_since_restore": 0, "iterations_since_restore": 257, "perf": {"cpu_util_percent": 22.1130812151271, "ram_util_percent": 35.87947923124612}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2738.1510741594684, "episode_reward_mean": -2592.947052309317, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2699.261262513071, -2648.631362458925, -2550.7779702143603, -2516.0716089689054, -2508.7634514838596, -2551.064774026026, -2601.8492190183542, -2570.6048324508733, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817, -2714.745867531087, -2656.7738994675174, -2568.5156543898556, -2541.254108542578, -2591.048002510315, -2684.519263104769, -2642.483433834375, -2595.5486596441974, -2615.512396102583, -2597.121081422249, -2517.4072859762264, -2567.2896185090913], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.7054657575256, "mean_raw_obs_processing_ms": 1.8874040850552734, "mean_inference_ms": 7.657038359418145, "mean_action_processing_ms": 0.2270128767819287}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1232000, "timers": {"sample_time_ms": 1125778.79, "sample_throughput": 3.553, "learn_time_ms": 16460.12, "learn_throughput": 243.012, "update_time_ms": 37.239}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.012838253285735846, "policy_loss": -0.06430245758383535, "vf_loss": 4889.317604064941, "vf_explained_var": 5.587935447692871e-09, "kl": 0.010122476436663419, "entropy": 49.31456387042999, "entropy_coeff": 0.001}}, "num_steps_sampled": 1232000, "num_steps_trained": 1232000}, "done": false, "episodes_total": 1232, "training_iteration": 308, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_03-52-36", "timestamp": 1618257156, "time_this_iter_s": 1166.55299782753, "time_total_s": 378901.26946115494, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 293145.49870324135, "timesteps_since_restore": 0, "iterations_since_restore": 258, "perf": {"cpu_util_percent": 21.93263094521373, "ram_util_percent": 35.876158940397346}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2738.1510741594684, "episode_reward_mean": -2594.3991194761647, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2640.178372298683, -2560.0827083181953, -2575.094836333511, -2602.1330767135796, -2588.601479782563, -2635.2207016571974, -2704.7692191293972, -2557.814074226304, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817, -2714.745867531087, -2656.7738994675174, -2568.5156543898556, -2541.254108542578, -2591.048002510315, -2684.519263104769, -2642.483433834375, -2595.5486596441974, -2615.512396102583, -2597.121081422249, -2517.4072859762264, -2567.2896185090913, -2699.261262513071, -2648.631362458925, -2550.7779702143603, -2516.0716089689054], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.7601354785952, "mean_raw_obs_processing_ms": 1.8874668606894205, "mean_inference_ms": 7.657782331597851, "mean_action_processing_ms": 0.2270333969716154}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1236000, "timers": {"sample_time_ms": 1128176.187, "sample_throughput": 3.546, "learn_time_ms": 16469.021, "learn_throughput": 242.88, "update_time_ms": 35.03}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.014013416395755485, "policy_loss": -0.059926114219706506, "vf_loss": 4374.285919189453, "vf_explained_var": -2.0489096641540527e-08, "kl": 0.010090288473293185, "entropy": 49.55076718330383, "entropy_coeff": 0.001}}, "num_steps_sampled": 1236000, "num_steps_trained": 1236000}, "done": false, "episodes_total": 1236, "training_iteration": 309, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_04-11-56", "timestamp": 1618258316, "time_this_iter_s": 1160.3078989982605, "time_total_s": 380061.5773601532, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 294305.8066022396, "timesteps_since_restore": 0, "iterations_since_restore": 259, "perf": {"cpu_util_percent": 22.065193704600482, "ram_util_percent": 35.877905569007254}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2738.1510741594684, "episode_reward_mean": -2593.6710870095926, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2553.19569306753, -2600.655911183341, -2577.8176465728147, -2681.932977314566, -2627.1563853243874, -2644.2616092743133, -2625.4327078870087, -2692.6625147951354, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817, -2714.745867531087, -2656.7738994675174, -2568.5156543898556, -2541.254108542578, -2591.048002510315, -2684.519263104769, -2642.483433834375, -2595.5486596441974, -2615.512396102583, -2597.121081422249, -2517.4072859762264, -2567.2896185090913, -2699.261262513071, -2648.631362458925, -2550.7779702143603, -2516.0716089689054, -2640.178372298683, -2560.0827083181953, -2575.094836333511, -2602.1330767135796], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.8205506375664, "mean_raw_obs_processing_ms": 1.8875601887034799, "mean_inference_ms": 7.658623848621861, "mean_action_processing_ms": 0.22705030104786872}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1240000, "timers": {"sample_time_ms": 1137584.797, "sample_throughput": 3.516, "learn_time_ms": 16451.747, "learn_throughput": 243.135, "update_time_ms": 34.353}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.024511974770575762, "policy_loss": -0.07080239354399964, "vf_loss": 4523.309761047363, "vf_explained_var": -3.725290298461914e-09, "kl": 0.009839428559644148, "entropy": 49.37743413448334, "entropy_coeff": 0.001}}, "num_steps_sampled": 1240000, "num_steps_trained": 1240000}, "done": false, "episodes_total": 1240, "training_iteration": 310, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_04-32-11", "timestamp": 1618259531, "time_this_iter_s": 1215.1263387203217, "time_total_s": 381276.7036988735, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 295520.93294095993, "timesteps_since_restore": 0, "iterations_since_restore": 260, "perf": {"cpu_util_percent": 21.800924855491328, "ram_util_percent": 35.87734104046242}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2738.1510741594684, "episode_reward_mean": -2592.725996891847, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2661.080420091431, -2574.848273325398, -2616.39367740091, -2642.6818346885116, -2623.7060176570626, -2523.2744313423445, -2616.2729548096545, -2515.713369509781, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817, -2714.745867531087, -2656.7738994675174, -2568.5156543898556, -2541.254108542578, -2591.048002510315, -2684.519263104769, -2642.483433834375, -2595.5486596441974, -2615.512396102583, -2597.121081422249, -2517.4072859762264, -2567.2896185090913, -2699.261262513071, -2648.631362458925, -2550.7779702143603, -2516.0716089689054, -2640.178372298683, -2560.0827083181953, -2575.094836333511, -2602.1330767135796, -2553.19569306753, -2600.655911183341, -2577.8176465728147, -2681.932977314566], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.8794549700658, "mean_raw_obs_processing_ms": 1.8876699517130817, "mean_inference_ms": 7.659365470340947, "mean_action_processing_ms": 0.2270759817715311}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1244000, "timers": {"sample_time_ms": 1139324.554, "sample_throughput": 3.511, "learn_time_ms": 16748.501, "learn_throughput": 238.827, "update_time_ms": 38.18}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.014322923874715343, "policy_loss": -0.06206211360404268, "vf_loss": 4442.240379333496, "vf_explained_var": 7.450580596923828e-09, "kl": 0.010184820130234584, "entropy": 48.888373613357544, "entropy_coeff": 0.001}}, "num_steps_sampled": 1244000, "num_steps_trained": 1244000}, "done": false, "episodes_total": 1244, "training_iteration": 311, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_04-51-51", "timestamp": 1618260711, "time_this_iter_s": 1179.0684869289398, "time_total_s": 382455.77218580246, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 296700.00142788887, "timesteps_since_restore": 0, "iterations_since_restore": 261, "perf": {"cpu_util_percent": 21.376758045292014, "ram_util_percent": 35.879916567342065}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2738.1510741594684, "episode_reward_mean": -2594.8565442057566, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2672.8454249480696, -2613.800757116385, -2602.064127775097, -2603.3111948702767, -2493.8781959186626, -2593.0252581549535, -2585.888606076236, -2508.064442913434, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817, -2714.745867531087, -2656.7738994675174, -2568.5156543898556, -2541.254108542578, -2591.048002510315, -2684.519263104769, -2642.483433834375, -2595.5486596441974, -2615.512396102583, -2597.121081422249, -2517.4072859762264, -2567.2896185090913, -2699.261262513071, -2648.631362458925, -2550.7779702143603, -2516.0716089689054, -2640.178372298683, -2560.0827083181953, -2575.094836333511, -2602.1330767135796, -2553.19569306753, -2600.655911183341, -2577.8176465728147, -2681.932977314566, -2661.080420091431, -2574.848273325398, -2616.39367740091, -2642.6818346885116], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.9362179076212, "mean_raw_obs_processing_ms": 1.887779173555881, "mean_inference_ms": 7.6601361174116995, "mean_action_processing_ms": 0.22710498791793604}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1248000, "timers": {"sample_time_ms": 1145752.052, "sample_throughput": 3.491, "learn_time_ms": 16824.275, "learn_throughput": 237.752, "update_time_ms": 39.046}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.010451928828842938, "policy_loss": -0.05591225525131449, "vf_loss": 4516.809661865234, "vf_explained_var": -7.450580596923828e-09, "kl": 0.009681185183580965, "entropy": 49.33140432834625, "entropy_coeff": 0.001}}, "num_steps_sampled": 1248000, "num_steps_trained": 1248000}, "done": false, "episodes_total": 1248, "training_iteration": 312, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_05-11-35", "timestamp": 1618261895, "time_this_iter_s": 1184.8443143367767, "time_total_s": 383640.61650013924, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 297884.84574222565, "timesteps_since_restore": 0, "iterations_since_restore": 262, "perf": {"cpu_util_percent": 21.67212336892052, "ram_util_percent": 35.87277580071174}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2738.1510741594684, "episode_reward_mean": -2596.1381396521315, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2524.801746312397, -2540.0000190641913, -2697.048850552052, -2547.1654317721645, -2486.3573183694075, -2608.1090203228036, -2550.686303642285, -2564.4842673988787, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817, -2714.745867531087, -2656.7738994675174, -2568.5156543898556, -2541.254108542578, -2591.048002510315, -2684.519263104769, -2642.483433834375, -2595.5486596441974, -2615.512396102583, -2597.121081422249, -2517.4072859762264, -2567.2896185090913, -2699.261262513071, -2648.631362458925, -2550.7779702143603, -2516.0716089689054, -2640.178372298683, -2560.0827083181953, -2575.094836333511, -2602.1330767135796, -2553.19569306753, -2600.655911183341, -2577.8176465728147, -2681.932977314566, -2661.080420091431, -2574.848273325398, -2616.39367740091, -2642.6818346885116, -2672.8454249480696, -2613.800757116385, -2602.064127775097, -2603.3111948702767], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 547.9850439313142, "mean_raw_obs_processing_ms": 1.8878946455679573, "mean_inference_ms": 7.6606956873090315, "mean_action_processing_ms": 0.2271311360221925}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1252000, "timers": {"sample_time_ms": 1146922.757, "sample_throughput": 3.488, "learn_time_ms": 16903.527, "learn_throughput": 236.637, "update_time_ms": 38.329}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.014827919047093019, "policy_loss": -0.06315864954376593, "vf_loss": 4382.174423217773, "vf_explained_var": -2.2351741790771484e-08, "kl": 0.010396184923592955, "entropy": 48.7795786857605, "entropy_coeff": 0.001}}, "num_steps_sampled": 1252000, "num_steps_trained": 1252000}, "done": false, "episodes_total": 1252, "training_iteration": 313, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_05-30-28", "timestamp": 1618263028, "time_this_iter_s": 1132.8852100372314, "time_total_s": 384773.50171017647, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 299017.7309522629, "timesteps_since_restore": 0, "iterations_since_restore": 263, "perf": {"cpu_util_percent": 22.21928084314941, "ram_util_percent": 35.860818350898946}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2738.1510741594684, "episode_reward_mean": -2597.2042389873723, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2594.8056986222837, -2584.7384885718093, -2535.9467843157536, -2600.7558717475413, -2619.870018006426, -2586.4942221913902, -2547.5692324464194, -2536.020667722791, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817, -2714.745867531087, -2656.7738994675174, -2568.5156543898556, -2541.254108542578, -2591.048002510315, -2684.519263104769, -2642.483433834375, -2595.5486596441974, -2615.512396102583, -2597.121081422249, -2517.4072859762264, -2567.2896185090913, -2699.261262513071, -2648.631362458925, -2550.7779702143603, -2516.0716089689054, -2640.178372298683, -2560.0827083181953, -2575.094836333511, -2602.1330767135796, -2553.19569306753, -2600.655911183341, -2577.8176465728147, -2681.932977314566, -2661.080420091431, -2574.848273325398, -2616.39367740091, -2642.6818346885116, -2672.8454249480696, -2613.800757116385, -2602.064127775097, -2603.3111948702767, -2524.801746312397, -2540.0000190641913, -2697.048850552052, -2547.1654317721645], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 548.0326357209258, "mean_raw_obs_processing_ms": 1.8880112541882073, "mean_inference_ms": 7.661297866536025, "mean_action_processing_ms": 0.2271604014528866}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1256000, "timers": {"sample_time_ms": 1153930.897, "sample_throughput": 3.466, "learn_time_ms": 16830.389, "learn_throughput": 237.665, "update_time_ms": 36.602}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.014841283962596208, "policy_loss": -0.06294272310333326, "vf_loss": 4456.781364440918, "vf_explained_var": -1.4901161193847656e-08, "kl": 0.010219328163657337, "entropy": 48.848408222198486, "entropy_coeff": 0.001}}, "num_steps_sampled": 1256000, "num_steps_trained": 1256000}, "done": false, "episodes_total": 1256, "training_iteration": 314, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_05-50-34", "timestamp": 1618264234, "time_this_iter_s": 1205.220222234726, "time_total_s": 385978.7219324112, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 300222.9511744976, "timesteps_since_restore": 0, "iterations_since_restore": 264, "perf": {"cpu_util_percent": 22.252214452214453, "ram_util_percent": 35.85180652680652}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2738.1510741594684, "episode_reward_mean": -2599.1486067472674, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2593.969538920055, -2556.512233053718, -2663.8782079035827, -2670.030936479214, -2577.7844284450084, -2549.9455646655456, -2627.4195891988347, -2545.1893549229503, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817, -2714.745867531087, -2656.7738994675174, -2568.5156543898556, -2541.254108542578, -2591.048002510315, -2684.519263104769, -2642.483433834375, -2595.5486596441974, -2615.512396102583, -2597.121081422249, -2517.4072859762264, -2567.2896185090913, -2699.261262513071, -2648.631362458925, -2550.7779702143603, -2516.0716089689054, -2640.178372298683, -2560.0827083181953, -2575.094836333511, -2602.1330767135796, -2553.19569306753, -2600.655911183341, -2577.8176465728147, -2681.932977314566, -2661.080420091431, -2574.848273325398, -2616.39367740091, -2642.6818346885116, -2672.8454249480696, -2613.800757116385, -2602.064127775097, -2603.3111948702767, -2524.801746312397, -2540.0000190641913, -2697.048850552052, -2547.1654317721645, -2594.8056986222837, -2584.7384885718093, -2535.9467843157536, -2600.7558717475413], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 548.0756923191607, "mean_raw_obs_processing_ms": 1.888130434122175, "mean_inference_ms": 7.661814315646033, "mean_action_processing_ms": 0.22718052998435576}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1260000, "timers": {"sample_time_ms": 1150639.217, "sample_throughput": 3.476, "learn_time_ms": 17553.081, "learn_throughput": 227.88, "update_time_ms": 37.462}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.014265586854889989, "policy_loss": -0.0635278407135047, "vf_loss": 4553.826225280762, "vf_explained_var": 1.862645149230957e-09, "kl": 0.010238439834211022, "entropy": 48.756006360054016, "entropy_coeff": 0.001}}, "num_steps_sampled": 1260000, "num_steps_trained": 1260000}, "done": false, "episodes_total": 1260, "training_iteration": 315, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_06-09-39", "timestamp": 1618265379, "time_this_iter_s": 1145.8836357593536, "time_total_s": 387124.60556817055, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 301368.83481025696, "timesteps_since_restore": 0, "iterations_since_restore": 265, "perf": {"cpu_util_percent": 22.09417535254445, "ram_util_percent": 35.87265481299816}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2738.1510741594684, "episode_reward_mean": -2599.622215066063, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2620.3027592596222, -2621.919643195325, -2561.4774387894554, -2543.999927867445, -2633.9443602614897, -2667.0632572992977, -2574.6782238822843, -2637.2780087206124, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817, -2714.745867531087, -2656.7738994675174, -2568.5156543898556, -2541.254108542578, -2591.048002510315, -2684.519263104769, -2642.483433834375, -2595.5486596441974, -2615.512396102583, -2597.121081422249, -2517.4072859762264, -2567.2896185090913, -2699.261262513071, -2648.631362458925, -2550.7779702143603, -2516.0716089689054, -2640.178372298683, -2560.0827083181953, -2575.094836333511, -2602.1330767135796, -2553.19569306753, -2600.655911183341, -2577.8176465728147, -2681.932977314566, -2661.080420091431, -2574.848273325398, -2616.39367740091, -2642.6818346885116, -2672.8454249480696, -2613.800757116385, -2602.064127775097, -2603.3111948702767, -2524.801746312397, -2540.0000190641913, -2697.048850552052, -2547.1654317721645, -2594.8056986222837, -2584.7384885718093, -2535.9467843157536, -2600.7558717475413, -2593.969538920055, -2556.512233053718, -2663.8782079035827, -2670.030936479214], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 548.1167733415349, "mean_raw_obs_processing_ms": 1.888242656865209, "mean_inference_ms": 7.662261591638197, "mean_action_processing_ms": 0.2272049259188871}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1264000, "timers": {"sample_time_ms": 1151826.806, "sample_throughput": 3.473, "learn_time_ms": 17492.358, "learn_throughput": 228.671, "update_time_ms": 39.089}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.023343758570263162, "policy_loss": -0.07048237236449495, "vf_loss": 4314.153831481934, "vf_explained_var": 1.1175870895385742e-08, "kl": 0.010341440996853635, "entropy": 49.010886549949646, "entropy_coeff": 0.001}}, "num_steps_sampled": 1264000, "num_steps_trained": 1264000}, "done": false, "episodes_total": 1264, "training_iteration": 316, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_06-29-11", "timestamp": 1618266551, "time_this_iter_s": 1171.0531759262085, "time_total_s": 388295.65874409676, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 302539.88798618317, "timesteps_since_restore": 0, "iterations_since_restore": 266, "perf": {"cpu_util_percent": 22.373305338932216, "ram_util_percent": 35.916676664667065}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2738.1510741594684, "episode_reward_mean": -2599.177692882486, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2527.6132701347133, -2674.1314571431744, -2559.559817712305, -2707.2070868159, -2615.674014117744, -2738.1510741594684, -2527.914354404398, -2535.819555651834, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817, -2714.745867531087, -2656.7738994675174, -2568.5156543898556, -2541.254108542578, -2591.048002510315, -2684.519263104769, -2642.483433834375, -2595.5486596441974, -2615.512396102583, -2597.121081422249, -2517.4072859762264, -2567.2896185090913, -2699.261262513071, -2648.631362458925, -2550.7779702143603, -2516.0716089689054, -2640.178372298683, -2560.0827083181953, -2575.094836333511, -2602.1330767135796, -2553.19569306753, -2600.655911183341, -2577.8176465728147, -2681.932977314566, -2661.080420091431, -2574.848273325398, -2616.39367740091, -2642.6818346885116, -2672.8454249480696, -2613.800757116385, -2602.064127775097, -2603.3111948702767, -2524.801746312397, -2540.0000190641913, -2697.048850552052, -2547.1654317721645, -2594.8056986222837, -2584.7384885718093, -2535.9467843157536, -2600.7558717475413, -2593.969538920055, -2556.512233053718, -2663.8782079035827, -2670.030936479214, -2620.3027592596222, -2621.919643195325, -2561.4774387894554, -2543.999927867445], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 548.1515682732937, "mean_raw_obs_processing_ms": 1.8883531123427486, "mean_inference_ms": 7.662639144128978, "mean_action_processing_ms": 0.22722118117091086}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1268000, "timers": {"sample_time_ms": 1151901.258, "sample_throughput": 3.473, "learn_time_ms": 17404.892, "learn_throughput": 229.82, "update_time_ms": 38.091}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.009696272754808888, "policy_loss": -0.061183150857686996, "vf_loss": 4730.130836486816, "vf_explained_var": -1.1175870895385742e-08, "kl": 0.010407572233816609, "entropy": 49.16136658191681, "entropy_coeff": 0.001}}, "num_steps_sampled": 1268000, "num_steps_trained": 1268000}, "done": false, "episodes_total": 1268, "training_iteration": 317, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_06-48-03", "timestamp": 1618267683, "time_this_iter_s": 1132.5960607528687, "time_total_s": 389428.2548048496, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 303672.48404693604, "timesteps_since_restore": 0, "iterations_since_restore": 267, "perf": {"cpu_util_percent": 21.856327543424317, "ram_util_percent": 35.97642679900744}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2723.1878420841517, "episode_reward_mean": -2600.5531562515407, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2604.7577679607034, -2624.7361702313196, -2624.8523192361317, -2700.7590778106733, -2647.2624222534064, -2521.8601529607495, -2579.140097778687, -2577.69811349371, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817, -2714.745867531087, -2656.7738994675174, -2568.5156543898556, -2541.254108542578, -2591.048002510315, -2684.519263104769, -2642.483433834375, -2595.5486596441974, -2615.512396102583, -2597.121081422249, -2517.4072859762264, -2567.2896185090913, -2699.261262513071, -2648.631362458925, -2550.7779702143603, -2516.0716089689054, -2640.178372298683, -2560.0827083181953, -2575.094836333511, -2602.1330767135796, -2553.19569306753, -2600.655911183341, -2577.8176465728147, -2681.932977314566, -2661.080420091431, -2574.848273325398, -2616.39367740091, -2642.6818346885116, -2672.8454249480696, -2613.800757116385, -2602.064127775097, -2603.3111948702767, -2524.801746312397, -2540.0000190641913, -2697.048850552052, -2547.1654317721645, -2594.8056986222837, -2584.7384885718093, -2535.9467843157536, -2600.7558717475413, -2593.969538920055, -2556.512233053718, -2663.8782079035827, -2670.030936479214, -2620.3027592596222, -2621.919643195325, -2561.4774387894554, -2543.999927867445, -2527.6132701347133, -2674.1314571431744, -2559.559817712305, -2707.2070868159], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 548.1857110854642, "mean_raw_obs_processing_ms": 1.8884634487282062, "mean_inference_ms": 7.662990627677036, "mean_action_processing_ms": 0.22725084974991966}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1272000, "timers": {"sample_time_ms": 1154830.037, "sample_throughput": 3.464, "learn_time_ms": 16769.521, "learn_throughput": 238.528, "update_time_ms": 40.073}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.01956417254405096, "policy_loss": -0.06635894799546804, "vf_loss": 4525.472679138184, "vf_explained_var": -3.725290298461914e-09, "kl": 0.00987658929079771, "entropy": 49.08518362045288, "entropy_coeff": 0.001}}, "num_steps_sampled": 1272000, "num_steps_trained": 1272000}, "done": false, "episodes_total": 1272, "training_iteration": 318, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_07-07-53", "timestamp": 1618268873, "time_this_iter_s": 1189.5070888996124, "time_total_s": 390617.76189374924, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 304861.99113583565, "timesteps_since_restore": 0, "iterations_since_restore": 268, "perf": {"cpu_util_percent": 21.823803898405195, "ram_util_percent": 35.9822799763733}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2723.1878420841517, "episode_reward_mean": -2600.6763609886093, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2654.131277973984, -2653.4113094414397, -2516.480200597169, -2514.2584721808976, -2682.018746963604, -2484.1948464527354, -2660.5396986911232, -2599.5250620134, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817, -2714.745867531087, -2656.7738994675174, -2568.5156543898556, -2541.254108542578, -2591.048002510315, -2684.519263104769, -2642.483433834375, -2595.5486596441974, -2615.512396102583, -2597.121081422249, -2517.4072859762264, -2567.2896185090913, -2699.261262513071, -2648.631362458925, -2550.7779702143603, -2516.0716089689054, -2640.178372298683, -2560.0827083181953, -2575.094836333511, -2602.1330767135796, -2553.19569306753, -2600.655911183341, -2577.8176465728147, -2681.932977314566, -2661.080420091431, -2574.848273325398, -2616.39367740091, -2642.6818346885116, -2672.8454249480696, -2613.800757116385, -2602.064127775097, -2603.3111948702767, -2524.801746312397, -2540.0000190641913, -2697.048850552052, -2547.1654317721645, -2594.8056986222837, -2584.7384885718093, -2535.9467843157536, -2600.7558717475413, -2593.969538920055, -2556.512233053718, -2663.8782079035827, -2670.030936479214, -2620.3027592596222, -2621.919643195325, -2561.4774387894554, -2543.999927867445, -2527.6132701347133, -2674.1314571431744, -2559.559817712305, -2707.2070868159, -2604.7577679607034, -2624.7361702313196, -2624.8523192361317, -2700.7590778106733], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 548.222530325862, "mean_raw_obs_processing_ms": 1.888575767379496, "mean_inference_ms": 7.663416702461933, "mean_action_processing_ms": 0.2272819563589816}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1276000, "timers": {"sample_time_ms": 1156586.429, "sample_throughput": 3.458, "learn_time_ms": 16827.194, "learn_throughput": 237.71, "update_time_ms": 39.526}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.011506790237035602, "policy_loss": -0.055538031563628465, "vf_loss": 4188.601505279541, "vf_explained_var": 5.587935447692871e-09, "kl": 0.010025105235399678, "entropy": 49.24126660823822, "entropy_coeff": 0.001}}, "num_steps_sampled": 1276000, "num_steps_trained": 1276000}, "done": false, "episodes_total": 1276, "training_iteration": 319, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_07-27-31", "timestamp": 1618270051, "time_this_iter_s": 1178.4431974887848, "time_total_s": 391796.205091238, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 306040.43433332443, "timesteps_since_restore": 0, "iterations_since_restore": 269, "perf": {"cpu_util_percent": 22.095411203814066, "ram_util_percent": 35.97443384982121}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2723.1878420841517, "episode_reward_mean": -2601.1317012611225, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2681.7611887993603, -2602.6346243850603, -2587.740907620948, -2599.675660566734, -2619.365112942418, -2564.555949380374, -2509.5377495659523, -2580.945302784127, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817, -2714.745867531087, -2656.7738994675174, -2568.5156543898556, -2541.254108542578, -2591.048002510315, -2684.519263104769, -2642.483433834375, -2595.5486596441974, -2615.512396102583, -2597.121081422249, -2517.4072859762264, -2567.2896185090913, -2699.261262513071, -2648.631362458925, -2550.7779702143603, -2516.0716089689054, -2640.178372298683, -2560.0827083181953, -2575.094836333511, -2602.1330767135796, -2553.19569306753, -2600.655911183341, -2577.8176465728147, -2681.932977314566, -2661.080420091431, -2574.848273325398, -2616.39367740091, -2642.6818346885116, -2672.8454249480696, -2613.800757116385, -2602.064127775097, -2603.3111948702767, -2524.801746312397, -2540.0000190641913, -2697.048850552052, -2547.1654317721645, -2594.8056986222837, -2584.7384885718093, -2535.9467843157536, -2600.7558717475413, -2593.969538920055, -2556.512233053718, -2663.8782079035827, -2670.030936479214, -2620.3027592596222, -2621.919643195325, -2561.4774387894554, -2543.999927867445, -2527.6132701347133, -2674.1314571431744, -2559.559817712305, -2707.2070868159, -2604.7577679607034, -2624.7361702313196, -2624.8523192361317, -2700.7590778106733, -2654.131277973984, -2653.4113094414397, -2516.480200597169, -2514.2584721808976], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 548.2612574461584, "mean_raw_obs_processing_ms": 1.888709786386805, "mean_inference_ms": 7.66385291580043, "mean_action_processing_ms": 0.22730560010725004}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1280000, "timers": {"sample_time_ms": 1150835.149, "sample_throughput": 3.476, "learn_time_ms": 16916.63, "learn_throughput": 236.454, "update_time_ms": 42.164}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.008040627173613757, "policy_loss": -0.05864018411375582, "vf_loss": 4622.1949462890625, "vf_explained_var": 3.725290298461914e-09, "kl": 0.010499211173737422, "entropy": 49.43904960155487, "entropy_coeff": 0.001}}, "num_steps_sampled": 1280000, "num_steps_trained": 1280000}, "done": false, "episodes_total": 1280, "training_iteration": 320, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_07-46-50", "timestamp": 1618271210, "time_this_iter_s": 1158.5352354049683, "time_total_s": 392954.740326643, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 307198.9695687294, "timesteps_since_restore": 0, "iterations_since_restore": 270, "perf": {"cpu_util_percent": 22.157575757575756, "ram_util_percent": 35.99333333333333}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2723.1878420841517, "episode_reward_mean": -2603.4670784340774, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2680.7458942199096, -2641.296499865457, -2641.232325682682, -2544.6671122002936, -2581.9748091396696, -2657.9340736939835, -2636.3155120026336, -2597.959161106923, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817, -2714.745867531087, -2656.7738994675174, -2568.5156543898556, -2541.254108542578, -2591.048002510315, -2684.519263104769, -2642.483433834375, -2595.5486596441974, -2615.512396102583, -2597.121081422249, -2517.4072859762264, -2567.2896185090913, -2699.261262513071, -2648.631362458925, -2550.7779702143603, -2516.0716089689054, -2640.178372298683, -2560.0827083181953, -2575.094836333511, -2602.1330767135796, -2553.19569306753, -2600.655911183341, -2577.8176465728147, -2681.932977314566, -2661.080420091431, -2574.848273325398, -2616.39367740091, -2642.6818346885116, -2672.8454249480696, -2613.800757116385, -2602.064127775097, -2603.3111948702767, -2524.801746312397, -2540.0000190641913, -2697.048850552052, -2547.1654317721645, -2594.8056986222837, -2584.7384885718093, -2535.9467843157536, -2600.7558717475413, -2593.969538920055, -2556.512233053718, -2663.8782079035827, -2670.030936479214, -2620.3027592596222, -2621.919643195325, -2561.4774387894554, -2543.999927867445, -2527.6132701347133, -2674.1314571431744, -2559.559817712305, -2707.2070868159, -2604.7577679607034, -2624.7361702313196, -2624.8523192361317, -2700.7590778106733, -2654.131277973984, -2653.4113094414397, -2516.480200597169, -2514.2584721808976, -2681.7611887993603, -2602.6346243850603, -2587.740907620948, -2599.675660566734], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 548.3042271886358, "mean_raw_obs_processing_ms": 1.8888475108022487, "mean_inference_ms": 7.664340051707233, "mean_action_processing_ms": 0.22732234534613951}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1284000, "timers": {"sample_time_ms": 1151552.134, "sample_throughput": 3.474, "learn_time_ms": 16977.459, "learn_throughput": 235.607, "update_time_ms": 41.435}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.017956725394469686, "policy_loss": -0.0636222493922105, "vf_loss": 4373.098327636719, "vf_explained_var": -9.313225746154785e-09, "kl": 0.009893054404528812, "entropy": 48.7750860452652, "entropy_coeff": 0.001}}, "num_steps_sampled": 1284000, "num_steps_trained": 1284000}, "done": false, "episodes_total": 1284, "training_iteration": 321, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_08-06-37", "timestamp": 1618272397, "time_this_iter_s": 1186.8354132175446, "time_total_s": 394141.57573986053, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 308385.80498194695, "timesteps_since_restore": 0, "iterations_since_restore": 271, "perf": {"cpu_util_percent": 21.72557726465364, "ram_util_percent": 35.96264061574896}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2723.1878420841517, "episode_reward_mean": -2602.0723446157117, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2611.9677541135743, -2612.2877924895315, -2522.5241266402986, -2587.9305008633014, -2603.7692808627303, -2577.528150899169, -2658.603862427157, -2618.6096537538488, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817, -2714.745867531087, -2656.7738994675174, -2568.5156543898556, -2541.254108542578, -2591.048002510315, -2684.519263104769, -2642.483433834375, -2595.5486596441974, -2615.512396102583, -2597.121081422249, -2517.4072859762264, -2567.2896185090913, -2699.261262513071, -2648.631362458925, -2550.7779702143603, -2516.0716089689054, -2640.178372298683, -2560.0827083181953, -2575.094836333511, -2602.1330767135796, -2553.19569306753, -2600.655911183341, -2577.8176465728147, -2681.932977314566, -2661.080420091431, -2574.848273325398, -2616.39367740091, -2642.6818346885116, -2672.8454249480696, -2613.800757116385, -2602.064127775097, -2603.3111948702767, -2524.801746312397, -2540.0000190641913, -2697.048850552052, -2547.1654317721645, -2594.8056986222837, -2584.7384885718093, -2535.9467843157536, -2600.7558717475413, -2593.969538920055, -2556.512233053718, -2663.8782079035827, -2670.030936479214, -2620.3027592596222, -2621.919643195325, -2561.4774387894554, -2543.999927867445, -2527.6132701347133, -2674.1314571431744, -2559.559817712305, -2707.2070868159, -2604.7577679607034, -2624.7361702313196, -2624.8523192361317, -2700.7590778106733, -2654.131277973984, -2653.4113094414397, -2516.480200597169, -2514.2584721808976, -2681.7611887993603, -2602.6346243850603, -2587.740907620948, -2599.675660566734, -2680.7458942199096, -2641.296499865457, -2641.232325682682, -2544.6671122002936], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 548.3481209836605, "mean_raw_obs_processing_ms": 1.8889593854470434, "mean_inference_ms": 7.66479749202988, "mean_action_processing_ms": 0.22735160102381122}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1288000, "timers": {"sample_time_ms": 1152369.379, "sample_throughput": 3.471, "learn_time_ms": 16758.09, "learn_throughput": 238.691, "update_time_ms": 41.643}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.017691949440632015, "policy_loss": -0.060987766162725165, "vf_loss": 4208.5130615234375, "vf_explained_var": -1.1175870895385742e-08, "kl": 0.009782310604350641, "entropy": 48.93129110336304, "entropy_coeff": 0.001}}, "num_steps_sampled": 1288000, "num_steps_trained": 1288000}, "done": false, "episodes_total": 1288, "training_iteration": 322, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_08-26-28", "timestamp": 1618273588, "time_this_iter_s": 1190.8631842136383, "time_total_s": 395332.4389240742, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 309576.6681661606, "timesteps_since_restore": 0, "iterations_since_restore": 272, "perf": {"cpu_util_percent": 25.386489675516227, "ram_util_percent": 36.45498525073746}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2406.880195647551, "episode_reward_min": -2723.1878420841517, "episode_reward_mean": -2601.5833796721945, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2608.2148490251334, -2577.28837761254, -2646.20569026291, -2577.905536690599, -2469.2063656336613, -2663.2234078787224, -2406.880195647551, -2566.8611028037544, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817, -2714.745867531087, -2656.7738994675174, -2568.5156543898556, -2541.254108542578, -2591.048002510315, -2684.519263104769, -2642.483433834375, -2595.5486596441974, -2615.512396102583, -2597.121081422249, -2517.4072859762264, -2567.2896185090913, -2699.261262513071, -2648.631362458925, -2550.7779702143603, -2516.0716089689054, -2640.178372298683, -2560.0827083181953, -2575.094836333511, -2602.1330767135796, -2553.19569306753, -2600.655911183341, -2577.8176465728147, -2681.932977314566, -2661.080420091431, -2574.848273325398, -2616.39367740091, -2642.6818346885116, -2672.8454249480696, -2613.800757116385, -2602.064127775097, -2603.3111948702767, -2524.801746312397, -2540.0000190641913, -2697.048850552052, -2547.1654317721645, -2594.8056986222837, -2584.7384885718093, -2535.9467843157536, -2600.7558717475413, -2593.969538920055, -2556.512233053718, -2663.8782079035827, -2670.030936479214, -2620.3027592596222, -2621.919643195325, -2561.4774387894554, -2543.999927867445, -2527.6132701347133, -2674.1314571431744, -2559.559817712305, -2707.2070868159, -2604.7577679607034, -2624.7361702313196, -2624.8523192361317, -2700.7590778106733, -2654.131277973984, -2653.4113094414397, -2516.480200597169, -2514.2584721808976, -2681.7611887993603, -2602.6346243850603, -2587.740907620948, -2599.675660566734, -2680.7458942199096, -2641.296499865457, -2641.232325682682, -2544.6671122002936, -2611.9677541135743, -2612.2877924895315, -2522.5241266402986, -2587.9305008633014], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 548.397393947226, "mean_raw_obs_processing_ms": 1.8890545831146257, "mean_inference_ms": 7.665337168209202, "mean_action_processing_ms": 0.2273823292676601}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1292000, "timers": {"sample_time_ms": 1162137.21, "sample_throughput": 3.442, "learn_time_ms": 16694.157, "learn_throughput": 239.605, "update_time_ms": 42.201}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.009496694518020377, "policy_loss": -0.06142913771327585, "vf_loss": 4787.549476623535, "vf_explained_var": -1.862645149230957e-09, "kl": 0.0103884506970644, "entropy": 49.191972494125366, "entropy_coeff": 0.001}}, "num_steps_sampled": 1292000, "num_steps_trained": 1292000}, "done": false, "episodes_total": 1292, "training_iteration": 323, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_08-46-58", "timestamp": 1618274818, "time_this_iter_s": 1229.9299461841583, "time_total_s": 396562.36887025833, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 310806.59811234474, "timesteps_since_restore": 0, "iterations_since_restore": 273, "perf": {"cpu_util_percent": 22.520388349514562, "ram_util_percent": 30.33814962878355}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2506.0623389823136, "episode_reward_min": -2723.1878420841517, "episode_reward_mean": -2604.735616912212, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2638.965812129919, -2546.4948583487894, -2606.077953009761, -2629.856172476998, -2723.1878420841517, -2650.320781737447, -2586.8645333709046, -2679.3435186195957, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817, -2714.745867531087, -2656.7738994675174, -2568.5156543898556, -2541.254108542578, -2591.048002510315, -2684.519263104769, -2642.483433834375, -2595.5486596441974, -2615.512396102583, -2597.121081422249, -2517.4072859762264, -2567.2896185090913, -2699.261262513071, -2648.631362458925, -2550.7779702143603, -2516.0716089689054, -2640.178372298683, -2560.0827083181953, -2575.094836333511, -2602.1330767135796, -2553.19569306753, -2600.655911183341, -2577.8176465728147, -2681.932977314566, -2661.080420091431, -2574.848273325398, -2616.39367740091, -2642.6818346885116, -2672.8454249480696, -2613.800757116385, -2602.064127775097, -2603.3111948702767, -2524.801746312397, -2540.0000190641913, -2697.048850552052, -2547.1654317721645, -2594.8056986222837, -2584.7384885718093, -2535.9467843157536, -2600.7558717475413, -2593.969538920055, -2556.512233053718, -2663.8782079035827, -2670.030936479214, -2620.3027592596222, -2621.919643195325, -2561.4774387894554, -2543.999927867445, -2527.6132701347133, -2674.1314571431744, -2559.559817712305, -2707.2070868159, -2604.7577679607034, -2624.7361702313196, -2624.8523192361317, -2700.7590778106733, -2654.131277973984, -2653.4113094414397, -2516.480200597169, -2514.2584721808976, -2681.7611887993603, -2602.6346243850603, -2587.740907620948, -2599.675660566734, -2680.7458942199096, -2641.296499865457, -2641.232325682682, -2544.6671122002936, -2611.9677541135743, -2612.2877924895315, -2522.5241266402986, -2587.9305008633014, -2608.2148490251334, -2577.28837761254, -2646.20569026291, -2577.905536690599], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 548.4475732338432, "mean_raw_obs_processing_ms": 1.8891897167762275, "mean_inference_ms": 7.665872709419597, "mean_action_processing_ms": 0.22741072306478569}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1296000, "timers": {"sample_time_ms": 1156889.158, "sample_throughput": 3.458, "learn_time_ms": 16776.334, "learn_throughput": 238.431, "update_time_ms": 41.867}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.017779330868506804, "policy_loss": -0.06459568289574236, "vf_loss": 4496.902252197266, "vf_explained_var": -3.725290298461914e-09, "kl": 0.009951716026989743, "entropy": 49.16298425197601, "entropy_coeff": 0.001}}, "num_steps_sampled": 1296000, "num_steps_trained": 1296000}, "done": false, "episodes_total": 1296, "training_iteration": 324, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_09-06-11", "timestamp": 1618275971, "time_this_iter_s": 1153.5579340457916, "time_total_s": 397715.9268043041, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 311960.15604639053, "timesteps_since_restore": 0, "iterations_since_restore": 274, "perf": {"cpu_util_percent": 23.353747714808044, "ram_util_percent": 24.750639853747717}, "trial_id": "9fefe_00000"}
{"episode_reward_max": -2499.3396358827845, "episode_reward_min": -2714.745867531087, "episode_reward_mean": -2600.7115406417274, "episode_len_mean": 1000.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2560.7099210152737, -2610.4487579029264, -2566.8107339625585, -2499.3396358827845, -2607.026873846456, -2619.353650452495, -2641.3630619216447, -2521.4786712643377, -2586.3933017475933, -2541.046816306267, -2631.3167811806056, -2572.7602796706906, -2667.3550243470213, -2514.908654762, -2652.3685595789757, -2624.9673872818234, -2506.0623389823136, -2518.4366147601845, -2569.5679309857273, -2609.6352204437817, -2714.745867531087, -2656.7738994675174, -2568.5156543898556, -2541.254108542578, -2591.048002510315, -2684.519263104769, -2642.483433834375, -2595.5486596441974, -2615.512396102583, -2597.121081422249, -2517.4072859762264, -2567.2896185090913, -2699.261262513071, -2648.631362458925, -2550.7779702143603, -2516.0716089689054, -2640.178372298683, -2560.0827083181953, -2575.094836333511, -2602.1330767135796, -2553.19569306753, -2600.655911183341, -2577.8176465728147, -2681.932977314566, -2661.080420091431, -2574.848273325398, -2616.39367740091, -2642.6818346885116, -2672.8454249480696, -2613.800757116385, -2602.064127775097, -2603.3111948702767, -2524.801746312397, -2540.0000190641913, -2697.048850552052, -2547.1654317721645, -2594.8056986222837, -2584.7384885718093, -2535.9467843157536, -2600.7558717475413, -2593.969538920055, -2556.512233053718, -2663.8782079035827, -2670.030936479214, -2620.3027592596222, -2621.919643195325, -2561.4774387894554, -2543.999927867445, -2527.6132701347133, -2674.1314571431744, -2559.559817712305, -2707.2070868159, -2604.7577679607034, -2624.7361702313196, -2624.8523192361317, -2700.7590778106733, -2654.131277973984, -2653.4113094414397, -2516.480200597169, -2514.2584721808976, -2681.7611887993603, -2602.6346243850603, -2587.740907620948, -2599.675660566734, -2680.7458942199096, -2641.296499865457, -2641.232325682682, -2544.6671122002936, -2611.9677541135743, -2612.2877924895315, -2522.5241266402986, -2587.9305008633014, -2608.2148490251334, -2577.28837761254, -2646.20569026291, -2577.905536690599, -2638.965812129919, -2546.4948583487894, -2606.077953009761, -2629.856172476998], "episode_lengths": [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000]}, "sampler_perf": {"mean_env_wait_ms": 548.5026934419001, "mean_raw_obs_processing_ms": 1.8893212336041085, "mean_inference_ms": 7.666470459768936, "mean_action_processing_ms": 0.22743808309194782}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 1300000, "timers": {"sample_time_ms": 1161237.772, "sample_throughput": 3.445, "learn_time_ms": 16801.182, "learn_throughput": 238.078, "update_time_ms": 41.866}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.12578125, "cur_lr": 5e-05, "total_loss": -0.025210697756847367, "policy_loss": -0.07013554766308516, "vf_loss": 4054.2236328125, "vf_explained_var": -1.6763806343078613e-08, "kl": 0.010435772855998948, "entropy": 49.108869433403015, "entropy_coeff": 0.001}}, "num_steps_sampled": 1300000, "num_steps_trained": 1300000}, "done": false, "episodes_total": 1300, "training_iteration": 325, "experiment_id": "c1e6d782d74f4a5ea46818223f5c4e6a", "date": "2021-04-13_09-26-01", "timestamp": 1618277161, "time_this_iter_s": 1189.619264125824, "time_total_s": 398905.54606842995, "pid": 20506, "hostname": "hk416-All-Series", "node_ip": "192.168.1.130", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 4000, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "FullyConnectedModel", "custom_model_config": {"adj_mask": "[[1. 1. 0. ... 0. 0. 0.]\n [1. 1. 1. ... 0. 0. 0.]\n [0. 1. 1. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 1. 1. 0.]\n [0. 0. 0. ... 1. 1. 1.]\n [0. 0. 0. ... 0. 1. 1.]]"}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"repeat_delay": 2}, "env": "SeqTrafficLightEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": true, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "logger_config": null, "replay_sequence_length": 1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1e-05, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 20.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true, "_fake_gpus": false}, "time_since_restore": 313149.77531051636, "timesteps_since_restore": 0, "iterations_since_restore": 275, "perf": {"cpu_util_percent": 27.94917355371901, "ram_util_percent": 24.99486422668241}, "trial_id": "9fefe_00000"}
